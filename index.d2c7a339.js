(()=>{let t,e,r,n;var i,o,u,a,l,d,c,s=Object.create,f=Object.defineProperty,p=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,_=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,m=(t={"node_modules/big-integer/BigInteger.js"(t,e){var r=function(t){var e=c(9007199254740992),n="0123456789abcdefghijklmnopqrstuvwxyz",i="function"==typeof BigInt;function o(t,e,r,n){return void 0===t?o[0]:void 0!==e&&(10!=+e||r)?F(t,e,r,n):j(t)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function a(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function d(t){return -9007199254740992<t&&t<9007199254740992}function c(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function s(t){f(t);var r=t.length;if(r<4&&0>L(t,e))switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+1e7*t[1];default:return t[0]+(t[1]+1e7*t[2])*1e7}return t}function f(t){for(var e=t.length;0===t[--e];);t.length=e+1}function p(t){for(var e=Array(t),r=-1;++r<t;)e[r]=0;return e}function g(t){return t>0?Math.floor(t):Math.ceil(t)}function _(t,e){var r,n,i=t.length,o=e.length,u=Array(i),a=0;for(n=0;n<o;n++)a=(r=t[n]+e[n]+a)>=1e7?1:0,u[n]=r-1e7*a;for(;n<i;)a=1e7===(r=t[n]+a)?1:0,u[n++]=r-1e7*a;return a>0&&u.push(a),u}function v(t,e){return t.length>=e.length?_(t,e):_(e,t)}function m(t,e){var r,n,i=t.length,o=Array(i);for(n=0;n<i;n++)e=Math.floor((r=t[n]-1e7+e)/1e7),o[n]=r-1e7*e,e+=1;for(;e>0;)o[n++]=e%1e7,e=Math.floor(e/1e7);return o}function h(t,e){var r,n,i=t.length,o=e.length,u=Array(i),a=0;for(r=0;r<o;r++)(n=t[r]-a-e[r])<0?(n+=1e7,a=1):a=0,u[r]=n;for(r=o;r<i;r++){if((n=t[r]-a)<0)n+=1e7;else{u[r++]=n;break}u[r]=n}for(;r<i;r++)u[r]=t[r];return f(u),u}function y(t,e,r){var n,i,o=t.length,l=Array(o),d=-e;for(n=0;n<o;n++)d=Math.floor((i=t[n]+d)/1e7),i%=1e7,l[n]=i<0?i+1e7:i;return"number"==typeof(l=s(l))?(r&&(l=-l),new a(l)):new u(l,r)}function b(t,e){var r,n,i,o,u=t.length,a=e.length,l=p(u+a);for(i=0;i<u;++i){o=t[i];for(var d=0;d<a;++d)n=Math.floor((r=o*e[d]+l[i+d])/1e7),l[i+d]=r-1e7*n,l[i+d+1]+=n}return f(l),l}function R(t,e){var r,n,i=t.length,o=Array(i),u=0;for(n=0;n<i;n++)u=Math.floor((r=t[n]*e+u)/1e7),o[n]=r-1e7*u;for(;u>0;)o[n++]=u%1e7,u=Math.floor(u/1e7);return o}function S(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function J(t,e,r){return t<1e7?new u(R(e,t),r):new u(b(e,c(t)),r)}function w(t){var e,r,n,i,o=t.length,u=p(o+o);for(n=0;n<o;n++){r=0-(i=t[n])*i;for(var a=n;a<o;a++)r=Math.floor((e=i*t[a]*2+u[n+a]+r)/1e7),u[n+a]=e-1e7*r;u[n+o]=r}return f(u),u}function E(t,e){var r,n,i,o,u=t.length,a=p(u);for(i=0,r=u-1;r>=0;--r)n=g((o=1e7*i+t[r])/e),i=o-n*e,a[r]=0|n;return[a,0|i]}function x(t,e){var r,n,d=j(e);if(i)return[new l(t.value/d.value),new l(t.value%d.value)];var _=t.value,v=d.value;if(0===v)throw Error("Cannot divide by zero");if(t.isSmall)return d.isSmall?[new a(g(_/v)),new a(_%v)]:[o[0],t];if(d.isSmall){if(1===v)return[t,o[0]];if(-1==v)return[t.negate(),o[0]];var m=Math.abs(v);if(m<1e7){r=s((n=E(_,m))[0]);var y=n[1];return(t.sign&&(y=-y),"number"==typeof r)?(t.sign!==d.sign&&(r=-r),[new a(r),new a(y)]):[new u(r,t.sign!==d.sign),new a(y)]}v=c(m)}var b=L(_,v);if(-1===b)return[o[0],t];if(0===b)return[o[t.sign===d.sign?1:-1],o[0]];r=(n=_.length+v.length<=200?function(t,e){var r,n,i,o,u,a,l,d=t.length,c=e.length,f=p(e.length),g=e[c-1],_=Math.ceil(1e7/(2*g)),v=R(t,_),m=R(e,_);for(v.length<=d&&v.push(0),m.push(0),g=m[c-1],n=d-c;n>=0;n--){for(r=1e7-1,v[n+c]!==g&&(r=Math.floor((1e7*v[n+c]+v[n+c-1])/g)),i=0,o=0,a=m.length,u=0;u<a;u++)i+=r*m[u],l=Math.floor(i/1e7),o+=v[n+u]-(i-1e7*l),i=l,o<0?(v[n+u]=o+1e7,o=-1):(v[n+u]=o,o=0);for(;0!==o;){for(r-=1,i=0,u=0;u<a;u++)(i+=v[n+u]-1e7+m[u])<0?(v[n+u]=i+1e7,i=0):(v[n+u]=i,i=1);o+=i}f[n]=r}return v=E(v,_)[0],[s(f),s(v)]}(_,v):function(t,e){for(var r,n,i,o,u,a=t.length,l=e.length,d=[],c=[];a;){if(c.unshift(t[--a]),f(c),0>L(c,e)){d.push(0);continue}n=c.length,i=1e7*c[n-1]+c[n-2],o=1e7*e[l-1]+e[l-2],n>l&&(i=(i+1)*1e7),r=Math.ceil(i/o);do{if(0>=L(u=R(e,r),c))break;r--}while(r)d.push(r),c=h(c,u)}return d.reverse(),[s(d),s(c)]}(_,v))[0];var S=t.sign!==d.sign,J=n[1],w=t.sign;return"number"==typeof r?(S&&(r=-r),r=new a(r)):r=new u(r,S),"number"==typeof J?(w&&(J=-J),J=new a(J)):J=new u(J,w),[r,J]}function L(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function N(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function A(t,e){for(var n,i,o,u=t.prev(),a=u,l=0;a.isEven();)a=a.divide(2),l++;t:for(i=0;i<e.length;i++)if(!t.lesser(e[i])&&!((o=r(e[i]).modPow(a,t)).isUnit()||o.equals(u))){for(n=l-1;0!=n&&!(o=o.square().mod(t)).isUnit();n--)if(o.equals(u))continue t;return!1}return!0}u.prototype=Object.create(o.prototype),a.prototype=Object.create(o.prototype),l.prototype=Object.create(o.prototype),u.prototype.add=function(t){var e=j(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(m(r,Math.abs(n)),this.sign):new u(v(r,n),this.sign)},u.prototype.plus=u.prototype.add,a.prototype.add=function(t){var e=j(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(d(r+n))return new a(r+n);n=c(Math.abs(n))}return new u(m(n,Math.abs(r)),r<0)},a.prototype.plus=a.prototype.add,l.prototype.add=function(t){return new l(this.value+j(t).value)},l.prototype.plus=l.prototype.add,u.prototype.subtract=function(t){var e,r,n=j(t);if(this.sign!==n.sign)return this.add(n.negate());var i=this.value,o=n.value;return n.isSmall?y(i,Math.abs(o),this.sign):(e=this.sign,(L(i,o)>=0?r=h(i,o):(r=h(o,i),e=!e),"number"==typeof(r=s(r)))?(e&&(r=-r),new a(r)):new u(r,e))},u.prototype.minus=u.prototype.subtract,a.prototype.subtract=function(t){var e=j(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new a(r-n):y(n,Math.abs(r),r>=0)},a.prototype.minus=a.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-j(t).value)},l.prototype.minus=l.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},a.prototype.negate=function(){var t=this.sign,e=new a(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},a.prototype.abs=function(){return new a(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(t){var e,r,n,i=j(t),a=this.value,l=i.value,d=this.sign!==i.sign;if(i.isSmall){if(0===l)return o[0];if(1===l)return this;if(-1===l)return this.negate();if((n=Math.abs(l))<1e7)return new u(R(a,n),d);l=c(n)}return -.012*(e=a.length)-.012*(r=l.length)+15e-6*e*r>0?new u(function t(e,r){var n=Math.max(e.length,r.length);if(n<=30)return b(e,r);n=Math.ceil(n/2);var i=e.slice(n),o=e.slice(0,n),u=r.slice(n),a=r.slice(0,n),l=t(o,a),d=t(i,u),c=t(v(o,i),v(a,u)),s=v(v(l,S(h(h(c,l),d),n)),S(d,2*n));return f(s),s}(a,l),d):new u(b(a,l),d)},u.prototype.times=u.prototype.multiply,a.prototype._multiplyBySmall=function(t){return d(t.value*this.value)?new a(t.value*this.value):J(Math.abs(t.value),c(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?o[0]:1===t.value?this:-1===t.value?this.negate():J(Math.abs(t.value),this.value,this.sign!==t.sign)},a.prototype.multiply=function(t){return j(t)._multiplyBySmall(this)},a.prototype.times=a.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*j(t).value)},l.prototype.times=l.prototype.multiply,u.prototype.square=function(){return new u(w(this.value),!1)},a.prototype.square=function(){var t=this.value*this.value;return d(t)?new a(t):new u(w(c(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},u.prototype.divmod=function(t){var e=x(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=a.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return x(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/j(t).value)},a.prototype.over=a.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return x(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%j(t).value)},a.prototype.remainder=a.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,i=j(t),u=this.value,l=i.value;if(0===l)return o[1];if(0===u)return o[0];if(1===u)return o[1];if(-1===u)return i.isEven()?o[1]:o[-1];if(i.sign)return o[0];if(!i.isSmall)throw Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&d(e=Math.pow(u,l)))return new a(g(e));for(r=this,n=o[1];!0&l&&(n=n.times(r),--l),0!==l;)l/=2,r=r.square();return n},a.prototype.pow=u.prototype.pow,l.prototype.pow=function(t){var e=j(t),r=this.value,n=e.value,i=BigInt(0),u=BigInt(1),a=BigInt(2);if(n===i)return o[1];if(r===i)return o[0];if(r===u)return o[1];if(r===BigInt(-1))return e.isEven()?o[1]:o[-1];if(e.isNegative())return new l(i);for(var d=this,c=o[1];(n&u)===u&&(c=c.times(d),--n),n!==i;)n/=a,d=d.square();return c},u.prototype.modPow=function(t,e){if(t=j(t),(e=j(e)).isZero())throw Error("Cannot take modPow with modulus 0");var r=o[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(o[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return o[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},l.prototype.modPow=a.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=j(t),r=this.value,n=e.value;return e.isSmall?1:L(r,n)},a.prototype.compareAbs=function(t){var e=j(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,r=j(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},u.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=j(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:L(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,a.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=j(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},a.prototype.compareTo=a.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=this.value,r=j(t).value;return e===r?0:e>r?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=a.prototype.eq=a.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=a.prototype.neq=a.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=a.prototype.gt=a.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return 0>this.compare(t)},l.prototype.lt=l.prototype.lesser=a.prototype.lt=a.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return 0>=this.compare(t)},l.prototype.leq=l.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return(1&this.value[0])==0},a.prototype.isEven=function(){return(1&this.value)==0},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return(1&this.value[0])==1},a.prototype.isOdd=function(){return(1&this.value)==1},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},a.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=a.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},a.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=a.prototype.isNegative,u.prototype.isUnit=function(){return!1},a.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},a.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(t){var e=j(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=a.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(t){var e=N(this);if(void 0!==e)return e;var n=this.abs(),i=n.bitLength();if(i<=64)return A(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*i.toJSNumber(),u=Math.ceil(!0===t?2*Math.pow(o,2):o),a=[],l=0;l<u;l++)a.push(r(l+2));return A(n,a)},l.prototype.isPrime=a.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(t,e){var n=N(this);if(void 0!==n)return n;for(var i=this.abs(),o=void 0===t?5:t,u=[],a=0;a<o;a++)u.push(r.randBetween(2,i.minus(2),e));return A(i,u)},l.prototype.isProbablePrime=a.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,n,i,o=r.zero,u=r.one,a=j(t),l=this.abs();!l.isZero();)e=a.divide(l),n=o,i=a,o=u,a=l,u=n.subtract(e.multiply(u)),l=i.subtract(e.multiply(l));if(!a.isUnit())throw Error(this.toString()+" and "+t.toString()+" are not co-prime");return(-1===o.compare(0)&&(o=o.add(t)),this.isNegative())?o.negate():o},l.prototype.modInv=a.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?y(t,1,this.sign):new u(m(t,1),this.sign)},a.prototype.next=function(){var t=this.value;return t+1<9007199254740992?new a(t+1):new u(e,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},u.prototype.prev=function(){var t=this.value;return this.sign?new u(m(t,1),!0):y(t,1,this.sign)},a.prototype.prev=function(){var t=this.value;return t-1>-9007199254740992?new a(t-1):new u(e,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var B=[1];2*B[B.length-1]<=1e7;)B.push(2*B[B.length-1]);var C=B.length,T=B[C-1];function I(t){return 1e7>=Math.abs(t)}function M(t,e,n){e=j(e);for(var i=t.isNegative(),o=e.isNegative(),u=i?t.not():t,a=o?e.not():e,l=0,d=0,c=null,s=null,f=[];!u.isZero()||!a.isZero();)l=(c=x(u,T))[1].toJSNumber(),i&&(l=T-1-l),d=(s=x(a,T))[1].toJSNumber(),o&&(d=T-1-d),u=c[0],a=s[0],f.push(n(l,d));for(var p=0!==n(i?1:0,o?1:0)?r(-1):r(0),g=f.length-1;g>=0;g-=1)p=p.multiply(T).add(r(f[g]));return p}function k(t){var e=t.value,r="number"==typeof e?1073741824|e:"bigint"==typeof e?e|BigInt(1073741824):e[0]+1e7*e[1]|1073758208;return r&-r}function O(t,e){return t=j(t),e=j(e),t.greater(e)?t:e}function q(t,e){return t=j(t),e=j(e),t.lesser(e)?t:e}function P(t,e){if(t=j(t).abs(),e=j(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,i=o[1];t.isEven()&&e.isEven();)r=q(k(t),k(e)),t=t.divide(r),e=e.divide(r),i=i.multiply(r);for(;t.isEven();)t=t.divide(k(t));do{for(;e.isEven();)e=e.divide(k(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero())return i.isUnit()?t:t.multiply(i)}u.prototype.shiftLeft=function(t){var e=j(t).toJSNumber();if(!I(e))throw Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=C;)r=r.multiply(T),e-=C-1;return r.multiply(B[e])},l.prototype.shiftLeft=a.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e,r=j(t).toJSNumber();if(!I(r))throw Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=C;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=x(n,T))[1].isNegative()?e[0].prev():e[0],r-=C-1}return(e=x(n,B[r]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=a.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},l.prototype.not=a.prototype.not=u.prototype.not,u.prototype.and=function(t){return M(this,t,function(t,e){return t&e})},l.prototype.and=a.prototype.and=u.prototype.and,u.prototype.or=function(t){return M(this,t,function(t,e){return t|e})},l.prototype.or=a.prototype.or=u.prototype.or,u.prototype.xor=function(t){return M(this,t,function(t,e){return t^e})},l.prototype.xor=a.prototype.xor=u.prototype.xor,u.prototype.bitLength=function(){var t=this;return(0>t.compareTo(r(0))&&(t=t.negate().subtract(r(1))),0===t.compareTo(r(0)))?r(0):r(function t(e,n){if(0>=n.compareTo(e)){var i=t(e,n.square(n)),o=i.p,u=i.e,a=o.multiply(n);return 0>=a.compareTo(e)?{p:a,e:2*u+1}:{p:o,e:2*u}}return{p:r(1),e:0}}(t,r(2)).e).add(r(1))},l.prototype.bitLength=a.prototype.bitLength=u.prototype.bitLength;var F=function(t,e,r,i){r=r||n,t=String(t),i||(t=t.toLowerCase(),r=r.toLowerCase());var o,u=t.length,a=Math.abs(e),l={};for(o=0;o<r.length;o++)l[r[o]]=o;for(o=0;o<u;o++){var d=t[o];if("-"!==d&&d in l&&l[d]>=a){if("1"===d&&1===a)continue;throw Error(d+" is not a valid digit in base "+e+".")}}e=j(e);var c=[],s="-"===t[0];for(o=s?1:0;o<t.length;o++){var d=t[o];if(d in l)c.push(j(l[d]));else if("<"===d){var f=o;do o++;while(">"!==t[o]&&o<t.length)c.push(j(t.slice(f+1,o)))}else throw Error(d+" is not a valid character")}return D(c,e,s)};function D(t,e,r){var n,i=o[0],u=o[1];for(n=t.length-1;n>=0;n--)i=i.add(t[n].times(u)),u=u.times(e);return r?i.negate():i}function U(t,e){if((e=r(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var i=!1;if(t.isNegative()&&e.isPositive()&&(i=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var o,u=[],a=t;a.isNegative()||a.compareAbs(e)>=0;){a=(o=a.divmod(e)).quotient;var l=o.remainder;l.isNegative()&&(l=e.minus(l).abs(),a=a.next()),u.push(l.toJSNumber())}return u.push(a.toJSNumber()),{value:u.reverse(),isNegative:i}}function z(t,e,r){var i=U(t,e);return(i.isNegative?"-":"")+i.value.map(function(t){var e;return t<(e=(e=r)||n).length?e[t]:"<"+t+">"}).join("")}function G(t){if(d(+t)){var e=+t;if(e===g(e))return i?new l(BigInt(e)):new a(e);throw Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw Error("Invalid integer: "+n.join("e"));if(2===n.length){var o=n[1];if("+"===o[0]&&(o=o.slice(1)),(o=+o)!==g(o)||!d(o))throw Error("Invalid integer: "+o+" is not a valid exponent.");var c=n[0],s=c.indexOf(".");if(s>=0&&(o-=c.length-s-1,c=c.slice(0,s)+c.slice(s+1)),o<0)throw Error("Cannot include negative exponent part for integers");c+=Array(o+1).join("0"),t=c}if(!/^([0-9][0-9]*)$/.test(t))throw Error("Invalid integer: "+t);if(i)return new l(BigInt(r?"-"+t:t));for(var p=[],_=t.length,v=_-7;_>0;)p.push(+t.slice(v,_)),(v-=7)<0&&(v=0),_-=7;return f(p),new u(p,r)}function j(t){return"number"==typeof t?function(t){if(i)return new l(BigInt(t));if(d(t)){if(t!==g(t))throw Error(t+" is not an integer.");return new a(t)}return G(t.toString())}(t):"string"==typeof t?G(t):"bigint"==typeof t?new l(t):t}u.prototype.toArray=function(t){return U(this,t)},a.prototype.toArray=function(t){return U(this,t)},l.prototype.toArray=function(t){return U(this,t)},u.prototype.toString=function(t,e){if(void 0===t&&(t=10),10!==t||e)return z(this,t,e);for(var r,n=this.value,i=n.length,o=String(n[--i]);--i>=0;)r=String(n[i]),o+="0000000".slice(r.length)+r;return(this.sign?"-":"")+o},a.prototype.toString=function(e,r){return(e===t&&(e=10),10!=e||r)?z(this,e,r):String(this.value)},l.prototype.toString=a.prototype.toString,l.prototype.toJSON=u.prototype.toJSON=a.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,a.prototype.valueOf=function(){return this.value},a.prototype.toJSNumber=a.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var H=0;H<1e3;H++)o[H]=j(H),H>0&&(o[-H]=j(-H));return o.one=o[1],o.zero=o[0],o.minusOne=o[-1],o.max=O,o.min=q,o.gcd=P,o.lcm=function(t,e){return t=j(t).abs(),e=j(e).abs(),t.divide(P(t,e)).multiply(e)},o.isInstance=function(t){return t instanceof u||t instanceof a||t instanceof l},o.randBetween=function(t,e,r){t=j(t);var n=r||Math.random,i=q(t,e=j(e)),u=O(t,e).subtract(i).add(1);if(u.isSmall)return i.add(Math.floor(n()*u));for(var a=U(u,1e7).value,l=[],d=!0,c=0;c<a.length;c++){var s=d?a[c]+(c+1<a.length?a[c+1]/1e7:0):1e7,f=g(n()*s);l.push(f),f<a[c]&&(d=!1)}return i.add(o.fromArray(l,1e7,!1))},o.fromArray=function(t,e,r){return D(t.map(j),j(e||10),r)},o}();void 0!==e&&e.hasOwnProperty("exports")&&(e.exports=r),"function"==typeof define&&define.amd&&define(function(){return r})}},function(){return e||(0,t[g(t)[0]])((e={exports:{}}).exports,e),e.exports});function h(){throw Error("Failed pattern match")}var y=t=>e=>t,b={tag:"Proxy"},R=function(t){return function(e){for(var r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t(e[i]);return n}},S={map:R},J=t=>t,w=function(t){return function(e){for(var r=[],n=0,i=t.length;n<i;n++)Array.prototype.push.apply(r,e(t[n]));return r}},E=function(t){return function(e){return function(r){var n={};for(var i in r)({}).hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n[t]=e,n}}},x=function(t){return t.toString()},L=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},N=function(t){var e=t.length;return'"'+t.replace(/[\0-\x1F\x7F"\\]/g,function(r,n){switch(r){case'"':case"\\":return"\\"+r;case"\x07":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\v":return"\\v"}var i=n+1,o=i<e&&t[i]>="0"&&t[i]<="9"?"\\&":"";return"\\"+r.charCodeAt(0).toString(10)+o})+'"'},A=(t,e)=>({tag:t,_1:e}),B={tag:"NoArguments"},C=(t,e)=>({tag:t,_1:e}),T=C("Nothing"),I=t=>C("Just",t),M={map:t=>e=>"Just"===e.tag?C("Just",t(e._1)):T},k={apply:t=>e=>"Just"===t.tag?"Just"===e.tag?C("Just",t._1(e._1)):T:"Nothing"===t.tag?T:void h(),Functor0:()=>M},O={pure:I,Apply0:()=>k},q=(t,e)=>({tag:t,_1:e}),P=t=>q("Left",t),F=t=>q("Right",t),D={map:t=>e=>"Left"===e.tag?q("Left",e._1):"Right"===e.tag?q("Right",t(e._1)):void h()},U={apply:t=>e=>{if("Left"===t.tag)return q("Left",t._1);if("Right"===t.tag){if("Left"===e.tag)return q("Left",e._1);if("Right"===e.tag)return q("Right",t._1(e._1))}h()},Functor0:()=>D},z={map:t=>e=>t(e)},G={apply:t=>e=>t(e),Functor0:()=>z},j={bind:t=>e=>e(t),Apply0:()=>G},H={pure:t=>t,Apply0:()=>G},Q={Applicative0:()=>H,Bind1:()=>j},Z={apply:t=>e=>()=>{let r=t(),n=e();return W.pure(r(n))()},Functor0:()=>K},W={pure:function(t){return function(){return t}},Apply0:()=>Z},K={map:t=>e=>()=>t(e())},V=(t,e)=>({tag:t,_1:e}),$=t=>V("Done",t),Y=t=>e=>{let r=t(e);return()=>{var e;let n=r();(e=()=>{let e=n;return"Loop"===e.tag?(n=t(e._1)(),!1):"Done"===e.tag||void h()},function(){for(;!e(););})();let i=n;if("Done"===i.tag)return i._1;h()}},X=function(t){return function(e){return function(r){for(var n=e,i=r.length,o=i-1;o>=0;o--)n=t(r[o])(n);return n}}},tt=function(t){return function(e){return function(r){for(var n=e,i=r.length,o=0;o<i;o++)n=t(n)(r[o]);return n}}},te=t=>{let e=t.Apply0();return r=>n=>r.foldr(t=>{let r=n(t);return t=>e.apply(e.Functor0().map(t=>J)(r))(t)})(t.pure())},tr=t=>{let e=te(t);return t=>{let r=e(t);return t=>e=>r(e)(t)}},tn=t=>e=>{let r=t.foldl(t=>r=>"Just"===t.elem.tag?t:t.pos===e?{elem:C("Just",r),pos:t.pos}:{pos:t.pos+1|0,elem:t.elem})({elem:T,pos:0});return t=>r(t).elem},ti={foldr:t=>e=>r=>"Nothing"===r.tag?e:"Just"===r.tag?t(r._1)(e):void h(),foldl:t=>e=>r=>"Nothing"===r.tag?e:"Just"===r.tag?t(e)(r._1):void h(),foldMap:t=>{let e=t.mempty;return t=>r=>"Nothing"===r.tag?e:"Just"===r.tag?t(r._1):void h()}},to={foldr:X,foldl:tt,foldMap:t=>{let e=t.mempty;return r=>to.foldr(e=>n=>t.Semigroup0().append(r(e))(n))(e)}},tu=(t,e)=>({tag:"NonEmpty",_1:t,_2:e}),ta=(t,e)=>({tag:"Tuple",_1:t,_2:e}),tl=t=>e=>ta(t,e),td=t=>t._2,tc=t=>t._1,ts=(t,e,r)=>({tag:t,_1:e,_2:r}),tf=ts("Nil"),tp={foldr:t=>e=>{let r=tp.foldl(e=>r=>t(r)(e))(e),n=t=>{let e=tf,r=t,n=!0,i;for(;n;){let t=e,o=r;if("Nil"===o.tag){n=!1,i=t;continue}if("Cons"===o.tag){e=ts("Cons",o._1,t),r=o._2;continue}h()}return i};return t=>r(n(t))},foldl:t=>e=>r=>{let n=e,i=r,o=!0,u;for(;o;){let e=n,r=i;if("Nil"===r.tag){o=!1,u=e;continue}if("Cons"===r.tag){n=t(e)(r._1),i=r._2;continue}h()}return u},foldMap:t=>{let e=t.mempty;return r=>tp.foldl(e=>{let n=t.Semigroup0().append(e);return t=>n(r(t))})(e)}},tg=(t=>{let e={foldMap:e=>{let r=t.foldMap(e);return t=>n=>e.Semigroup0().append(t(n._1))(r(t)(n._2))},foldl:e=>r=>n=>t.foldl(e)(e(r)(n._1))(n._2),foldr:e=>r=>n=>e(n._1)(t.foldr(e)(r)(n._2))};return{foldMap1:e=>r=>n=>t.foldl(t=>n=>e.append(t)(r(n)))(r(n._1))(n._2),foldr1:e=>r=>{let n=e(r._1),i=t.foldr(t=>{let r=e(t);return e=>C("Just","Nothing"===e.tag?t:"Just"===e.tag?r(e._1):void h())})(T)(r._2);return"Nothing"===i.tag?r._1:"Just"===i.tag?n(i._1):void h()},foldl1:e=>r=>t.foldl(e)(r._1)(r._2),Foldable0:()=>e}})(tp),t_=t=>{let e=tf,r=t,n=!0,i;for(;n;){let t=e,o=r;if("Nil"===o.tag){n=!1,i=t;continue}if("Cons"===o.tag){e=ts("Cons",o._1,t),r=o._2;continue}h()}return i},tv=function(t){return t},tm=function(){function t(t){return[t]}function e(t){return function(e){return[t,e]}}function r(t){return function(e){return function(r){return[t,e,r]}}}function n(t){return function(e){return t.concat(e)}}return function(i){return function(o){return function(u){return function(a){return function(l){return function d(c,s){switch(s-c){case 0:return u([]);case 1:return o(t)(a(l[c]));case 2:return i(o(e)(a(l[c])))(a(l[c+1]));case 3:return i(i(o(r)(a(l[c])))(a(l[c+1])))(a(l[c+2]));default:var f=c+2*Math.floor((s-c)/4);return i(o(n)(d(c,f)))(d(f,s))}}(0,l.length)}}}}}}(),th=t=>t,ty={traverse:t=>{let e=t.Apply0();return tm(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>ty.traverse(t)(th),Functor0:()=>S,Foldable1:()=>to},tb=(t,e)=>({tag:"CatQueue",_1:t,_2:e}),tR=t=>{let e=t,r=!0,n;for(;r;){let t=e;if("Nil"===t._1.tag){if("Nil"===t._2.tag){r=!1,n=T;continue}e=tb(t_(t._2),tf);continue}if("Cons"===t._1.tag){r=!1,n=C("Just",ta(t._1._1,tb(t._1._2,t._2)));continue}h()}return n},tS=(t,e,r)=>({tag:t,_1:e,_2:r}),tJ=tS("CatNil"),tw=t=>e=>"CatNil"===t.tag?e:"CatNil"===e.tag?t:"CatCons"===t.tag?tS("CatCons",t._1,tb(t._2._1,ts("Cons",e,t._2._2))):void h(),tE=t=>e=>r=>{let n=t=>e=>r=>{let n=t,i=e,o=r,u=!0,a;for(;u;){let t=n,e=i,r=o;if("Nil"===r.tag){u=!1,a=e;continue}if("Cons"===r.tag){n=t,i=t(e)(r._1),o=r._2;continue}h()}return a};return(i=>{let o=r,u=i,a=!0,l;for(;a;){let r=u,i=tR(o);if("Nothing"===i.tag){a=!1,l=n(t=>e=>e(t))(e)(r);continue}if("Just"===i.tag){o=i._1._2,u=ts("Cons",t(i._1._1),r);continue}h()}return l})(tf)},tx=t=>"CatNil"===t.tag?T:"CatCons"===t.tag?C("Just",ta(t._1,"Nil"===t._2._1.tag&&"Nil"===t._2._2.tag?tJ:tE(tw)(tJ)(t._2))):void h(),tL=t=>e=>"CatNil"===t.tag?tS("CatCons",e,tb(tf,tf)):"CatCons"===t.tag?tS("CatCons",t._1,tb(t._2._1,ts("Cons",tS("CatCons",e,tb(tf,tf)),t._2._2))):void h(),tN=(t,e)=>({tag:"Free",_1:t,_2:e}),tA=(t,e,r)=>({tag:t,_1:e,_2:r}),tB=t=>{let e=t,r=!0,n;for(;r;){let t=e;if("Return"===t._1.tag){let i=tx(t._2);if("Nothing"===i.tag){r=!1,n=tA("Return",t._1._1);continue}if("Just"===i.tag){e=(()=>{let e=i._1._1(t._1._1);return tN(e._1,"CatNil"===e._2.tag?i._1._2:"CatNil"===i._1._2.tag?e._2:"CatCons"===e._2.tag?tS("CatCons",e._2._1,tb(e._2._2._1,ts("Cons",i._1._2,e._2._2._2))):void h())})();continue}h()}if("Bind"===t._1.tag){r=!1,n=tA("Bind",t._1._1,e=>{let r=t._1._2(e);return tN(r._1,"CatNil"===r._2.tag?t._2:"CatNil"===t._2.tag?r._2:"CatCons"===r._2.tag?tS("CatCons",r._2._1,tb(r._2._2._1,ts("Cons",t._2,r._2._2._2))):void h())});continue}h()}return n},tC={Applicative0:()=>tk,Bind1:()=>tI},tT={map:t=>e=>tI.bind(e)(e=>tk.pure(t(e)))},tI={bind:t=>e=>tN(t._1,tL(t._2)(e)),Apply0:()=>tM},tM={apply:t=>e=>tN(t._1,tL(t._2)(t=>tN(e._1,tL(e._2)(e=>tk.pure(t(e)))))),Functor0:()=>tT},tk={pure:t=>tN(tA("Return",t),tJ),Apply0:()=>tM},tO=t=>({append:e=>r=>tM.apply(tN(e._1,tL(e._2)(e=>tN(tA("Return",t.append(e)),tJ))))(r)}),tq=t=>{let e=tO(t.Semigroup0());return{mempty:tN(tA("Return",t.mempty),tJ),Semigroup0:()=>e}},tP=t=>({bind:e=>r=>t.Bind1().bind(e)(e=>"Nothing"===e.tag?t.Applicative0().pure(T):"Just"===e.tag?r(e._1):void h()),Apply0:()=>tF(t)}),tF=t=>{let e=t.Bind1().Apply0().Functor0(),r={map:t=>r=>e.map(M.map(t))(r)};return{apply:(()=>{let e=tP(t);return r=>n=>e.bind(r)(r=>e.bind(n)(e=>tD(t).pure(r(e))))})(),Functor0:()=>r}},tD=t=>({pure:e=>t.Applicative0().pure(C("Just",e)),Apply0:()=>tF(t)}),tU=t=>{let e=t.Monad0(),r={Applicative0:()=>tD(e),Bind1:()=>tP(e)};return{state:r=>e.Bind1().bind(t.state(r))(t=>e.Applicative0().pure(C("Just",t))),Monad0:()=>r}},tz=t=>{let e=t.Bind1(),r=e.Apply0().Functor0(),n={map:t=>e=>r.map(M.map(t))(e)};return{alt:r=>n=>e.bind(r)(e=>"Nothing"===e.tag?n:t.Applicative0().pure(e)),Functor0:()=>n}},tG=t=>{let e=tz(t);return{empty:t.Applicative0().pure(T),Alt0:()=>e}},tj=t=>{let e=tD(t),r=tG(t);return{Applicative0:()=>e,Plus1:()=>r}},tH=function(t,e,r,n){return r>=0&&r<n.length?t(n[r]):e},tQ=function(t,e,r){var n=t>=0&&t<r.length;return n&&(r[t]=e),n},tZ=(a=function(t,e,r,n){return n.splice.apply(n,[t,e].concat(r))},function(t){return function(e){return function(r){return function(n){return function(){return a(t,e,r,n)}}}}}),tW=(l=function(t,e){return e.push(t)},function(t){return function(e){return function(){return l(t,e)}}}),tK=function(t){return function(e){for(var r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t(i)(e[i]);return n}},tV={mapWithIndex:tK,Functor0:()=>S},t$=function(t){return function(e){return t===e}},tY=function(t){return function(e){return function(r){if(e.length!==r.length)return!1;for(var n=0;n<e.length;n++)if(!t(e[n])(r[n]))return!1;return!0}}},tX={eq:t=>t=>!0},t1={eq:t$},t0={eq:t$},t2=function(t){return function(e){return function(r){return function(n){return function(i){return n<i?t:n===i?e:r}}}}},t5={compare:t=>t=>"EQ",Eq0:()=>tX},t3={compare:t2("LT")("EQ")("GT"),Eq0:()=>t1},t4={compare:t2("LT")("EQ")("GT"),Eq0:()=>t0},t6=function(t,e){for(var r=t>e?-1:1,n=Array(r*(e-t)+1),i=t,o=0;i!==e;)n[o++]=i,i+=r;return n[o]=i,n};Array.prototype.fill;var t7=function(){function t(t,e){this.head=t,this.tail=e}var e={};function r(e){return function(r){return new t(e,r)}}return function(t,n){return function(t){for(var r=[],n=0,i=t;i!==e;)r[n++]=i.head,i=i.tail;return r}(t(r)(e)(n))}}(),t9=function(t,e,r,n){for(var i=0,o=n.length;i<o;i++)if(r(n[i]))return t(i);return e},t8=function(t,e,r,n){if(r<0||r>=n.length)return e;var i=n.slice();return i.splice(r,1),t(i)},et=function(t,e,r,n,i){if(r<0||r>=i.length)return e;var o=i.slice();return o[r]=n,t(o)},ee=function(t,e){return e.filter(t)},er=function(t,e,r){var n;return r.length<2?r:(!function t(e,r,n,i,o,u){var a,l,d,c,s,f;for((a=o+(u-o>>1))-o>1&&t(e,r,i,n,o,a),u-a>1&&t(e,r,i,n,a,u),l=o,d=a,c=o;l<a&&d<u;)s=i[l],f=i[d],r(e(s)(f))>0?(n[c++]=f,++d):(n[c++]=s,++l);for(;l<a;)n[c++]=i[l++];for(;d<u;)n[c++]=i[d++]}(t,e,n=r.slice(0),r.slice(0),0,r.length),n)},en=function(t,e,r){for(var n=e.length<r.length?e.length:r.length,i=Array(n),o=0;o<n;o++)i[o]=t(e[o])(r[o]);return i},ei=function(t,e){for(var r=e.length,n=0;n<r;n++)if(!t(e[n]))return!1;return!0},eo=t=>e=>er(t,t=>"GT"===t?1:"EQ"===t?0:"LT"===t?-1:void h(),e),eu=t=>e=>eo(r=>n=>t.compare(e(r))(e(n))),ea=t=>e=>(()=>{let r=tW(e);return()=>{let e=[...t];return r(e)(),e}})()(),el=t=>{let e=t.length-1|0;return e>=0&&e<t.length?C("Just",t[e]):T},ed=t=>e=>r=>t>=0&&t<r.length?et(I,T,t,e(r[t]),r):T,ec=t=>e=>{let r=eo(e=>r=>t(e._2)(r._2))(tK(tl)(e));return 0<r.length?R(td)(eu(t4)(tc)((()=>{let e=[r[0]];for(let n of r){let r=t((()=>{let t=el(e);if("Just"===t.tag)return t._1._2;h()})())(n._2);("LT"===r||"GT"===r||"EQ"!==r)&&e.push(n)}return e})())):[]},es=t=>e=>{let r=t9(I,T,t,e);return"Just"===r.tag?C("Just",e[r._1]):T},ef=t=>e=>r=>{let n=t9(I,T,r=>t.eq(r)(e),r);return"Nothing"===n.tag||"Just"!==n.tag&&void h()},ep=t=>e=>r=>{let n=t9(I,T,r=>t.eq(r)(e),r);return"Nothing"!==n.tag&&("Just"===n.tag||void h())},eg=t=>e=>r=>{if(0===r.length)return[];let n=t9(I,T,t(e),r);if("Nothing"===n.tag)return r;if("Just"===n.tag){let t=t8(I,T,n._1,r);if("Just"===t.tag)return t._1}h()},e_=t=>e=>w(e)(t),ev=t=>e_(e=>{let r=t(e);return"Nothing"===r.tag?[]:"Just"===r.tag?[r._1]:void h()}),em={unfoldr1:(d=t=>"Nothing"===t.tag||"Just"!==t.tag&&void h(),function(t){return function(e){return function(r){return function(n){return function(i){for(var o=[],u=i;;){var a=n(u);o.push(e(a));var l=r(a);if(d(l))return o;u=t(l)}}}}}})(t=>{if("Just"===t.tag)return t._1;h()})(tc)(td)},eh=(t,e,r,n,i,o,u)=>({tag:t,_1:e,_2:r,_3:n,_4:i,_5:o,_6:u}),ey=(t,e,r)=>({tag:"Split",_1:t,_2:e,_3:r}),eb=(t,e,r)=>({tag:"SplitLast",_1:t,_2:e,_3:r}),eR=eh("Leaf"),eS=(t,e,r,n)=>{if("Leaf"===r.tag){if("Leaf"===n.tag)return eh("Node",1,1,t,e,r,n);if("Node"===n.tag)return eh("Node",1+n._1|0,1+n._2|0,t,e,r,n);h()}if("Node"===r.tag){if("Leaf"===n.tag)return eh("Node",1+r._1|0,1+r._2|0,t,e,r,n);if("Node"===n.tag)return eh("Node",r._1>n._1?1+r._1|0:1+n._1|0,(1+r._2|0)+n._2|0,t,e,r,n)}h()},eJ=(t,e,r,n)=>{if("Leaf"===r.tag)return"Leaf"===n.tag?eh("Node",1,1,t,e,eR,eR):"Node"===n.tag&&n._1>1?"Node"===n._5.tag&&("Leaf"===n._6.tag?n._5._1>0:"Node"===n._6.tag?n._5._1>n._6._1:void h())?eS(n._5._3,n._5._4,eS(t,e,r,n._5._5),eS(n._3,n._4,n._5._6,n._6)):eS(n._3,n._4,eS(t,e,r,n._5),n._6):eS(t,e,r,n);if("Node"===r.tag)return"Node"===n.tag?n._1>(r._1+1|0)?"Node"===n._5.tag&&("Leaf"===n._6.tag?n._5._1>0:"Node"===n._6.tag?n._5._1>n._6._1:void h())?eS(n._5._3,n._5._4,eS(t,e,r,n._5._5),eS(n._3,n._4,n._5._6,n._6)):eS(n._3,n._4,eS(t,e,r,n._5),n._6):r._1>(n._1+1|0)?"Node"===r._6.tag&&("Leaf"===r._5.tag?0<=r._6._1:"Node"===r._5.tag?r._5._1<=r._6._1:void h())?eS(r._6._3,r._6._4,eS(r._3,r._4,r._5,r._6._5),eS(t,e,r._6._6,n)):eS(r._3,r._4,r._5,eS(t,e,r._6,n)):eS(t,e,r,n):"Leaf"===n.tag&&r._1>1?"Node"===r._6.tag&&("Leaf"===r._5.tag?0<=r._6._1:"Node"===r._5.tag?r._5._1<=r._6._1:void h())?eS(r._6._3,r._6._4,eS(r._3,r._4,r._5,r._6._5),eS(t,e,r._6._6,n)):eS(r._3,r._4,r._5,eS(t,e,r._6,n)):eS(t,e,r,n);h()},ew=(t,e,r)=>{if("Leaf"===r.tag)return ey(T,eR,eR);if("Node"===r.tag){let n=t(e)(r._3);if("LT"===n){let n=ew(t,e,r._5);return ey(n._1,n._2,eJ(r._3,r._4,n._3,r._6))}if("GT"===n){let n=ew(t,e,r._6);return ey(n._1,eJ(r._3,r._4,r._5,n._2),n._3)}if("EQ"===n)return ey(C("Just",r._4),r._5,r._6)}h()},eE=(t,e,r,n)=>{if("Leaf"===n.tag)return eb(t,e,r);if("Node"===n.tag){let i=eE(n._3,n._4,n._5,n._6);return eb(i._1,i._2,eJ(t,e,r,i._3))}h()},ex=(t,e)=>{if("Leaf"===t.tag)return e;if("Node"===t.tag){let r=eE(t._3,t._4,t._5,t._6);return eJ(r._1,r._2,r._3,e)}h()},eL=(t,e,r,n)=>{if("Leaf"===r.tag)return n;if("Leaf"===n.tag)return r;if("Node"===n.tag){let i=ew(t,n._3,r),o=eL(t,e,i._2,n._5),u=eL(t,e,i._3,n._6);if("Just"===i._1.tag)return eJ(n._3,e(i._1._1)(n._4),o,u);if("Nothing"===i._1.tag)return eJ(n._3,n._4,o,u)}h()},eN=t=>e=>r=>{let n=r,i=!0,o;for(;i;){let r=n;if("Leaf"===r.tag){i=!1,o=T;continue}if("Node"===r.tag){let u=t.compare(e)(r._3);if("LT"===u){n=r._5;continue}if("GT"===u){n=r._6;continue}if("EQ"===u){i=!1,o=C("Just",r._4);continue}}h()}return o},eA=t=>e=>r=>{let n=i=>{if("Leaf"===i.tag)return eh("Node",1,1,e,r,eR,eR);if("Node"===i.tag){let o=t.compare(e)(i._3);if("LT"===o)return eJ(i._3,i._4,n(i._5),i._6);if("GT"===o)return eJ(i._3,i._4,i._5,n(i._6));if("EQ"===o)return eh("Node",i._1,i._2,e,r,i._5,i._6)}h()};return n},eB={map:t=>{let e=r=>"Leaf"===r.tag?eR:"Node"===r.tag?eh("Node",r._1,r._2,r._3,t(r._4),e(r._5),e(r._6)):void h();return e}},eC={foldr:t=>e=>{let r=(e,n)=>"Leaf"===e.tag?n:"Node"===e.tag?r(e._5,t(e._4)(r(e._6,n))):void h();return t=>r(t,e)},foldl:t=>e=>{let r=(e,n)=>"Leaf"===n.tag?e:"Node"===n.tag?r(t(r(e,n._5))(n._4),n._6):void h();return t=>r(e,t)},foldMap:t=>{let e=t.mempty,r=t.Semigroup0();return t=>{let n=i=>"Leaf"===i.tag?e:"Node"===i.tag?r.append(n(i._5))(r.append(t(i._4))(n(i._6))):void h();return n}}},eT=t=>{let e=t.Apply0();return r=>{let n=i=>{if("Leaf"===i.tag)return t.pure(eR);if("Node"===i.tag){let t=i._1,o=i._3,u=i._2;return e.apply(e.apply(e.Functor0().map(e=>r=>n=>eh("Node",t,u,o,r,e,n))(n(i._5)))(r(i._4)))(n(i._6))}h()};return n}},eI=t=>e=>r=>n=>i=>o=>{let u=(()=>{if("Just"===n.tag){let e=n._1;return r=>"LT"===t.compare(r)(e)}if("Nothing"===n.tag)return t=>!1;h()})(),a=(()=>{if("Just"===i.tag){let e=i._1;return r=>"GT"===t.compare(r)(e)}if("Nothing"===i.tag)return t=>!1;h()})(),l=(()=>{if("Just"===n.tag){if("Just"===i.tag){let e=i._1,r=n._1;return n=>"GT"!==t.compare(r)(n)&&"GT"!==t.compare(n)(e)}if("Nothing"===i.tag){let e=n._1;return r=>"GT"!==t.compare(e)(r)}h()}if("Nothing"===n.tag){if("Just"===i.tag){let e=i._1;return r=>"GT"!==t.compare(r)(e)}if("Nothing"===i.tag)return t=>!0}h()})(),d=t=>"Leaf"===t.tag?r:"Node"===t.tag?e(e(u(t._3)?r:d(t._5))(l(t._3)?o(t._3)(t._4):r))(a(t._3)?r:d(t._6)):void h();return d},eM=t=>e=>eI(t)(e.Semigroup0().append)(e.mempty),ek=t=>t=>{let e=r=>"Leaf"===r.tag?eR:"Node"===r.tag?t(r._3)?eJ(r._3,r._4,e(r._5),e(r._6)):ex(e(r._5),e(r._6)):void h();return e},eO=t=>e=>{let r=n=>{if("Leaf"===n.tag)return eR;if("Node"===n.tag){let i=t.compare(e)(n._3);if("LT"===i)return eJ(n._3,n._4,r(n._5),n._6);if("GT"===i)return eJ(n._3,n._4,n._5,r(n._6));if("EQ"===i)return ex(n._5,n._6)}h()};return r},eq=t=>{let e={alt:(()=>{let e=t.compare;return t=>r=>eL(e,y,t,r)})(),Functor0:()=>eB};return{empty:eR,Alt0:()=>e}},eP=(t,e,r)=>({tag:"OrdBox",_1:t,_2:e,_3:r}),eF=t=>e=>r=>eP(t,e,r),eD={eq:t=>e=>t._1(t._3)(e._3)},eU=(t=>{let e=t.Eq0();return r=>{let n=r.Eq0(),i={eq:t=>r=>e.eq(t._1)(r._1)&&n.eq(t._2)(r._2)};return{compare:e=>n=>{let i=t.compare(e._1)(n._1);return"LT"===i?"LT":"GT"===i?"GT":r.compare(e._2)(n._2)},Eq0:()=>i}}})(t3)({compare:t=>e=>t._2(t._3)(e._3),Eq0:()=>eD}),ez=(t=>{let e=t.compare;return t=>r=>{let n=ew(e,t,r);return"Just"===n._1.tag?C("Just",ta(n._1._1,ex(n._2,n._3))):T}})(eU),eG=()=>t=>e=>{let r=eM(eU)((()=>{let t=eq(e),r=t.Alt0(),n={append:t=>e=>r.alt(t)(e)};return{mempty:t.empty,Semigroup0:()=>n}})());return e=>n=>{let i=t.reflectSymbol(e);return r(T)(T)(t=>e=>i===t._1?eh("Node",1,1,t._2._3,e,eR,eR):eR)(n)}},ej=()=>t=>e=>{let r=eF(e.Eq0().eq)(e.compare);return e=>n=>i=>ez(ta(t.reflectSymbol(e),r(n)))(i)},eH=()=>t=>e=>{let r=eF(e.Eq0().eq)(e.compare);return e=>n=>i=>eN(eU)(ta(t.reflectSymbol(e),r(n)))(i)},eQ=()=>t=>e=>{let r=eF(e.Eq0().eq)(e.compare);return e=>n=>i=>o=>eA(eU)(ta(t.reflectSymbol(e),r(n)))(i)(o)},eZ=function(t){return function(e){return e.join(t)}},eW="InputNumber",eK=t=>"InputButton"===t?"button":"InputCheckbox"===t?"checkbox":"InputColor"===t?"color":"InputDate"===t?"date":"InputDatetimeLocal"===t?"datetime-local":"InputEmail"===t?"email":"InputFile"===t?"file":"InputHidden"===t?"hidden":"InputImage"===t?"image":"InputMonth"===t?"month":"InputNumber"===t?"number":"InputPassword"===t?"password":"InputRadio"===t?"radio":"InputRange"===t?"range":"InputReset"===t?"reset":"InputSearch"===t?"search":"InputSubmit"===t?"submit":"InputTel"===t?"tel":"InputText"===t?"text":"InputTime"===t?"time":"InputUrl"===t?"url":"InputWeek"===t?"week":void h(),eV=(t,e,r)=>({tag:t,_1:e,_2:r});function e$(t,e,r){return null==t?e:r(t)}var eY=t=>({bind:e=>r=>t.Bind1().bind(e)(e=>"Left"===e.tag?t.Applicative0().pure(q("Left",e._1)):"Right"===e.tag?r(e._1):void h()),Apply0:()=>eX(t)}),eX=t=>{let e=t.Bind1().Apply0().Functor0(),r={map:t=>e.map(e=>"Left"===e.tag?q("Left",e._1):"Right"===e.tag?q("Right",t(e._1)):void h())};return{apply:(()=>{let e=eY(t);return r=>n=>e.bind(r)(r=>e.bind(n)(e=>e1(t).pure(r(e))))})(),Functor0:()=>r}},e1=t=>({pure:e=>t.Applicative0().pure(q("Right",e)),Apply0:()=>eX(t)}),e0=t=>{let e={Applicative0:()=>e1(t),Bind1:()=>eY(t)};return{throwError:e=>t.Applicative0().pure(q("Left",e)),Monad0:()=>e}},e2=function(t){return t},e5=(i=10,o=RegExp("^[\\+\\-]?"+("[0-"+(i-1).toString()+"]")+"+$","i"),function(t){if(!o.test(t))return T;var e=parseInt(t,i);return(0|e)===e?I(e):T}),e3=t=>e=>{var r;let n=(r=t.length,function(t){return{before:t.substring(0,r),after:t.substring(r)}})(e);return n.before===t?C("Just",n.after):T};function e4(t){return Object.prototype.toString.call(t).slice(8,-1)}var e6=(t,e,r)=>({tag:t,_1:e,_2:r}),e7=t=>"ForeignError"===t.tag?t._1:"ErrorAtIndex"===t.tag?"Error at array index "+x(t._1)+": "+e7(t._2):"ErrorAtProperty"===t.tag?"Error at property "+N(t._1)+": "+e7(t._2):"TypeMismatch"===t.tag?"Type mismatch: expected "+t._1+", found "+t._2:void h(),e9=t=>e=>r=>e4(r)===e?e1(t).pure(r):e0(t).throwError(tu(e6("TypeMismatch",e,e4(r)),tf)),e8=t=>e9(t)("String"),rt={},re=t=>e=>{let r={...e};return t(r)(),r},rr=(t,e,r,n)=>({tag:"Step",_1:t,_2:e,_3:r,_4:n}),rn=(t,e)=>{let r=t._2;return t._3(r,e)},ri=t=>{let e=t._2;return t._4(e)};function ro(t,e,r){for(var n={},i=0;i<t.length;i++){var o=t[i],u=e(o);n[u]=r(u,i,o)}return n}function ru(t,e,r,n,i,o){for(var u={},a=0;a<e.length;a++){var l=e[a],d=r(l);t.hasOwnProperty(d)?u[d]=n(d,a,t[d],l):u[d]=o(d,a,l)}for(var d in t)d in u||i(d,t[d]);return u}function ra(t,e,r){return null!=t?r.createElementNS(t,e):r.createElement(e)}function rl(t,e,r){var n=r.childNodes.item(t)||null;n!==e&&r.insertBefore(e,n)}function rd(t,e){e&&t.parentNode===e&&e.removeChild(t)}function rc(t){return t.parentNode}function rs(t,e,r,n){null!=t?n.setAttributeNS(t,e,r):n.setAttribute(e,r)}function rf(t,e,r){null!=t?r.removeAttributeNS(t,e):r.removeAttribute(e)}var rp=void 0;function rg(t){return function(){return function(e){return t(e)()}}}function r_(t){return function(e){return function(r){return function(n){return function(){return n.addEventListener(t,e,r)}}}}}function rv(t){return function(e){return function(r){return function(n){return function(){return n.removeEventListener(t,e,r)}}}}}var rm=(t,e)=>({tag:t,_1:e}),rh=(t,e,r,n)=>({tag:t,_1:e,_2:r,_3:n}),ry=t=>e=>rh("Property",t,e),rb=(t,e)=>e.hasAttribute(t)?rf(null,t,e):"string"==typeof e[t]?void(e[t]=""):"rowSpan"===t||"colSpan"===t?void(e[t]=1):void(e[t]=rp),rR=t=>"Attribute"===t.tag?"Just"===t._1.tag?"attr/"+t._1._1+":"+t._2:"attr/:"+t._2:"Property"===t.tag?"prop/"+t._1:"Handler"===t.tag?"handler/"+t._1:"Ref"===t.tag?"ref":void h(),rS=t=>e=>{let r=r=>{var n;let i="ref"in(n=r.props)?I(n.ref):T;if("Just"===i.tag&&"Ref"===i._1.tag){let r=i._1._1(rm("Removed",e));if("Just"===r.tag)return t(r._1)()}},n=r=>(n,i,o)=>{var u,a,l;if("Attribute"===o.tag){let t=o._2,r=o._3;return rs("Nothing"===o._1.tag?null:"Just"===o._1.tag?o._1._1:void h(),t,r,e),o}if("Property"===o.tag){let t=o._1,r=o._2;return e[t]=r,o}if("Handler"===o.tag){if(u=o._1,r.hasOwnProperty(u))return r[o._1]._2.value=o._2,o;let n={value:o._2},i=rg(e=>()=>{let r=(0,n.value)(e);if("Just"===r.tag)return t(r._1)()})();return a=o._1,l=ta(i,n),r[a]=l,!function(t,e,r){r.addEventListener(t,e,!1)}(o._1,i,e),o}if("Ref"===o.tag){let r=o._1(rm("Created",e));return"Just"===r.tag&&t(r._1)(),o}h()},i=(t,o)=>{let u={},a=t.events,l=ru(t.props,o,rR,(t,r,n,i)=>{var o,l;if("Attribute"===n.tag){if("Attribute"===i.tag){if(n._3===i._3)return i;rs("Nothing"===i._1.tag?null:"Just"===i._1.tag?i._1._1:void h(),i._2,i._3,e)}return i}if("Property"===n.tag){if("Property"===i.tag){if(n._2===i._2||"value"===i._1&&e.value===i._2)return i;o=i._1,l=i._2,e[o]=l}return i}if("Handler"===n.tag&&"Handler"===i.tag){let t=i._2,e=i._1,r=a[e];r._2.value=t,u[e]=r}return i},(t,r)=>{if("Attribute"===r.tag){let t=r._2;return rf("Nothing"===r._1.tag?null:"Just"===r._1.tag?r._1._1:void h(),t,e)}if("Property"===r.tag)return rb(r._1,e);if("Handler"===r.tag){let t=r._1,n=a[t]._1;return function(t,e,r){r.removeEventListener(t,e,!1)}(t,n,e)}"Ref"!==r.tag&&h()},n(u));return rr(void 0,{events:u,props:l},i,r)};return t=>{let e={},o=ro(t,rR,n(e));return rr(void 0,{events:e,props:o},i,r)}},rJ=(t,e,r)=>({tag:"Graft",_1:t,_2:e,_3:r}),rw=(t,e,r,n,i)=>({tag:t,_1:e,_2:r,_3:n,_4:i}),rE=t=>{let e=r=>{if("Text"===r.tag)return rw("Text",r._1);if("Elem"===r.tag)return rw("Elem",r._1,r._2,t._1(r._3),R(e)(r._4));if("Keyed"===r.tag)return rw("Keyed",r._1,r._2,t._1(r._3),R(t=>ta(t._1,e(t._2)))(r._4));if("Widget"===r.tag)return rw("Widget",t._2(r._1));if("Grafted"===r.tag){let e=r._1;return rw("Grafted",rJ(r=>t._1(e._1(r)),r=>t._2(e._2(r)),e._3))}h()};return e(t._3)},rx=(t,e,r)=>({tag:t,_1:e,_2:r}),rL=t=>t,rN=t=>e=>r=>n=>i=>o=>{let u,a=t,l=e,d=r,c=n,s=i,f=o,p=!0;for(;p;){let t=a,e=l,r=d,n=c,i=s,o=f;if("Pure"===i.tag){p=!1,u=ta(ts("Cons",{func:t.pure(i._1),count:o},e),r);continue}if("Lift"===i.tag){p=!1,u=ta(ts("Cons",{func:n(i._1),count:o},e),r);continue}if("Ap"===i.tag){a=t,l=e,d=tu(i._2,ts("Cons",r._1,r._2)),c=n,s=i._1,f=o+1|0;continue}h()}return u},rA=t=>e=>r=>n=>{let i=t,o=e,u=r,a=n,l=!0,d;for(;l;){let t=i,e=o,r=u,n=a;if("Nil"===e.tag){l=!1,d=q("Left",n);continue}if("Cons"===e.tag){let c=t.Apply0().apply(e._1.func)(n);if(1===e._1.count){if("Nil"===e._2.tag){l=!1,d=q("Left",c);continue}i=t,o=e._2,u=r,a=c;continue}if("Nil"===r.tag){l=!1,d=q("Left",c);continue}if("Cons"===r.tag){l=!1,d=q("Right",ta(ts("Cons",{func:c,count:e._1.count-1|0},e._2),tu(r._1,r._2)));continue}}h()}return d},rB={map:t=>e=>rx("Ap",rx("Pure",t),e)},rC=t=>e=>r=>(r=>{let n=r,i=!0,o;for(;i;){let r=n;if("Pure"===r._2._1.tag){let e=rA(t)(r._1)(r._2._2)(t.pure(r._2._1._1));if("Left"===e.tag){i=!1,o=e._1;continue}if("Right"===e.tag){n=e._1;continue}h()}if("Lift"===r._2._1.tag){let u=rA(t)(r._1)(r._2._2)(e(r._2._1._1));if("Left"===u.tag){i=!1,o=u._1;continue}if("Right"===u.tag){n=u._1;continue}h()}if("Ap"===r._2._1.tag){n=rN(t)(r._1)(tu(r._2._1._2,r._2._2))(e)(r._2._1._1)(1);continue}h()}return o})(ta(tf,tu(r,tf))),rT={apply:t=>e=>rx("Ap",t,e),Functor0:()=>rB},rI={pure:t=>rx("Pure",t),Apply0:()=>rT},rM=(t,e,r)=>({tag:"ChildQuery",_1:t,_2:e,_3:r}),rk=(t,e,r)=>({tag:t,_1:e,_2:r}),rO=t=>t,rq=t=>t,rP=t=>t,rF=()=>t=>e=>{let r=eG()(t)(e);return t=>n=>{let i=(t,r)=>"Leaf"===t.tag?r:"Node"===t.tag?i(t._5,(()=>{let n=i(t._6,r);return"Nothing"===t._4.tag?n:"Just"===t._4.tag?eA(e)(t._3)(t._4._1)(n):void h()})()):void h();return tN(tA("Bind",rk("ChildQuery",rM(e=>{let n=eT(e);return o=>{let u=e.Apply0().Functor0().map(t=>i(t,eR)),a=n(o),l=r(t);return t=>u(a(l(t)))}},n,rO)),t=>tN(tA("Return",t),tJ)),tJ)}},rD=()=>t=>e=>{let r=eH()(t)(e);return t=>e=>n=>tN(tA("Bind",rk("ChildQuery",rM(n=>i=>{let o=n.pure(T),u=r(t)(e);return t=>{let e=u(t);return"Nothing"===e.tag?o:"Just"===e.tag?i(e._1):void h()}},n,rO)),t=>tN(tA("Return",t),tJ)),tJ)},rU={state:t=>tN(tA("Bind",rk("State",t),t=>tN(tA("Return",t),tJ)),tJ),Monad0:()=>tC},rz=t=>({liftEffect:e=>tN(tA("Bind",rk("Lift",t.liftEffect(e)),t=>tN(tA("Return",t),tJ)),tJ),Monad0:()=>tC}),rG=t=>tN(tA("Bind",rk("Kill",t,void 0),t=>tN(tA("Return",t),tJ)),tJ),rj=t=>ri(t.widget),rH=(t,e)=>{if("Grafted"===e.tag)return rH(t,rE(e._1));if("Widget"===e.tag){let r=e._1,n=rn(t.widget,r);return rr(n._1,{build:t.build,widget:n},rH,rj)}return rj(t),t.build(e)},rQ=t=>{let e=t.node,r=rc(e);return rd(e,r)},rZ=(t,e)=>{if("Grafted"===e.tag)return rZ(t,rE(e._1));if("Text"===e.tag){if(t.value===e._1)return rr(t.node,t,rZ,rQ);let r=e._1;return t.node.textContent=r,rr(t.node,{build:t.build,node:t.node,value:r},rZ,rQ)}return rQ(t),t.build(e)},rW=t=>{let e=t.attrs,r=t.children,n=t.node,i=rc(n);return rd(n,i),!function(t,e){for(var r=Object.keys(t),n=0;n<r.length;n++){var i=r[n];e(i,t[i])}}(r,(t,e)=>ri(e)),ri(e)},rK=t=>{let e=t.attrs,r=t.children,n=t.node,i=rc(n);return rd(n,i),!function(t,e){for(var r=0;r<t.length;r++)e(t[r])}(r,ri),ri(e)},rV=(t,e,r,n)=>e===n&&("Just"===t.tag?"Just"===r.tag&&t._1===r._1:"Nothing"===t.tag&&"Nothing"===r.tag),r$=(t,e)=>{if("Grafted"===e.tag)return r$(t,rE(e._1));if("Elem"===e.tag&&rV(t.ns,t.name,e._1,e._2)){if(0===t.children.length&&0===e._4.length){let r=rn(t.attrs,e._3);return rr(t.node,{build:t.build,node:t.node,attrs:r,ns:e._1,name:e._2,children:t.children},r$,rK)}let r=function(t,e,r,n,i){for(var o=[],u=t.length,a=e.length,l=0;;){if(l<u)l<a?o.push(r(l,t[l],e[l])):n(l,t[l]);else if(l<a)o.push(i(l,e[l]));else break;l++}return o}(t.children,e._4,(e,r,n)=>{let i=rn(r,n);return rl(e,i._1,t.node),i},(t,e)=>ri(e),(e,r)=>{let n=t.build(r);return rl(e,n._1,t.node),n}),n=rn(t.attrs,e._3);return rr(t.node,{build:t.build,node:t.node,attrs:n,ns:e._1,name:e._2,children:r},r$,rK)}return rK(t),t.build(e)},rY=(t,e)=>{if("Grafted"===e.tag)return rY(t,rE(e._1));if("Keyed"===e.tag&&rV(t.ns,t.name,e._1,e._2)){let r=e._4.length;if(0===t.length&&0===r){let r=rn(t.attrs,e._3);return rr(t.node,{build:t.build,node:t.node,attrs:r,ns:e._1,name:e._2,children:t.children,length:0},rY,rW)}let n=ru(t.children,e._4,tc,(e,r,n,i)=>{let o=rn(n,i._2);return rl(r,o._1,t.node),o},(t,e)=>ri(e),(e,r,n)=>{let i=n._2,o=t.build(i);return rl(r,o._1,t.node),o}),i=rn(t.attrs,e._3);return rr(t.node,{build:t.build,node:t.node,attrs:i,ns:e._1,name:e._2,children:n,length:r},rY,rW)}return rW(t),t.build(e)},rX=(t,e,r)=>{let n=t.buildWidget(t)(r);return rr(n._1,{build:e,widget:n},rH,rj)},r1=(t,e,r)=>{let n=t.document.createTextNode(r);return rr(n,{build:e,node:n,value:r},rZ,rQ)},r0=(t,e,r,n,i,o)=>{let u=ra("Nothing"===r.tag?null:"Just"===r.tag?r._1:void h(),n,t.document),a=ro(o,tc,(t,r,n)=>{let i=e(n._2);return rl(r,i._1,u),i}),l=t.buildAttributes(u)(i);return rr(u,{build:e,node:u,attrs:l,ns:r,name:n,children:a,length:o.length},rY,rW)},r2=(t,e,r,n,i,o)=>{let u=ra("Nothing"===r.tag?null:"Just"===r.tag?r._1:void h(),n,t.document),a=function(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e(n,t[n]));return r}(o,(t,r)=>{let n=e(r);return rl(t,n._1,u),n}),l=t.buildAttributes(u)(i);return rr(u,{build:e,node:u,attrs:l,ns:r,name:n,children:a},r$,rK)},r5=t=>{let e=r=>{if("Text"===r.tag)return r1(t,e,r._1);if("Elem"===r.tag){let n=r._3,i=r._4,o=r._2;return r2(t,e,r._1,o,n,i)}if("Keyed"===r.tag){let n=r._3,i=r._4,o=r._2;return r0(t,e,r._1,o,n,i)}return"Widget"===r.tag?rX(t,e,r._1):"Grafted"===r.tag?e(rE(r._1)):void h()};return e},r3=(t,e)=>t._1===e._1&&t._2===e._2&&t._2(t._4,e._4),r4=t=>{let e=(r,n)=>{if(r3(r.thunk,n))return rr(r.vdom._1,r,e,t=>ri(t.vdom));let i=t(n._3(n._4)),o=rn(r.vdom,i);return rr(o._1,{vdom:o,thunk:n},e,t=>ri(t.vdom))};return r=>n=>{let i=t(n._3(n._4)),o=r5(r)(i);return rr(o._1,{thunk:n,vdom:o},e,t=>ri(t.vdom))}},r6=(t,e)=>({tag:t,_1:e}),r7=te(tk)(ti),r9=t=>e=>{if("Initialize"===e.tag){let r=e._1,n=r7(t.handleAction)(t.initialize);return tN(n._1,tL(n._2)(t=>tN(tA("Return",r),tJ)))}if("Finalize"===e.tag){let r=e._1,n=r7(t.handleAction)(t.finalize);return tN(n._1,tL(n._2)(t=>tN(tA("Return",r),tJ)))}if("Receive"===e.tag){let r=e._2,n=r7(t.handleAction)(t.receive(e._1));return tN(n._1,tL(n._2)(t=>tN(tA("Return",r),tJ)))}if("Action"===e.tag){let r=e._2,n=t.handleAction(e._1);return tN(n._1,tL(n._2)(t=>tN(tA("Return",r),tJ)))}if("Query"===e.tag){let r=e._2(),n=t.handleQuery(e._1._2);return tN(n._1,tL(n._2)(t=>tN(tA("Return","Nothing"===t.tag?r:"Just"===t.tag?e._1._1(t._1):void h()),tJ)))}h()},r8={handleAction:t=>tN(tA("Return",void 0),tJ),handleQuery:t=>tN(tA("Return",T),tJ),receive:t=>T,initialize:T,finalize:T},nt=()=>t=>e=>{let r=eH()(t)(e),n=ej()(t)(e),i=eQ()(t)(e);return t=>e=>o=>u=>a=>({get:r(t)(e),pop:n(t)(e),set:i(t)(e),component:o,input:u,output:a})},ne=ry("rel"),nr=(()=>{let t=ry("step");return e=>t("Any"===e.tag?"any":"Step"===e.tag?L(e._1):void h())})(),nn=ry("target"),ni=ry("min"),no=ry("max"),nu=ry("href"),na=ry("draggable"),nl=(()=>{let t=ry("className"),e=eZ(" "),r=R(tv);return n=>t(e(r(n)))})(),nd=ry("className"),nc=t=>()=>()=>e=>r=>n=>E(t.reflectSymbol(e))(r)(n),ns=t=>e=>rw("Elem",T,"i",[nl(["fa-solid "+t,...e])],[]),nf=t=>e=>r=>rw("Elem",T,"button",[nl(["rounded w-full h-full py-1 px-2 transition-colors duration-75",e]),rh("Handler","click",t=>C("Just",eV("Action",r)))],[t]),np=(t,e)=>({tag:t,_1:e}),ng=(t,e)=>({tag:"SetItems",_1:t,_2:e}),n_=(()=>{let t=tU(rU);return e=>t.state(t=>ta(void 0,e))})(),nv=tD(tC).pure,nm=nc({reflectSymbol:()=>"selected"})()(),nh=t=>tN(tA("Bind",rk("State",e=>ta(void 0,t(e))),t=>tN(tA("Return",t),tJ)),tJ),ny=t=>tN(tA("Bind",rk("State",e=>{let r=t(e);return ta(r,r)}),t=>tN(tA("Return",t),tJ)),tJ),nb=t=>tN(tA("Bind",rk("State",e=>ta(t(e),e)),t=>tN(tA("Return",t),tJ)),tJ),nR=t=>e=>ng(t,e),nS=np("EnterEdit"),nJ=np("LeaveEdit"),nw=(t,e)=>({tag:t,_1:e});function nE(t){return Error(t)}function nx(t){return function(){throw t}}var nL=t=>t,nN=t=>e=>{let r=te(e);return e=>{let n=r(e);return e=>{let r=n(r=>t.parallel(e(r)));return e=>t.sequential(r(e))}}},nA=function(t){throw Error(t)},nB=function(){var t={},e="Pure",r="Throw",n="Catch",i="Sync",o="Async",u="Bind",a="Bracket",l="Fork",d="Sequential",c="Apply",s="Cons",f="Resume",p="Release",g="Finalizer",_="Finalized",v="Forked";function m(t,e,r,n){this.tag=t,this._1=e,this._2=r,this._3=n}function h(t){var e=function(e,r,n){return new m(t,e,r,n)};return e.tag=t,e}function y(t){return new m(e,void 0)}var b=function(){var t=0,e=0,r=Array(1024),n=!1;function i(){var i;for(n=!0;0!==t;)t--,i=r[e],r[e]=void 0,e=(e+1)%1024,i();n=!1}return{isDraining:function(){return n},enqueue:function(o){var u;1024===t&&(u=n,i(),n=u),r[(e+t)%1024]=o,t++,n||i()}}}();return m.EMPTY=t,m.Pure=h(e),m.Throw=h(r),m.Catch=h(n),m.Sync=h(i),m.Async=h(o),m.Bind=h(u),m.Bracket=h(a),m.Fork=h(l),m.Seq=h(d),m.ParMap=h("Map"),m.ParApply=h(c),m.ParAlt=h("Alt"),m.Fiber=function h(R,S,J){var w=0,E=0,x=J,L=null,N=null,A=null,B=null,C=null,T=0,I=0,M=null,k=!0;function O(J){for(var I,q,P;;)switch(I=null,q=null,P=null,E){case 2:E=1;try{x=A(x),null===B?A=null:(A=B._1,B=B._2)}catch(t){E=5,L=R.left(t),x=null}break;case 3:R.isLeft(x)?(E=5,L=x,x=null):null===A?E=5:(E=2,x=R.fromRight(x));break;case 1:switch(x.tag){case u:A&&(B=new m(s,A,B)),A=x._2,E=1,x=x._1;break;case e:null===A?(E=5,x=R.right(x._1)):(E=2,x=x._1);break;case i:E=3,x=function(t,e,r){try{return e(r())}catch(e){return t(e)}}(R.left,R.right,x._1);break;case o:E=4,x=function(t,e,r){try{return e(r)()}catch(e){return r(t(e))(),y}}(R.left,x._1,function(t){return function(){w===J&&(w++,b.enqueue(function(){w===J+1&&(E=3,x=t,O(w))}))}});return;case r:E=5,L=R.left(x._1),x=null;break;case n:C=null===A?new m(s,x,C,N):new m(s,x,new m(s,new m(f,A,B),C,N),N),A=null,B=null,E=1,x=x._1;break;case a:T++,C=null===A?new m(s,x,C,N):new m(s,x,new m(s,new m(f,A,B),C,N),N),A=null,B=null,E=1,x=x._1;break;case l:E=3,I=h(R,S,x._2),S&&S.register(I),x._1&&I.run(),x=R.right(I);break;case d:E=1,x=function(e,r,n){return new m(o,function(i){return function(){return function(e,r,n,i){var u=0,a={},l=0,d={},f=Error("[ParAff] Early exit"),p=null,g=t;function _(r,n,i){var o,u,l=n,d=null,f=null,p=0,g={};e:for(;;)switch(o=null,l.tag){case v:if(l._3===t&&(o=a[l._1],g[p++]=o.kill(r,function(t){return function(){0==--p&&i(t)()}})),null===d)break e;l=d._2,null===f?d=null:(d=f._1,f=f._2);break;case"Map":l=l._2;break;case c:case"Alt":d&&(f=new m(s,d,f)),d=l,l=l._1}if(0===p)i(e.right(void 0))();else for(u=0,o=p;u<o;u++)g[u]=g[u]();return g}return function(){var o,y,b=1,R=n,S=null,J=null;e:for(;;)switch(o=null,y=null,b){case 1:switch(R.tag){case"Map":S&&(J=new m(s,S,J)),S=new m("Map",R._1,t,t),R=R._2;break;case c:S&&(J=new m(s,S,J)),S=new m(c,t,R._2,t),R=R._1;break;case"Alt":S&&(J=new m(s,S,J)),S=new m("Alt",t,R._2,t),R=R._1;break;default:y=u++,b=5,o=R,R=new m(v,y,new m(s,S,J),t),(o=h(e,r,o)).onComplete({rethrow:!1,handler:function(r){return function(n){return function(){delete a[r._1],r._3=n,function r(n,o,u){var a,s,g,v,m,h;for(e.isLeft(n)?(a=n,s=null):(s=n,a=null);;){if(g=null,v=null,m=null,h=null,null!==p)return;if(null===o){i(a||s)();return}if(o._3!==t)return;switch(o.tag){case"Map":null===a?(o._3=e.right(o._1(e.fromRight(s))),s=o._3):o._3=a;break;case c:if(g=o._1._3,v=o._2._3,a){if(o._3=a,m=!0,d[h=l++]=_(f,a===g?o._2:o._1,function(){return function(){delete d[h],m?m=!1:null===u?r(a,null,null):r(a,u._1,u._2)}}),m){m=!1;return}}else{if(g===t||v===t)return;s=e.right(e.fromRight(g)(e.fromRight(v))),o._3=s}break;case"Alt":if(g=o._1._3,v=o._2._3,g===t&&e.isLeft(v)||v===t&&e.isLeft(g))return;if(g!==t&&e.isLeft(g)&&v!==t&&e.isLeft(v))a=s===g?v:g,s=null,o._3=a;else if(o._3=s,m=!0,d[h=l++]=_(f,s===g?o._2:o._1,function(){return function(){delete d[h],m?m=!1:null===u?r(s,null,null):r(s,u._1,u._2)}}),m){m=!1;return}}null===u?o=null:(o=u._1,u=u._2)}}(n,r._2._1,r._2._2)}}}(R)})(),a[y]=o,r&&r.register(o)}break;case 5:if(null===S)break e;S._1===t?(S._1=R,b=1,R=S._2,S._2=t):(S._2=R,R=S,null===J?S=null:(S=J._1,J=J._2))}for(y=0,g=R;y<u;y++)a[y].run()}(),function(t){return new m(o,function(r){return function(){return function(t,r){for(var n in p=e.left(t),d)if(d.hasOwnProperty(n))for(n in i=d[n])i.hasOwnProperty(n)&&i[n]();d=null;var i,u=_(t,g,r);return function(t){return new m(o,function(t){return function(){for(var t in u)u.hasOwnProperty(t)&&u[t]();return y}})}}(t,r)}})}}(e,r,n,i)}})}(R,S,x._1)}break;case 5:if(A=null,B=null,null===C)E=6,x=N||L||x;else switch(I=C._3,P=C._1,C=C._2,P.tag){case n:N&&N!==I&&0===T?E=5:L&&(E=1,x=P._2(R.fromLeft(L)),L=null);break;case f:N&&N!==I&&0===T||L?E=5:(A=P._1,B=P._2,E=2,x=R.fromRight(x));break;case a:T--,null===L&&(q=R.fromRight(x),C=new m(s,new m(p,P._2,q),C,I),(N===I||T>0)&&(E=1,x=P._3(q)));break;case p:C=new m(s,new m(_,x,L),C,N),E=1,x=N&&N!==I&&0===T?P._1.killed(R.fromLeft(N))(P._2):L?P._1.failed(R.fromLeft(L))(P._2):P._1.completed(R.fromRight(x))(P._2),L=null,T++;break;case g:T++,C=new m(s,new m(_,x,L),C,N),E=1,x=P._1;break;case _:T--,E=5,x=P._1,L=P._2}break;case 6:for(var F in M)M.hasOwnProperty(F)&&(k=k&&M[F].rethrow,function(t){try{t()}catch(t){setTimeout(function(){throw t},0)}}(M[F].handler(x)));M=null,N&&L?setTimeout(function(){throw R.fromLeft(L)},0):R.isLeft(x)&&k&&setTimeout(function(){if(k)throw R.fromLeft(x)},0);return;case 0:E=1;break;case 4:return}}function q(t){return function(){if(6===E)return k=k&&t.rethrow,t.handler(x)(),function(){};var e=I++;return(M=M||{})[e]=t,function(){null!==M&&delete M[e]}}}return{kill:function(t,e){return function(){if(6===E)return e(R.right(void 0))(),function(){};var r=q({rethrow:!1,handler:function(){return e(R.right(void 0))}})();switch(E){case 0:N=R.left(t),E=6,x=N,O(w);break;case 4:null===N&&(N=R.left(t)),0===T&&(4===E&&(C=new m(s,new m(g,x(t)),C,N)),E=5,x=null,L=null,O(++w));break;default:null===N&&(N=R.left(t)),0===T&&(E=5,x=null,L=null)}return r}},join:function(t){return function(){var e=q({rethrow:!1,handler:t})();return 0===E&&O(w),e}},onComplete:q,isSuspended:function(){return 0===E},run:function(){0===E&&(b.isDraining()?O(w):b.enqueue(function(){O(w)}))}}},m.Supervisor=function(t){var e={},r=0,n=0;return{register:function(t){var i=r++;t.onComplete({rethrow:!0,handler:function(t){return function(){n--,delete e[i]}}})(),e[i]=t,n++},isEmpty:function(){return 0===n},killAll:function(o,u){return function(){if(0===n)return u();var a=0,l={};for(var d in e)e.hasOwnProperty(d)&&(a++,function(r){l[r]=e[r].kill(o,function(e){return function(){delete l[r],a--,t.isLeft(e)&&t.fromLeft(e)&&setTimeout(function(){throw t.fromLeft(e)},0),0===a&&u()}})()}(d));return e={},r=0,n=0,function(t){return new m(i,function(){for(var t in l)l.hasOwnProperty(t)&&l[t]()})}}}}},m.Scheduler=b,m.nonCanceler=y,m}(),nC=nB.Pure,nT=nB.Throw;function nI(t){return function(e){return e.tag===nB.Pure.tag?nB.Pure(t(e._1)):nB.Bind(e,function(e){return nB.Pure(t(e))})}}function nM(t){return function(e){return nB.Bind(t,e)}}var nk=nB.Sync,nO=nB.Async,nq=nB.Seq,nP={map:function(t){return function(e){return nB.ParMap(t,e)}}},nF={map:nI},nD=function(t){return nB.Fork(!0,t)},nU={isLeft:t=>"Left"===t.tag||"Right"!==t.tag&&void h(),fromLeft:t=>"Left"===t.tag?t._1:"Right"===t.tag?nA("unsafeFromLeft: Right"):void h(),fromRight:t=>"Right"===t.tag?t._1:"Left"===t.tag?nA("unsafeFromRight: Left"):void h(),left:P,right:F},nz={apply:function(t){return function(e){return nB.ParApply(t,e)}},Functor0:()=>nP},nG={Applicative0:()=>nQ,Bind1:()=>nj},nj={bind:nM,Apply0:()=>nH},nH={apply:t=>e=>nM(t)(t=>nM(e)(e=>nQ.pure(t(e)))),Functor0:()=>nF},nQ={pure:nC,Apply0:()=>nH},nZ=t=>e=>{var r;return(r=nC(),function(t){return function(e){return nB.Bracket(r,t,e)}})({killed:e=>e=>t,failed:e=>e=>t,completed:e=>e=>t})(t=>e)},nW={parallel:tv,sequential:nq,Apply0:()=>nH,Apply1:()=>nz},nK={pure:t=>nC(t),Apply0:()=>nz},nV={liftEffect:nk,Monad0:()=>nG},n$=t=>nO(e=>{let r=t.join(e);return()=>{let t=nk(r());return e=>t}}),nY=t=>e=>nM(nk(e.isSuspended))(r=>r?nk((()=>{let r=e.kill(t,t=>()=>{});return()=>{r()}})()):nO(r=>{let n=e.kill(t,r);return()=>{let t=nk(n());return e=>t}})),nX={throwError:nT,Monad0:()=>nG},n1=(t=>{let e=t.MonadThrow0().Monad0();return r=>t.catchError(e.Bind1().Apply0().Functor0().map(F)(r))(t=>e.Applicative0().pure(q("Left",t)))})({catchError:function(t){return function(e){return nB.Catch(t,e)}},MonadThrow0:()=>nX}),n0=t=>e=>{var r;let n=(r=nM(n1(e))(e=>nk(t(e))),function(){return nB.Fiber(nU,null,r)});return()=>{let t=n();return t.run(),t}},n2=t=>e=>{let r=n0(t)(e);return()=>{r()}},n5=(()=>{let t=nC();return e=>t})(),n3=()=>t=>e=>{let r=nt()(t)(e);return t=>e=>n=>i=>rw("Widget",r6("ComponentSlot",r(t)(e)(n)(i)(t=>T)))},n4=()=>t=>e=>{let r=nt()(t)(e);return t=>e=>n=>i=>o=>rw("Widget",r6("ComponentSlot",r(t)(e)(n)(i)(t=>C("Just",o(t)))))};function n6(t){return function(){return t.preventDefault()}}function n7(t,e,r,n){if("undefined"!=typeof window){var i=window[r];if(null!=i&&n instanceof i)return e(n)}for(var o=n;null!=o;){var u=Object.getPrototypeOf(o),a=u.constructor.name;if(a===r)return e(n);if("Object"===a)break;o=u}return t}function n9(t){return function(){t.select()}}var n8=(t=>{let e=e1(t).pure;return r=>n=>{var i;return i=e0(t).throwError(tu(e6("TypeMismatch","object",typeof n),tf)),null==n?i:e(n[r])}})(Q),it=t=>e=>rh("Handler",t,t=>{let r=e(t);return"Just"===r.tag?C("Just",eV("Action",r._1)):T}),ie=t=>e=>r=>n=>it(t)(t=>{let i=e$(t.currentTarget,T,I);if("Just"===i.tag){let t=eY(Q).bind(n8(e)(i._1))(r);if("Left"===t.tag)return T;if("Right"===t.tag)return C("Just",n(t._1));h()}if("Nothing"===i.tag)return T;h()}),ir=t=>t,ii=()=>t=>e=>{let r=rD()(t)(e);return t=>e=>n=>{let i=r(t)(e)(n());return tN(i._1,tL(i._2)(t=>tN(tA("Return",void 0),tJ)))}},io=()=>t=>e=>{let r=rF()(t)(e);return t=>e=>r(t)(e(ir))};function iu(t){return t}function ia(t){return JSON.stringify(t)}function il(t,e,r,n,i,o,u){return null==u?t():"boolean"==typeof u?e(u):"number"==typeof u?r(u):"string"==typeof u?n(u):"[object Array]"===Object.prototype.toString.call(u)?i(u):o(u)}var id=(t,e,r)=>({tag:t,_1:e,_2:r}),ic=t=>e=>id("AtIndex",t,e),is=t=>e=>id("AtKey",t,e),ip=t=>e=>id("Named",t,e),ig=id("MissingValue"),i_=t=>{let e=t=>"TypeMismatch"===t.tag?"  Expected value of type '"+t._1+"'.":"UnexpectedValue"===t.tag?"  Unexpected value "+ia(t._1)+".":"AtIndex"===t.tag?"  At array index "+x(t._1)+":\n"+e(t._2):"AtKey"===t.tag?"  At object key '"+t._1+"':\n"+e(t._2):"Named"===t.tag?"  Under '"+t._1+"':\n"+e(t._2):"MissingValue"===t.tag?"  No value was found.":void h();return"An error occurred while decoding a JSON value:\n"+e(t)};String.fromCharCode(65535),"undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&String.prototype[Symbol.iterator],String.prototype.fromCodePoint,String.prototype.codePointAt;var iv={traverseWithIndex:t=>{let e=iv.Traversable2().sequence(t);return t=>{let r=iv.FunctorWithIndex0().mapWithIndex(t);return t=>e(r(t))}},FunctorWithIndex0:()=>tV,Traversable2:()=>ty},im=iv.traverseWithIndex({pure:F,Apply0:()=>U}),ih=t=>{let e=il(t=>T,t=>T,t=>T,t=>T,I,t=>T,t);return"Nothing"===e.tag?q("Left",id("TypeMismatch","Array")):"Just"===e.tag?q("Right",e._1):void h()},iy=t=>{let e=il(t=>q("Left",id("TypeMismatch","Number")),t=>q("Left",id("TypeMismatch","Number")),F,t=>q("Left",id("TypeMismatch","Number")),t=>q("Left",id("TypeMismatch","Number")),t=>q("Left",id("TypeMismatch","Number")),t);if("Left"===e.tag)return q("Left",e._1);if("Right"===e.tag){var r;let t=(0|(r=e._1))===r?I(r):T;if("Nothing"===t.tag)return q("Left",id("TypeMismatch","Integer"));if("Just"===t.tag)return q("Right",t._1)}h()},ib=t=>{let e=ip("Array"),r=im(e=>{let r=ic(e);return e=>{let n=t(e);return"Left"===n.tag?q("Left",r(n._1)):"Right"===n.tag?q("Right",n._1):void h()}});return t=>{let n=ih(t);if("Left"===n.tag)return q("Left",n._1);if("Right"===n.tag){let t=r(n._1);if("Left"===t.tag)return q("Left",e(t._1));if("Right"===t.tag)return q("Right",t._1)}h()}},iR={gDecodeJson:t=>t=>q("Right",{})},iS=t=>()=>({decodeJson:e=>{let r=il(t=>T,t=>T,t=>T,t=>T,t=>T,I,e);return"Just"===r.tag?t.gDecodeJson(r._1)(b):"Nothing"===r.tag?q("Left",id("TypeMismatch","Object")):void h()}}),iJ=t=>e=>r=>()=>()=>({gDecodeJson:n=>i=>{let o=r.reflectSymbol(b),u=t.decodeJsonField(o in n?I(n[o]):T);if("Just"===u.tag){let t=is(o);if("Left"===u._1.tag)return q("Left",t(u._1._1));if("Right"===u._1.tag){let t=u._1._1,i=e.gDecodeJson(n)(b);return(()=>{if("Left"===i.tag){let t=i._1;return e=>q("Left",t)}if("Right"===i.tag){let t=i._1;return e=>e(t)}h()})()(e=>q("Right",E(r.reflectSymbol(b))(t)(e)))}h()}if("Nothing"===u.tag)return q("Left",id("AtKey",o,ig));h()}}),iw={gEncodeJson:t=>t=>rt},iE={encodeJson:iu},ix={encodeJson:iu},iL={encodeJson:t=>e2(t)},iN=t=>({encodeJson:(()=>{let e=R(t.encodeJson);return t=>e(t)})()}),iA=t=>({encodeJson:(()=>{let e=R(t.encodeJson);return t=>e(t)})()}),iB=t=>e=>r=>()=>({gEncodeJson:n=>i=>{var o;let u=r.reflectSymbol(b),a=t.encodeJson((o=r.reflectSymbol(b),function(t){return t[o]})(n));return re(t=>()=>(t[u]=a,t))(e.gEncodeJson(n)(b))}}),iC={genericShowArgs:t=>[]},iT=t=>e=>({"genericShow'":r=>{let n=e.reflectSymbol(b),i=t.genericShowArgs(r);return 0===i.length?n:"("+[n,...i].join(" ")+")"}}),iI=new Uint8Array(16),iM=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,ik=function(t){return"string"==typeof t&&iM.test(t)},iO=[];for(let t=0;t<256;++t)iO.push((t+256).toString(16).slice(1));function iq(t,e=0){return iO[t[e+0]]+iO[t[e+1]]+iO[t[e+2]]+iO[t[e+3]]+"-"+iO[t[e+4]]+iO[t[e+5]]+"-"+iO[t[e+6]]+iO[t[e+7]]+"-"+iO[t[e+8]]+iO[t[e+9]]+"-"+iO[t[e+10]]+iO[t[e+11]]+iO[t[e+12]]+iO[t[e+13]]+iO[t[e+14]]+iO[t[e+15]]}var iP=function(t){let e;if(!ik(t))throw TypeError("Invalid UUID");let r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=255&e,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=255&e,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=255&e,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=255&e,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=255&e,r},iF={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function iD(t,e){return t<<e|t>>>32-e}var iU=function(t,e,r){function n(t,e,n,i){var o;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}(t)),"string"==typeof e&&(e=iP(e)),(null===(o=e)||void 0===o?void 0:o.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+t.length);if(u.set(e),u.set(t,e.length),(u=r(u))[6]=15&u[6]|80,u[8]=63&u[8]|128,n){i=i||0;for(let t=0;t<16;++t)n[i+t]=u[t];return n}return iq(u)}try{n.name="v5"}catch(t){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}(0,0,function(t){let e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){let e=unescape(encodeURIComponent(t));t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);let n=Math.ceil((t.length/4+2)/16),i=Array(n);for(let e=0;e<n;++e){let r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=t[64*e+4*n]<<24|t[64*e+4*n+1]<<16|t[64*e+4*n+2]<<8|t[64*e+4*n+3];i[e]=r}i[n-1][14]=(t.length-1)*8/4294967296,i[n-1][14]=Math.floor(i[n-1][14]),i[n-1][15]=(t.length-1)*8&4294967295;for(let t=0;t<n;++t){let n=new Uint32Array(80);for(let e=0;e<16;++e)n[e]=i[t][e];for(let t=16;t<80;++t)n[t]=iD(n[t-3]^n[t-8]^n[t-14]^n[t-16],1);let o=r[0],u=r[1],a=r[2],l=r[3],d=r[4];for(let t=0;t<80;++t){let r=Math.floor(t/20),i=iD(o,5)+function(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:case 3:return e^r^n;case 2:return e&r^e&n^r&n}}(r,u,a,l)+d+e[r]+n[t]>>>0;d=l,l=a,a=iD(u,30)>>>0,u=o,o=i}r[0]=r[0]+o>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+a>>>0,r[3]=r[3]+l>>>0,r[4]=r[4]+d>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}),iz=function(t,e,r){if(iF.randomUUID&&!e&&!t)return iF.randomUUID();let n=(t=t||{}).random||(t.rng||function(){if(!c&&!(c="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(iI)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=n[t];return e}return iq(n)},iG=function(t){return function(e){return iU(t,e)}},ij={eq:t=>e=>t===e},iH={compare:t=>e=>t3.compare(t)(e),Eq0:()=>ij},iQ={encodeJson:t=>t},iZ=iG("tcg-calculator")("00000000-0000-0000-0000-000000000000"),iW={decodeJson:t=>{let e=il(t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),F,t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),t);return"Left"===e.tag?q("Left",e._1):"Right"===e.tag?q("Right",ik(e._1)?e._1:iG(e._1)(iZ)):void h()}},iK={reflectSymbol:()=>"cards"},iV={reflectSymbol:()=>"count"},i$={reflectSymbol:()=>"mode"},iY={reflectSymbol:()=>"id"},iX={reflectSymbol:()=>"name"},i1="AtLeast",i0="JustDraw",i2="Remains",i5="JustRemains",i3="Choice",i4="LeftOne",i6="LeftAll",i7=t=>"AtLeast"===t?A("Inl",B):"JustDraw"===t?A("Inr",A("Inl",B)):"Remains"===t?A("Inr",A("Inr",A("Inl",B))):"JustRemains"===t?A("Inr",A("Inr",A("Inr",A("Inl",B)))):"Choice"===t?A("Inr",A("Inr",A("Inr",A("Inr",A("Inl",B))))):"LeftOne"===t?A("Inr",A("Inr",A("Inr",A("Inr",A("Inr",A("Inl",B)))))):"LeftAll"===t?A("Inr",A("Inr",A("Inr",A("Inr",A("Inr",A("Inr",B)))))):void h(),i9={show:(()=>{let t=iT(iC)({reflectSymbol:()=>"AtLeast"}),e=iT(iC)({reflectSymbol:()=>"JustDraw"}),r=(()=>{let r=(()=>{let t=iT(iC)({reflectSymbol:()=>"Remains"}),r=(()=>{let e=iT(iC)({reflectSymbol:()=>"JustRemains"}),r=(()=>{let t=iT(iC)({reflectSymbol:()=>"Choice"}),r=(()=>{let e=iT(iC)({reflectSymbol:()=>"LeftOne"}),r=(()=>{let t=iT(iC)({reflectSymbol:()=>"LeftAll"});return{"genericShow'":r=>"Inl"===r.tag?e["genericShow'"](r._1):"Inr"===r.tag?t["genericShow'"](r._1):void h()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void h()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?r["genericShow'"](t._1):void h()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void h()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?r["genericShow'"](t._1):void h()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void h()}})();return t=>r["genericShow'"](i7(t))})()},i8={encodeJson:t=>i9.show(t)},ot=(()=>{let t=iB(iN((()=>{let t=iB(iL)(iB(iQ)(iB(iE)(iw)(iX)())(iY)())(iV)();return{encodeJson:e=>t.gEncodeJson(e)(b)}})()))(iB(iL)(iB(i8)(iw)(i$)())(iV)())(iK)();return{encodeJson:e=>t.gEncodeJson(e)(b)}})(),oe=t=>"AtLeast"===t?C("Just",i1):"JustDraw"===t?C("Just",i0):"Remains"===t?C("Just",i2):"JustRemains"===t?C("Just",i5):"Choice"===t?C("Just",i3):"LeftOne"===t?C("Just",i4):"LeftAll"===t?C("Just",i6):T,or={decodeJson:t=>{let e=il(t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),F,t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),t);if("Left"===e.tag)return q("Left",e._1);if("Right"===e.tag){let r=oe(e._1);if("Nothing"===r.tag)return q("Left",id("UnexpectedValue",t));if("Just"===r.tag)return q("Right",r._1)}h()}},on=(t,e)=>({tag:t,_1:e}),oi=(t,e,r,n)=>({tag:t,_1:e,_2:r,_3:n}),oo=ry("value"),ou={reflectSymbol:()=>"selector"},oa=n4()(ou)(t5),ol=(t=>{let e=rw("Elem",T,"div",[],[nf(rw("Elem",T,"i",[nd("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(nS)]);return{initialState:(()=>{let t=R(nm(b)(!1));return e=>({items:t(e),isEditMode:!1})})(),render:t=>{let r=t.isEditMode;return rw("Elem",T,"div",[nd("mx-1 flex")],[ei(t=>!t.selected,t.items)||r?e:rw("Text",""),rw("Elem",T,"div",[nd(r?"fixed inset-0 bg-black opacity-20":"hidden"),rh("Handler","click",t=>C("Just",eV("Action",nJ)))],[]),rw("Elem",T,"ul",[nd(r?"break-anywhere absolute flex min-w-48 flex-col gap-0.5 bg-white p-4 shadow-md":"break-anywhere flex w-full flex-wrap gap-1"),rh("Handler","click",t=>C("Just",eV("Action",nS)))],R(t=>rw("Elem",T,"li",[nd(t.selected||r?"min-w-0":"hidden")],[rw("Elem",T,"button",[nl(["h-full w-full rounded border px-3 py-1 transition-colors duration-75",t.selected?"border-sky-700 bg-sky-500 text-white hover:bg-sky-600":"border-gray-800 bg-gray-300 text-black hover:bg-gray-400"]),(()=>{let e=np("Toggle",t.id);return rh("Handler","click",t=>C("Just",eV("Action",e)))})()],[rw("Text",t.value)])]))(t.items))])},eval:r9({...r8,handleAction:e=>{if("EnterEdit"===e.tag)return nh(t=>({...t,isEditMode:!0}));if("LeaveEdit"===e.tag){let t=ny(t=>({...t,isEditMode:!1}));return tN(t._1,tL(t._2)(t=>tN(tA("Bind",rk("Raise",R(t=>t.id)(ee(t=>t.selected,t.items)),void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("Toggle"===e.tag){let r=e._1,n=nb(t=>t.isEditMode),i=nh(e=>({...e,items:R(e=>t.eq(e.id)(r)?{...e,selected:!e.selected}:e)(e.items)}));return tN(n._1,tL(n._2)(t=>t?i:tN(tA("Return",void 0),tJ)))}if("Receive"===e.tag){let r=e._1;return nh(e=>{let n=e.items;return{...e,items:R(e=>{let r=e.id;return{id:r,value:e.value,selected:(()=>{let e=es(e=>t.eq(e.id)(r))(n);return"Nothing"!==e.tag&&("Just"===e.tag?e._1.selected:void h())})()}})(r)}})}h()},handleQuery:t=>{let e=t._2;return tP(tC).bind(n_({items:t._1,isEditMode:!1}))(()=>nv(e))},receive:t=>C("Just",np("Receive",t))})}})(ij),od=(()=>{let t=ry("type");return e=>t(eK(e))})(),oc=(()=>{let t={append:t=>e=>t+e|0};return to.foldMap({mempty:0,Semigroup0:()=>t})})(),os=t=>e=>{let r=t4.compare(t)(e);return"LT"===r||"EQ"===r?t:"GT"===r?e:void h()},of=t=>e=>tN(e._1,tL(e._2)(e=>tN(tA("Return","Just"===e.tag?C("Just",t(e._1)):T),tJ))),op=(()=>{let t=tU(rU);return e=>t.state(t=>ta(e(t),t))})(),og=ep({eq:t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name}),o_=ii()(ou)(t5),ov=t=>e=>r=>{let n=t4.compare(t)(r),i="LT"===n?r:"EQ"===n||"GT"===n?t:void h(),o=t4.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void h()},om=tN(tA("Bind",rk("State",t=>ta(t,t)),t=>tN(tA("Return",t),tJ)),tJ),oh=te(tk)(ti),oy=t=>tN(tA("Bind",rk("State",e=>{let r=t(e);return ta(r,r)}),t=>tN(tA("Return",t),tJ)),tJ),ob=rz(nV).liftEffect,oR=te(W)(ti),oS=t=>oi("GetCondition",t),oJ=t=>e=>r=>oi("RestoreState",t,e,r),ow={tag:"Updated"},oE=on("Initialize"),ox=t=>on("UpdateConditionMode",t),oL=t=>on("UpdateCardSelected",t),oN=t=>on("UpdateCardCount",t),oA={initialState:t=>({cards:t,condition:{mode:i1,count:0,cards:[]},min:0,max:0}),render:t=>rw("Elem",T,"div",[nd("flex flex-wrap items-center justify-end")],[rw("Elem",T,"div",[nd("w-48 grow rounded border p-0.5")],[oa(b)()(ol)(R(t=>({id:t.id,value:t.name}))(t.cards))(oL)]),rw("Elem",T,"div",[nd("flex items-center")],[rw("Elem",T,"div",[nd("mx-1")],[rw("Text","を")]),rw("Elem",T,"input",[nl(["w-12 appearance-none rounded border border-gray-400 bg-transparent p-1 text-right","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),od(eW),nr(nw("Step",1)),oo(x(t.condition.count)),ni(e2(t.min)),no(e2(t.max)),rh("Handler","focus",t=>C("Just",eV("Action",on("SelectOnFocus",t)))),ie("change")("value")(e8(Q))(oN)],[]),rw("Elem",T,"select",[nl(["w-full appearance-none rounded border border-gray-400 bg-transparent px-3 py-1","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),oo(i9.show(t.condition.mode)),ie("change")("value")(e8(Q))(ox)],[rw("Elem",T,"option",[oo(i9.show(i1))],[rw("Text","枚以上ドローする")]),rw("Elem",T,"option",[oo(i9.show(i0))],[rw("Text","枚ちょうどドローする")]),rw("Elem",T,"option",[oo(i9.show(i2))],[rw("Text","枚以上デッキに残す")]),rw("Elem",T,"option",[oo(i9.show(i5))],[rw("Text","枚ちょうどデッキに残す")]),rw("Elem",T,"option",[oo(i9.show(i3))],[rw("Text","種類以上ドローする")]),rw("Elem",T,"option",[oo(i9.show(i4))],[rw("Text","種類以上デッキに残す")]),rw("Elem",T,"option",[oo(i9.show(i6))],[rw("Text","種類以上ドローしない")])])])]),eval:r9({...r8,handleAction:t=>{if("Initialize"===t.tag)return tN(om._1,tL(om._2)(t=>{let e=oc(t=>t.count);if("AtLeast"===t.condition.mode){let r=e(t.condition.cards),n={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:ov(os(1)(r))(r)(t.condition.count)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}if("JustDraw"===t.condition.mode){let r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:ov(0)(e(t.condition.cards))(t.condition.count)},min:0,max:e(t.condition.cards)};return tN(tA("Bind",rk("State",t=>ta(void 0,r)),t=>tN(tA("Return",t),tJ)),tJ)}if("Remains"===t.condition.mode){let r=e(t.condition.cards),n={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:ov(os(1)(r))(r)(t.condition.count)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}if("JustRemains"===t.condition.mode){let r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:ov(0)(e(t.condition.cards))(t.condition.count)},min:0,max:e(t.condition.cards)};return tN(tA("Bind",rk("State",t=>ta(void 0,r)),t=>tN(tA("Return",t),tJ)),tJ)}if("Choice"===t.condition.mode){let e=t.condition.cards.length,r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,r)),t=>tN(tA("Return",t),tJ)),tJ)}if("LeftOne"===t.condition.mode){let e=t.condition.cards.length,r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,r)),t=>tN(tA("Return",t),tJ)),tJ)}if("LeftAll"===t.condition.mode){let e=t.condition.cards.length,r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,r)),t=>tN(tA("Return",t),tJ)),tJ)}h()}));if("UpdateCardSelected"===t.tag){let e=t._1;return tN(om._1,tL(tL(om._2)(t=>{let r=ee(t=>ep(ij)(t.id)(e),t.cards),n=oc(t=>t.count);if("AtLeast"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tJ)}if("JustDraw"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tN(tA("Bind",rk("State",t=>ta(void 0,e)),t=>tN(tA("Return",t),tJ)),tJ)}if("Remains"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tJ)}if("JustRemains"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tN(tA("Bind",rk("State",t=>ta(void 0,e)),t=>tN(tA("Return",t),tJ)),tJ)}if("Choice"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}if("LeftOne"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}if("LeftAll"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}h()}))(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("UpdateConditionMode"===t.tag)return oh(t=>tN(om._1,tL(om._2)(e=>{let r=oc(t=>t.count);if("AtLeast"===t){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:ov(os(1)(n))(n)(e.condition.count)},min:os(1)(n),max:n};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("JustDraw"===t){let n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:ov(0)(r(e.condition.cards))(e.condition.count)},min:0,max:r(e.condition.cards)};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("Remains"===t){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:ov(os(1)(n))(n)(e.condition.count)},min:os(1)(n),max:n};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("JustRemains"===t){let n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:ov(0)(r(e.condition.cards))(e.condition.count)},min:0,max:r(e.condition.cards)};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("Choice"===t){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:ov(os(1)(r))(r)(e.condition.count)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("LeftOne"===t){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:ov(os(1)(r))(r)(e.condition.count)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("LeftAll"===t){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:ov(os(1)(r))(r)(e.condition.count)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}h()})))(oe(t._1));if("UpdateCardCount"===t.tag)return oh(t=>tN(om._1,tL(om._2)(e=>{let r=oc(t=>t.count);if("AtLeast"===e.condition.mode){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:ov(os(1)(n))(n)(t)},min:os(1)(n),max:n};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("JustDraw"===e.condition.mode){let n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:ov(0)(r(e.condition.cards))(t)},min:0,max:r(e.condition.cards)};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("Remains"===e.condition.mode){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:ov(os(1)(n))(n)(t)},min:os(1)(n),max:n};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("JustRemains"===e.condition.mode){let n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:ov(0)(r(e.condition.cards))(t)},min:0,max:r(e.condition.cards)};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("Choice"===e.condition.mode){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:ov(os(1)(r))(r)(t)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("LeftOne"===e.condition.mode){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:ov(os(1)(r))(r)(t)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("LeftAll"===e.condition.mode){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:ov(os(1)(r))(r)(t)},min:os(1)(r),max:r};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>tN(tA("Bind",rk("Raise",ow,void 0),t=>tN(tA("Return",t),tJ)),tJ)))}h()})))(e5(t._1));if("Receive"===t.tag){let e=t._1,r=oy(t=>({...t,cards:e}));return tN(r._1,tL(r._2)(t=>{let e=R(t=>t.id)(t.condition.cards);return tN(om._1,tL(om._2)(t=>{let r=ee(t=>ep(ij)(t.id)(e),t.cards),n=oc(t=>t.count);if("AtLeast"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tJ)}if("JustDraw"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tN(tA("Bind",rk("State",t=>ta(void 0,e)),t=>tN(tA("Return",t),tJ)),tJ)}if("Remains"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,i)),t=>tN(tA("Return",t),tJ)),tJ)}if("JustRemains"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tN(tA("Bind",rk("State",t=>ta(void 0,e)),t=>tN(tA("Return",t),tJ)),tJ)}if("Choice"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}if("LeftOne"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}if("LeftAll"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:ov(os(1)(e))(e)(t.condition.count)},min:os(1)(e),max:e};return tN(tA("Bind",rk("State",t=>ta(void 0,n)),t=>tN(tA("Return",t),tJ)),tJ)}h()}))}))}if("SelectOnFocus"===t.tag)return ob(oR(n9)((()=>{let e=e$(t._1.target,T,I);return"Just"===e.tag?n7(T,I,"HTMLInputElement",e._1):"Nothing"===e.tag?T:void h()})()));h()},handleQuery:t=>{if("GetCondition"===t.tag)return of(e=>t._1(e))(op(t=>t.condition));if("RestoreState"===t.tag){let e=oc(t=>t.count);if("AtLeast"===t._2.mode){let r=e(t._2.cards);return tN(tA("Bind",rk("State",e=>ta(void 0,{cards:t._1,condition:t._2,min:os(1)(r),max:r})),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}if("JustDraw"===t._2.mode)return tN(tA("Bind",rk("State",r=>ta(void 0,{cards:t._1,condition:t._2,min:0,max:e(t._2.cards)})),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)));if("Remains"===t._2.mode){let r=e(t._2.cards);return tN(tA("Bind",rk("State",e=>ta(void 0,{cards:t._1,condition:t._2,min:os(1)(r),max:r})),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}if("JustRemains"===t._2.mode)return tN(tA("Bind",rk("State",r=>ta(void 0,{cards:t._1,condition:t._2,min:0,max:e(t._2.cards)})),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)));if("Choice"===t._2.mode){let e=t._2.cards.length;return tN(tA("Bind",rk("State",r=>ta(void 0,{cards:t._1,condition:t._2,min:os(1)(e),max:e})),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}if("LeftOne"===t._2.mode){let e=t._2.cards.length;return tN(tA("Bind",rk("State",r=>ta(void 0,{cards:t._1,condition:t._2,min:os(1)(e),max:e})),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}if("LeftAll"===t._2.mode){let e=t._2.cards.length;return tN(tA("Bind",rk("State",r=>ta(void 0,{cards:t._1,condition:t._2,min:os(1)(e),max:e})),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}return tN(tA("Bind",rk("State",t=>{h()}),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(()=>{let e=o_(b)()(nR(R(e=>({id:e.id,value:e.name,selected:og(e)(t._2.cards)}))(t._1)));return tN(e._1,tL(e._2)(()=>tN(tA("Return",t._3),tJ)))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}h()},receive:t=>C("Just",on("Receive",t)),initialize:C("Just",oE)})},oB=((t,e,r,n)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let r of g(e))v.call(t,r)||void 0===r||f(t,r,{get:()=>e[r],enumerable:!(n=p(e,r))||n.enumerable});return t})(f(null!=(r=m())?s(_(r)):{},"default",{value:r,enumerable:!0}),r);function oC(t){return(0,oB.default)(t)}function oT(t){return t.toJSNumber()}function oI(t){return function(e){return t.add(e)}}function oM(t){return function(e){return t.multiply(e)}}function ok(t){return function(e){return t.minus(e)}}function oO(t){return function(e){return t.mod(e)}}var oq=function(t){return t.toString(10)},oP={add:oI,zero:oC(0),mul:oM,one:oC(1)},oF=(u=10,function(t){try{var e=(0,oB.default)(t,10);return I(e)}catch(t){return T}}),oD={mod:t=>e=>{let r=e.abs();return oO(oI(oO(t)(r))(r))(r)}};function oU(t){return function(){t.terminate()}}var oz=t=>e=>{var r;return r={name:e.name,credentials:"Omit"===e.credentials?"omit":"SameOrigin"===e.credentials?"same-origin":"Include"===e.credentials?"include":void h(),type:"Classic"===e.type?"classic":"Module"===e.type?"module":void h()},function(){return new Worker(t,r)}},oG={name:"",credentials:"Omit",type:"Classic"},oj=(()=>{let t=tg.foldMap1({append:t=>e=>r=>t(r)+r+e(r)});return e=>r=>n=>t(t=>{let e=r(t);return t=>e})(n)(e)})(),oH=(()=>{let t=iB(iN(iA(ot)))(iB((()=>{let t=iB(iN((()=>{let t=iB(iL)(iB(iQ)(iB(iE)(iw)({reflectSymbol:()=>"name"})())({reflectSymbol:()=>"id"})())({reflectSymbol:()=>"count"})();return{encodeJson:e=>t.gEncodeJson(e)(b)}})()))(iB(iL)(iB(iL)(iw)({reflectSymbol:()=>"others"})())({reflectSymbol:()=>"hand"})())({reflectSymbol:()=>"cards"})();return{encodeJson:e=>t.gEncodeJson(e)(b)}})())(iw)({reflectSymbol:()=>"deck"})())({reflectSymbol:()=>"conditions"})();return e=>t.gEncodeJson(e)(b)})(),oQ=t=>nO(e=>{let r=oz("bundle/worker.js")({...oG,type:"Module"});return()=>{var n,i,o;let u=r();(n=t=>e((()=>{let e=oj("\n")(e7),r=e9(Q)("String")(t.data);if("Left"===r.tag)return q("Left",nE(e(r._1)));if("Right"===r.tag){let t=nE("BigInt.fromString"),e=oF(r._1);if("Nothing"===e.tag)return q("Left",t);if("Just"===e.tag)return q("Right",e._1)}h()})()),function(t){return function(){t.onmessage=function(t){n(t)()}}})(u)(),(i=t=>{let r=oU(u);return()=>(r(),e(q("Left",nE((()=>{let e=n7(T,I,"ErrorEvent",t);return"Nothing"===e.tag?"Unknown worker error":"Just"===e.tag?e._1.message:void h()})())))())},function(t){return function(){t.onerror=function(t){i(t)()}}})(u)(),(o=oH(t),function(t){return function(e){return function(){e.postMessage(o,t.length>0?t:void 0)}}})([])(u)();let a=nk(oU(u));return t=>a}});function oZ(t){return function(e){return function(r){return t.apply(r,[e])}}}var oW=oZ(Number.prototype.toPrecision),oK=oZ(Number.prototype.toFixed),oV=oZ(Number.prototype.toExponential),o$=(t,e)=>({tag:t,_1:e}),oY=t=>e=>r=>{let n=t4.compare(t)(r),i="LT"===n?r:"EQ"===n||"GT"===n?t:void h(),o=t4.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void h()},oX=t=>"Precision"===t.tag?oW(t._1):"Fixed"===t.tag?oK(t._1):"Exponential"===t.tag?oV(t._1):void h(),o1={append:t=>t=>{}},o0=t=>t,o2=t=>e=>r=>()=>{let n=tH(I,T,t,r),i=tH(I,T,e,r);"Just"===n.tag&&"Just"===i.tag&&(tQ(t,i._1,r),tQ(e,n._1,r))},o5=t=>e=>r=>{let n=[...r];return o2(t)(e)(n)(),n},o3=t=>e=>r=>{if(t===e)return r;let n=[...r],i=tZ(t)(1)([])(n)();return tZ(e)(0)(i)(n)(),n},o4=tt(oM)(oP.one),o6=(n=64,t=>e=>em.unfoldr1(e=>ta(e._1,e._2>0?C("Just",ta(t(e._1),e._2-1|0)):T))(ta(e,64-1|0)))(t=>en(oI,[oP.zero,...t],[...t,oP.zero]))([oP.one]),o7=t=>e=>{let r=t,n=e,i=!0,o;for(;i;){let t=r,e=n;if(t<0||e<0){i=!1,o=oP.zero;continue}if(0===e){i=!1,o=oP.one;continue}if(1===e){i=!1,o=oC(t);continue}if((t-e|0)<e){r=t,n=t-e|0;continue}if(t<64){i=!1,o=o6[t][e];continue}let u=R(oC),a=o4(u(t6((t-e|0)+1|0,t))),l=o4(u(t6(1,e)));i=!1,o=(function(t){return function(e){return t.divide(e)}})(ok(a)(oD.mod(a)(l)))(l)}return o},o9=(t=>{let e={append:e=>r=>t.add(e)(r)};return to.foldMap({mempty:t.zero,Semigroup0:()=>e})})({add:function(t){return function(e){return t+e|0}},zero:0,mul:function(t){return function(e){return t*e|0}},one:1}),o8=t=>e=>{let r=ec(t=>e=>t3.compare(t.id)(e.id))(w(w(e)(o0))(t=>t.cards));return{...t,cards:r,others:t.others+o9(t=>t.count)(X(eg(t=>e=>t.id===e.id))(t.cards)(r))|0}},ut=t=>o7(o9(t=>t.count)(t.cards)+t.others|0)(t.hand),ue=(t,e,r)=>({tag:"Calculate",_1:t,_2:e,_3:r}),ur=(t=>{let e=rz(t.MonadEffect0());return{liftAff:e=>tN(tA("Bind",rk("Lift",t.liftAff(e)),t=>tN(tA("Return",t),tJ)),tJ),MonadEffect0:()=>e}})({liftAff:t=>t,MonadEffect0:()=>nV}).liftAff,un=t=>tN(tA("Bind",rk("Lift",nX.throwError(t)),t=>tN(tA("Return",t),tJ)),tJ),ui=t=>tN(tA("Bind",rk("State",e=>ta(t(e),e)),t=>tN(tA("Return",t),tJ)),tJ),uo=t=>tN(tA("Bind",rk("State",e=>ta(void 0,t(e))),t=>tN(tA("Return",t),tJ)),tJ),uu=te(tk)(ti),ua=t=>e=>r=>ue(t,e,r),ul={initialState:t=>({combination:oP.zero,total:oP.zero,calculation:T}),render:t=>{var e;return rw("Elem",T,"div",[nd("flex min-w-60 items-center")],[rw("Elem",T,"div",[nd("mx-1 flex w-36 items-center justify-end gap-1")],"Just"===t.calculation.tag?[rw("Elem",T,"div",[nd("text-2xl")],[rw("Text","Calculating")]),rw("Elem",T,"i",[nd("fa-solid fa-spinner fa-pulse")],[])]:[rw("Elem",T,"div",[nd("text-2xl")],[rw("Text",(e=t.total,function(t){return e.equals(t)})(oP.zero)?"N/A":oX(o$("Fixed",oY(0)(20)(4)))(oT(t.combination)/oT(t.total)*100)+"%")])]),rw("Elem",T,"div",[nd("mx-1 flex min-w-20 flex-col items-end divide-y divide-gray-400")],[rw("Elem",T,"div",[nd("px-1")],[rw("Text",oq(t.combination))]),rw("Elem",T,"div",[nd("px-1")],[rw("Text",oq(t.total))])])])},eval:r9({...r8,handleQuery:t=>{let e=t._3,r=o8(t._1)(t._2),n=ur(n1(oQ({deck:r,conditions:t._2})));return tN(tA("Bind",rk("Fork",tN(n._1,tL(n._2)(t=>{if("Left"===t.tag){let e=t._1;return tN(tA("Bind",rk("State",t=>ta(void 0,{combination:oP.zero,total:oP.zero,calculation:T})),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>un(e)))}if("Right"===t.tag){let e={combination:t._1,total:ut(r),calculation:T};return tN(tA("Bind",rk("State",t=>ta(void 0,e)),t=>tN(tA("Return",t),tJ)),tJ)}h()})),rO),t=>tN(tA("Return",t),tJ)),tL(tL(tJ)(t=>{let r=ui(t=>t.calculation);return tN(r._1,tL(r._2)(r=>{let n=uo(e=>({...e,calculation:C("Just",t)}));return tN(n._1,tL(n._2)(()=>{let t=uu(rG)(r);return tN(t._1,tL(t._2)(()=>tN(tA("Return",e),tJ)))}))}))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}})},ud=(t,e)=>({tag:t,_1:e}),uc=(t,e,r,n)=>({tag:t,_1:e,_2:r,_3:n}),us={reflectSymbol:()=>"line"},uf=n4()(us)(iH),up={reflectSymbol:()=>"result"},ug=n3()(up)(t5),u_=(t=>{let e=t.foldr;return t=>{let r=t7(e,t);return r.length>0?C("Just",r):T}})(eC),uv=t=>tN(tA("Bind",rk("State",e=>ta(t(e),e)),t=>tN(tA("Return",t),tJ)),tJ),um=io()(us)(iH),uh=ii()(up)(t5),uy=tF(tC).apply,ub=t=>e=>tN(e._1,tL(e._2)(e=>tN(tA("Return","Just"===e.tag?C("Just",t(e._1)):T),tJ))),uR=tP(tC),uS=(()=>{let t=tj(tC),e=t.Plus1().empty;return r=>r?t.Applicative0().pure():e})(),uJ=tU(rU),uw=(()=>{let t=ty.traverse(O);return e=>r=>t(r)(e)})(),uE=tN(tA("Bind",rk("State",t=>ta(t,t)),t=>tN(tA("Return",t),tJ)),tJ),ux=ty.traverse(tk),uL={reflectSymbol:()=>"id"},uN=rz(nV).liftEffect(iz),uA=tr(tk)(to),uB=ii()(us)(iH),uC=tD(tC).pure,uT=t=>tN(tA("Bind",rk("State",e=>ta(void 0,t(e))),t=>tN(tA("Return",t),tJ)),tJ),uI=t=>tN(tA("Bind",rk("State",e=>{let r=t(e);return ta(r,r)}),t=>tN(tA("Return",t),tJ)),tJ),uM=t=>uc("GetConditions",t),uk=t=>uc("GetState",t),uO=t=>e=>r=>uc("RestoreState",t,e,r),uq=t=>uc("ToggleDisabled",t),uP=ud("Initialize"),uF=ud("AddCondition"),uD=ud("Calculate"),uU=(()=>{let t=rw("Elem",T,"div",[nd("px-1")],[nf(rw("Elem",T,"i",[nd("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(uF)]),e=tM.apply((()=>{let t=R(t=>t.id),e=uv(t=>t.conditions);return tN(e._1,tL(tL(e._2)(e=>tN(tA("Return",t(ee(t=>t.disabled,e))),tJ)))(t=>tN(tA("Return",e=>u_(ek(iH)(e=>ef(ij)(e)(t))(e))),tJ)))})())(um(b)(oS)),r=uv(t=>t.deck),n=tN(r._1,tL(r._2)(t=>tN(e._1,tL(tL(e._2)(t=>tN(tA("Return",t7(ti.foldr,t)),tJ)))(e=>uh(b)()(ua(t)(e)))))),i=t=>{if("Initialize"===t.tag){let t=i(uF);return tN(t._1,tL(t._2)(()=>n))}if("AddCondition"===t.tag){let t=uv(t=>t.conditions);return tN(t._1,tL(t._2)(t=>tN(uN._1,tL(uN._2)(e=>uT(r=>({...r,conditions:ea(t)({id:e,disabled:!1})}))))))}if("RemoveCondition"===t.tag){let e=t._1,r=uI(t=>({...t,conditions:ee(t=>t.id!==e,t.conditions)}));return tN(r._1,tL(r._2)(t=>0===t.conditions.length?tN(tA("Bind",rk("Raise","AllConditionDeleted",void 0),t=>tN(tA("Return",t),tJ)),tJ):i(uD)))}if("ToggleItemDisabled"===t.tag){let e=t._1,r=uT(t=>{let r=t9(I,T,t=>t.id===e,t.conditions);if("Just"===r.tag){let e=ed(r._1)(t=>({...t,disabled:!t.disabled}))(t.conditions);if("Just"===e.tag)return{...t,conditions:e._1};if("Nothing"===e.tag)return t;h()}if("Nothing"===r.tag)return t;h()});return tN(r._1,tL(r._2)(()=>i(uD)))}if("Receive"===t.tag){let e=t._1,r=uv(t=>t.deck);return tN(r._1,tL(r._2)(t=>{let r=uT(t=>({...t,deck:e})),i=tN(r._1,tL(r._2)(()=>n));return tY(t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name)(e.cards)(t.cards)&&e.hand===t.hand&&e.others===t.others?tN(tA("Return",void 0),tJ):i}))}if("Calculate"===t.tag)return tN(n._1,tL(n._2)(()=>tN(tA("Bind",rk("Raise","Updated",void 0),t=>tN(tA("Return",t),tJ)),tJ)));h()};return{initialState:t=>({conditions:[],deck:t,disabled:!1}),render:e=>rw("Elem",T,"div",[nl(["grow rounded border-2 border-violet-300 p-1",e.disabled?"bg-slate-100 text-gray-400":"bg-white text-gray-700"])],[rw("Elem",T,"div",[nd("flex items-center justify-end gap-1")],[rw("Elem",T,"div",[nd(e.disabled?"mr-auto w-0 py-1 pl-3 text-xl":"hidden")],[rw("Text","Disabled")]),rw("Elem",T,"div",[nd(e.disabled?"text-gray-400":"text-black")],[ug(b)()(ul)()])]),rw("Elem",T,"ul",[nd("my-1")],R((()=>{let t=e.deck.cards;return e=>rw("Elem",T,"li",[nl(["flex gap-1 rounded px-1",e.disabled?"bg-slate-100 text-gray-400 line-through":"bg-transparent"])],[rw("Elem",T,"div",[nd("mx-1 flex")],[nf(rw("Elem",T,"i",[nd("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(ud("RemoveCondition",e.id)),nf(rw("Elem",T,"i",[nd("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(ud("ToggleItemDisabled",e.id))]),rw("Elem",T,"div",[nd("min-w-0 grow")],[uf(b)(e.id)(oA)(t)(t=>uD)])])})())(e.conditions)),t]),eval:r9({...r8,handleAction:i,handleQuery:t=>{if("GetConditions"===t.tag)return uy(ub(e=>e=>t._1(e))(uR.bind(uJ.state(t=>ta(t.disabled,t)))(t=>uS(!t))))(e);if("GetState"===t.tag)return tM.apply(tN(uE._1,tL(uE._2)(e=>tN(tA("Return",(()=>{let r=e.conditions,n=e.disabled;return e=>{let i=uw(r)(t=>{let r=eN(iH)(t.id)(e);return"Just"===r.tag?C("Just",{mode:r._1.mode,count:r._1.count,cards:R(t=>t.id)(r._1.cards),disabled:t.disabled}):T});return"Just"===i.tag?C("Just",t._1({conditions:i._1,disabled:n})):T}})()),tJ))))(um(b)(oS));if("RestoreState"===t.tag){let e=t._3,r=t._1,i=t._2.disabled,o=ux((()=>{let t=tL(uN._2)(t=>tN(tA("Return",nc(uL)()()(b)(t)),tJ));return e=>tN(uN._1,tL(t)(t=>tN(tA("Return",t(e)),tJ)))})())(t._2.conditions);return tN(o._1,tL(tL(o._2)(t=>{let o={conditions:R(t=>({id:t.id,disabled:t.disabled}))(t),deck:r,disabled:i};return tN(tA("Bind",rk("State",t=>ta(void 0,o)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>{let i=uA(t)(t=>uB(b)(t.id)(oJ(r.cards)({mode:t.mode,count:t.count,cards:ev(t=>es(e=>e.id===t)(r.cards))(t.cards)})));return tN(i._1,tL(i._2)(()=>tN(n._1,tL(n._2)(()=>tN(tA("Return",e),tJ)))))}))}))(t=>tN(tA("Return",C("Just",t)),tJ)))}if("ToggleDisabled"===t.tag){let e=t._1;return uR.bind(uJ.state(t=>ta(void 0,{...t,disabled:!t.disabled})))(()=>uC(e))}h()},receive:t=>C("Just",ud("Receive",t)),initialize:C("Just",uP)})}})(),uz={mempty:void 0,Semigroup0:()=>o1},uG=function(){return window};function uj(t){return t.dataTransfer}function uH(t){return function(){return t.document}}function uQ(t){return function(){return t.location}}var uZ=(t,e,r)=>({tag:t,_1:e,_2:r}),uW=(t,e)=>({tag:"SetDeck",_1:t,_2:e}),uK=(()=>{let t=ry("type");return e=>t(eK(e))})(),uV=ry("value"),u$=tP(tC).bind,uY=(()=>{let t=tU(rU);return e=>t.state(t=>ta(void 0,e))})(),uX=tD(tC).pure,u1=rz(nV),u0=u1.liftEffect(iz),u2=t=>tN(tA("Bind",rk("State",e=>ta(void 0,t(e))),t=>tN(tA("Return",t),tJ)),tJ),u5=t=>tN(tA("Bind",rk("State",e=>{let r=t(e);return ta(r,r)}),t=>tN(tA("Return",t),tJ)),tJ),u3=tN(tA("Bind",rk("State",t=>ta(t,t)),t=>tN(tA("Return",t),tJ)),tJ),u4=(()=>{let t=tq(uz).mempty;return e=>"Nothing"===e.tag?t:"Just"===e.tag?e._1:void h()})(),u6=t=>e=>r=>{let n=t4.compare(t)(r),i="LT"===n?r:"EQ"===n||"GT"===n?t:void h(),o=t4.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void h()},u7=t=>tN(tA("Bind",rk("State",e=>ta(t(e),e)),t=>tN(tA("Return",t),tJ)),tJ),u9=t=>e=>{let r=t4.compare(t)(e);return"LT"===r||"EQ"===r?t:"GT"===r?e:void h()},u8=te(W)(ti),at=tY(t$),ae=t=>e=>uW(t,e),ar=uZ("AddCard"),an=t=>uZ("UpdateDeck",t),ai=t=>uZ("UpdateHand",t),ao=t=>uZ("UpdateOthers",t),au=t=>e=>uZ("StartReorder",t,e),aa=t=>e=>uZ("ExecuteReorder",t,e),al=(()=>{let t=eZ(" ")(["appearance-none rounded-none border-b border-transparent bg-white p-1 text-gray-700","transition-colors duration-75 hover:border-gray-500 focus:border-slate-800 focus:outline-none"]),e=eZ(" ")(["w-16 text-right",t]),r=(t,r,n,i,o)=>rw("Elem",T,"div",[nd("mx-1 flex flex-wrap justify-end border-b border-gray-500")],[rw("Elem",T,"div",[nd("m-1")],[rw("Text",t)]),rw("Elem",T,"input",[nd(e),uK(eW),uV(x(r)),nr(nw("Step",1)),ni(e2(n)),no(e2(i)),rh("Handler","focus",t=>C("Just",eV("Action",uZ("SelectOnFocus",t)))),ie("change")("value")(e8(Q))(t=>o((()=>{let e=e5(t);return"Nothing"===e.tag?0:"Just"===e.tag?e._1:void h()})()))],[])]),n={append:t=>e=>t+e|0},i=to.foldMap({mempty:0,Semigroup0:()=>n})(t=>t.count),o=t=>{var e,r;if("AddCard"===t.tag)return tN(u0._1,tL(u0._2)(t=>u2(e=>({...e,cards:ea(e.cards)({id:t,name:"",count:0})}))));if("RemoveCard"===t.tag){let e=u1.liftEffect((()=>{var e;let r=(e="カード「"+t._1.name+"」を削除します。",function(t){return function(){return t.confirm(e)}});return()=>r(uG())()})());return""===t._1.name?tN(tA("Bind",rk("Fork",(()=>{let e=u5(e=>({...e,cards:eg(t=>e=>t.id===e.id)(t._1)(e.cards),others:e.others+t._1.count|0})),r=tN(e._1,tL(e._2)(t=>tN(tA("Bind",rk("Raise",{...t,cards:ee(t=>""!==t.name,t.cards)},void 0),t=>tN(tA("Return",t),tJ)),tJ)));return tN(tA("Return",!0),tL(tJ)(t=>t?r:tN(tA("Return",void 0),tJ)))})(),rO),t=>tN(tA("Return",t),tJ)),tL(tJ)(t=>tN(tA("Return",void 0),tJ))):tN(tA("Bind",rk("Fork",(()=>{let r=u5(e=>({...e,cards:eg(t=>e=>t.id===e.id)(t._1)(e.cards),others:e.others+t._1.count|0})),n=tN(r._1,tL(r._2)(t=>tN(tA("Bind",rk("Raise",{...t,cards:ee(t=>""!==t.name,t.cards)},void 0),t=>tN(tA("Return",t),tJ)),tJ)));return tN(e._1,tL(e._2)(t=>t?n:tN(tA("Return",void 0),tJ)))})(),rO),t=>tN(tA("Return",t),tJ)),tL(tJ)(t=>tN(tA("Return",void 0),tJ)))}if("UpdateCard"===t.tag){let e=t._1;return tN(u3._1,tL(u3._2)(t=>u4((()=>{let r=t9(I,T,t=>t.id===e.id,t.cards);if("Just"===r.tag){if(r._1>=0&&r._1<t.cards.length){let n=""===e.name?{...e,count:0}:{...e,count:u6(0)(t.cards[r._1].count+t.others|0)(e.count)},i=et(I,T,r._1,n,t.cards);if("Just"===i.tag){let e=i._1;return C("Just",(()=>{let i=u5(i=>({...i,cards:e,others:t.others-(n.count-t.cards[r._1].count|0)|0}));return tN(i._1,tL(i._2)(t=>tN(tA("Bind",rk("Raise",{...t,cards:ee(t=>""!==t.name,t.cards)},void 0),t=>tN(tA("Return",t),tJ)),tJ)))})())}if("Nothing"===i.tag)return T;h()}return T}if("Nothing"===r.tag)return T;h()})())))}if("UpdateDeck"===t.tag){let e=t._1,r=u7(t=>t.cards);return tN(r._1,tL(r._2)(t=>o(uZ("UpdateOthers",e-i(t)|0))))}if("UpdateHand"===t.tag){let e=t._1,r=u5(t=>({...t,hand:u6(1)(i(t.cards)+t.others|0)(e)}));return tN(r._1,tL(r._2)(t=>tN(tA("Bind",rk("Raise",{...t,cards:ee(t=>""!==t.name,t.cards)},void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("UpdateOthers"===t.tag){let e=t._1,r=u5(t=>{let r=i(t.cards),n=u6(r)(255)(r+e|0);return{...t,others:n-r|0,hand:u9(t.hand)(n)}});return tN(r._1,tL(r._2)(t=>tN(tA("Bind",rk("Raise",{...t,cards:ee(t=>""!==t.name,t.cards)},void 0),t=>tN(tA("Return",t),tJ)),tJ)))}if("SelectOnFocus"===t.tag)return u1.liftEffect(u8(n9)((()=>{let e=e$(t._1.target,T,I);return"Just"===e.tag?n7(T,I,"HTMLInputElement",e._1):"Nothing"===e.tag?T:void h()})()));if("StartReorder"===t.tag){let r=t._1,n=uj(t._2),i=u1.liftEffect((e="tcg-calculator/card",function(t){return function(r){return function(){return r.setData(e,t)}}})(r)(n));return tN(i._1,tL(i._2)(()=>tN(tA("Bind",rk("GetRef",r,rO),t=>tN(tA("Return",t),tJ)),tL(tJ)(t=>u1.liftEffect(u8(t=>{var e;return(e=5,function(e){return function(){return n.setDragImage(t,5,e)}})(15)})(t))))))}if("HandleDragBehavior"===t.tag){let e=u1.liftEffect(n6(t._1));return at(uj(t._1).types)(["tcg-calculator/card"])?e:tN(tA("Return",void 0),tJ)}if("ExecuteReorder"===t.tag){let e=t._1,n=t._2,i=u1.liftEffect((r="tcg-calculator/card",function(t){return function(){return t.getData(r)}})(uj(n)));return tN(i._1,tL(i._2)(t=>{let r=""===t,i=u1.liftEffect(n6(n)),o=tN(i._1,tL(i._2)(()=>{let r=u5(r=>{if(ik(t)){let n=t9(I,T,e=>e.id===t,r.cards);if("Just"===n.tag){let t=t9(I,T,t=>t.id===e,r.cards);if("Just"===t.tag)return{...r,cards:o3(n._1)(t._1)(r.cards)};if("Nothing"===t.tag)return{...r,cards:[]};h()}if("Nothing"===n.tag)return{...r,cards:[]};h()}return{...r,cards:[]}});return tN(r._1,tL(r._2)(t=>tN(tA("Bind",rk("Raise",{...t,cards:ee(t=>""!==t.name,t.cards)},void 0),t=>tN(tA("Return",t),tJ)),tJ)))}));return r?r?tN(tA("Return",void 0),tJ):void h():o}))}h()};return{initialState:t=>({cards:[],others:40,hand:5}),render:n=>{let o=n.others,u=i(n.cards);return rw("Elem",T,"div",[nd("rounded border-2 border-amber-500 p-1")],[(()=>{let t=u+o|0;return rw("Elem",T,"div",[nd("flex gap-1")],[rw("Elem",T,"div",[nd("mx-1 flex grow flex-wrap text-sky-900")],[ns("fa-layer-group")(["m-1 text-2xl"]),rw("Elem",T,"div",[nd("m-1")],[rw("Text","デッキ情報")])]),r("手札枚数:",n.hand,1,t,ai),r("デッキ枚数:",t,u,255,an)])})(),rw("Elem",T,"ul",[nd("m-1"),rh("Handler","dragenter",t=>C("Just",eV("Action",uZ("HandleDragBehavior",t)))),rh("Handler","dragover",t=>C("Just",eV("Action",uZ("HandleDragBehavior",t))))],R(r=>rw("Elem",T,"li",[nd("flex"),(()=>{let t=r.id;return rh("Ref",e=>C("Just",eV("RefUpdate",t,"Created"===e.tag?C("Just",e._1):"Removed"===e.tag?T:void h())))})(),(()=>{let t=aa(r.id);return rh("Handler","drop",e=>C("Just",eV("Action",t(e))))})()],[rw("Elem",T,"div",[nd("mx-1 flex items-center")],[rw("Elem",T,"div",[nd("hidden cursor-grab px-1 text-gray-500 active:cursor-grabbing md:block"),na(!0),(()=>{let t=au(r.id);return rh("Handler","dragstart",e=>C("Just",eV("Action",t(e))))})()],[rw("Elem",T,"i",[nd("fa-solid fa-grip-vertical")],[])]),nf(rw("Elem",T,"i",[nd("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(uZ("RemoveCard",r))]),rw("Elem",T,"div",[nd("flex grow border-b border-gray-500")],[rw("Elem",T,"input",[nl(["grow",t]),uK("InputText"),uV(r.name),ie("change")("value")(e8(Q))(t=>uZ("UpdateCard",{...r,name:t}))],[]),rw("Elem",T,"input",[nd(e),uK(eW),nr(nw("Step",1)),uV(x(r.count)),ni(0),no(""===r.name?0:e2(r.count+o|0)),rh("Handler","focus",t=>C("Just",eV("Action",uZ("SelectOnFocus",t)))),ie("change")("value")(e8(Q))(t=>uZ("UpdateCard",(()=>{let e=e5(t);return{...r,count:"Nothing"===e.tag?0:"Just"===e.tag?e._1:void h()}})()))],[])])]))(n.cards)),rw("Elem",T,"div",[nd("flex gap-1")],[rw("Elem",T,"div",[nd("mx-1 grow")],[nf(rw("Elem",T,"i",[nd("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(ar)]),r("その他のカード:",o,0,255-u|0,ao)])])},eval:r9({...r8,handleAction:o,handleQuery:t=>{let e=t._2;return u$(uY(t._1))(()=>uX(e))}})}})(),ad=t=>{let e=function(t,e,r){try{return e(JSON.parse(r))}catch(e){return t(e.message)}}(P,F,t);return"Left"===e.tag?q("Left",id("TypeMismatch","JSON")):"Right"===e.tag?q("Right",e._1):void h()};function ac(t){return function(e){return t===e}}var as=te(W)(to),af=t=>t,ap=()=>{let t=[];return{emitter:e=>()=>(t=[...t,e],()=>{let r=t;t=eg(ac)(e)(r)}),listener:e=>{let r=as(t=>t(e));return()=>r(t)()}}},ag=t=>(function(t,e,r){try{return e(decodeURIComponent(r))}catch(e){return t(e)}})(t=>T,I,t),a_=t=>()=>{var e;return(e=uQ(uG())(),function(){e.hash=t})()},av=()=>{var t;let e=(t=uQ(uG())(),function(){return t.hash})(),r=e3("#")(e);return"Nothing"===r.tag?"":"Just"===r.tag?r._1:void h()},am=t=>e=>()=>{let r=e(av())(),n=uG(),i=rg(e=>()=>{let e=r,n=av();return r=t(e)(n)()})();return r_("hashchange")(i)(!1)(n)(),rv("hashchange")(i)(!1)(n)},ah=t=>e=>r=>{let n=n=>{let i=tn(t)(0);return t=>{let o=i(e(t));if("Nothing"===o.tag)return()=>n;if("Just"===o.tag){let t=o._1,e=r(n)(t);return()=>(e(),C("Just",t))}h()}};return am(t=>n(t))(n(T))},ay=(t,e,r)=>({tag:t,_1:e,_2:r}),ab={reflectSymbol:()=>"result"},aR={reflectSymbol:()=>"deck"},aS={reflectSymbol:()=>"condition"},aJ=n4()(aS)(iH),aw=rz(nV),aE=tN(tA("Bind",rk("State",t=>ta(t,t)),t=>tN(tA("Return",t),tJ)),tJ),ax=aw.liftEffect(iz),aL=t=>tN(tA("Bind",rk("State",e=>ta(void 0,t(e))),t=>tN(tA("Return",t),tJ)),tJ),aN=ii()(aR)(t5),aA=t=>tN(tA("Bind",rk("State",e=>ta(t(e),e)),t=>tN(tA("Return",t),tJ)),tJ),aB={reflectSymbol:()=>"others"},aC={reflectSymbol:()=>"hand"},aT={reflectSymbol:()=>"cards"},aI={reflectSymbol:()=>"name"},aM={reflectSymbol:()=>"id"},ak={reflectSymbol:()=>"count"},aO=ii()(aS)(iH),aq=io()(aS)(iH),aP=ii()(ab)(t5),aF=iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",il(t=>q("Left",id("TypeMismatch","Boolean")),F,t=>q("Left",id("TypeMismatch","Boolean")),t=>q("Left",id("TypeMismatch","Boolean")),t=>q("Left",id("TypeMismatch","Boolean")),t=>q("Left",id("TypeMismatch","Boolean")),t._1)):T}),aD={reflectSymbol:()=>"mode"},aU={reflectSymbol:()=>"disabled"},az={reflectSymbol:()=>"conditions"},aG=iS(iJ((()=>{let t=ib(iS(iJ((()=>{let t=ib(iS(iJ((()=>{let t=ib(iW.decodeJson);return{decodeJsonField:e=>"Just"===e.tag?C("Just",t(e._1)):T}})())(iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",iy(t._1)):T})(aF(iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",or.decodeJson(t._1)):T})(iR)(aD)()())(aU)()())(ak)()())(aT)()())().decodeJson);return{decodeJsonField:e=>"Just"===e.tag?C("Just",t(e._1)):T}})())(aF(iR)(aU)()())(az)()())().decodeJson);return{decodeJsonField:e=>"Just"===e.tag?C("Just",t(e._1)):T}})())(iJ((()=>{let t=iS(iJ((()=>{let t=ib(iS(iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",iy(t._1)):T})(iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",iW.decodeJson(t._1)):T})(iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",il(t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),F,t=>q("Left",id("TypeMismatch","String")),t=>q("Left",id("TypeMismatch","String")),t._1)):T})(iR)(aI)()())(aM)()())(ak)()())().decodeJson);return{decodeJsonField:e=>"Just"===e.tag?C("Just",t(e._1)):T}})())(iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",iy(t._1)):T})(iJ({decodeJsonField:t=>"Just"===t.tag?C("Just",iy(t._1)):T})(iR)(aB)()())(aC)()())(aT)()())();return{decodeJsonField:e=>"Just"===e.tag?C("Just",t.decodeJson(e._1)):T}})())(iR)(aR)()())(az)()())().decodeJson,aj=ty.traverse(tk),aH=tr(tk)(to),aQ=(()=>{let t=iB(iN((()=>{let t=iB(iN((()=>{let t=iB(iN(iQ))(iB(iL)(iB(ix)(iB(i8)(iw)(aD)())(aU)())(ak)())(aT)();return{encodeJson:e=>t.gEncodeJson(e)(b)}})()))(iB(ix)(iw)(aU)())(az)();return{encodeJson:e=>t.gEncodeJson(e)(b)}})()))(iB((()=>{let t=iB(iN((()=>{let t=iB(iL)(iB(iQ)(iB(iE)(iw)(aI)())(aM)())(ak)();return{encodeJson:e=>t.gEncodeJson(e)(b)}})()))(iB(iL)(iB(iL)(iw)(aB)())(aC)())(aT)();return{encodeJson:e=>t.gEncodeJson(e)(b)}})())(iw)(aR)())(az)();return e=>t.gEncodeJson(e)(b)})(),aZ=ay("Initialize"),aW=ay("PrepareDefaultState"),aK=t=>ay("UpdateDeck",t),aV=ay("AddCondition"),a$=t=>e=>ay("ReceiveConditionUpdated",t,e),aY=ay("Calculate"),aX=ay("SaveState"),a1=(()=>{let t=rw("Elem",T,"div",[nd("flex grow basis-0 items-center rounded border-2 border-cyan-400 p-1")],[rw("Elem",T,"div",[nd("flex w-full justify-end gap-1")],[rw("Elem",T,"div",[],[nf(rw("Text","Save"))("border border-rose-500 hover:bg-rose-100")(aX)]),n3()(ab)(t5)(b)()(ul)()])]),e=rw("Elem",T,"div",[nd("grow")],[n4()(aR)(t5)(b)()(al)()(aK)]),r=rw("Elem",T,"div",[],[nf(rw("Elem",T,"i",[nd("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(aV)]),n=t=>{if("Initialize"===t.tag){let t=aw.liftEffect(ap);return tN(t._1,tL(t._2)(t=>{let e=t.emitter;return tN(tA("Bind",rk("Subscribe",t=>e,rO),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>{let e=aw.liftEffect(ah(ti)(ag)(e=>e=>t.listener(""===e?aW:ay("RestoreState",e))));return tN(e._1,tL(tL(e._2)(t=>tN(tA("Return",void 0),tJ)))(()=>aw.liftEffect(()=>{let t=uG(),e=rg(e=>{let r=n7(T,I,"PageTransitionEvent",e);if("Just"===r.tag){if(r._1.persisted){let e=uQ(t);return()=>{var t;return(t=e(),function(){t.reload()})()}}return()=>{}}if("Nothing"===r.tag)return()=>{};h()})();return r_("pageshow")(e)(!1)(t)()})))}))}))}if("PrepareDefaultState"===t.tag)return tN(aE._1,tL(aE._2)(t=>{let e=tN(ax._1,tL(ax._2)(t=>{let e={cards:[{id:t,name:"Card1",count:3}],others:37,hand:5},r=aL(t=>({...t,deck:e}));return tN(r._1,tL(r._2)(()=>{let t=aN(b)()(ae(e));return tN(t._1,tL(t._2)(()=>n(aV)))}))}));return 0===t.deck.cards.length&&0===t.conditions.length?e:tN(tA("Return",void 0),tJ)}));if("UpdateDeck"===t.tag){let e=t._1,r=aA(t=>t.deck);return tN(r._1,tL(r._2)(t=>{let r=aL(t=>({...t,deck:e})),i=tN(r._1,tL(r._2)(()=>n(aY)));return tY(t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name)(e.cards)(t.cards)&&e.hand===t.hand&&e.others===t.others?tN(tA("Return",void 0),tJ):i}))}if("AddCondition"===t.tag)return tN(ax._1,tL(ax._2)(t=>{let e=aL(e=>({...e,conditions:ea(e.conditions)(t)}));return tN(e._1,tL(e._2)(()=>n(aY)))}));if("RemoveCondition"===t.tag){let e=t._1,r=aL(t=>({...t,conditions:ee(t=>t!==e,t.conditions)}));return tN(r._1,tL(r._2)(()=>n(aY)))}if("ToggleDisabled"===t.tag){let e=aO(b)(t._1)(uq);return tN(e._1,tL(e._2)(()=>n(aY)))}if("Swap"===t.tag){let e=t._1,r=t._2;return aL(t=>({...t,conditions:o5(e)(r)(t.conditions)}))}if("ReceiveConditionUpdated"===t.tag){if("Updated"===t._2)return n(aY);if("AllConditionDeleted"===t._2)return n(ay("RemoveCondition",t._1));h()}if("Calculate"===t.tag){let t=aA(t=>t.deck);return tN(t._1,tL(t._2)(t=>{let e=aq(b)(uM);return tN(e._1,tL(e._2)(e=>aP(b)()(ua(t)(t7(eC.foldr,e)))))}))}if("RestoreState"===t.tag){let r=ad(t._1),i="Left"===r.tag?q("Left",r._1):"Right"===r.tag?aG(r._1):void h();if("Left"===i.tag){var e;let t=aw.liftEffect((e=i_(i._1),function(){console.error(e)}));return tN(t._1,tL(t._2)(()=>n(aW)))}if("Right"===i.tag){let t=i._1.deck,e=aj((()=>{let t=tL(ax._2)(t=>tN(tA("Return",e=>({id:t,condition:e})),tJ));return e=>tN(ax._1,tL(t)(t=>tN(tA("Return",t(e)),tJ)))})())(i._1.conditions);return tN(e._1,tL(e._2)(e=>{let r={deck:t,conditions:R(t=>t.id)(e)};return tN(tA("Bind",rk("State",t=>ta(void 0,r)),t=>tN(tA("Return",t),tJ)),tL(tJ)(()=>{let r=aN(b)()(ae(t));return tN(r._1,tL(r._2)(()=>{let r=aH(e)(e=>aO(b)(e.id)(uO(t)(e.condition)));return tN(r._1,tL(r._2)(()=>n(aY)))}))}))}))}h()}if("SaveState"===t.tag)return tN(aE._1,tL(aE._2)(t=>{let e=t.deck,r=t.conditions,n=aq(b)(uk);return tN(n._1,tL(n._2)(t=>aw.liftEffect(a_(ia(aQ({deck:e,conditions:ev(e=>eN(iH)(e)(t))(r)}))))))}));h()};return{initialState:t=>({deck:{cards:[],others:0,hand:0},conditions:[]}),render:n=>{let i=n.deck;return rw("Elem",T,"div",[nd("relative overflow-x-clip")],[rw("Elem",T,"header",[nd("flex items-baseline px-2")],[rw("Elem",T,"h1",[nd("p-1 text-lg")],[rw("Elem",T,"a",[nu(".")],[rw("Text","Draw Calculator")])]),rw("Text","-"),rw("Elem",T,"h2",[nd("p-1")],[rw("Text","TCG 用ドロー確率計算機")])]),rw("Elem",T,"main",[nd("relative mb-[80vh] flex max-w-4xl flex-col gap-3 p-1")],[rw("Elem",T,"div",[nd("flex flex-wrap gap-1")],[e,t]),rw("Elem",T,"ul",[nd("flex flex-col gap-1")],tK(t=>e=>rw("Elem",T,"li",[nd("flex items-start gap-1")],[rw("Elem",T,"div",[nd("flex flex-col")],[nf(rw("Elem",T,"i",[nd("fa-solid fa-angle-up")],[]))("text-gray-500 hover:bg-gray-200")(ay("Swap",t-1|0,t)),nf(rw("Elem",T,"i",[nd("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(ay("RemoveCondition",e)),nf(rw("Elem",T,"i",[nd("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(ay("ToggleDisabled",e)),nf(rw("Elem",T,"i",[nd("fa-solid fa-angle-down")],[]))("text-gray-500 hover:bg-gray-200")(ay("Swap",t,t+1|0))]),aJ(b)(e)(uU)(i)(a$(e))]))(n.conditions)),r]),rw("Elem",T,"footer",[nd("flex items-baseline px-2")],[rw("Elem",T,"a",[nd("m-1 rounded border border-sky-500 px-2 py-1 text-sm"),nu("https://github.com/acple/tcg-calculator"),nn("_blank"),ne("noopener noreferrer")],[rw("Text","→ 使い方とかソース")])])])},eval:r9({...r8,handleAction:n,initialize:C("Just",aZ)})}})(),a0=function(t){return function(e){return function(){return e[t]}}};a0("children"),a0("firstElementChild"),a0("lastElementChild"),a0("childElementCount");var a2=t=>e=>()=>e$(e.querySelector(t),T,I),a5="Loading",a3=t=>"loading"===t?C("Just",a5):"interactive"===t?C("Just","Interactive"):"complete"===t?C("Just","Complete"):T,a4=t=>()=>{let e=a3(t.readyState);return"Nothing"===e.tag?a5:"Just"===e.tag?e._1:void h()},a6=t=>nM(nk((()=>{let e=a2(t);return()=>e(uH(uG())())()})()))(t=>nC((()=>{if("Just"===t.tag){var e,r;return e=t._1,0===(r=Object.prototype.toString.call(e)).indexOf("[object HTML")&&r.indexOf("Element]")===r.length-8?I(e):T}if("Nothing"===t.tag)return T;h()})())),a7=n2(t=>"Left"===t.tag?nx(t._1):"Right"===t.tag?()=>{}:void h()),a9=nM(nO(t=>()=>{if("Loading"===a4(uH(uG())())()){let e=uG(),r=rg(e=>t(q("Right",void 0)))();r_("DOMContentLoaded")(r)(!1)(e)();let n=nk(rv("DOMContentLoaded")(r)(!1)(e));return t=>n}return t(q("Right",void 0))(),n5}))(()=>nM(a6("body"))(t=>{let e=nT(nE("Could not find body"));return"Nothing"===t.tag?e:"Just"===t.tag?nC(t._1):void h()})),a8=(t,e)=>({tag:"CoyonedaF",_1:t,_2:e}),lt=(t,e,r)=>({tag:t,_1:e,_2:r}),le=te(W)(ti),lr=te(nQ),ln=lr(tp),li=nN(nW)(nK)(tp)(nL),lo=lr(ti),lu=(t=>{let e=t.Monad0(),r=e.Bind1().Apply0().Functor0();return n=>t.tailRecM(t=>{let i=tB(t);return"Return"===i.tag?r.map($)(e.Applicative0().pure(i._1)):"Bind"===i.tag?r.map(t=>V("Loop",i._2(t)))(n(i._1)):void h()})})({tailRecM:t=>{let e=r=>nM(t(r))(t=>"Done"===t.tag?nC(t._1):"Loop"===t.tag?e(t._1):void h());return e},Monad0:()=>nG}),la=(t=>{let e=t.compare;return t=>r=>n=>{let i=ew(e,r,n),o=t(i._1);return"Nothing"===o.tag?ex(i._2,i._3):"Just"===o.tag?eJ(r,o._1,i._2,i._3):void h()}})(t3),ll=t=>e=>()=>{let r=e.value.subscriptions.value;return le(af)((()=>{let e=eN(t4)(t);return"Just"===r.tag?e(r._1):"Nothing"===r.tag?T:void h()})())()},ld=t=>e=>nM(nk(()=>t.value))(r=>"Nothing"===r.tag?e:"Just"===r.tag?nk(()=>t.value=C("Just",ts("Cons",e,r._1))):void h()),lc=t=>e=>nM(nk(()=>t.value={initializers:tf,finalizers:tf}))(()=>nM(nk(e))(e=>nM(nk(()=>t.value))(t=>{let r=t.initializers;return nM(ln(nD)(t.finalizers))(()=>nM(li(r))(()=>nC(e)))}))),ls=n2(t=>"Left"===t.tag?nx(t._1):"Right"===t.tag?()=>{}:void h()),lf=t=>e=>nM(nk(()=>e.value))(e=>{var r;return nk((r=e=>({state:e+1|0,value:t(e)}),function(t){return function(){var e=r(t.value);return t.value=e.state,e.value}})(e.fresh))}),lp=t=>e=>r=>nM(nk(()=>e.value))(n=>lg(t)(e)(n.component.eval(lt("Query",a8(t=>C("Just",t),r),t=>T)))),lg=t=>e=>r=>lu(r=>{if("State"===r.tag)return nM(nk(()=>e.value))(n=>{let i=r._1(n.state);if(ac(n.state)(i._2))return nC(i._1);let o=i._1;return nM(nk((()=>{let t={...n,state:i._2};return()=>e.value=t})()))(()=>nM(lc(n.lifecycleHandlers)(t(n.lifecycleHandlers)(e)))(()=>nC(o)))});if("Subscribe"===r.tag)return nM(lf(rq)(e))(n=>nM(nk(r._1(n)(r=>{let n=ls(l_(t)(e)(eV("Action",r)));return()=>{n()}})))(t=>nM(nk(()=>e.value))(e=>nM(nk((()=>{let r=M.map(eA(t4)(n)(t)),i=e.subscriptions;return()=>{let t=i.value;i.value=r(t)}})()))(()=>nC(r._2(n))))));if("Unsubscribe"===r.tag){let t=r._2;return nM(nk(ll(r._1)(e)))(()=>nC(t))}if("Lift"===r.tag)return r._1;if("ChildQuery"===r.tag){let n=r._1;return nM(nk(()=>e.value))(e=>{let r=n._2;return nI(n._3)(nq(n._1(nK)(e=>nM(nk(()=>e.value))(e=>lp(t)(e.selfRef)(r)))(e.children)))})}if("Raise"===r.tag){let t=r._2,n=r._1;return nM(nk(()=>e.value))(e=>{let r=e.handlerRef,i=e.pendingOuts;return nM(nk(()=>r.value))(e=>nM(ld(i)(e(n)))(()=>nC(t)))})}if("Par"===r.tag)return nq(rC(nK)(rL)((()=>{let n=lg(t)(e);return rC(rI)(t=>rx("Lift",n(t)))(r._1)})()));if("Fork"===r.tag){let n=r._1;return nM(lf(rP)(e))(i=>nM(nk(()=>e.value))(o=>{let u=o.forks;return nM(nk(()=>({value:!1})))(o=>nM(nD(nZ(nk((()=>{let t=eO(t4)(i);return()=>{let e=u.value;return u.value=t(e),o.value=!0}})()))(lg(t)(e)(n))))(t=>nM(nk((()=>{let e=eA(t4)(i)(t);return()=>{let t=o.value;if(!t){let t=u.value;u.value=e(t);return}t||h()}})()))(()=>nC(r._2(i)))))}))}if("Join"===r.tag){let t=r._2,n=r._1;return nM(nk(()=>e.value))(e=>{let r=e.forks;return nM(nk(()=>r.value))(e=>nM(lo(n$)(eN(t4)(n)(e)))(()=>nC(t)))})}if("Kill"===r.tag){let t=r._2,n=r._1;return nM(nk(()=>e.value))(e=>{let r=e.forks;return nM(nk(()=>r.value))(e=>nM(lo(nY(nE("Cancelled")))(eN(t4)(n)(e)))(()=>nC(t)))})}if("GetRef"===r.tag){let t=r._1;return nM(nk(()=>e.value))(e=>nC(r._2(eN(t3)(t)(e.refs))))}h()})(r),l_=t=>e=>r=>{if("RefUpdate"===r.tag){let t=r._2,n=r._1;return nk(()=>{let r=e.value;e.value={...r,refs:la(e=>t)(n)(r.refs)}})}if("Action"===r.tag){let n=r._1;return nM(nk(()=>e.value))(r=>lg(t)(e)(r.component.eval(lt("Action",n,void 0))))}h()},lv=t=>e=>r=>n=>()=>{let i={value:{}},o={value:C("Just",tf)},u={value:C("Just",tf)},a={value:C("Just",eR)};return i.value={component:t,state:t.initialState(e),refs:eR,children:eR,childrenIn:{value:eR},childrenOut:{value:eR},selfRef:i,handlerRef:{value:r},pendingQueries:o,pendingOuts:u,pendingHandlers:{value:T},rendering:T,fresh:{value:1},subscriptions:a,forks:{value:eR},lifecycleHandlers:n},i},lm=tr(W)(ti),lh=te(nQ)(tp),ly=te(W),lb=ly(ti),lR=ly(eC),lS=nN(nW)(nK)(tp)(nL),lJ=(t=>{let e=te(t)(eC);return t=>r=>e(t=>r(t))(t)})(W),lw=(()=>{let t=te(W)(ti);return e=>r=>t(e)(r.rendering)})(),lE=()=>({value:{initializers:tf,finalizers:tf}}),lx=t=>()=>{let e=t.value;return t.value=T,lm(e)((()=>{let t=lh(nD);return e=>ls(t(t_(e)))})())()},lL=t=>{let e=lb(lR(af)),r=t.subscriptions;return()=>{e(r.value)(),t.subscriptions.value=T;let n=t.forks.value;return lR((()=>{let t=nY(nE("finalized"));return e=>ls(t(e))})())(n)(),t.forks.value=eR}},lN=t=>e=>r=>{let n=t=>e=>r=>{let n=lg(u)(r.selfRef)(r.component.eval(lt("Initialize",void 0)));return()=>{let i=t.value;t.value={initializers:ts("Cons",nM(lS(t_(i.initializers)))(()=>nM(n)(()=>nk((()=>{let t=lx(r.pendingQueries);return()=>(t(),lx(r.pendingOuts)())})()))),e),finalizers:i.finalizers}}},i=t=>e=>r=>i=>()=>{let o=lE(),a=lv(i)(r)(e)(o)(),l=t.value;t.value={initializers:tf,finalizers:l.finalizers};let d=a.value;u(t)(d.selfRef)();let c=a.value;return n(t)(l.initializers)(c)(),a},o=e=>r=>n=>o=>a=>()=>{let l=n.value,d=a.pop(l),c=(()=>{if("Just"===d.tag){n.value=d._1._2;let t=d._1._1.value,e=nC();return t.handlerRef.value=t=>{let n=a.output(t);return"Nothing"===n.tag?e:"Just"===n.tag?r(n._1):void h()},ls(lg(u)(t.selfRef)(t.component.eval(lt("Receive",a.input,void 0))))(),d._1._1}if("Nothing"===d.tag)return i(e)((()=>{let t=nC();return e=>{let n=a.output(e);return"Nothing"===n.tag?t:"Just"===n.tag?r(n._1):void h()}})())(a.input)(a.component)();h()})(),s=o.value;(()=>{let t=a.get(s);return"Nothing"!==t.tag&&("Just"===t.tag||void h())})()&&console.warn("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur");let f=o.value;o.value=a.set(c)(f);let p=c.value;return"Nothing"===p.rendering.tag?nx(nE("Halogen internal error: child was not initialized in renderChild"))():"Just"===p.rendering.tag?t.renderChild(p.rendering._1):void h()},u=e=>r=>()=>{let n=r.value,i=n.pendingHandlers.value,l="Nothing"===i.tag||"Just"!==i.tag&&void h();l&&(n.pendingHandlers.value=C("Just",tf)),n.childrenOut.value=eR,n.childrenIn.value=n.children;let d=n.pendingHandlers,c=t.render((()=>{let t=nI(t=>{});return e=>ls(ld(d)(t(l_(u)(n.selfRef)(e))))})())(o(e)((()=>{let t=nI(t=>{});return e=>ld(n.pendingQueries)(ld(d)(t(l_(u)(n.selfRef)(eV("Action",e)))))})())(n.childrenIn)(n.childrenOut))(n.component.render(n.state))(n.rendering)(),s=n.childrenOut.value;lJ(n.childrenIn.value)(r=>()=>{let n=r.value;return lw(t.removeChild)(n)(),a(e)(n)()})();let f=n.selfRef.value;n.selfRef.value={...f,rendering:C("Just",c),children:s};let p=Y(t=>()=>{let t=d.value;d.value=C("Just",tf),lb((()=>{let t=lh(nD);return e=>ls(t(t_(e)))})())(t)();let e=d.value;return"Nothing"!==e.tag&&("Just"===e.tag?"Nil"===e._1.tag:void h())?(d.value=T,V("Done",void 0)):V("Loop",void 0)})();if(l)return p()},a=t=>e=>{let r=lL(e);return()=>{r();let n=t.value;return t.value={initializers:n.initializers,finalizers:ts("Cons",lg(u)(e.selfRef)(e.component.eval(lt("Finalize",void 0))),n.finalizers)},lJ(e.children)(e=>()=>{let r=e.value;return a(t)(r)()})()}};return nM(nk(lE))(n=>nM(nk(()=>({value:!1})))(o=>lc(n)(()=>{let l=ap(),d=i(n)(t=>nk(l.listener(t)))(r)(e)().value;return{query:(()=>{let t=d.selfRef;return e=>nM(nk(()=>o.value))(r=>r?nC(T):lp(u)(t)(e))})(),messages:l.emitter,dispose:lc(n)(()=>{if(!o.value)return o.value=!0,a(n)(d)(),lm(d.selfRef.value.rendering)(t.dispose)()})}})))},lA=function(t){return function(e){return function(){return e[t]}}};lA("baseURI"),lA("ownerDocument");var lB=lA("parentNode");lA("parentElement"),lA("childNodes"),lA("firstChild"),lA("lastChild"),lA("previousSibling");var lC=lA("nextSibling");function lT(t){return function(e){return function(){e.appendChild(t)}}}lA("nodeValue"),lA("textContent");var lI=te(W)(ti),lM=t=>t,lk=t=>e=>r=>{if("Just"===r.tag){if("Just"===e.tag){var n;let i=(n=e._1,function(e){return function(){e.insertBefore(t,n)}})(r._1);return()=>{i()}}if("Nothing"===e.tag){let e=lT(t)(r._1);return()=>{e()}}}return()=>{}},lO=t=>{let e=t.node,r=lB(e);return()=>{let t=r();return lI(t=>function(){t.removeChild(e)})(e$(t,T,I))()}},lq=t=>e=>r=>({buildWidget:t=>{let r=r4(tv)(t),n=t=>rr((0,e.value)(t)().node,T,o,t=>{if("Just"===t.tag)return ri(t._1)}),i=t=>{if("ComponentSlot"===t.tag)return n(t._1);if("ThunkSlot"===t.tag){let e=r(t._1);return rr(e._1,C("Just",e),o,t=>{if("Just"===t.tag)return ri(t._1)})}h()},o=(t,e)=>{if("Just"===t.tag){if("ComponentSlot"===e.tag){let r=e._1;return ri(t._1),n(r)}if("ThunkSlot"===e.tag){let r=e._1,n=rn(t._1,r);return rr(n._1,C("Just",n),o,t=>{if("Just"===t.tag)return ri(t._1)})}h()}return i(e)};return i},buildAttributes:rS(t),document:r}),lP=t=>e=>({render:r=>n=>i=>o=>{if("Nothing"===o.tag)return()=>{let o={value:n},u=r5(lq(r)(o)(t))(i);return lT(u._1)(e)(),{machine:u,node:u._1,renderChildRef:o}};if("Just"===o.tag){let t=o._1.machine,e=o._1.node,r=o._1.renderChildRef;return()=>{r.value=n;let o=lB(e)(),u=lC(e)(),a=rn(t,i),l=lk(a._1)(e$(u,T,I))(e$(o,T,I));return ac(e)(a._1)||l(),{machine:a,node:a._1,renderChildRef:r}}}h()},renderChild:lM,removeChild:lO,dispose:lO}),lF=t=>e=>r=>nM(nk(()=>uH(uG())()))(n=>lN(lP(n)(r))(t)(e));a7(nM(a9)(t=>lF(a1)()(t)))()})();
//# sourceMappingURL=index.d2c7a339.js.map
