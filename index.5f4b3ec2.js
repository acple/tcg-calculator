(()=>{let t,e,n,r,o,i,a;var u,l,s,d,c,f,_,g=Object.create,p=Object.defineProperty,v=Object.getOwnPropertyDescriptor,m=Object.getOwnPropertyNames,h=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,y=(t={"node_modules/big-integer/BigInteger.js"(t,e){var n=function(t){var e=d(0x20000000000000),r="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function i(t,e,n,r){return void 0===t?i[0]:void 0!==e&&(10!=+e||n)?F(t,e,n,r):Q(t)}function a(t,e){this.value=t,this.sign=e,this.isSmall=!1}function u(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function s(t){return -0x20000000000000<t&&t<0x20000000000000}function d(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function c(t){f(t);var n=t.length;if(n<4&&0>x(t,e))switch(n){case 0:return 0;case 1:return t[0];case 2:return t[0]+1e7*t[1];default:return t[0]+(t[1]+1e7*t[2])*1e7}return t}function f(t){for(var e=t.length;0===t[--e];);t.length=e+1}function _(t){for(var e=Array(t),n=-1;++n<t;)e[n]=0;return e}function g(t){return t>0?Math.floor(t):Math.ceil(t)}function p(t,e){var n,r,o=t.length,i=e.length,a=Array(o),u=0;for(r=0;r<i;r++)u=+((n=t[r]+e[r]+u)>=1e7),a[r]=n-1e7*u;for(;r<o;)u=+(1e7===(n=t[r]+u)),a[r++]=n-1e7*u;return u>0&&a.push(u),a}function v(t,e){return t.length>=e.length?p(t,e):p(e,t)}function m(t,e){var n,r,o=t.length,i=Array(o);for(r=0;r<o;r++)e=Math.floor((n=t[r]-1e7+e)/1e7),i[r]=n-1e7*e,e+=1;for(;e>0;)i[r++]=e%1e7,e=Math.floor(e/1e7);return i}function h(t,e){var n,r,o=t.length,i=e.length,a=Array(o),u=0;for(n=0;n<i;n++)(r=t[n]-u-e[n])<0?(r+=1e7,u=1):u=0,a[n]=r;for(n=i;n<o;n++){if((r=t[n]-u)<0)r+=1e7;else{a[n++]=r;break}a[n]=r}for(;n<o;n++)a[n]=t[n];return f(a),a}function C(t,e,n){var r,o,i=t.length,l=Array(i),s=-e;for(r=0;r<i;r++)s=Math.floor((o=t[r]+s)/1e7),o%=1e7,l[r]=o<0?o+1e7:o;return"number"==typeof(l=c(l))?(n&&(l=-l),new u(l)):new a(l,n)}function y(t,e){var n,r,o,i,a=t.length,u=e.length,l=_(a+u);for(o=0;o<a;++o){i=t[o];for(var s=0;s<u;++s)r=Math.floor((n=i*e[s]+l[o+s])/1e7),l[o+s]=n-1e7*r,l[o+s+1]+=r}return f(l),l}function b(t,e){var n,r,o=t.length,i=Array(o),a=0;for(r=0;r<o;r++)a=Math.floor((n=t[r]*e+a)/1e7),i[r]=n-1e7*a;for(;a>0;)i[r++]=a%1e7,a=Math.floor(a/1e7);return i}function R(t,e){for(var n=[];e-- >0;)n.push(0);return n.concat(t)}function w(t,e,n){return t<1e7?new a(b(e,t),n):new a(y(e,d(t)),n)}function S(t){var e,n,r,o,i=t.length,a=_(i+i);for(r=0;r<i;r++){n=0-(o=t[r])*o;for(var u=r;u<i;u++)n=Math.floor((e=o*t[u]*2+a[r+u]+n)/1e7),a[r+u]=e-1e7*n;a[r+i]=n}return f(a),a}function N(t,e){var n,r,o,i,a=t.length,u=_(a);for(o=0,n=a-1;n>=0;--n)r=g((i=1e7*o+t[n])/e),o=i-r*e,u[n]=0|r;return[u,0|o]}function E(t,e){var n,r,s=Q(e);if(o)return[new l(t.value/s.value),new l(t.value%s.value)];var p=t.value,v=s.value;if(0===v)throw Error("Cannot divide by zero");if(t.isSmall)return s.isSmall?[new u(g(p/v)),new u(p%v)]:[i[0],t];if(s.isSmall){if(1===v)return[t,i[0]];if(-1==v)return[t.negate(),i[0]];var m=Math.abs(v);if(m<1e7){n=c((r=N(p,m))[0]);var C=r[1];return(t.sign&&(C=-C),"number"==typeof n)?(t.sign!==s.sign&&(n=-n),[new u(n),new u(C)]):[new a(n,t.sign!==s.sign),new u(C)]}v=d(m)}var y=x(p,v);if(-1===y)return[i[0],t];if(0===y)return[i[t.sign===s.sign?1:-1],i[0]];n=(r=p.length+v.length<=200?function(t,e){var n,r,o,i,a,u,l,s=t.length,d=e.length,f=_(e.length),g=e[d-1],p=Math.ceil(1e7/(2*g)),v=b(t,p),m=b(e,p);for(v.length<=s&&v.push(0),m.push(0),g=m[d-1],r=s-d;r>=0;r--){for(n=1e7-1,v[r+d]!==g&&(n=Math.floor((1e7*v[r+d]+v[r+d-1])/g)),o=0,i=0,u=m.length,a=0;a<u;a++)o+=n*m[a],l=Math.floor(o/1e7),i+=v[r+a]-(o-1e7*l),o=l,i<0?(v[r+a]=i+1e7,i=-1):(v[r+a]=i,i=0);for(;0!==i;){for(n-=1,o=0,a=0;a<u;a++)(o+=v[r+a]-1e7+m[a])<0?(v[r+a]=o+1e7,o=0):(v[r+a]=o,o=1);i+=o}f[r]=n}return v=N(v,p)[0],[c(f),c(v)]}(p,v):function(t,e){for(var n,r,o,i,a,u=t.length,l=e.length,s=[],d=[];u;){if(d.unshift(t[--u]),f(d),0>x(d,e)){s.push(0);continue}r=d.length,o=1e7*d[r-1]+d[r-2],i=1e7*e[l-1]+e[l-2],r>l&&(o=(o+1)*1e7),n=Math.ceil(o/i);do{if(0>=x(a=b(e,n),d))break;n--}while(n)s.push(n),d=h(d,a)}return s.reverse(),[c(s),c(d)]}(p,v))[0];var R=t.sign!==s.sign,w=r[1],S=t.sign;return"number"==typeof n?(R&&(n=-n),n=new u(n)):n=new a(n,R),"number"==typeof w?(S&&(w=-w),w=new u(w)):w=new a(w,S),[n,w]}function x(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n])return t[n]>e[n]?1:-1;return 0}function J(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function L(t,e){for(var r,o,i,a=t.prev(),u=a,l=0;u.isEven();)u=u.divide(2),l++;t:for(o=0;o<e.length;o++)if(!t.lesser(e[o])&&!((i=n(e[o]).modPow(u,t)).isUnit()||i.equals(a))){for(r=l-1;0!=r&&!(i=i.square().mod(t)).isUnit();r--)if(i.equals(a))continue t;return!1}return!0}a.prototype=Object.create(i.prototype),u.prototype=Object.create(i.prototype),l.prototype=Object.create(i.prototype),a.prototype.add=function(t){var e=Q(t);if(this.sign!==e.sign)return this.subtract(e.negate());var n=this.value,r=e.value;return e.isSmall?new a(m(n,Math.abs(r)),this.sign):new a(v(n,r),this.sign)},a.prototype.plus=a.prototype.add,u.prototype.add=function(t){var e=Q(t),n=this.value;if(n<0!==e.sign)return this.subtract(e.negate());var r=e.value;if(e.isSmall){if(s(n+r))return new u(n+r);r=d(Math.abs(r))}return new a(m(r,Math.abs(n)),n<0)},u.prototype.plus=u.prototype.add,l.prototype.add=function(t){return new l(this.value+Q(t).value)},l.prototype.plus=l.prototype.add,a.prototype.subtract=function(t){var e,n,r=Q(t);if(this.sign!==r.sign)return this.add(r.negate());var o=this.value,i=r.value;return r.isSmall?C(o,Math.abs(i),this.sign):(e=this.sign,(x(o,i)>=0?n=h(o,i):(n=h(i,o),e=!e),"number"==typeof(n=c(n)))?(e&&(n=-n),new u(n)):new a(n,e))},a.prototype.minus=a.prototype.subtract,u.prototype.subtract=function(t){var e=Q(t),n=this.value;if(n<0!==e.sign)return this.add(e.negate());var r=e.value;return e.isSmall?new u(n-r):C(r,Math.abs(n),n>=0)},u.prototype.minus=u.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-Q(t).value)},l.prototype.minus=l.prototype.subtract,a.prototype.negate=function(){return new a(this.value,!this.sign)},u.prototype.negate=function(){var t=this.sign,e=new u(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},a.prototype.abs=function(){return new a(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},a.prototype.multiply=function(t){var e,n,r,o=Q(t),u=this.value,l=o.value,s=this.sign!==o.sign;if(o.isSmall){if(0===l)return i[0];if(1===l)return this;if(-1===l)return this.negate();if((r=Math.abs(l))<1e7)return new a(b(u,r),s);l=d(r)}return -.012*(e=u.length)-.012*(n=l.length)+15e-6*e*n>0?new a(function t(e,n){var r=Math.max(e.length,n.length);if(r<=30)return y(e,n);r=Math.ceil(r/2);var o=e.slice(r),i=e.slice(0,r),a=n.slice(r),u=n.slice(0,r),l=t(i,u),s=t(o,a),d=t(v(i,o),v(u,a)),c=v(v(l,R(h(h(d,l),s),r)),R(s,2*r));return f(c),c}(u,l),s):new a(y(u,l),s)},a.prototype.times=a.prototype.multiply,u.prototype._multiplyBySmall=function(t){return s(t.value*this.value)?new u(t.value*this.value):w(Math.abs(t.value),d(Math.abs(this.value)),this.sign!==t.sign)},a.prototype._multiplyBySmall=function(t){return 0===t.value?i[0]:1===t.value?this:-1===t.value?this.negate():w(Math.abs(t.value),this.value,this.sign!==t.sign)},u.prototype.multiply=function(t){return Q(t)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*Q(t).value)},l.prototype.times=l.prototype.multiply,a.prototype.square=function(){return new a(S(this.value),!1)},u.prototype.square=function(){var t=this.value*this.value;return s(t)?new u(t):new a(S(d(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},a.prototype.divmod=function(t){var e=E(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=u.prototype.divmod=a.prototype.divmod,a.prototype.divide=function(t){return E(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/Q(t).value)},u.prototype.over=u.prototype.divide=a.prototype.over=a.prototype.divide,a.prototype.mod=function(t){return E(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%Q(t).value)},u.prototype.remainder=u.prototype.mod=a.prototype.remainder=a.prototype.mod,a.prototype.pow=function(t){var e,n,r,o=Q(t),a=this.value,l=o.value;if(0===l)return i[1];if(0===a)return i[0];if(1===a)return i[1];if(-1===a)return o.isEven()?i[1]:i[-1];if(o.sign)return i[0];if(!o.isSmall)throw Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&s(e=Math.pow(a,l)))return new u(g(e));for(n=this,r=i[1];!0&l&&(r=r.times(n),--l),0!==l;)l/=2,n=n.square();return r},u.prototype.pow=a.prototype.pow,l.prototype.pow=function(t){var e=Q(t),n=this.value,r=e.value,o=BigInt(0),a=BigInt(1),u=BigInt(2);if(r===o)return i[1];if(n===o)return i[0];if(n===a)return i[1];if(n===BigInt(-1))return e.isEven()?i[1]:i[-1];if(e.isNegative())return new l(o);for(var s=this,d=i[1];(r&a)===a&&(d=d.times(s),--r),r!==o;)r/=u,s=s.square();return d},a.prototype.modPow=function(t,e){if(t=Q(t),(e=Q(e)).isZero())throw Error("Cannot take modPow with modulus 0");var n=i[1],r=this.mod(e);for(t.isNegative()&&(t=t.multiply(i[-1]),r=r.modInv(e));t.isPositive();){if(r.isZero())return i[0];t.isOdd()&&(n=n.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return n},l.prototype.modPow=u.prototype.modPow=a.prototype.modPow,a.prototype.compareAbs=function(t){var e=Q(t),n=this.value,r=e.value;return e.isSmall?1:x(n,r)},u.prototype.compareAbs=function(t){var e=Q(t),n=Math.abs(this.value),r=e.value;return e.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,n=Q(t).value;return(e=e>=0?e:-e)===(n=n>=0?n:-n)?0:e>n?1:-1},a.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=Q(t),n=this.value,r=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:x(n,r)*(this.sign?-1:1)},a.prototype.compareTo=a.prototype.compare,u.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=Q(t),n=this.value,r=e.value;return e.isSmall?n==r?0:n>r?1:-1:n<0!==e.sign?n<0?-1:1:n<0?1:-1},u.prototype.compareTo=u.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=this.value,n=Q(t).value;return e===n?0:e>n?1:-1},l.prototype.compareTo=l.prototype.compare,a.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=u.prototype.eq=u.prototype.equals=a.prototype.eq=a.prototype.equals,a.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=a.prototype.neq=a.prototype.notEquals,a.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=u.prototype.gt=u.prototype.greater=a.prototype.gt=a.prototype.greater,a.prototype.lesser=function(t){return 0>this.compare(t)},l.prototype.lt=l.prototype.lesser=u.prototype.lt=u.prototype.lesser=a.prototype.lt=a.prototype.lesser,a.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals,a.prototype.lesserOrEquals=function(t){return 0>=this.compare(t)},l.prototype.leq=l.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals,a.prototype.isEven=function(){return(1&this.value[0])==0},u.prototype.isEven=function(){return(1&this.value)==0},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},a.prototype.isOdd=function(){return(1&this.value[0])==1},u.prototype.isOdd=function(){return(1&this.value)==1},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},a.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=u.prototype.isPositive,a.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=u.prototype.isNegative,a.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},a.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},a.prototype.isDivisibleBy=function(t){var e=Q(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=u.prototype.isDivisibleBy=a.prototype.isDivisibleBy,a.prototype.isPrime=function(t){var e=J(this);if(void 0!==e)return e;var r=this.abs(),o=r.bitLength();if(o<=64)return L(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*o.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(i,2):i),u=[],l=0;l<a;l++)u.push(n(l+2));return L(r,u)},l.prototype.isPrime=u.prototype.isPrime=a.prototype.isPrime,a.prototype.isProbablePrime=function(t,e){var r=J(this);if(void 0!==r)return r;for(var o=this.abs(),i=void 0===t?5:t,a=[],u=0;u<i;u++)a.push(n.randBetween(2,o.minus(2),e));return L(o,a)},l.prototype.isProbablePrime=u.prototype.isProbablePrime=a.prototype.isProbablePrime,a.prototype.modInv=function(t){for(var e,r,o,i=n.zero,a=n.one,u=Q(t),l=this.abs();!l.isZero();)e=u.divide(l),r=i,o=u,i=a,u=l,a=r.subtract(e.multiply(a)),l=o.subtract(e.multiply(l));if(!u.isUnit())throw Error(this.toString()+" and "+t.toString()+" are not co-prime");return(-1===i.compare(0)&&(i=i.add(t)),this.isNegative())?i.negate():i},l.prototype.modInv=u.prototype.modInv=a.prototype.modInv,a.prototype.next=function(){var t=this.value;return this.sign?C(t,1,this.sign):new a(m(t,1),this.sign)},u.prototype.next=function(){var t=this.value;return t+1<0x20000000000000?new u(t+1):new a(e,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},a.prototype.prev=function(){var t=this.value;return this.sign?new a(m(t,1),!0):C(t,1,this.sign)},u.prototype.prev=function(){var t=this.value;return t-1>-0x20000000000000?new u(t-1):new a(e,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var A=[1];2*A[A.length-1]<=1e7;)A.push(2*A[A.length-1]);var B=A.length,k=A[B-1];function I(t){return 1e7>=Math.abs(t)}function T(t,e,r){e=Q(e);for(var o=t.isNegative(),i=e.isNegative(),a=o?t.not():t,u=i?e.not():e,l=0,s=0,d=null,c=null,f=[];!a.isZero()||!u.isZero();)l=(d=E(a,k))[1].toJSNumber(),o&&(l=k-1-l),s=(c=E(u,k))[1].toJSNumber(),i&&(s=k-1-s),a=d[0],u=c[0],f.push(r(l,s));for(var _=0!==r(+!!o,+!!i)?n(-1):n(0),g=f.length-1;g>=0;g-=1)_=_.multiply(k).add(n(f[g]));return _}a.prototype.shiftLeft=function(t){var e=Q(t).toJSNumber();if(!I(e))throw Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var n=this;if(n.isZero())return n;for(;e>=B;)n=n.multiply(k),e-=B-1;return n.multiply(A[e])},l.prototype.shiftLeft=u.prototype.shiftLeft=a.prototype.shiftLeft,a.prototype.shiftRight=function(t){var e,n=Q(t).toJSNumber();if(!I(n))throw Error(String(n)+" is too large for shifting.");if(n<0)return this.shiftLeft(-n);for(var r=this;n>=B;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(e=E(r,k))[1].isNegative()?e[0].prev():e[0],n-=B-1}return(e=E(r,A[n]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=u.prototype.shiftRight=a.prototype.shiftRight,a.prototype.not=function(){return this.negate().prev()},l.prototype.not=u.prototype.not=a.prototype.not,a.prototype.and=function(t){return T(this,t,function(t,e){return t&e})},l.prototype.and=u.prototype.and=a.prototype.and,a.prototype.or=function(t){return T(this,t,function(t,e){return t|e})},l.prototype.or=u.prototype.or=a.prototype.or,a.prototype.xor=function(t){return T(this,t,function(t,e){return t^e})},l.prototype.xor=u.prototype.xor=a.prototype.xor;function M(t){var e=t.value,n="number"==typeof e?0x40000000|e:"bigint"==typeof e?e|BigInt(0x40000000):e[0]+1e7*e[1]|0x40004000;return n&-n}function O(t,e){return t=Q(t),e=Q(e),t.greater(e)?t:e}function q(t,e){return t=Q(t),e=Q(e),t.lesser(e)?t:e}function P(t,e){if(t=Q(t).abs(),e=Q(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var n,r,o=i[1];t.isEven()&&e.isEven();)n=q(M(t),M(e)),t=t.divide(n),e=e.divide(n),o=o.multiply(n);for(;t.isEven();)t=t.divide(M(t));do{for(;e.isEven();)e=e.divide(M(e));t.greater(e)&&(r=e,e=t,t=r),e=e.subtract(t)}while(!e.isZero())return o.isUnit()?t:t.multiply(o)}a.prototype.bitLength=function(){var t=this;return(0>t.compareTo(n(0))&&(t=t.negate().subtract(n(1))),0===t.compareTo(n(0)))?n(0):n(function t(e,r){if(0>=r.compareTo(e)){var o=t(e,r.square(r)),i=o.p,a=o.e,u=i.multiply(r);return 0>=u.compareTo(e)?{p:u,e:2*a+1}:{p:i,e:2*a}}return{p:n(1),e:0}}(t,n(2)).e).add(n(1))},l.prototype.bitLength=u.prototype.bitLength=a.prototype.bitLength;var F=function(t,e,n,o){n=n||r,t=String(t),o||(t=t.toLowerCase(),n=n.toLowerCase());var i,a=t.length,u=Math.abs(e),l={};for(i=0;i<n.length;i++)l[n[i]]=i;for(i=0;i<a;i++){var s=t[i];if("-"!==s&&s in l&&l[s]>=u){if("1"===s&&1===u)continue;throw Error(s+" is not a valid digit in base "+e+".")}}e=Q(e);var d=[],c="-"===t[0];for(i=+!!c;i<t.length;i++){var s=t[i];if(s in l)d.push(Q(l[s]));else if("<"===s){var f=i;do i++;while(">"!==t[i]&&i<t.length)d.push(Q(t.slice(f+1,i)))}else throw Error(s+" is not a valid character")}return D(d,e,c)};function D(t,e,n){var r,o=i[0],a=i[1];for(r=t.length-1;r>=0;r--)o=o.add(t[r].times(a)),a=a.times(e);return n?o.negate():o}function z(t,e){if((e=n(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var o=!1;if(t.isNegative()&&e.isPositive()&&(o=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:o};for(var i,a=[],u=t;u.isNegative()||u.compareAbs(e)>=0;){u=(i=u.divmod(e)).quotient;var l=i.remainder;l.isNegative()&&(l=e.minus(l).abs(),u=u.next()),a.push(l.toJSNumber())}return a.push(u.toJSNumber()),{value:a.reverse(),isNegative:o}}function U(t,e,n){var o=z(t,e);return(o.isNegative?"-":"")+o.value.map(function(t){var e;return t<(e=(e=n)||r).length?e[t]:"<"+t+">"}).join("")}function G(t){if(s(+t)){var e=+t;if(e===g(e))return o?new l(BigInt(e)):new u(e);throw Error("Invalid integer: "+t)}var n="-"===t[0];n&&(t=t.slice(1));var r=t.split(/e/i);if(r.length>2)throw Error("Invalid integer: "+r.join("e"));if(2===r.length){var i=r[1];if("+"===i[0]&&(i=i.slice(1)),(i*=1)!==g(i)||!s(i))throw Error("Invalid integer: "+i+" is not a valid exponent.");var d=r[0],c=d.indexOf(".");if(c>=0&&(i-=d.length-c-1,d=d.slice(0,c)+d.slice(c+1)),i<0)throw Error("Cannot include negative exponent part for integers");d+=Array(i+1).join("0"),t=d}if(!/^([0-9][0-9]*)$/.test(t))throw Error("Invalid integer: "+t);if(o)return new l(BigInt(n?"-"+t:t));for(var _=[],p=t.length,v=p-7;p>0;)_.push(+t.slice(v,p)),(v-=7)<0&&(v=0),p-=7;return f(_),new a(_,n)}function Q(t){return"number"==typeof t?function(t){if(o)return new l(BigInt(t));if(s(t)){if(t!==g(t))throw Error(t+" is not an integer.");return new u(t)}return G(t.toString())}(t):"string"==typeof t?G(t):"bigint"==typeof t?new l(t):t}a.prototype.toArray=function(t){return z(this,t)},u.prototype.toArray=function(t){return z(this,t)},l.prototype.toArray=function(t){return z(this,t)},a.prototype.toString=function(e,n){if(e===t&&(e=10),10!==e||n)return U(this,e,n);for(var r,o=this.value,i=o.length,a=String(o[--i]);--i>=0;)r=String(o[i]),a+="0000000".slice(r.length)+r;return(this.sign?"-":"")+a},u.prototype.toString=function(e,n){return(e===t&&(e=10),10!=e||n)?U(this,e,n):String(this.value)},l.prototype.toString=u.prototype.toString,l.prototype.toJSON=a.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},a.prototype.valueOf=function(){return parseInt(this.toString(),10)},a.prototype.toJSNumber=a.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var j=0;j<1e3;j++)i[j]=Q(j),j>0&&(i[-j]=Q(-j));return i.one=i[1],i.zero=i[0],i.minusOne=i[-1],i.max=O,i.min=q,i.gcd=P,i.lcm=function(t,e){return t=Q(t).abs(),e=Q(e).abs(),t.divide(P(t,e)).multiply(e)},i.isInstance=function(t){return t instanceof a||t instanceof u||t instanceof l},i.randBetween=function(t,e,n){t=Q(t);var r=n||Math.random,o=q(t,e=Q(e)),a=O(t,e).subtract(o).add(1);if(a.isSmall)return o.add(Math.floor(r()*a));for(var u=z(a,1e7).value,l=[],s=!0,d=0;d<u.length;d++){var c=s?u[d]+(d+1<u.length?u[d+1]/1e7:0):1e7,f=g(r()*c);l.push(f),f<u[d]&&(s=!1)}return o.add(i.fromArray(l,1e7,!1))},i.fromArray=function(t,e,n){return D(t.map(Q),Q(e||10),n)},i}();void 0!==e&&e.hasOwnProperty("exports")&&(e.exports=n),"function"==typeof define&&define.amd&&define(function(){return n})}},function(){return e||(0,t[m(t)[0]])((e={exports:{}}).exports,e),e.exports});function b(){throw Error("Failed pattern match")}var R=t=>e=>t,w={tag:"Proxy"},S=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}},N={map:S},E=t=>t,x=function(t){return function(e){for(var n=[],r=0,o=t.length;r<o;r++)Array.prototype.push.apply(n,e(t[r]));return n}},J=function(t){return function(e){return e[t]}},L=function(t){return function(e){return function(n){var r={};for(var o in n)({}).hasOwnProperty.call(n,o)&&(r[o]=n[o]);return r[t]=e,r}}},A=function(t){return t.toString()},B=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},k=function(t){var e=t.length;return'"'+t.replace(/[\0-\x1F\x7F"\\]/g,function(n,r){switch(n){case'"':case"\\":return"\\"+n;case"\x07":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\v":return"\\v"}var o=r+1,i=o<e&&t[o]>="0"&&t[o]<="9"?"\\&":"";return"\\"+n.charCodeAt(0).toString(10)+i})+'"'},I=(t,e)=>({tag:t,_1:e}),T={tag:"NoArguments"},M=(t,e)=>({tag:t,_1:e}),O=M("Nothing"),q=t=>M("Just",t),P={map:t=>e=>"Just"===e.tag?M("Just",t(e._1)):O},F={apply:t=>e=>"Just"===t.tag?"Just"===e.tag?M("Just",t._1(e._1)):O:"Nothing"===t.tag?O:void b(),Functor0:()=>P},D={pure:q,Apply0:()=>F},z=(t,e)=>({tag:t,_1:e}),U=t=>z("Left",t),G=t=>z("Right",t),Q={map:t=>e=>t(e)},j={apply:t=>e=>t(e),Functor0:()=>Q},H={bind:t=>e=>e(t),Apply0:()=>j},W={pure:t=>t,Apply0:()=>j},Z={Applicative0:()=>W,Bind1:()=>H},K={Applicative0:()=>Y,Bind1:()=>$},$={bind:function(t){return function(e){return function(){return e(t())()}}},Apply0:()=>V},V={apply:t=>e=>()=>{let n=t(),r=e();return Y.pure(n(r))()},Functor0:()=>X},Y={pure:function(t){return function(){return t}},Apply0:()=>V},X={map:t=>e=>()=>t(e())},tt=(t,e)=>({tag:t,_1:e}),te=t=>tt("Done",t),tn=t=>e=>{let n=t(e);return()=>{var e;let r=n();(e=()=>{let e=r;return"Loop"===e.tag?(r=t(e._1)(),!1):"Done"===e.tag||void b()},function(){for(;!e(););})();let o=r;if("Done"===o.tag)return o._1;b()}},tr=function(t){return function(e){return function(n){for(var r=e,o=n.length,i=o-1;i>=0;i--)r=t(n[i])(r);return r}}},to=function(t){return function(e){return function(n){for(var r=e,o=n.length,i=0;i<o;i++)r=t(r)(n[i]);return r}}},ti=t=>{let e=t.Apply0();return n=>r=>n.foldr(t=>{let n=r(t);return t=>e.apply(e.Functor0().map(t=>E)(n))(t)})(t.pure())},ta=t=>{let e=ti(t);return t=>{let n=e(t);return t=>e=>n(e)(t)}},tu={foldr:t=>e=>n=>"Nothing"===n.tag?e:"Just"===n.tag?t(n._1)(e):void b(),foldl:t=>e=>n=>"Nothing"===n.tag?e:"Just"===n.tag?t(e)(n._1):void b(),foldMap:t=>{let e=t.mempty;return t=>n=>"Nothing"===n.tag?e:"Just"===n.tag?t(n._1):void b()}},tl={foldr:tr,foldl:to,foldMap:t=>{let e=t.mempty;return n=>tl.foldr(e=>r=>t.Semigroup0().append(n(e))(r))(e)}},ts=(t,e)=>({tag:"NonEmpty",_1:t,_2:e}),td=(t,e)=>({tag:"Tuple",_1:t,_2:e}),tc=t=>e=>td(t,e),tf=t=>t._2,t_={map:t=>e=>td(e._1,t(e._2))},tg=t=>t._1,tp=t=>({apply:e=>n=>td(t.append(e._1)(n._1),e._2(n._2)),Functor0:()=>t_}),tv=(t,e,n)=>({tag:t,_1:e,_2:n}),tm=tv("Nil"),th=t=>e=>tv("Cons",t,e),tC={foldr:t=>e=>{let n=tC.foldl(e=>n=>t(n)(e))(e),r=t=>{let e=tm,n=t,r=!0,o;for(;r;){let t=e,i=n;if("Nil"===i.tag){r=!1,o=t;continue}if("Cons"===i.tag){e=tv("Cons",i._1,t),n=i._2;continue}b()}return o};return t=>n(r(t))},foldl:t=>e=>n=>{let r=e,o=n,i=!0,a;for(;i;){let e=r,n=o;if("Nil"===n.tag){i=!1,a=e;continue}if("Cons"===n.tag){r=t(e)(n._1),o=n._2;continue}b()}return a},foldMap:t=>{let e=t.mempty;return n=>tC.foldl(e=>{let r=t.Semigroup0().append(e);return t=>r(n(t))})(e)}},ty={append:t=>e=>tC.foldr(th)(e)(t)},tb=(t=>{let e={foldMap:e=>{let n=t.foldMap(e);return t=>r=>e.Semigroup0().append(t(r._1))(n(t)(r._2))},foldl:e=>n=>r=>t.foldl(e)(e(n)(r._1))(r._2),foldr:e=>n=>r=>e(r._1)(t.foldr(e)(n)(r._2))};return{foldMap1:e=>n=>r=>t.foldl(t=>r=>e.append(t)(n(r)))(n(r._1))(r._2),foldr1:e=>n=>{let r=e(n._1),o=t.foldr(t=>{let n=e(t);return e=>M("Just","Nothing"===e.tag?t:"Just"===e.tag?n(e._1):void b())})(O)(n._2);return"Nothing"===o.tag?n._1:"Just"===o.tag?r(o._1):void b()},foldl1:e=>n=>t.foldl(e)(n._1)(n._2),Foldable0:()=>e}})(tC),tR=function(t){return t},tw=function(){function t(t){return[t]}function e(t){return function(e){return[t,e]}}function n(t){return function(e){return function(n){return[t,e,n]}}}function r(t){return function(e){return t.concat(e)}}return function(o){return function(i){return function(a){return function(u){return function(l){return function s(d,c){switch(c-d){case 0:return a([]);case 1:return i(t)(u(l[d]));case 2:return o(i(e)(u(l[d])))(u(l[d+1]));case 3:return o(o(i(n)(u(l[d])))(u(l[d+1])))(u(l[d+2]));default:var f=d+2*Math.floor((c-d)/4);return o(i(r)(s(d,f)))(s(f,c))}}(0,l.length)}}}}}}(),tS=t=>t,tN={traverse:t=>{let e=t.Apply0();return tw(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>tN.traverse(t)(tS),Functor0:()=>N,Foldable1:()=>tl},tE=(t,e)=>({tag:"CatQueue",_1:t,_2:e}),tx=t=>{let e=t,n=!0,r;for(;n;){let t=e;if("Nil"===t._1.tag){let o;if("Nil"===t._2.tag){n=!1,r=O;continue}e=tE((o=tm,t=>{let e=o,n=t,r=!0,i;for(;r;){let t=e,o=n;if("Nil"===o.tag){r=!1,i=t;continue}if("Cons"===o.tag){e=tv("Cons",o._1,t),n=o._2;continue}b()}return i})(t._2),tm);continue}if("Cons"===t._1.tag){n=!1,r=M("Just",td(t._1._1,tE(t._1._2,t._2)));continue}b()}return r},tJ=(t,e,n)=>({tag:t,_1:e,_2:n}),tL=tJ("CatNil"),tA=t=>e=>"CatNil"===t.tag?e:"CatNil"===e.tag?t:"CatCons"===t.tag?tJ("CatCons",t._1,tE(t._2._1,tv("Cons",e,t._2._2))):void b(),tB=t=>e=>n=>{let r=t=>e=>n=>{let r=t,o=e,i=n,a=!0,u;for(;a;){let t=r,e=o,n=i;if("Nil"===n.tag){a=!1,u=e;continue}if("Cons"===n.tag){r=t,o=t(e)(n._1),i=n._2;continue}b()}return u};return(o=>{let i=n,a=o,u=!0,l;for(;u;){let n=a,o=tx(i);if("Nothing"===o.tag){u=!1,l=r(t=>e=>e(t))(e)(n);continue}if("Just"===o.tag){i=o._1._2,a=tv("Cons",t(o._1._1),n);continue}b()}return l})(tm)},tk=t=>"CatNil"===t.tag?O:"CatCons"===t.tag?M("Just",td(t._1,"Nil"===t._2._1.tag&&"Nil"===t._2._2.tag?tL:tB(tA)(tL)(t._2))):void b(),tI=(t,e)=>({tag:"Free",_1:t,_2:e}),tT=(t,e,n)=>({tag:t,_1:e,_2:n}),tM=t=>{let e=t,n=!0,r;for(;n;){let t=e;if("Return"===t._1.tag){let o=tk(t._2);if("Nothing"===o.tag){n=!1,r=tT("Return",t._1._1);continue}if("Just"===o.tag){e=(()=>{let e=o._1._1(t._1._1);return tI(e._1,"CatNil"===e._2.tag?o._1._2:"CatNil"===o._1._2.tag?e._2:"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",o._1._2,e._2._2._2))):void b())})();continue}b()}if("Bind"===t._1.tag){n=!1,r=tT("Bind",t._1._1,e=>{let n=t._1._2(e);return tI(n._1,"CatNil"===n._2.tag?t._2:"CatNil"===t._2.tag?n._2:"CatCons"===n._2.tag?tJ("CatCons",n._2._1,tE(n._2._2._1,tv("Cons",t._2,n._2._2._2))):void b())});continue}b()}return r},tO={Applicative0:()=>tD,Bind1:()=>tP},tq={map:t=>e=>tP.bind(e)(e=>tD.pure(t(e)))},tP={bind:t=>e=>tI(t._1,"CatNil"===t._2.tag?tJ("CatCons",e,tE(tm,tm)):"CatCons"===t._2.tag?tJ("CatCons",t._2._1,tE(t._2._2._1,tv("Cons",tJ("CatCons",e,tE(tm,tm)),t._2._2._2))):void b()),Apply0:()=>tF},tF={apply:t=>e=>{let n=t=>tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",e=>tD.pure(t(e)),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",e=>tD.pure(t(e)),tE(tm,tm)),e._2._2._2))):void b());return tI(t._1,"CatNil"===t._2.tag?tJ("CatCons",n,tE(tm,tm)):"CatCons"===t._2.tag?tJ("CatCons",t._2._1,tE(t._2._2._1,tv("Cons",tJ("CatCons",n,tE(tm,tm)),t._2._2._2))):void b())},Functor0:()=>tq},tD={pure:t=>tI(tT("Return",t),tL),Apply0:()=>tF},tz=t=>({append:e=>n=>tF.apply(tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",e=>tI(tT("Return",t.append(e)),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",e=>tI(tT("Return",t.append(e)),tL),tE(tm,tm)),e._2._2._2))):void b()))(n)}),tU=t=>{let e=tz(t.Semigroup0());return{mempty:tI(tT("Return",t.mempty),tL),Semigroup0:()=>e}},tG=t=>({bind:e=>n=>t.Bind1().bind(e)(e=>"Nothing"===e.tag?t.Applicative0().pure(O):"Just"===e.tag?n(e._1):void b()),Apply0:()=>tQ(t)}),tQ=t=>{let e=t.Bind1().Apply0().Functor0(),n={map:t=>n=>e.map(e=>"Just"===e.tag?M("Just",t(e._1)):O)(n)};return{apply:(()=>{let e=tG(t);return n=>r=>e.bind(n)(n=>e.bind(r)(e=>tj(t).pure(n(e))))})(),Functor0:()=>n}},tj=t=>({pure:e=>t.Applicative0().pure(M("Just",e)),Apply0:()=>tQ(t)}),tH=t=>{let e=t.Monad0(),n={Applicative0:()=>tj(e),Bind1:()=>tG(e)};return{state:n=>e.Bind1().bind(t.state(n))(t=>e.Applicative0().pure(M("Just",t))),Monad0:()=>n}},tW=t=>{let e=t.Bind1(),n=e.Apply0().Functor0(),r=(()=>{let r={map:t=>e=>n.map(e=>"Just"===e.tag?M("Just",t(e._1)):O)(e)};return{alt:n=>r=>e.bind(n)(e=>"Nothing"===e.tag?r:t.Applicative0().pure(e)),Functor0:()=>r}})();return{empty:t.Applicative0().pure(O),Alt0:()=>r}},tZ=t=>{let e=tj(t),n=tW(t);return{Applicative0:()=>e,Plus1:()=>n}},tK=function(t,e,n,r){return n>=0&&n<r.length?t(r[n]):e},t$=function(t,e,n){var r=t>=0&&t<n.length;return r&&(n[t]=e),r},tV=(d=function(t,e,n,r){return r.splice.apply(r,[t,e].concat(n))},function(t){return function(e){return function(n){return function(r){return function(){return d(t,e,n,r)}}}}}),tY=(c=function(t,e){return e.push(t)},function(t){return function(e){return function(){return c(t,e)}}}),tX=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(o)(e[o]);return r}},t1={mapWithIndex:tX,Functor0:()=>N},t0=function(t){return function(e){return t===e}},t2=function(t){return function(e){return function(n){if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r])(n[r]))return!1;return!0}}},t3={eq:t=>t=>!0},t5={eq:t0},t4={eq:t0},t6=function(t){return function(e){return function(n){return function(r){return function(o){return r<o?t:r===o?e:n}}}}},t7={compare:t=>t=>"EQ",Eq0:()=>t3},t8={compare:t6("LT")("EQ")("GT"),Eq0:()=>t5},t9={compare:t6("LT")("EQ")("GT"),Eq0:()=>t4},et=function(t,e){for(var n=t>e?-1:1,r=Array(n*(e-t)+1),o=t,i=0;o!==e;)r[i++]=o,o+=n;return r[i]=o,r};Array.prototype.fill;var ee=function(){function t(t,e){this.head=t,this.tail=e}var e={};function n(e){return function(n){return new t(e,n)}}return function(t,r){return function(t){for(var n=[],r=0,o=t;o!==e;)n[r++]=o.head,o=o.tail;return n}(t(n)(e)(r))}}(),en=function(t,e,n,r){for(var o=0,i=r.length;o<i;o++)if(n(r[o]))return t(o);return e},er=function(t,e,n,r){if(n<0||n>=r.length)return e;var o=r.slice();return o.splice(n,1),t(o)},eo=function(t,e,n,r,o){if(n<0||n>=o.length)return e;var i=o.slice();return i[n]=r,t(i)},ei=function(t,e){return e.filter(t)},ea=function(t,e,n){var r;return n.length<2?n:(!function t(e,n,r,o,i,a){var u,l,s,d,c,f;for((u=i+(a-i>>1))-i>1&&t(e,n,o,r,i,u),a-u>1&&t(e,n,o,r,u,a),l=i,s=u,d=i;l<u&&s<a;)c=o[l],f=o[s],n(e(c)(f))>0?(r[d++]=f,++s):(r[d++]=c,++l);for(;l<u;)r[d++]=o[l++];for(;s<a;)r[d++]=o[s++]}(t,e,r=n.slice(0),n.slice(0),0,n.length),r)},eu=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,o=Array(r),i=0;i<r;i++)o[i]=t(e[i])(n[i]);return o},el=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0},es=t=>e=>ea(t,t=>"GT"===t?1:"EQ"===t?0:"LT"===t?-1:void b(),e),ed=t=>e=>es(n=>r=>t.compare(e(n))(e(r))),ec=t=>e=>(()=>{let n=tY(e);return()=>{let e=[...t];return n(e)(),e}})()(),ef=t=>e=>n=>t>=0&&t<n.length?eo(q,O,t,e(n[t]),n):O,e_=t=>e=>{let n=es(e=>n=>t(e._2)(n._2))(tX(tc)(e));return 0<n.length?S(tf)(ed(t9)(tg)((()=>{let e=[n[0]];for(let r of n){let n=t((()=>{let t=e.length-1|0;if(t>=0&&t<e.length)return e[t]._2;b()})())(r._2);("LT"===n||"GT"===n||"EQ"!==n)&&e.push(r)}return e})())):[]},eg=t=>e=>en(q,O,t,e),ep=t=>e=>{let n=en(q,O,t,e);return"Just"===n.tag?M("Just",e[n._1]):O},ev=t=>e=>n=>ei(e=>{let r=en(q,O,t(e),n);return"Nothing"!==r.tag&&("Just"===r.tag||void b())},e),em=t=>e=>n=>{let r=en(q,O,n=>t.eq(n)(e),n);return"Nothing"===r.tag||"Just"!==r.tag&&void b()},eh=t=>e=>n=>{let r=en(q,O,n=>t.eq(n)(e),n);return"Nothing"!==r.tag&&("Just"===r.tag||void b())},eC=t=>e=>n=>{if(0===n.length)return[];let r=en(q,O,t(e),n);if("Nothing"===r.tag)return n;if("Just"===r.tag){let t=er(q,O,r._1,n);if("Just"===t.tag)return t._1}b()},ey=t=>e=>x(e)(t),eb=t=>ey(e=>{let n=t(e);return"Nothing"===n.tag?[]:"Just"===n.tag?[n._1]:void b()}),eR={unfoldr1:(f=t=>"Nothing"===t.tag||"Just"!==t.tag&&void b(),function(t){return function(e){return function(n){return function(r){return function(o){for(var i=[],a=o;;){var u=r(a);i.push(e(u));var l=n(u);if(f(l))return i;a=t(l)}}}}}})(t=>{if("Just"===t.tag)return t._1;b()})(tg)(tf)},ew=(t,e,n,r,o,i,a)=>({tag:t,_1:e,_2:n,_3:r,_4:o,_5:i,_6:a}),eS=(t,e,n)=>({tag:"Split",_1:t,_2:e,_3:n}),eN=(t,e,n)=>({tag:"SplitLast",_1:t,_2:e,_3:n}),eE=t=>t,ex=ew("Leaf"),eJ=(t,e,n,r)=>{if("Leaf"===n.tag){if("Leaf"===r.tag)return ew("Node",1,1,t,e,n,r);if("Node"===r.tag)return ew("Node",1+r._1|0,1+r._2|0,t,e,n,r);b()}if("Node"===n.tag){if("Leaf"===r.tag)return ew("Node",1+n._1|0,1+n._2|0,t,e,n,r);if("Node"===r.tag)return ew("Node",n._1>r._1?1+n._1|0:1+r._1|0,(1+n._2|0)+r._2|0,t,e,n,r)}b()},eL=(t,e,n,r)=>{if("Leaf"===n.tag)return"Leaf"===r.tag?ew("Node",1,1,t,e,ex,ex):"Node"===r.tag&&r._1>1?"Node"===r._5.tag&&("Leaf"===r._6.tag?r._5._1>0:"Node"===r._6.tag?r._5._1>r._6._1:void b())?eJ(r._5._3,r._5._4,eJ(t,e,n,r._5._5),eJ(r._3,r._4,r._5._6,r._6)):eJ(r._3,r._4,eJ(t,e,n,r._5),r._6):eJ(t,e,n,r);if("Node"===n.tag){if("Node"===r.tag)return r._1>(n._1+1|0)?"Node"===r._5.tag&&("Leaf"===r._6.tag?r._5._1>0:"Node"===r._6.tag?r._5._1>r._6._1:void b())?eJ(r._5._3,r._5._4,eJ(t,e,n,r._5._5),eJ(r._3,r._4,r._5._6,r._6)):eJ(r._3,r._4,eJ(t,e,n,r._5),r._6):n._1>(r._1+1|0)?"Node"===n._6.tag&&("Leaf"===n._5.tag?0<=n._6._1:"Node"===n._5.tag?n._5._1<=n._6._1:void b())?eJ(n._6._3,n._6._4,eJ(n._3,n._4,n._5,n._6._5),eJ(t,e,n._6._6,r)):eJ(n._3,n._4,n._5,eJ(t,e,n._6,r)):eJ(t,e,n,r);return"Leaf"===r.tag&&n._1>1?"Node"===n._6.tag&&("Leaf"===n._5.tag?0<=n._6._1:"Node"===n._5.tag?n._5._1<=n._6._1:void b())?eJ(n._6._3,n._6._4,eJ(n._3,n._4,n._5,n._6._5),eJ(t,e,n._6._6,r)):eJ(n._3,n._4,n._5,eJ(t,e,n._6,r)):eJ(t,e,n,r)}b()},eA=(t,e,n)=>{if("Leaf"===n.tag)return eS(O,ex,ex);if("Node"===n.tag){let r=t(e)(n._3);if("LT"===r){let r=eA(t,e,n._5);return eS(r._1,r._2,eL(n._3,n._4,r._3,n._6))}if("GT"===r){let r=eA(t,e,n._6);return eS(r._1,eL(n._3,n._4,n._5,r._2),r._3)}if("EQ"===r)return eS(M("Just",n._4),n._5,n._6)}b()},eB=(t,e,n,r)=>{if("Leaf"===r.tag)return eN(t,e,n);if("Node"===r.tag){let o=eB(r._3,r._4,r._5,r._6);return eN(o._1,o._2,eL(t,e,n,o._3))}b()},ek=(t,e)=>{if("Leaf"===t.tag)return e;if("Node"===t.tag){let n=eB(t._3,t._4,t._5,t._6);return eL(n._1,n._2,n._3,e)}b()},eI=(t,e,n,r)=>{if("Leaf"===n.tag)return r;if("Leaf"===r.tag)return n;if("Node"===r.tag){let o=eA(t,r._3,n),i=eI(t,e,o._2,r._5),a=eI(t,e,o._3,r._6);if("Just"===o._1.tag)return eL(r._3,e(o._1._1)(r._4),i,a);if("Nothing"===o._1.tag)return eL(r._3,r._4,i,a)}b()},eT=t=>e=>n=>{let r=o=>{if("Leaf"===o.tag)return ew("Node",1,1,e,n,ex,ex);if("Node"===o.tag){let i=t.compare(e)(o._3);if("LT"===i)return eL(o._3,o._4,r(o._5),o._6);if("GT"===i)return eL(o._3,o._4,o._5,r(o._6));if("EQ"===i)return ew("Node",o._1,o._2,e,n,o._5,o._6)}b()};return r},eM={map:t=>{let e=n=>"Leaf"===n.tag?ex:"Node"===n.tag?ew("Node",n._1,n._2,n._3,t(n._4),e(n._5),e(n._6)):void b();return e}},eO={foldr:t=>e=>{let n=(e,r)=>"Leaf"===e.tag?r:"Node"===e.tag?n(e._5,t(e._4)(n(e._6,r))):void b();return t=>n(t,e)},foldl:t=>e=>{let n=(e,r)=>"Leaf"===r.tag?e:"Node"===r.tag?n(t(n(e,r._5))(r._4),r._6):void b();return t=>n(e,t)},foldMap:t=>{let e=t.mempty,n=t.Semigroup0();return t=>{let r=o=>"Leaf"===o.tag?e:"Node"===o.tag?n.append(r(o._5))(n.append(t(o._4))(r(o._6))):void b();return r}}},eq={traverse:t=>{let e=t.Apply0();return n=>{let r=o=>{if("Leaf"===o.tag)return t.pure(ex);if("Node"===o.tag){let t=o._1,i=o._3,a=o._2;return e.apply(e.apply(e.Functor0().map(e=>n=>r=>ew("Node",t,a,i,n,e,r))(r(o._5)))(n(o._4)))(r(o._6))}b()};return r}},sequence:t=>eq.traverse(t)(eE),Functor0:()=>eM,Foldable1:()=>eO},eP=t=>e=>n=>r=>o=>i=>{let a=(()=>{if("Just"===r.tag){let e=r._1;return n=>"LT"===t.compare(n)(e)}if("Nothing"===r.tag)return t=>!1;b()})(),u=(()=>{if("Just"===o.tag){let e=o._1;return n=>"GT"===t.compare(n)(e)}if("Nothing"===o.tag)return t=>!1;b()})(),l=(()=>{if("Just"===r.tag){if("Just"===o.tag){let e=o._1,n=r._1;return r=>"GT"!==t.compare(n)(r)&&"GT"!==t.compare(r)(e)}if("Nothing"===o.tag){let e=r._1;return n=>"GT"!==t.compare(e)(n)}b()}if("Nothing"===r.tag){if("Just"===o.tag){let e=o._1;return n=>"GT"!==t.compare(n)(e)}if("Nothing"===o.tag)return t=>!0}b()})(),s=t=>"Leaf"===t.tag?n:"Node"===t.tag?e(e(a(t._3)?n:s(t._5))(l(t._3)?i(t._3)(t._4):n))(u(t._3)?n:s(t._6)):void b();return s},eF=t=>e=>eP(t)(e.Semigroup0().append)(e.mempty),eD=t=>t=>{let e=n=>"Leaf"===n.tag?ex:"Node"===n.tag?t(n._3)?eL(n._3,n._4,e(n._5),e(n._6)):ek(e(n._5),e(n._6)):void b();return e},ez=t=>e=>{let n=r=>{if("Leaf"===r.tag)return ex;if("Node"===r.tag){let o=t.compare(e)(r._3);if("LT"===o)return eL(r._3,r._4,n(r._5),r._6);if("GT"===o)return eL(r._3,r._4,r._5,n(r._6));if("EQ"===o)return ek(r._5,r._6)}b()};return n},eU=t=>{let e={alt:(()=>{let e=t.compare;return t=>n=>eI(e,R,t,n)})(),Functor0:()=>eM};return{empty:ex,Alt0:()=>e}},eG=(t,e,n)=>({tag:"OrdBox",_1:t,_2:e,_3:n}),eQ=t=>e=>n=>eG(t,e,n),ej=(()=>{let t={eq:t=>e=>t._1===e._1&&t._2._1(t._2._3)(e._2._3)};return{compare:t=>e=>{let n=t8.compare(t._1)(e._1);return"LT"===n?"LT":"GT"===n?"GT":t._2._2(t._2._3)(e._2._3)},Eq0:()=>t}})(),eH=(t=>{let e=t.compare;return t=>n=>{let r=eA(e,t,n);return"Just"===r._1.tag?M("Just",td(r._1._1,ek(r._2,r._3))):O}})(ej),eW=t=>e=>{let n=e,r=!0,o;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,o=O;continue}if("Node"===e.tag){let i=ej.compare(t)(e._3);if("LT"===i){n=e._5;continue}if("GT"===i){n=e._6;continue}if("EQ"===i){r=!1,o=M("Just",e._4);continue}}b()}return o},eZ=()=>t=>e=>{let n=eF(ej)((()=>{let t=eU(e),n=t.Alt0(),r={append:t=>e=>n.alt(t)(e)};return{mempty:t.empty,Semigroup0:()=>r}})());return e=>r=>{let o=t.reflectSymbol(e);return n(O)(O)(t=>e=>o===t._1?ew("Node",1,1,t._2._3,e,ex,ex):ex)(r)}},eK=()=>t=>e=>{let n=eQ(e.Eq0().eq)(e.compare);return e=>r=>o=>eH(td(t.reflectSymbol(e),n(r)))(o)},e$=()=>t=>e=>{let n=eQ(e.Eq0().eq)(e.compare);return e=>r=>o=>eW(td(t.reflectSymbol(e),n(r)))(o)},eV=()=>t=>e=>{let n=eQ(e.Eq0().eq)(e.compare);return e=>r=>o=>i=>eT(ej)(td(t.reflectSymbol(e),n(r)))(o)(i)},eY=function(t){return function(e){return e.join(t)}},eX="InputNumber",e1=t=>"InputButton"===t?"button":"InputCheckbox"===t?"checkbox":"InputColor"===t?"color":"InputDate"===t?"date":"InputDatetimeLocal"===t?"datetime-local":"InputEmail"===t?"email":"InputFile"===t?"file":"InputHidden"===t?"hidden":"InputImage"===t?"image":"InputMonth"===t?"month":"InputNumber"===t?"number":"InputPassword"===t?"password":"InputRadio"===t?"radio":"InputRange"===t?"range":"InputReset"===t?"reset":"InputSearch"===t?"search":"InputSubmit"===t?"submit":"InputTel"===t?"tel":"InputText"===t?"text":"InputTime"===t?"time":"InputUrl"===t?"url":"InputWeek"===t?"week":void b(),e0=(t,e,n)=>({tag:t,_1:e,_2:n});function e2(t,e,n){return null==t?e:n(t)}var e3=t=>({bind:e=>n=>t.Bind1().bind(e)(e=>"Left"===e.tag?t.Applicative0().pure(z("Left",e._1)):"Right"===e.tag?n(e._1):void b()),Apply0:()=>e5(t)}),e5=t=>{let e=t.Bind1().Apply0().Functor0(),n={map:t=>e.map(e=>"Left"===e.tag?z("Left",e._1):"Right"===e.tag?z("Right",t(e._1)):void b())};return{apply:(()=>{let e=e3(t);return n=>r=>e.bind(n)(n=>e.bind(r)(e=>e4(t).pure(n(e))))})(),Functor0:()=>n}},e4=t=>({pure:e=>t.Applicative0().pure(z("Right",e)),Apply0:()=>e5(t)}),e6=t=>{let e={Applicative0:()=>e4(t),Bind1:()=>e3(t)};return{throwError:e=>t.Applicative0().pure(z("Left",e)),Monad0:()=>e}},e7=isFinite,e8=Math.floor,e9=function(t){return t},nt=(u=O,function(t){var e,n=RegExp("^[\\+\\-]?"+(t<11?"[0-"+(t-1).toString()+"]":11===t?"[0-9a]":"[0-9a-"+String.fromCharCode(86+t)+"]")+"+$","i");return function(e){if(!n.test(e))return u;var r=parseInt(e,t);return(0|r)===r?q(r):u}})(10),ne=(l=O,function(t){return(0|t)===t?q(t):l}),nn=t=>{if(!e7(t))return 0;if(t>=e9(0x7fffffff))return 0x7fffffff;if(t<=e9(-0x80000000))return -0x80000000;let e=ne(t);return"Nothing"===e.tag?0:"Just"===e.tag?e._1:void b()},nr=t=>e=>{var n;let r=(n=t.length,function(t){return{before:t.substring(0,n),after:t.substring(n)}})(e);return r.before===t?M("Just",r.after):O};function no(t){return Object.prototype.toString.call(t).slice(8,-1)}var ni=(t,e,n)=>({tag:t,_1:e,_2:n}),na=t=>"ForeignError"===t.tag?t._1:"ErrorAtIndex"===t.tag?"Error at array index "+A(t._1)+": "+na(t._2):"ErrorAtProperty"===t.tag?"Error at property "+k(t._1)+": "+na(t._2):"TypeMismatch"===t.tag?"Type mismatch: expected "+t._1+", found "+t._2:void b(),nu=t=>e=>n=>no(n)===e?e4(t).pure(n):e6(t).throwError(ts(ni("TypeMismatch",e,no(n)),tm)),nl=t=>nu(t)("String"),ns={foldrWithIndex:t=>e=>{let n=tr(e=>{let n=e._1,r=e._2;return e=>t(n)(r)(e)})(e),r=tX(tc);return t=>n(r(t))},foldlWithIndex:t=>e=>{let n=to(e=>n=>t(n._1)(e)(n._2))(e),r=tX(tc);return t=>n(r(t))},foldMapWithIndex:t=>{let e=t.mempty;return n=>ns.foldrWithIndex(e=>r=>o=>t.Semigroup0().append(n(e)(r))(o))(e)},Foldable0:()=>tl},nd=(t,e,n,r)=>({tag:"Step",_1:t,_2:e,_3:n,_4:r}),nc=(t,e)=>{let n=t._2;return t._3(n,e)},nf=t=>{let e=t._2;return t._4(e)};function n_(t,e,n){for(var r={},o=0;o<t.length;o++){var i=t[o],a=e(i);r[a]=n(a,o,i)}return r}function ng(t,e,n,r,o,i){for(var a={},u=0;u<e.length;u++){var l=e[u],s=n(l);t.hasOwnProperty(s)?a[s]=r(s,u,t[s],l):a[s]=i(s,u,l)}for(var s in t)s in a||o(s,t[s]);return a}function np(t,e,n){return null!=t?n.createElementNS(t,e):n.createElement(e)}function nv(t,e,n){var r=n.childNodes.item(t)||null;r!==e&&n.insertBefore(e,r)}function nm(t,e){e&&t.parentNode===e&&e.removeChild(t)}function nh(t){return t.parentNode}function nC(t,e,n,r){null!=t?r.setAttributeNS(t,e,n):r.setAttribute(e,n)}function ny(t,e,n){null!=t?n.removeAttributeNS(t,e):n.removeAttribute(e)}var nb=void 0;function nR(t){return function(){return function(e){return t(e)()}}}function nw(t){return function(e){return function(n){return function(r){return function(){return r.addEventListener(t,e,n)}}}}}function nS(t){return function(e){return function(n){return function(r){return function(){return r.removeEventListener(t,e,n)}}}}}var nN=(t,e)=>({tag:t,_1:e}),nE=(t,e,n,r)=>({tag:t,_1:e,_2:n,_3:r}),nx=t=>e=>nE("Property",t,e),nJ=(t,e)=>e.hasAttribute(t)?ny(null,t,e):"string"==typeof e[t]?void(e[t]=""):"rowSpan"===t||"colSpan"===t?void(e[t]=1):void(e[t]=nb),nL=t=>"Attribute"===t.tag?"Just"===t._1.tag?"attr/"+t._1._1+":"+t._2:"attr/:"+t._2:"Property"===t.tag?"prop/"+t._1:"Handler"===t.tag?"handler/"+t._1:"Ref"===t.tag?"ref":void b(),nA=t=>e=>{let n=n=>{var r;let o="ref"in(r=n.props)?q(r.ref):O;if("Just"===o.tag&&"Ref"===o._1.tag){let n=o._1._1(nN("Removed",e));if("Just"===n.tag)return t(n._1)()}},r=n=>(r,o,i)=>{var a,u,l;if("Attribute"===i.tag){let t=i._2,n=i._3;return nC("Nothing"===i._1.tag?null:"Just"===i._1.tag?i._1._1:void b(),t,n,e),i}if("Property"===i.tag){let t=i._1,n=i._2;return e[t]=n,i}if("Handler"===i.tag){if(a=i._1,n.hasOwnProperty(a))return n[i._1]._2.value=i._2,i;let r={value:i._2},o=nR(e=>()=>{let n=(0,r.value)(e);if("Just"===n.tag)return t(n._1)()})();return u=i._1,l=td(o,r),n[u]=l,!function(t,e,n){n.addEventListener(t,e,!1)}(i._1,o,e),i}if("Ref"===i.tag){let n=i._1(nN("Created",e));return"Just"===n.tag&&t(n._1)(),i}b()},o=(t,i)=>{let a={},u=t.events,l=ng(t.props,i,nL,(t,n,r,o)=>{var i,l;if("Attribute"===r.tag){if("Attribute"===o.tag){if(r._3===o._3)return o;nC("Nothing"===o._1.tag?null:"Just"===o._1.tag?o._1._1:void b(),o._2,o._3,e)}return o}if("Property"===r.tag){if("Property"===o.tag){if(r._2===o._2||"value"===o._1&&e.value===o._2)return o;i=o._1,l=o._2,e[i]=l}return o}if("Handler"===r.tag&&"Handler"===o.tag){let t=o._2,e=o._1,n=u[e];n._2.value=t,a[e]=n}return o},(t,n)=>{if("Attribute"===n.tag){let t=n._2;return ny("Nothing"===n._1.tag?null:"Just"===n._1.tag?n._1._1:void b(),t,e)}if("Property"===n.tag)return nJ(n._1,e);if("Handler"===n.tag){let t=n._1,r=u[t]._1;return function(t,e,n){n.removeEventListener(t,e,!1)}(t,r,e)}"Ref"!==n.tag&&b()},r(a));return nd(void 0,{events:a,props:l},o,n)};return t=>{let e={},i=n_(t,nL,r(e));return nd(void 0,{events:e,props:i},o,n)}},nB=(t,e,n)=>({tag:"Graft",_1:t,_2:e,_3:n}),nk=(t,e,n,r,o)=>({tag:t,_1:e,_2:n,_3:r,_4:o}),nI=t=>{let e=n=>{if("Text"===n.tag)return nk("Text",n._1);if("Elem"===n.tag)return nk("Elem",n._1,n._2,t._1(n._3),S(e)(n._4));if("Keyed"===n.tag)return nk("Keyed",n._1,n._2,t._1(n._3),S(t=>td(t._1,e(t._2)))(n._4));if("Widget"===n.tag)return nk("Widget",t._2(n._1));if("Grafted"===n.tag){let e=n._1;return nk("Grafted",nB(n=>t._1(e._1(n)),n=>t._2(e._2(n)),e._3))}b()};return e(t._3)},nT=(t,e,n)=>({tag:t,_1:e,_2:n}),nM=t=>t,nO=t=>e=>n=>r=>o=>i=>{let a,u=t,l=e,s=n,d=r,c=o,f=i,_=!0;for(;_;){let t=u,e=l,n=s,r=d,o=c,i=f;if("Pure"===o.tag){_=!1,a=td(tv("Cons",{func:t.pure(o._1),count:i},e),n);continue}if("Lift"===o.tag){_=!1,a=td(tv("Cons",{func:r(o._1),count:i},e),n);continue}if("Ap"===o.tag){u=t,l=e,s=ts(o._2,tv("Cons",n._1,n._2)),d=r,c=o._1,f=i+1|0;continue}b()}return a},nq=t=>e=>n=>r=>{let o=t,i=e,a=n,u=r,l=!0,s;for(;l;){let t=o,e=i,n=a,r=u;if("Nil"===e.tag){l=!1,s=z("Left",r);continue}if("Cons"===e.tag){let d=t.Apply0().apply(e._1.func)(r);if(1===e._1.count){if("Nil"===e._2.tag){l=!1,s=z("Left",d);continue}o=t,i=e._2,a=n,u=d;continue}if("Nil"===n.tag){l=!1,s=z("Left",d);continue}if("Cons"===n.tag){l=!1,s=z("Right",td(tv("Cons",{func:d,count:e._1.count-1|0},e._2),ts(n._1,n._2)));continue}}b()}return s},nP={map:t=>e=>nT("Ap",nT("Pure",t),e)},nF=t=>e=>n=>(n=>{let r=n,o=!0,i;for(;o;){let n=r;if("Pure"===n._2._1.tag){let e=nq(t)(n._1)(n._2._2)(t.pure(n._2._1._1));if("Left"===e.tag){o=!1,i=e._1;continue}if("Right"===e.tag){r=e._1;continue}b()}if("Lift"===n._2._1.tag){let a=nq(t)(n._1)(n._2._2)(e(n._2._1._1));if("Left"===a.tag){o=!1,i=a._1;continue}if("Right"===a.tag){r=a._1;continue}b()}if("Ap"===n._2._1.tag){r=nO(t)(n._1)(ts(n._2._1._2,n._2._2))(e)(n._2._1._1)(1);continue}b()}return i})(td(tm,ts(n,tm))),nD={apply:t=>e=>nT("Ap",t,e),Functor0:()=>nP},nz={pure:t=>nT("Pure",t),Apply0:()=>nD},nU=(t,e,n)=>({tag:"ChildQuery",_1:t,_2:e,_3:n}),nG=(t,e,n)=>({tag:t,_1:e,_2:n}),nQ=t=>t,nj=t=>t,nH=t=>t,nW=()=>t=>e=>{let n=eZ()(t)(e);return t=>r=>{let o=(t,n)=>"Leaf"===t.tag?n:"Node"===t.tag?o(t._5,(()=>{let r=o(t._6,n);return"Nothing"===t._4.tag?r:"Just"===t._4.tag?eT(e)(t._3)(t._4._1)(r):void b()})()):void b();return tI(tT("Bind",nG("ChildQuery",nU(e=>{let r=eq.traverse(e);return i=>{let a=e.Apply0().Functor0().map(t=>o(t,ex)),u=r(i),l=n(t);return t=>a(u(l(t)))}},r,nQ)),t=>tI(tT("Return",t),tL)),tL)}},nZ=()=>t=>e=>{let n=e$()(t)(e);return t=>e=>r=>tI(tT("Bind",nG("ChildQuery",nU(r=>o=>{let i=r.pure(O),a=n(t)(e);return t=>{let e=a(t);return"Nothing"===e.tag?i:"Just"===e.tag?o(e._1):void b()}},r,nQ)),t=>tI(tT("Return",t),tL)),tL)},nK={state:t=>tI(tT("Bind",nG("State",t),t=>tI(tT("Return",t),tL)),tL),Monad0:()=>tO},n$=t=>({liftEffect:e=>tI(tT("Bind",nG("Lift",t.liftEffect(e)),t=>tI(tT("Return",t),tL)),tL),Monad0:()=>tO}),nV=t=>tI(tT("Bind",nG("Kill",t,void 0),t=>tI(tT("Return",t),tL)),tL),nY=t=>nf(t.widget),nX=(t,e)=>{if("Grafted"===e.tag)return nX(t,nI(e._1));if("Widget"===e.tag){let n=e._1,r=nc(t.widget,n);return nd(r._1,{build:t.build,widget:r},nX,nY)}return nY(t),t.build(e)},n1=t=>{let e=t.node,n=nh(e);return nm(e,n)},n0=(t,e)=>{if("Grafted"===e.tag)return n0(t,nI(e._1));if("Text"===e.tag){if(t.value===e._1)return nd(t.node,t,n0,n1);let n=e._1;return t.node.textContent=n,nd(t.node,{build:t.build,node:t.node,value:n},n0,n1)}return n1(t),t.build(e)},n2=t=>{let e=t.attrs,n=t.children,r=t.node,o=nh(r);return nm(r,o),!function(t,e){for(var n=Object.keys(t),r=0;r<n.length;r++){var o=n[r];e(o,t[o])}}(n,(t,e)=>nf(e)),nf(e)},n3=t=>{let e=t.attrs,n=t.children,r=t.node,o=nh(r);return nm(r,o),!function(t,e){for(var n=0;n<t.length;n++)e(t[n])}(n,nf),nf(e)},n5=(t,e,n,r)=>e===r&&("Just"===t.tag?"Just"===n.tag&&t._1===n._1:"Nothing"===t.tag&&"Nothing"===n.tag),n4=(t,e)=>{if("Grafted"===e.tag)return n4(t,nI(e._1));if("Elem"===e.tag&&n5(t.ns,t.name,e._1,e._2)){if(0===t.children.length&&0===e._4.length){let n=nc(t.attrs,e._3);return nd(t.node,{build:t.build,node:t.node,attrs:n,ns:e._1,name:e._2,children:t.children},n4,n3)}let n=function(t,e,n,r,o){for(var i=[],a=t.length,u=e.length,l=0;;){if(l<a)l<u?i.push(n(l,t[l],e[l])):r(l,t[l]);else if(l<u)i.push(o(l,e[l]));else break;l++}return i}(t.children,e._4,(e,n,r)=>{let o=nc(n,r);return nv(e,o._1,t.node),o},(t,e)=>nf(e),(e,n)=>{let r=t.build(n);return nv(e,r._1,t.node),r}),r=nc(t.attrs,e._3);return nd(t.node,{build:t.build,node:t.node,attrs:r,ns:e._1,name:e._2,children:n},n4,n3)}return n3(t),t.build(e)},n6=(t,e)=>{if("Grafted"===e.tag)return n6(t,nI(e._1));if("Keyed"===e.tag&&n5(t.ns,t.name,e._1,e._2)){let n=e._4.length;if(0===t.length&&0===n){let n=nc(t.attrs,e._3);return nd(t.node,{build:t.build,node:t.node,attrs:n,ns:e._1,name:e._2,children:t.children,length:0},n6,n2)}let r=ng(t.children,e._4,tg,(e,n,r,o)=>{let i=nc(r,o._2);return nv(n,i._1,t.node),i},(t,e)=>nf(e),(e,n,r)=>{let o=r._2,i=t.build(o);return nv(n,i._1,t.node),i}),o=nc(t.attrs,e._3);return nd(t.node,{build:t.build,node:t.node,attrs:o,ns:e._1,name:e._2,children:r,length:n},n6,n2)}return n2(t),t.build(e)},n7=(t,e,n)=>{let r=t.buildWidget(t)(n);return nd(r._1,{build:e,widget:r},nX,nY)},n8=(t,e,n)=>{let r=t.document.createTextNode(n);return nd(r,{build:e,node:r,value:n},n0,n1)},n9=(t,e,n,r,o,i)=>{let a=np("Nothing"===n.tag?null:"Just"===n.tag?n._1:void b(),r,t.document),u=n_(i,tg,(t,n,r)=>{let o=e(r._2);return nv(n,o._1,a),o}),l=t.buildAttributes(a)(o);return nd(a,{build:e,node:a,attrs:l,ns:n,name:r,children:u,length:i.length},n6,n2)},rt=(t,e,n,r,o,i)=>{let a=np("Nothing"===n.tag?null:"Just"===n.tag?n._1:void b(),r,t.document),u=function(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e(r,t[r]));return n}(i,(t,n)=>{let r=e(n);return nv(t,r._1,a),r}),l=t.buildAttributes(a)(o);return nd(a,{build:e,node:a,attrs:l,ns:n,name:r,children:u},n4,n3)},re=t=>{let e=n=>{if("Text"===n.tag)return n8(t,e,n._1);if("Elem"===n.tag){let r=n._3,o=n._4,i=n._2;return rt(t,e,n._1,i,r,o)}if("Keyed"===n.tag){let r=n._3,o=n._4,i=n._2;return n9(t,e,n._1,i,r,o)}return"Widget"===n.tag?n7(t,e,n._1):"Grafted"===n.tag?e(nI(n._1)):void b()};return e},rn=(t,e)=>t._1===e._1&&t._2===e._2&&t._2(t._4,e._4),rr=t=>{let e=(n,r)=>{if(rn(n.thunk,r))return nd(n.vdom._1,n,e,t=>nf(t.vdom));let o=t(r._3(r._4)),i=nc(n.vdom,o);return nd(i._1,{vdom:i,thunk:r},e,t=>nf(t.vdom))};return n=>r=>{let o=t(r._3(r._4)),i=re(n)(o);return nd(i._1,{thunk:r,vdom:i},e,t=>nf(t.vdom))}},ro=(t,e)=>({tag:t,_1:e}),ri=ti(tD)(tu),ra=t=>e=>{if("Initialize"===e.tag){let n=ri(t.handleAction)(t.initialize);return tI(n._1,"CatNil"===n._2.tag?tJ("CatCons",t=>tI(tT("Return",e._1),tL),tE(tm,tm)):"CatCons"===n._2.tag?tJ("CatCons",n._2._1,tE(n._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",e._1),tL),tE(tm,tm)),n._2._2._2))):void b())}if("Finalize"===e.tag){let n=ri(t.handleAction)(t.finalize);return tI(n._1,"CatNil"===n._2.tag?tJ("CatCons",t=>tI(tT("Return",e._1),tL),tE(tm,tm)):"CatCons"===n._2.tag?tJ("CatCons",n._2._1,tE(n._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",e._1),tL),tE(tm,tm)),n._2._2._2))):void b())}if("Receive"===e.tag){let n=ri(t.handleAction)(t.receive(e._1));return tI(n._1,"CatNil"===n._2.tag?tJ("CatCons",t=>tI(tT("Return",e._2),tL),tE(tm,tm)):"CatCons"===n._2.tag?tJ("CatCons",n._2._1,tE(n._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",e._2),tL),tE(tm,tm)),n._2._2._2))):void b())}if("Action"===e.tag){let n=t.handleAction(e._1);return tI(n._1,"CatNil"===n._2.tag?tJ("CatCons",t=>tI(tT("Return",e._2),tL),tE(tm,tm)):"CatCons"===n._2.tag?tJ("CatCons",n._2._1,tE(n._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",e._2),tL),tE(tm,tm)),n._2._2._2))):void b())}if("Query"===e.tag){let n=e._2(),r=t.handleQuery(e._1._2);return tI(r._1,"CatNil"===r._2.tag?tJ("CatCons",t=>tI(tT("Return","Nothing"===t.tag?n:"Just"===t.tag?e._1._1(t._1):void b()),tL),tE(tm,tm)):"CatCons"===r._2.tag?tJ("CatCons",r._2._1,tE(r._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return","Nothing"===t.tag?n:"Just"===t.tag?e._1._1(t._1):void b()),tL),tE(tm,tm)),r._2._2._2))):void b())}b()},ru={handleAction:t=>tI(tT("Return",void 0),tL),handleQuery:t=>tI(tT("Return",O),tL),receive:t=>O,initialize:O,finalize:O},rl=()=>t=>e=>{let n=e$()(t)(e),r=eK()(t)(e),o=eV()(t)(e);return t=>e=>i=>a=>u=>({get:n(t)(e),pop:r(t)(e),set:o(t)(e),component:i,input:a,output:u})},rs=nx("rel"),rd=(()=>{let t=nx("step");return e=>t("Any"===e.tag?"any":"Step"===e.tag?B(e._1):void b())})(),rc=nx("target"),rf=nx("min"),r_=nx("max"),rg=nx("href"),rp=nx("draggable"),rv=(()=>{let t=nx("className"),e=eY(" "),n=S(tR);return r=>t(e(n(r)))})(),rm=nx("className"),rh=t=>()=>()=>e=>n=>r=>L(t.reflectSymbol(e))(n)(r),rC=t=>()=>()=>e=>n=>r=>L(t.reflectSymbol(e))(n(J(t.reflectSymbol(e))(r)))(r),ry=t=>e=>nk("Elem",O,"i",[rv(["fa-solid "+t,...e])],[]),rb=t=>e=>n=>nk("Elem",O,"button",[rv(["rounded w-full h-full py-1 px-2 transition-colors duration-75",e]),nE("Handler","click",t=>M("Just",e0("Action",n)))],[t]),rR=(t,e)=>({tag:t,_1:e}),rw=(t,e)=>({tag:"SetItems",_1:t,_2:e}),rS=(()=>{let t=tH(nK);return e=>t.state(t=>td(void 0,e))})(),rN=tj(tO).pure,rE=rh({reflectSymbol:()=>"selected"})()(),rx=t=>e=>rw(t,e),rJ=rR("EnterEdit"),rL=rR("LeaveEdit"),rA=(t,e)=>({tag:t,_1:e}),rB=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,rk=[];for(let t=0;t<256;++t)rk.push((t+256).toString(16).slice(1));var rI=new Uint8Array(16),rT={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},rM=function(t,e,n){if(rT.randomUUID&&!e&&!t)return rT.randomUUID();let r=(t=t||{}).random??t.rng?.()??function(){if(!_){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");_=crypto.getRandomValues.bind(crypto)}return _(rI)}();if(r.length<16)throw Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){if((n=n||0)<0||n+16>e.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let t=0;t<16;++t)e[n+t]=r[t];return e}return function(t,e=0){return(rk[t[e+0]]+rk[t[e+1]]+rk[t[e+2]]+rk[t[e+3]]+"-"+rk[t[e+4]]+rk[t[e+5]]+"-"+rk[t[e+6]]+rk[t[e+7]]+"-"+rk[t[e+8]]+rk[t[e+9]]+"-"+rk[t[e+10]]+rk[t[e+11]]+rk[t[e+12]]+rk[t[e+13]]+rk[t[e+14]]+rk[t[e+15]]).toLowerCase()}(r)},rO=function(t){return"string"==typeof t&&rB.test(t)},rq={eq:t=>e=>t===e},rP={compare:t=>e=>t8.compare(t)(e),Eq0:()=>rq};function rF(t){return Error(t)}function rD(t){return function(){throw t}}var rz=t=>t,rU=t=>e=>{let n=ti(e);return e=>{let r=n(e);return e=>{let n=r(n=>t.parallel(e(n)));return e=>t.sequential(n(e))}}},rG=function(t){throw Error(t)},rQ=function(){var t={},e="Pure",n="Throw",r="Catch",o="Sync",i="Async",a="Bind",u="Bracket",l="Fork",s="Sequential",d="Apply",c="Cons",f="Resume",_="Release",g="Finalizer",p="Finalized",v="Forked";function m(t,e,n,r){this.tag=t,this._1=e,this._2=n,this._3=r}function h(t){var e=function(e,n,r){return new m(t,e,n,r)};return e.tag=t,e}function C(t){return new m(e,void 0)}var y=function(){var t=0,e=0,n=Array(1024),r=!1;function o(){var o;for(r=!0;0!==t;)t--,o=n[e],n[e]=void 0,e=(e+1)%1024,o();r=!1}return{isDraining:function(){return r},enqueue:function(i){var a;1024===t&&(a=r,o(),r=a),n[(e+t)%1024]=i,t++,r||o()}}}();return m.EMPTY=t,m.Pure=h(e),m.Throw=h(n),m.Catch=h(r),m.Sync=h(o),m.Async=h(i),m.Bind=h(a),m.Bracket=h(u),m.Fork=h(l),m.Seq=h(s),m.ParMap=h("Map"),m.ParApply=h(d),m.ParAlt=h("Alt"),m.Fiber=function h(b,R,w){var S=0,N=0,E=w,x=null,J=null,L=null,A=null,B=null,k=0,I=0,T=null,M=!0;function O(w){for(var I,q,P;;)switch(I=null,q=null,P=null,N){case 2:N=1;try{E=L(E),null===A?L=null:(L=A._1,A=A._2)}catch(t){N=5,x=b.left(t),E=null}break;case 3:b.isLeft(E)?(N=5,x=E,E=null):null===L?N=5:(N=2,E=b.fromRight(E));break;case 1:switch(E.tag){case a:L&&(A=new m(c,L,A)),L=E._2,N=1,E=E._1;break;case e:null===L?(N=5,E=b.right(E._1)):(N=2,E=E._1);break;case o:N=3,E=function(t,e,n){try{return e(n())}catch(e){return t(e)}}(b.left,b.right,E._1);break;case i:N=4,E=function(t,e,n){try{return e(n)()}catch(e){return n(t(e))(),C}}(b.left,E._1,function(t){return function(){S===w&&(S++,y.enqueue(function(){S===w+1&&(N=3,E=t,O(S))}))}});return;case n:N=5,x=b.left(E._1),E=null;break;case r:B=null===L?new m(c,E,B,J):new m(c,E,new m(c,new m(f,L,A),B,J),J),L=null,A=null,N=1,E=E._1;break;case u:k++,B=null===L?new m(c,E,B,J):new m(c,E,new m(c,new m(f,L,A),B,J),J),L=null,A=null,N=1,E=E._1;break;case l:N=3,I=h(b,R,E._2),R&&R.register(I),E._1&&I.run(),E=b.right(I);break;case s:N=1,E=function(e,n,r){return new m(i,function(o){return function(){return function(e,n,r,o){var a=0,u={},l=0,s={},f=Error("[ParAff] Early exit"),_=null,g=t;function p(n,r,o){var i,a,l=r,s=null,f=null,_=0,g={};e:for(;;)switch(i=null,l.tag){case v:if(l._3===t&&(i=u[l._1],g[_++]=i.kill(n,function(t){return function(){0==--_&&o(t)()}})),null===s)break e;l=s._2,null===f?s=null:(s=f._1,f=f._2);break;case"Map":l=l._2;break;case d:case"Alt":s&&(f=new m(c,s,f)),s=l,l=l._1}if(0===_)o(e.right(void 0))();else for(a=0,i=_;a<i;a++)g[a]=g[a]();return g}return function(){var i,C,y=1,b=r,R=null,w=null;e:for(;;)switch(i=null,C=null,y){case 1:switch(b.tag){case"Map":R&&(w=new m(c,R,w)),R=new m("Map",b._1,t,t),b=b._2;break;case d:R&&(w=new m(c,R,w)),R=new m(d,t,b._2,t),b=b._1;break;case"Alt":R&&(w=new m(c,R,w)),R=new m("Alt",t,b._2,t),b=b._1;break;default:C=a++,y=5,i=b,b=new m(v,C,new m(c,R,w),t),(i=h(e,n,i)).onComplete({rethrow:!1,handler:function(n){return function(r){return function(){delete u[n._1],n._3=r,function n(r,i,a){var u,c,g,v,m,h;for(e.isLeft(r)?(u=r,c=null):(c=r,u=null);;){if(g=null,v=null,m=null,h=null,null!==_)return;if(null===i){o(u||c)();return}if(i._3!==t)return;switch(i.tag){case"Map":null===u?(i._3=e.right(i._1(e.fromRight(c))),c=i._3):i._3=u;break;case d:if(g=i._1._3,v=i._2._3,u){if(i._3=u,m=!0,s[h=l++]=p(f,u===g?i._2:i._1,function(){return function(){delete s[h],m?m=!1:null===a?n(u,null,null):n(u,a._1,a._2)}}),m){m=!1;return}}else{if(g===t||v===t)return;c=e.right(e.fromRight(g)(e.fromRight(v))),i._3=c}break;case"Alt":if(g=i._1._3,v=i._2._3,g===t&&e.isLeft(v)||v===t&&e.isLeft(g))return;if(g!==t&&e.isLeft(g)&&v!==t&&e.isLeft(v))u=c===g?v:g,c=null,i._3=u;else if(i._3=c,m=!0,s[h=l++]=p(f,c===g?i._2:i._1,function(){return function(){delete s[h],m?m=!1:null===a?n(c,null,null):n(c,a._1,a._2)}}),m){m=!1;return}}null===a?i=null:(i=a._1,a=a._2)}}(r,n._2._1,n._2._2)}}}(b)})(),u[C]=i,n&&n.register(i)}break;case 5:if(null===R)break e;R._1===t?(R._1=b,y=1,b=R._2,R._2=t):(R._2=b,b=R,null===w?R=null:(R=w._1,w=w._2))}for(C=0,g=b;C<a;C++)u[C].run()}(),function(t){return new m(i,function(n){return function(){return function(t,n){for(var r in _=e.left(t),s)if(s.hasOwnProperty(r))for(r in o=s[r])o.hasOwnProperty(r)&&o[r]();s=null;var o,a=p(t,g,n);return function(t){return new m(i,function(t){return function(){for(var t in a)a.hasOwnProperty(t)&&a[t]();return C}})}}(t,n)}})}}(e,n,r,o)}})}(b,R,E._1)}break;case 5:if(L=null,A=null,null===B)N=6,E=J||x||E;else switch(I=B._3,P=B._1,B=B._2,P.tag){case r:J&&J!==I&&0===k?N=5:x&&(N=1,E=P._2(b.fromLeft(x)),x=null);break;case f:J&&J!==I&&0===k||x?N=5:(L=P._1,A=P._2,N=2,E=b.fromRight(E));break;case u:k--,null===x&&(q=b.fromRight(E),B=new m(c,new m(_,P._2,q),B,I),(J===I||k>0)&&(N=1,E=P._3(q)));break;case _:B=new m(c,new m(p,E,x),B,J),N=1,E=J&&J!==I&&0===k?P._1.killed(b.fromLeft(J))(P._2):x?P._1.failed(b.fromLeft(x))(P._2):P._1.completed(b.fromRight(E))(P._2),x=null,k++;break;case g:k++,B=new m(c,new m(p,E,x),B,J),N=1,E=P._1;break;case p:k--,N=5,E=P._1,x=P._2}break;case 6:for(var F in T)T.hasOwnProperty(F)&&(M=M&&T[F].rethrow,function(t){try{t()}catch(t){setTimeout(function(){throw t},0)}}(T[F].handler(E)));T=null,J&&x?setTimeout(function(){throw b.fromLeft(x)},0):b.isLeft(E)&&M&&setTimeout(function(){if(M)throw b.fromLeft(E)},0);return;case 0:N=1;break;case 4:return}}function q(t){return function(){if(6===N)return M=M&&t.rethrow,t.handler(E)(),function(){};var e=I++;return(T=T||{})[e]=t,function(){null!==T&&delete T[e]}}}return{kill:function(t,e){return function(){if(6===N)return e(b.right(void 0))(),function(){};var n=q({rethrow:!1,handler:function(){return e(b.right(void 0))}})();switch(N){case 0:J=b.left(t),N=6,E=J,O(S);break;case 4:null===J&&(J=b.left(t)),0===k&&(4===N&&(B=new m(c,new m(g,E(t)),B,J)),N=5,E=null,x=null,O(++S));break;default:null===J&&(J=b.left(t)),0===k&&(N=5,E=null,x=null)}return n}},join:function(t){return function(){var e=q({rethrow:!1,handler:t})();return 0===N&&O(S),e}},onComplete:q,isSuspended:function(){return 0===N},run:function(){0===N&&(y.isDraining()?O(S):y.enqueue(function(){O(S)}))}}},m.Supervisor=function(t){var e={},n=0,r=0;return{register:function(t){var o=n++;t.onComplete({rethrow:!0,handler:function(t){return function(){r--,delete e[o]}}})(),e[o]=t,r++},isEmpty:function(){return 0===r},killAll:function(i,a){return function(){if(0===r)return a();var u=0,l={};for(var s in e)e.hasOwnProperty(s)&&(u++,function(n){l[n]=e[n].kill(i,function(e){return function(){delete l[n],u--,t.isLeft(e)&&t.fromLeft(e)&&setTimeout(function(){throw t.fromLeft(e)},0),0===u&&a()}})()}(s));return e={},n=0,r=0,function(t){return new m(o,function(){for(var t in l)l.hasOwnProperty(t)&&l[t]()})}}}}},m.Scheduler=y,m.nonCanceler=C,m}(),rj=rQ.Pure,rH=rQ.Throw;function rW(t){return function(e){return e.tag===rQ.Pure.tag?rQ.Pure(t(e._1)):rQ.Bind(e,function(e){return rQ.Pure(t(e))})}}function rZ(t){return function(e){return rQ.Bind(t,e)}}var rK=rQ.Sync,r$=rQ.Async,rV=rQ.Seq,rY={map:function(t){return function(e){return rQ.ParMap(t,e)}}},rX={map:rW},r1=function(t){return rQ.Fork(!0,t)},r0={isLeft:t=>"Left"===t.tag||"Right"!==t.tag&&void b(),fromLeft:t=>"Left"===t.tag?t._1:"Right"===t.tag?rG("unsafeFromLeft: Right"):void b(),fromRight:t=>"Right"===t.tag?t._1:"Left"===t.tag?rG("unsafeFromRight: Left"):void b(),left:U,right:G},r2={apply:function(t){return function(e){return rQ.ParApply(t,e)}},Functor0:()=>rY},r3={Applicative0:()=>r6,Bind1:()=>r5},r5={bind:rZ,Apply0:()=>r4},r4={apply:t=>e=>rZ(t)(t=>rZ(e)(e=>r6.pure(t(e)))),Functor0:()=>rX},r6={pure:rj,Apply0:()=>r4},r7=t=>e=>{var n;return(n=rj(),function(t){return function(e){return rQ.Bracket(n,t,e)}})({killed:e=>e=>t,failed:e=>e=>t,completed:e=>e=>t})(t=>e)},r8={parallel:tR,sequential:rV,Apply0:()=>r4,Apply1:()=>r2},r9={pure:t=>rj(t),Apply0:()=>r2},ot={liftEffect:rK,Monad0:()=>r3},oe=t=>r$(e=>{let n=t.join(e);return()=>{let t=rK(n());return e=>t}}),on=t=>e=>rZ(rK(e.isSuspended))(n=>n?rK((()=>{let n=e.kill(t,t=>()=>{});return()=>{n()}})()):r$(n=>{let r=e.kill(t,n);return()=>{let t=rK(r());return e=>t}})),or={throwError:rH,Monad0:()=>r3},oo=(t=>{let e=t.MonadThrow0().Monad0();return n=>t.catchError(e.Bind1().Apply0().Functor0().map(G)(n))(t=>e.Applicative0().pure(z("Left",t)))})({catchError:function(t){return function(e){return rQ.Catch(t,e)}},MonadThrow0:()=>or}),oi=t=>e=>{var n;let r=(n=rZ(oo(e))(e=>rK(t(e))),function(){return rQ.Fiber(r0,null,n)});return()=>{let t=r();return t.run(),t}},oa=t=>e=>{let n=oi(t)(e);return()=>{n()}},ou=(()=>{let t=rj();return e=>t})(),ol=()=>t=>e=>{let n=rl()(t)(e);return t=>e=>r=>o=>nk("Widget",ro("ComponentSlot",n(t)(e)(r)(o)(t=>O)))},os=()=>t=>e=>{let n=rl()(t)(e);return t=>e=>r=>o=>i=>nk("Widget",ro("ComponentSlot",n(t)(e)(r)(o)(t=>M("Just",i(t)))))};function od(t){return function(){return t.preventDefault()}}function oc(t,e,n,r){if("undefined"!=typeof window){var o=window[n];if(null!=o&&r instanceof o)return e(r)}for(var i=r;null!=i;){var a=Object.getPrototypeOf(i),u=a.constructor.name;if(u===n)return e(r);if("Object"===u)break;i=a}return t}function of(t){return function(){t.select()}}var o_=(t=>{let e=e4(t).pure;return n=>r=>{var o;return o=e6(t).throwError(ts(ni("TypeMismatch","object",typeof r),tm)),null==r?o:e(r[n])}})(Z),og=t=>e=>n=>r=>nE("Handler",t,t=>{let o=e2(t.currentTarget,O,q);if("Just"===o.tag){let t=e3(Z).bind(o_(e)(o._1))(n);if("Left"===t.tag)return O;if("Right"===t.tag)return M("Just",e0("Action",r(t._1)));b()}if("Nothing"===o.tag)return O;b()}),op=t=>t,ov=()=>t=>e=>{let n=nZ()(t)(e);return t=>e=>r=>{let o=n(t)(e)(r());return tI(o._1,"CatNil"===o._2.tag?tJ("CatCons",t=>tI(tT("Return",void 0),tL),tE(tm,tm)):"CatCons"===o._2.tag?tJ("CatCons",o._2._1,tE(o._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",void 0),tL),tE(tm,tm)),o._2._2._2))):void b())}},om=()=>t=>e=>{let n=nW()(t)(e);return t=>e=>n(t)(e(op))},oh={genericShowArgs:t=>[]},oC=t=>e=>({"genericShow'":n=>{let r=e.reflectSymbol(w),o=t.genericShowArgs(n);if(0===o.length)return r;return"("+[r,...o].join(" ")+")"}}),oy="AtLeast",ob="JustDraw",oR="Remains",ow="JustRemains",oS="Choice",oN="LeftOne",oE="LeftAll",ox={show:(()=>{let t=oC(oh)({reflectSymbol:()=>"AtLeast"}),e=oC(oh)({reflectSymbol:()=>"JustDraw"}),n=(()=>{let n=(()=>{let t=oC(oh)({reflectSymbol:()=>"Remains"}),n=(()=>{let e=oC(oh)({reflectSymbol:()=>"JustRemains"}),n=(()=>{let t=oC(oh)({reflectSymbol:()=>"Choice"}),n=(()=>{let e=oC(oh)({reflectSymbol:()=>"LeftOne"}),n=(()=>{let t=oC(oh)({reflectSymbol:()=>"LeftAll"});return{"genericShow'":n=>"Inl"===n.tag?e["genericShow'"](n._1):"Inr"===n.tag?t["genericShow'"](n._1):void b()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?n["genericShow'"](e._1):void b()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?n["genericShow'"](t._1):void b()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?n["genericShow'"](e._1):void b()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?n["genericShow'"](t._1):void b()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?n["genericShow'"](e._1):void b()}})();return t=>n["genericShow'"]("AtLeast"===t?I("Inl",T):"JustDraw"===t?I("Inr",I("Inl",T)):"Remains"===t?I("Inr",I("Inr",I("Inl",T))):"JustRemains"===t?I("Inr",I("Inr",I("Inr",I("Inl",T)))):"Choice"===t?I("Inr",I("Inr",I("Inr",I("Inr",I("Inl",T))))):"LeftOne"===t?I("Inr",I("Inr",I("Inr",I("Inr",I("Inr",I("Inl",T)))))):"LeftAll"===t?I("Inr",I("Inr",I("Inr",I("Inr",I("Inr",I("Inr",T)))))):void b())})()},oJ=(t,e)=>({tag:t,_1:e}),oL=(t,e,n,r)=>({tag:t,_1:e,_2:n,_3:r}),oA=nx("value"),oB={reflectSymbol:()=>"selector"},ok=os()(oB)(t7),oI={initialState:(()=>{let t=S(rE(w)(!1));return e=>({items:t(e),isEditMode:!1})})(),render:t=>{let e=t.isEditMode;return nk("Elem",O,"div",[rm("mx-1 flex")],[el(t=>!t.selected,t.items)||e?nk("Elem",O,"div",[],[rb(nk("Elem",O,"i",[rm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(rJ)]):nk("Text",""),nk("Elem",O,"div",[rm(e?"fixed inset-0 bg-black opacity-20":"hidden"),nE("Handler","click",t=>M("Just",e0("Action",rL)))],[]),nk("Elem",O,"ul",[rm(e?"break-anywhere absolute flex min-w-48 flex-col gap-0.5 bg-white p-4 shadow-md":"break-anywhere flex w-full flex-wrap gap-1"),nE("Handler","click",t=>M("Just",e0("Action",rJ)))],S(t=>nk("Elem",O,"li",[rm(t.selected||e?"min-w-0":"hidden")],[nk("Elem",O,"button",[rv(["h-full w-full rounded border px-3 py-1 transition-colors duration-75",t.selected?"border-sky-700 bg-sky-500 text-white hover:bg-sky-600":"border-gray-800 bg-gray-300 text-black hover:bg-gray-400"]),(()=>{let e=rR("Toggle",t.key);return nE("Handler","click",t=>M("Just",e0("Action",e)))})()],[nk("Text",t.value)])]))(t.items))])},eval:ra({...ru,handleAction:t=>{if("EnterEdit"===t.tag)return tI(tT("Bind",nG("State",t=>td(void 0,{...t,isEditMode:!0})),t=>tI(tT("Return",t),tL)),tL);if("LeaveEdit"===t.tag)return tI(tT("Bind",nG("State",t=>{let e={...t,isEditMode:!1};return td(e,e)}),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>tI(tT("Bind",nG("Raise",S(t=>t.key)(ei(t=>t.selected,t.items)),void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)));if("Toggle"===t.tag){let e=t._1,n=tI(tT("Bind",nG("State",t=>td(void 0,{...t,items:S(t=>rq.eq(t.key)(e)?{...t,selected:!t.selected}:t)(t.items)})),t=>tI(tT("Return",t),tL)),tL);return tI(tT("Bind",nG("State",t=>td(t.isEditMode,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>t?n:tI(tT("Return",void 0),tL),tE(tm,tm)))}if("Receive"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>td(void 0,(()=>{let n=t.items;return{...t,items:S(t=>{let e=t.key;return{key:e,value:t.value,selected:(()=>{let t=ep(t=>rq.eq(t.key)(e))(n);return"Nothing"!==t.tag&&("Just"===t.tag?t._1.selected:void b())})()}})(e)}})())),t=>tI(tT("Return",t),tL)),tL)}b()},handleQuery:t=>{let e=t._2;return tG(tO).bind(rS({items:t._1,isEditMode:!1}))(()=>rN(e))},receive:t=>M("Just",rR("Receive",t))})},oT=(()=>{let t=nx("type");return e=>t(e1(e))})(),oM=(()=>{let t={append:t=>e=>t+e|0};return tl.foldMap({mempty:0,Semigroup0:()=>t})})(),oO=t=>e=>{let n=t9.compare(t)(e);return"LT"===n||"EQ"===n?t:"GT"===n?e:void b()},oq=(()=>{let t=tH(nK);return e=>t.state(t=>td(e(t),t))})(),oP=eh({eq:t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name}),oF=ov()(oB)(t7),oD=t=>e=>n=>{let r=t9.compare(t)(n),o="LT"===r?n:"EQ"===r||"GT"===r?t:void b(),i=t9.compare(e)(o);return"LT"===i||"EQ"===i?e:"GT"===i?o:void b()},oz=tI(tT("Bind",nG("State",t=>td(t,t)),t=>tI(tT("Return",t),tL)),tL),oU=ti(tD)(tu),oG=n$(ot).liftEffect,oQ=ti(Y)(tu),oj=t=>oL("GetCondition",t),oH=t=>e=>n=>oL("RestoreState",t,e,n),oW={tag:"Updated"},oZ=oJ("Initialize"),oK=t=>oJ("UpdateConditionMode",t),o$=t=>oJ("UpdateCardSelected",t),oV=t=>oJ("UpdateCardCount",t),oY={initialState:t=>({cards:t,condition:{mode:oy,count:0,cards:[]},min:0,max:0}),render:t=>nk("Elem",O,"div",[rm("flex flex-wrap items-center justify-end")],[nk("Elem",O,"div",[rm("w-48 grow rounded border border-gray-200 p-0.5")],[ok(w)()(oI)(S(t=>({key:t.id,value:t.name}))(t.cards))(o$)]),nk("Elem",O,"div",[rm("flex items-center")],[nk("Elem",O,"div",[rm("mx-1")],[nk("Text","を")]),nk("Elem",O,"input",[rv(["w-12 appearance-none rounded border border-gray-400 bg-transparent p-1 text-right","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),oT(eX),rd(rA("Step",1)),oA(A(t.condition.count)),rf(e9(t.min)),r_(e9(t.max)),nE("Handler","focus",t=>M("Just",e0("Action",oJ("SelectOnFocus",t)))),og("change")("value")(nl(Z))(oV)],[]),nk("Elem",O,"select",[rv(["w-full appearance-none rounded border border-gray-400 bg-transparent px-3 py-1","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),oA(ox.show(t.condition.mode)),og("change")("value")(nl(Z))(oK)],[nk("Elem",O,"option",[oA(ox.show(oy))],[nk("Text","枚以上ドローする")]),nk("Elem",O,"option",[oA(ox.show(ob))],[nk("Text","枚ちょうどドローする")]),nk("Elem",O,"option",[oA(ox.show(oR))],[nk("Text","枚以上デッキに残す")]),nk("Elem",O,"option",[oA(ox.show(ow))],[nk("Text","枚ちょうどデッキに残す")]),nk("Elem",O,"option",[oA(ox.show(oS))],[nk("Text","種類以上ドローする")]),nk("Elem",O,"option",[oA(ox.show(oN))],[nk("Text","種類以上デッキに残す")]),nk("Elem",O,"option",[oA(ox.show(oE))],[nk("Text","種類以上ドローしない")])])])]),eval:ra({...ru,handleAction:t=>{if("Initialize"===t.tag)return tI(oz._1,tJ("CatCons",t=>{let e=oM(t=>t.count);if("AtLeast"===t.condition.mode){let n=e(t.condition.cards),r={cards:t.cards,condition:{mode:t.condition.mode,count:oD(oO(1)(n))(n)(t.condition.count),cards:t.condition.cards},min:oO(1)(n),max:n};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tL)}if("JustDraw"===t.condition.mode){let n={cards:t.cards,condition:{mode:t.condition.mode,count:oD(0)(e(t.condition.cards))(t.condition.count),cards:t.condition.cards},min:0,max:e(t.condition.cards)};return tI(tT("Bind",nG("State",t=>td(void 0,n)),t=>tI(tT("Return",t),tL)),tL)}if("Remains"===t.condition.mode){let n=e(t.condition.cards),r={cards:t.cards,condition:{mode:t.condition.mode,count:oD(oO(1)(n))(n)(t.condition.count),cards:t.condition.cards},min:oO(1)(n),max:n};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tL)}if("JustRemains"===t.condition.mode){let n={cards:t.cards,condition:{mode:t.condition.mode,count:oD(0)(e(t.condition.cards))(t.condition.count),cards:t.condition.cards},min:0,max:e(t.condition.cards)};return tI(tT("Bind",nG("State",t=>td(void 0,n)),t=>tI(tT("Return",t),tL)),tL)}if("Choice"===t.condition.mode||"LeftOne"===t.condition.mode||"LeftAll"===t.condition.mode){let e=t.condition.cards.length,n={cards:t.cards,condition:{mode:t.condition.mode,count:oD(oO(1)(e))(e)(t.condition.count),cards:t.condition.cards},min:oO(1)(e),max:e};return tI(tT("Bind",nG("State",t=>td(void 0,n)),t=>tI(tT("Return",t),tL)),tL)}b()},tE(tm,tm)));if("UpdateCardSelected"===t.tag){let e=t._1;return tI(oz._1,tJ("CatCons",t=>{let n=ei(t=>eh(rq)(t.id)(e),t.cards),r=oM(t=>t.count),o=(()=>{if("AtLeast"===t.condition.mode){let e=r(n),o={cards:t.cards,condition:{mode:t.condition.mode,count:oD(oO(1)(e))(e)(t.condition.count),cards:n},min:oO(1)(e),max:e};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("JustDraw"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,count:oD(0)(r(n))(t.condition.count),cards:n},min:0,max:r(n)};return tI(tT("Bind",nG("State",t=>td(void 0,e)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("Remains"===t.condition.mode){let e=r(n),o={cards:t.cards,condition:{mode:t.condition.mode,count:oD(oO(1)(e))(e)(t.condition.count),cards:n},min:oO(1)(e),max:e};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("JustRemains"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,count:oD(0)(r(n))(t.condition.count),cards:n},min:0,max:r(n)};return tI(tT("Bind",nG("State",t=>td(void 0,e)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("Choice"===t.condition.mode||"LeftOne"===t.condition.mode||"LeftAll"===t.condition.mode){let e=n.length,r={cards:t.cards,condition:{mode:t.condition.mode,count:oD(oO(1)(e))(e)(t.condition.count),cards:n},min:oO(1)(e),max:e};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}b()})();return t2(rq.eq)(e)(S(t=>t.id)(t.condition.cards))?tI(tT("Return",void 0),tL):o},tE(tm,tm)))}if("UpdateConditionMode"===t.tag)return oU(t=>tI(oz._1,tJ("CatCons",e=>{let n=oM(t=>t.count);if("AtLeast"===t){let r=n(e.condition.cards),o={cards:e.cards,condition:{mode:t,count:oD(oO(1)(r))(r)(e.condition.count),cards:e.condition.cards},min:oO(1)(r),max:r};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("JustDraw"===t){let r={cards:e.cards,condition:{mode:t,count:oD(0)(n(e.condition.cards))(e.condition.count),cards:e.condition.cards},min:0,max:n(e.condition.cards)};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("Remains"===t){let r=n(e.condition.cards),o={cards:e.cards,condition:{mode:t,count:oD(oO(1)(r))(r)(e.condition.count),cards:e.condition.cards},min:oO(1)(r),max:r};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("JustRemains"===t){let r={cards:e.cards,condition:{mode:t,count:oD(0)(n(e.condition.cards))(e.condition.count),cards:e.condition.cards},min:0,max:n(e.condition.cards)};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("Choice"===t||"LeftOne"===t||"LeftAll"===t){let n=e.condition.cards.length,r={cards:e.cards,condition:{mode:t,count:oD(oO(1)(n))(n)(e.condition.count),cards:e.condition.cards},min:oO(1)(n),max:n};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}b()},tE(tm,tm))))("AtLeast"===t._1?M("Just",oy):"JustDraw"===t._1?M("Just",ob):"Remains"===t._1?M("Just",oR):"JustRemains"===t._1?M("Just",ow):"Choice"===t._1?M("Just",oS):"LeftOne"===t._1?M("Just",oN):"LeftAll"===t._1?M("Just",oE):O);if("UpdateCardCount"===t.tag)return oU(t=>tI(oz._1,tJ("CatCons",e=>{let n=oM(t=>t.count);if("AtLeast"===e.condition.mode){let r=n(e.condition.cards),o={cards:e.cards,condition:{mode:e.condition.mode,count:oD(oO(1)(r))(r)(t),cards:e.condition.cards},min:oO(1)(r),max:r};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("JustDraw"===e.condition.mode){let r={cards:e.cards,condition:{mode:e.condition.mode,count:oD(0)(n(e.condition.cards))(t),cards:e.condition.cards},min:0,max:n(e.condition.cards)};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("Remains"===e.condition.mode){let r=n(e.condition.cards),o={cards:e.cards,condition:{mode:e.condition.mode,count:oD(oO(1)(r))(r)(t),cards:e.condition.cards},min:oO(1)(r),max:r};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("JustRemains"===e.condition.mode){let r={cards:e.cards,condition:{mode:e.condition.mode,count:oD(0)(n(e.condition.cards))(t),cards:e.condition.cards},min:0,max:n(e.condition.cards)};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("Choice"===e.condition.mode||"LeftOne"===e.condition.mode||"LeftAll"===e.condition.mode){let n=e.condition.cards.length,r={cards:e.cards,condition:{mode:e.condition.mode,count:oD(oO(1)(n))(n)(t),cards:e.condition.cards},min:oO(1)(n),max:n};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>tI(tT("Bind",nG("Raise",oW,void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}b()},tE(tm,tm))))(nt(t._1));if("Receive"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>td(t.condition,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>{let n=ev(t=>e=>t.id===e.id)(e)(t.cards),r=oM(t=>t.count);if("AtLeast"===t.mode){let o=r(n),i={cards:e,condition:{mode:t.mode,count:oD(oO(1)(o))(o)(t.count),cards:n},min:oO(1)(o),max:o};return tI(tT("Bind",nG("State",t=>td(void 0,i)),t=>tI(tT("Return",t),tL)),tL)}if("JustDraw"===t.mode){let o={cards:e,condition:{mode:t.mode,count:oD(0)(r(n))(t.count),cards:n},min:0,max:r(n)};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tL)}if("Remains"===t.mode){let o=r(n),i={cards:e,condition:{mode:t.mode,count:oD(oO(1)(o))(o)(t.count),cards:n},min:oO(1)(o),max:o};return tI(tT("Bind",nG("State",t=>td(void 0,i)),t=>tI(tT("Return",t),tL)),tL)}if("JustRemains"===t.mode){let o={cards:e,condition:{mode:t.mode,count:oD(0)(r(n))(t.count),cards:n},min:0,max:r(n)};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tL)}if("Choice"===t.mode||"LeftOne"===t.mode||"LeftAll"===t.mode){let r=n.length,o={cards:e,condition:{mode:t.mode,count:oD(oO(1)(r))(r)(t.count),cards:n},min:oO(1)(r),max:r};return tI(tT("Bind",nG("State",t=>td(void 0,o)),t=>tI(tT("Return",t),tL)),tL)}b()},tE(tm,tm)))}if("SelectOnFocus"===t.tag)return oG(oQ(of)((()=>{let e=e2(t._1.target,O,q);return"Just"===e.tag?oc(O,q,"HTMLInputElement",e._1):"Nothing"===e.tag?O:void b()})()));b()},handleQuery:t=>{if("GetCondition"===t.tag){let e=oq(t=>t.condition);return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",e=>tI(tT("Return","Just"===e.tag?M("Just",t._1(e._1)):O),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",e=>tI(tT("Return","Just"===e.tag?M("Just",t._1(e._1)):O),tL),tE(tm,tm)),e._2._2._2))):void b())}if("RestoreState"===t.tag){let e=oM(t=>t.count);if("AtLeast"===t._2.mode){let n=e(t._2.cards);return tI(tT("Bind",nG("State",e=>td(void 0,{cards:t._1,condition:t._2,min:oO(1)(n),max:n})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=oF(w)()(rx(S(e=>({key:e.id,value:e.name,selected:oP(e)(t._2.cards)}))(t._1)));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))))}if("JustDraw"===t._2.mode)return tI(tT("Bind",nG("State",n=>td(void 0,{cards:t._1,condition:t._2,min:0,max:e(t._2.cards)})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=oF(w)()(rx(S(e=>({key:e.id,value:e.name,selected:oP(e)(t._2.cards)}))(t._1)));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))));if("Remains"===t._2.mode){let n=e(t._2.cards);return tI(tT("Bind",nG("State",e=>td(void 0,{cards:t._1,condition:t._2,min:oO(1)(n),max:n})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=oF(w)()(rx(S(e=>({key:e.id,value:e.name,selected:oP(e)(t._2.cards)}))(t._1)));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))))}if("JustRemains"===t._2.mode)return tI(tT("Bind",nG("State",n=>td(void 0,{cards:t._1,condition:t._2,min:0,max:e(t._2.cards)})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=oF(w)()(rx(S(e=>({key:e.id,value:e.name,selected:oP(e)(t._2.cards)}))(t._1)));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))));if("Choice"===t._2.mode||"LeftOne"===t._2.mode||"LeftAll"===t._2.mode){let e=t._2.cards.length;return tI(tT("Bind",nG("State",n=>td(void 0,{cards:t._1,condition:t._2,min:oO(1)(e),max:e})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=oF(w)()(rx(S(e=>({key:e.id,value:e.name,selected:oP(e)(t._2.cards)}))(t._1)));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))))}return tI(tT("Bind",nG("State",t=>{b()}),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=oF(w)()(rx(S(e=>({key:e.id,value:e.name,selected:oP(e)(t._2.cards)}))(t._1)));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",t._3),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))))}b()},receive:t=>M("Just",oJ("Receive",t)),initialize:M("Just",oZ)})},oX=((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of m(e))C.call(t,n)||void 0===n||p(t,n,{get:()=>e[n],enumerable:!(r=v(e,n))||r.enumerable});return t})(p(null!=(n=y())?g(h(n)):{},"default",{value:n,enumerable:!0}),n);function o1(t){return(0,oX.default)(t)}function o0(t){return t.toJSNumber()}function o2(t){return function(e){return t.add(e)}}function o3(t){return function(e){return t.multiply(e)}}function o5(t){return function(e){return t.minus(e)}}function o4(t){return function(e){return t.mod(e)}}function o6(t){return function(e){return t.divide(e)}}var o7=function(t){return t.toString(10)},o8={add:o2,zero:o1(0),mul:o3,one:o1(1)},o9={sub:o5,Semiring0:()=>o8},it=(s=O,function(t){return function(e){try{var n=(0,oX.default)(e,t);return q(n)}catch(t){return s}}})(10),ie={Ring0:()=>o9},ir={div:t=>e=>o6(o5(t)(ir.mod(t)(e)))(e),mod:t=>e=>{let n=e.abs();return o4(o2(o4(t)(n))(n))(n)},degree:t=>nn(e8(o0(t.abs()))),CommutativeRing0:()=>ie},io=(t,e)=>({tag:"Codec",_1:t,_2:e}),ii=Object.prototype.toString,ia=Object.prototype.hasOwnProperty,iu=(t,e,n)=>{try{return e(JSON.parse(n))}catch(e){return t(e.message)}},il=(t,e)=>isNaN(e)||!isFinite(e)?t:e,is=(t,e,n,r,o,i,a)=>{if(null==a)return t(null);let u=typeof a;return"boolean"===u?e(a):"number"===u?n(a):"string"===u?r(a):"[object Array]"===ii.call(a)?o(a):i(a)},id=t=>t,ic=t=>t,i_=(t,e,n)=>{let r={};for(var o=0;o<n.length;o++)r[t(n[o])]=e(n[o]);return r},ig=(t,e,n,r)=>ia.call(r,n)?e(r[n]):t,ip=t=>t,iv=t=>JSON.stringify(t),im=t=>O,ih=(t,e,n)=>({tag:t,_1:e,_2:n}),iC=ih("Tip"),iy=t=>e=>ih("AtKey",t,e),ib=t=>e=>ih("AtIndex",t,e),iR={eq:t=>e=>"Tip"===t.tag?"Tip"===e.tag:"AtKey"===t.tag?"AtKey"===e.tag&&t._1===e._1&&iR.eq(t._2)(e._2):"AtIndex"===t.tag&&"AtIndex"===e.tag&&t._1===e._1&&iR.eq(t._2)(e._2)},iw=t=>e=>{let n=t,r=e,o=!0,i;for(;o;){let t=n,e=r;if("AtKey"===e.tag){if("AtKey"===t.tag){if(t._1===e._1){n=t._2,r=e._2;continue}o=!1,i=O;continue}if("Tip"===t.tag){o=!1,i=M("Just",e);continue}o=!1,i=O;continue}if("AtIndex"===e.tag&&"AtIndex"===t.tag){if(t._1===e._1){n=t._2,r=e._2;continue}o=!1,i=O;continue}if("Tip"===t.tag){o=!1,i=M("Just",e);continue}o=!1,i=O}return i},iS=t=>{let e=t=>"Tip"===t.tag?"":"AtKey"===t.tag?"."+t._1+e(t._2):"AtIndex"===t.tag?"["+A(t._1)+"]"+e(t._2):void b();return"$"+e(t)},iN=t=>e=>({...e,path:t(e.path),causes:S(iN(t))(e.causes)}),iE=t=>{let e=S(e=>{var n;return(n=1===t.causes.length?"\n  ":"\n    ",function(t){return t.replace(RegExp("\n".replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)})(iE(iN(e=>{let n=iw(t.path)(e);return"Nothing"===n.tag?e:"Just"===n.tag?n._1:void b()})(e)))})(t.causes),n=t.causes.length;return(iR.eq(t.path)(iC)?""+t.message:iS(t.path)+": "+t.message)+(0===n?"":1===n?":\n  "+eY("\n  ")(e):":\n  - "+eY("\n  - ")(e))};String.fromCharCode(65535),"undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&String.prototype[Symbol.iterator],String.prototype.fromCodePoint,String.prototype.codePointAt;var ix={traverseWithIndex:t=>{let e=ix.Traversable2().sequence(t);return t=>{let n=ix.FunctorWithIndex0().mapWithIndex(t);return t=>e(n(t))}},FunctorWithIndex0:()=>t1,FoldableWithIndex1:()=>ns,Traversable2:()=>tN},iJ=e4(Z),iL=e3(Z),iA=ix.traverseWithIndex(iJ),iB=io((()=>{let t=iJ.pure({});return e=>t})(),(t=>{let e=tp(t.Semigroup0());return{pure:tc(t.mempty),Apply0:()=>e}})({mempty:tm,Semigroup0:()=>ty}).pure),ik=io(t=>{let e=is(im,im,im,q,im,im,t);return"Just"===e.tag?z("Right",e._1):"Nothing"===e.tag?z("Left",{path:iC,message:"Expected value of type String",causes:[]}):void b()},t=>td(ip(t),t)),iI=io(t=>{let e=is(im,im,im,im,im,q,t);return"Just"===e.tag?z("Right",e._1):"Nothing"===e.tag?z("Left",{path:iC,message:"Expected value of type Object",causes:[]}):void b()},t=>td(ip(t),t)),iT=io(t=>{let e=is(im,im,im,im,q,im,t);return"Just"===e.tag?z("Right",e._1):"Nothing"===e.tag?z("Left",{path:iC,message:"Expected value of type Array",causes:[]}):void b()},t=>td(ip(t),t)),iM=io(t=>{let e=is(im,im,q,im,im,im,t),n="Just"===e.tag?ne(e._1):"Nothing"===e.tag?O:void b();return"Just"===n.tag?z("Right",n._1):"Nothing"===n.tag?z("Left",{path:iC,message:"Expected value of type Int",causes:[]}):void b()},t=>td(il(0,e9(t)),t)),iO=t=>io(e=>iL.bind(iI._1(e))(t._1),e=>td(iI._2(i_(tg,tf,ee(tC.foldr,t._2(e)._1)))._1,e)),iq=t=>()=>e=>n=>{let r=t.reflectSymbol(w);return io(t=>iL.bind(n._1(t))(n=>iL.bind((()=>{let n=ig(O,q,r,t);if("Just"===n.tag){let t=e._1(n._1);return"Left"===t.tag?z("Left",iN(iy(r))(t._1)):t}if("Nothing"===n.tag)return z("Left",{path:ih("AtKey",r,iC),message:"No value found",causes:[]});b()})())(t=>iJ.pure(L(r)(t)(n)))),t=>td(tv("Cons",td(r,e._2(J(r)(t))._1),n._2(t)._1),t))},iP=io(t=>{let e=is(im,q,im,im,im,im,t);return"Just"===e.tag?z("Right",e._1):"Nothing"===e.tag?z("Left",{path:iC,message:"Expected value of type Boolean",causes:[]}):void b()},t=>td(ip(t),t)),iF=t=>io(e=>iL.bind(iT._1(e))(e=>iA(e=>n=>{let r=t._1(n);return"Left"===r.tag?z("Left",iN(ib(e))(r._1)):r})(id(e))),e=>td(ip(ic(S(e=>t._2(e)._1)(e))),e)),iD=t=>{let e=iF(t);return io(t=>{let n=e._1(t);return"Left"===n.tag?z("Left",{path:n._1.path,message:"Could not decode NonEmptyArray",causes:[n._1]}):"Right"===n.tag?n._1.length>0?z("Right",n._1):z("Left",{path:iC,message:"Could not decode NonEmptyArray, unexpected value found",causes:[]}):void b()},t=>td(e._2(t)._1,t))},iz={rowListCodec:t=>iB},iU=t=>()=>()=>e=>({rowListCodec:n=>iq(e)()(J(e.reflectSymbol(w))(n))(t.rowListCodec(n))}),iG=()=>t=>e=>iO(t.rowListCodec(e)),iQ={reflectSymbol:()=>"conditions"},ij={reflectSymbol:()=>"name"},iH={reflectSymbol:()=>"count"},iW=(r={eq:t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name},t=>eg(e=>r.eq(e)(t))),iZ=e3(K),iK=e4(K),i$=tN.traverse(iK),iV=(t=>{let e=t.Monad0(),n={Applicative0:()=>e4(e),Bind1:()=>e3(e)};return{liftEffect:n=>e.Bind1().bind(t.liftEffect(n))(t=>e.Applicative0().pure(z("Right",t))),Monad0:()=>n}})({liftEffect:t=>t,Monad0:()=>K}).liftEffect(rM),iY=(()=>{let t=tN.traverse(D);return e=>n=>t(n)(e)})(),iX=(()=>{let t=tN.traverse(D);return e=>n=>t(n)(e)})(),i1=tN.traverse(D),i0={reflectSymbol:()=>"disabled"},i2={reflectSymbol:()=>"cards"},i3=iG()(iU(iU(iU(iz)()()({reflectSymbol:()=>"others"}))()()({reflectSymbol:()=>"hand"}))()()(i2)),i5=iG()(iU(iU(iz)()()({reflectSymbol:()=>"deck"}))()()({reflectSymbol:()=>"condition"})),i4=io(t=>{let e=ik._1(t);return"Left"===e.tag?z("Left",{path:e._1.path,message:"Could not decode Id",causes:[e._1]}):"Right"===e.tag?rO(e._1)?z("Right",e._1):z("Left",{path:iC,message:"Could not decode Id, unexpected value found",causes:[]}):void b()},t=>td(ik._2(t)._1,t)),i6=io(t=>{let e=t.deck.hand,n=t.deck.others,r=t.condition;return iZ.bind(i$(t=>()=>{let e=iV();return"Left"===e.tag?z("Left",e._1):"Right"===e.tag?z("Right",{...t,id:e._1}):void b()})(t.deck.cards))(t=>iZ.bind((()=>{let e=iY(r)(e=>{let n=iX(e.conditions)(e=>{let n=i1(e=>e>=0&&e<t.length?M("Just",t[e]):O)(e.cards);return"Just"===n.tag?M("Just",{condition:{mode:e.mode,count:e.count,cards:n._1},disabled:e.disabled}):O});return"Just"===n.tag?M("Just",{conditions:n._1,disabled:e.disabled}):O}),n="Nothing"===e.tag?z("Left",{path:iC,message:"Could not decode conditions",causes:[]}):"Just"===e.tag?z("Right",e._1):void b();return()=>n})())(r=>iK.pure({deck:{cards:t,hand:e,others:n},condition:r})))},t=>td((()=>{let e=t.deck.cards;return{deck:{cards:S(t=>({name:t.name,count:t.count}))(e),hand:t.deck.hand,others:t.deck.others},condition:S(rC(iQ)()()(w)(S(t=>({mode:t.condition.mode,count:t.condition.count,cards:eb(t=>iW(t)(e))(t.condition.cards),disabled:t.disabled}))))(t.condition)}})(),t)),i7=(o=ox.show,t=>io(e=>{let n=ik._1(e);return(()=>{if("Left"===n.tag){let t=n._1;return e=>z("Left",t)}if("Right"===n.tag){let t=n._1;return e=>e(t)}b()})()(e=>{let n=t(e);return"Nothing"===n.tag?z("Left",{path:iC,message:"Unexpected value '"+e+"' found",causes:[]}):"Just"===n.tag?z("Right",n._1):void b()})},t=>td(ik._2(o(t))._1,t)))(t=>"AtLeast"===t?M("Just",oy):"JustDraw"===t?M("Just",ob):"Remains"===t?M("Just",oR):"JustRemains"===t?M("Just",ow):"Choice"===t?M("Just",oS):"LeftOne"===t?M("Just",oN):"LeftAll"===t?M("Just",oE):O),i8=iO(iU(iU(iz)()()(i0))()()(iQ).rowListCodec({conditions:iD(iO(iU(iU(iU(iU(iz)()()({reflectSymbol:()=>"mode"}))()()(i0))()()(iH))()()(i2).rowListCodec({mode:i7,count:iM,cards:iF(iM),disabled:iP}))),disabled:iP})),i9=iF(i8),at=i5({deck:i3({cards:iF(iO(iU(iU(iz)()()(ij))()()(iH).rowListCodec({name:ik,count:iM}))),others:iM,hand:iM}),condition:i9}),ae=io(t=>iZ.bind((()=>{let e=at._1(t);return()=>e})())(i6._1),t=>{let e=i6._2(t);return td(at._2(e._1)._1,e._2)}),an=iO(iU(iU(iU(iz)()()(ij))()()({reflectSymbol:()=>"id"}))()()(iH).rowListCodec({id:i4,name:ik,count:iM})),ar=iD(iO(iU(iU(iU(iz)()()({reflectSymbol:()=>"mode"}))()()(iH))()()(i2).rowListCodec({mode:i7,count:iM,cards:iF(an)}))),ao=iF(ar),ai=i5({deck:i3({cards:iF(an),others:iM,hand:iM}),condition:ao});function aa(t){return function(){t.terminate()}}var au=t=>e=>{var n;return n={name:e.name,credentials:"Omit"===e.credentials?"omit":"SameOrigin"===e.credentials?"same-origin":"Include"===e.credentials?"include":void b(),type:"Classic"===e.type?"classic":"Module"===e.type?"module":void b()},function(){return new Worker(t,n)}},al={name:"",credentials:"Omit",type:"Classic"},as=(()=>{let t=tb.foldMap1({append:t=>e=>n=>t(n)+n+e(n)});return e=>n=>r=>t(t=>{let e=n(t);return t=>e})(r)(e)})(),ad=t=>r$(e=>{let n=au("bundle/worker.js")({...al,type:"Module"});return()=>{var r,o,i;let a=n();(r=t=>e((()=>{let e=as("\n")(na),n=nu(Z)("String")(t.data);if("Left"===n.tag)return z("Left",rF(e(n._1)));if("Right"===n.tag){let t=rF("BigInt.fromString"),e=it(n._1);if("Nothing"===e.tag)return z("Left",t);if("Just"===e.tag)return z("Right",e._1)}b()})()),function(t){return function(){t.onmessage=function(t){r(t)()}}})(a)(),(o=t=>{let n=aa(a);return()=>(n(),e(z("Left",rF((()=>{let e=oc(O,q,"ErrorEvent",t);return"Nothing"===e.tag?"Unknown worker error":"Just"===e.tag?e._1.message:void b()})())))())},function(t){return function(){t.onerror=function(t){o(t)()}}})(a)(),(i=ai._2(t)._1,function(t){return function(e){return function(){e.postMessage(i,t.length>0?t:void 0)}}})([])(a)();let u=rK(aa(a));return t=>u}});function ac(t){return function(e){return function(n){return t.apply(n,[e])}}}var af=ac(Number.prototype.toPrecision),a_=ac(Number.prototype.toFixed),ag=ac(Number.prototype.toExponential),ap=(t,e)=>({tag:t,_1:e}),av=t=>e=>n=>{let r=t9.compare(t)(n),o="LT"===r?n:"EQ"===r||"GT"===r?t:void b(),i=t9.compare(e)(o);return"LT"===i||"EQ"===i?e:"GT"===i?o:void b()},am=t=>"Precision"===t.tag?af(t._1):"Fixed"===t.tag?a_(t._1):"Exponential"===t.tag?ag(t._1):void b(),ah={append:t=>t=>{}},aC=t=>t,ay=t=>e=>n=>()=>{let r=tK(q,O,t,n),o=tK(q,O,e,n);"Just"===r.tag&&"Just"===o.tag&&(t$(t,o._1,n),t$(e,r._1,n))},ab=t=>e=>n=>{let r=[...n];return ay(t)(e)(r)(),r},aR=t=>e=>n=>{if(t===e)return n;let r=[...n],o=tV(t)(1)([])(r)();return tV(e)(0)(o)(r)(),r},aw=to(o3)(o8.one),aS=(i=t=>eu(o2,[o8.zero,...t],[...t,o8.zero]),t=>eR.unfoldr1(t=>td(t._1,t._2>0?M("Just",td(i(t._1),t._2-1|0)):O))(td(t,64-1|0)))([o8.one]),aN=t=>e=>{let n=t,r=e,o=!0,i;for(;o;){let t=n,e=r;if(t<0||e<0){o=!1,i=o8.zero;continue}if(0===e){o=!1,i=o8.one;continue}if(1===e){o=!1,i=o1(t);continue}if((t-e|0)<e){n=t,r=t-e|0;continue}if(t<64){o=!1,i=aS[t][e];continue}let a=S(o1),u=aw(a(et((t-e|0)+1|0,t))),l=aw(a(et(1,e)));o=!1,i=o6(o5(u)(ir.mod(u)(l)))(l)}return i},aE=(t=>{let e={append:e=>n=>t.add(e)(n)};return tl.foldMap({mempty:t.zero,Semigroup0:()=>e})})({add:function(t){return function(e){return t+e|0}},zero:0,mul:function(t){return function(e){return t*e|0}},one:1}),ax=t=>e=>{let n=e_(t=>e=>t8.compare(t.id)(e.id))(x(x(e)(aC))(t=>t.cards));return{...t,cards:n,others:t.others+aE(t=>t.count)(tr(eC(t=>e=>t.id===e.id))(t.cards)(n))|0}},aJ=t=>aN(aE(t=>t.count)(t.cards)+t.others|0)(t.hand),aL=(t,e,n)=>({tag:"Calculate",_1:t,_2:e,_3:n}),aA=(t=>{let e=n$(t.MonadEffect0());return{liftAff:e=>tI(tT("Bind",nG("Lift",t.liftAff(e)),t=>tI(tT("Return",t),tL)),tL),MonadEffect0:()=>e}})({liftAff:t=>t,MonadEffect0:()=>ot}).liftAff,aB=(a=or,{throwError:t=>tI(tT("Bind",nG("Lift",a.throwError(t)),t=>tI(tT("Return",t),tL)),tL),Monad0:()=>tO}).throwError,ak=ti(tD)(tu),aI=t=>e=>n=>aL(t,e,n),aT={initialState:t=>({combination:o8.zero,total:o8.zero,calculation:O}),render:t=>{var e;return nk("Elem",O,"div",[rm("flex min-w-60 items-center")],[nk("Elem",O,"div",[rm("mx-1 flex w-36 items-center justify-end gap-1")],"Just"===t.calculation.tag?[nk("Elem",O,"div",[rm("text-2xl")],[nk("Text","Calculating")]),nk("Elem",O,"i",[rm("fa-solid fa-spinner fa-pulse")],[])]:[nk("Elem",O,"div",[rm("text-2xl")],[nk("Text",(e=t.total,function(t){return e.equals(t)})(o8.zero)?"N/A":am(ap("Fixed",av(0)(20)(4)))(100*(o0(t.combination)/o0(t.total)))+"%")])]),nk("Elem",O,"div",[rm("mx-1 flex min-w-20 flex-col items-end divide-y divide-gray-400")],[nk("Elem",O,"div",[rm("px-1")],[nk("Text",o7(t.combination))]),nk("Elem",O,"div",[rm("px-1")],[nk("Text",o7(t.total))])])])},eval:ra({...ru,handleQuery:t=>{let e=t._3,n=ax(t._1)(t._2),r=aA(oo(ad({deck:n,condition:t._2})));return tI(tT("Bind",nG("Fork",(()=>{let t=t=>{if("Left"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>td(void 0,{combination:o8.zero,total:o8.zero,calculation:O})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>aB(e),tE(tm,tm)))}if("Right"===t.tag){let e={combination:t._1,total:aJ(n),calculation:O};return tI(tT("Bind",nG("State",t=>td(void 0,e)),t=>tI(tT("Return",t),tL)),tL)}b()};return tI(r._1,"CatNil"===r._2.tag?tJ("CatCons",t,tE(tm,tm)):"CatCons"===r._2.tag?tJ("CatCons",r._2._1,tE(r._2._2._1,tv("Cons",tJ("CatCons",t,tE(tm,tm)),r._2._2._2))):void b())})(),nQ),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>tI(tT("Bind",nG("State",t=>td(t.calculation,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",n=>tI(tT("Bind",nG("State",e=>td(void 0,{...e,calculation:M("Just",t)})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let t=ak(nV)(n);return tI(t._1,"CatNil"===t._2.tag?tJ("CatCons",()=>tI(tT("Return",e),tL),tE(tm,tm)):"CatCons"===t._2.tag?tJ("CatCons",t._2._1,tE(t._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",e),tL),tE(tm,tm)),t._2._2._2))):void b())},tE(tm,tm))),tE(tm,tm))),tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))))}})},aM=(t,e)=>({tag:t,_1:e}),aO=(t,e,n,r)=>({tag:t,_1:e,_2:n,_3:r}),aq={reflectSymbol:()=>"line"},aP=os()(aq)(rP),aF={reflectSymbol:()=>"result"},aD=ol()(aF)(t7),az=(t=>{let e=t.foldr;return t=>{let n=ee(e,t);return n.length>0?M("Just",n):O}})(eO),aU=om()(aq)(rP),aG=ov()(aF)(t7),aQ=tQ(tO).apply,aj=tG(tO),aH=(()=>{let t=tZ(tO),e=t.Plus1().empty;return n=>n?t.Applicative0().pure():e})(),aW=tH(nK),aZ=tN.traverse(D),aK=t=>e=>{let n=e,r=!0,o;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,o=O;continue}if("Node"===e.tag){let i=t8.compare(t)(e._3);if("LT"===i){n=e._5;continue}if("GT"===i){n=e._6;continue}if("EQ"===i){r=!1,o=M("Just",e._4);continue}}b()}return o},a$=tI(tT("Bind",nG("State",t=>td(t,t)),t=>tI(tT("Return",t),tL)),tL),aV=tN.traverse(tD),aY={reflectSymbol:()=>"id"},aX=n$(ot).liftEffect(rM),a1=ta(tD)(tl),a0=ov()(aq)(rP),a2=tj(tO).pure,a3=t=>aO("GetConditions",t),a5=t=>aO("Export",t),a4=t=>e=>n=>aO("RestoreState",t,e,n),a6=t=>aO("ToggleDisabled",t),a7=aM("Initialize"),a8=aM("AddCondition"),a9=aM("Calculate"),ut=(()=>{let t=tF.apply((()=>{let t=S(t=>t.id);return tI(tT("Bind",nG("State",t=>td(t.conditions,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",e=>tI(tT("Return",t(ei(t=>t.disabled,e))),tL),tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",e=>az(eD(rP)(e=>em(rq)(e)(t))(e))),tL),tE(tm,tm)),tm))))})())(aU(w)(oj)),e=tI(tT("Bind",nG("State",t=>td(t.deck,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",e=>"CatNil"===t._2.tag?tI(t._1,tJ("CatCons",t=>tI(tT("Return",ee(tu.foldr,t)),tL),tE(tm,tv("Cons",tJ("CatCons",t=>aG(w)()(aI(e)(t)),tE(tm,tm)),tm)))):"CatCons"===t._2.tag?tI(t._1,tJ("CatCons",t._2._1,tE(t._2._2._1,tv("Cons",tJ("CatCons",t=>aG(w)()(aI(e)(t)),tE(tm,tm)),tv("Cons",tJ("CatCons",t=>tI(tT("Return",ee(tu.foldr,t)),tL),tE(tm,tm)),t._2._2._2))))):void b(),tE(tm,tm))),n=t=>{if("Initialize"===t.tag){let t=n(a8);return tI(t._1,"CatNil"===t._2.tag?tJ("CatCons",()=>e,tE(tm,tm)):"CatCons"===t._2.tag?tJ("CatCons",t._2._1,tE(t._2._2._1,tv("Cons",tJ("CatCons",()=>e,tE(tm,tm)),t._2._2._2))):void b())}if("AddCondition"===t.tag)return tI(tT("Bind",nG("State",t=>td(t.conditions,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>{let e=e=>tI(tT("Bind",nG("State",n=>td(void 0,{...n,conditions:ec(t)({id:e,disabled:!1})})),t=>tI(tT("Return",t),tL)),tL);return tI(aX._1,"CatNil"===aX._2.tag?tJ("CatCons",e,tE(tm,tm)):"CatCons"===aX._2.tag?tJ("CatCons",aX._2._1,tE(aX._2._2._1,tv("Cons",tJ("CatCons",e,tE(tm,tm)),aX._2._2._2))):void b())},tE(tm,tm)));if("RemoveCondition"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>{let n={...t,conditions:ei(t=>t.id!==e,t.conditions)};return td(n,n)}),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>0===t.conditions.length?tI(tT("Bind",nG("Raise","AllConditionDeleted",void 0),t=>tI(tT("Return",t),tL)),tL):n(a9),tE(tm,tm)))}if("ToggleItemDisabled"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>td(void 0,(()=>{let n=en(q,O,t=>t.id===e,t.conditions);if("Just"===n.tag){let e=ef(n._1)(t=>({...t,disabled:!t.disabled}))(t.conditions);if("Just"===e.tag)return{...t,conditions:e._1};if("Nothing"===e.tag)return t;b()}if("Nothing"===n.tag)return t;b()})())),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>n(a9),tE(tm,tm)))}if("Receive"===t.tag){let n=t._1;return tI(tT("Bind",nG("State",t=>td(t.deck,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>t2(t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name)(n.cards)(t.cards)&&n.hand===t.hand&&n.others===t.others?tI(tT("Return",void 0),tL):tI(tT("Bind",nG("State",t=>td(void 0,{...t,deck:n})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>e,tE(tm,tm))),tE(tm,tm)))}if("Calculate"===t.tag)return tI(e._1,tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Bind",nG("Raise","Updated",void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)),e._2._2._2))));b()};return{initialState:t=>({conditions:[],deck:t,disabled:!1}),render:t=>nk("Elem",O,"div",[rv(["grow rounded border-2 border-violet-300 p-1",t.disabled?"bg-slate-100 text-gray-400":"bg-white text-gray-700"])],[nk("Elem",O,"div",[rm("flex items-center justify-end gap-1")],[nk("Elem",O,"div",[rm(t.disabled?"mr-auto w-0 py-1 pl-3 text-xl":"hidden")],[nk("Text","Disabled")]),nk("Elem",O,"div",[rm(t.disabled?"text-gray-400":"text-black")],[aD(w)()(aT)()])]),nk("Elem",O,"ul",[rm("my-1")],S((()=>{let e=t.deck.cards;return t=>nk("Elem",O,"li",[rv(["flex gap-1 rounded px-1",t.disabled?"bg-slate-100 text-gray-400 line-through":"bg-transparent"])],[nk("Elem",O,"div",[rm("mx-1 flex")],[rb(nk("Elem",O,"i",[rm("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(aM("RemoveCondition",t.id)),rb(nk("Elem",O,"i",[rm("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(aM("ToggleItemDisabled",t.id))]),nk("Elem",O,"div",[rm("min-w-0 grow")],[aP(w)(t.id)(oY)(e)(t=>a9)])])})())(t.conditions)),nk("Elem",O,"div",[rm("px-1")],[rb(nk("Elem",O,"i",[rm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(a8)])]),eval:ra({...ru,handleAction:n,handleQuery:n=>{if("GetConditions"===n.tag)return aQ((()=>{let t=aj.bind(aW.state(t=>td(t.disabled,t)))(t=>aH(!t));return tI(t._1,"CatNil"===t._2.tag?tJ("CatCons",t=>tI(tT("Return","Just"===t.tag?M("Just",t=>n._1(t)):O),tL),tE(tm,tm)):"CatCons"===t._2.tag?tJ("CatCons",t._2._1,tE(t._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return","Just"===t.tag?M("Just",t=>n._1(t)):O),tL),tE(tm,tm)),t._2._2._2))):void b())})())(t);if("Export"===n.tag)return tF.apply(tI(a$._1,tJ("CatCons",t=>tI(tT("Return",(()=>{let e=t.conditions,r=t.disabled;return t=>{let o=e.length>0?aZ(e=>{let n=aK(e.id)(t);return"Just"===n.tag?M("Just",{condition:n._1,disabled:e.disabled}):O})(e):O;return"Just"===o.tag?M("Just",n._1({conditions:o._1,disabled:r})):O}})()),tL),tE(tm,tm))))(aU(w)(oj));if("RestoreState"===n.tag){let t=n._3,r=n._1,o=n._2.disabled,i=aV("CatNil"===aX._2.tag?t=>tI(aX._1,tJ("CatCons",t=>tI(tT("Return",rh(aY)()()(w)(t)),tL),tE(tm,tv("Cons",tJ("CatCons",e=>tI(tT("Return",e(t)),tL),tE(tm,tm)),tm)))):"CatCons"===aX._2.tag?t=>tI(aX._1,tJ("CatCons",aX._2._1,tE(aX._2._2._1,tv("Cons",tJ("CatCons",e=>tI(tT("Return",e(t)),tL),tE(tm,tm)),tv("Cons",tJ("CatCons",t=>tI(tT("Return",rh(aY)()()(w)(t)),tL),tE(tm,tm)),aX._2._2._2))))):t=>{b()})(n._2.conditions),a=n=>{let i={conditions:S(t=>({id:t.id,disabled:t.disabled}))(n),deck:r,disabled:o};return tI(tT("Bind",nG("State",t=>td(void 0,i)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let o=a1(n)(t=>a0(w)(t.id)(oH(r.cards)(t.condition))),i=()=>tI(e._1,tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>tI(tT("Return",t),tL),tE(tm,tm)),e._2._2._2))));return tI(o._1,"CatNil"===o._2.tag?tJ("CatCons",i,tE(tm,tm)):"CatCons"===o._2.tag?tJ("CatCons",o._2._1,tE(o._2._2._1,tv("Cons",tJ("CatCons",i,tE(tm,tm)),o._2._2._2))):void b())},tE(tm,tm)))};if("CatNil"===i._2.tag)return tI(i._1,tJ("CatCons",a,tE(tm,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tm))));if("CatCons"===i._2.tag)return tI(i._1,tJ("CatCons",i._2._1,tE(i._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",M("Just",t)),tL),tE(tm,tm)),tv("Cons",tJ("CatCons",a,tE(tm,tm)),i._2._2._2)))));b()}if("ToggleDisabled"===n.tag){let t=n._1;return aj.bind(aW.state(t=>td(void 0,{...t,disabled:!t.disabled})))(()=>a2(t))}b()},receive:t=>M("Just",aM("Receive",t)),initialize:M("Just",a7)})}})(),ue={mempty:void 0,Semigroup0:()=>ah};function un(t){return t.dataTransfer}var ur=(t,e,n)=>({tag:t,_1:e,_2:n}),uo=(t,e)=>({tag:"SetDeck",_1:t,_2:e}),ui=(()=>{let t=nx("type");return e=>t(e1(e))})(),ua=nx("value"),uu=tG(tO).bind,ul=(()=>{let t=tH(nK);return e=>t.state(t=>td(void 0,e))})(),us=tj(tO).pure,ud=n$(ot),uc=ud.liftEffect(rM),uf=tI(tT("Bind",nG("State",t=>td(t,t)),t=>tI(tT("Return",t),tL)),tL),u_=(()=>{let t=tU(ue).mempty;return e=>"Nothing"===e.tag?t:"Just"===e.tag?e._1:void b()})(),ug=t=>e=>n=>{let r=t9.compare(t)(n),o="LT"===r?n:"EQ"===r||"GT"===r?t:void b(),i=t9.compare(e)(o);return"LT"===i||"EQ"===i?e:"GT"===i?o:void b()},up=t=>e=>{let n=t9.compare(t)(e);return"LT"===n||"EQ"===n?t:"GT"===n?e:void b()},uv=ti(Y)(tu),um=t2(t0),uh=ti(tD)(tu),uC=t=>e=>uo(t,e),uy=ur("AddCard"),ub=t=>ur("UpdateDeck",t),uR=t=>ur("UpdateHand",t),uw=t=>ur("UpdateOthers",t),uS=t=>e=>ur("StartReorder",t,e),uN=t=>e=>ur("ExecuteReorder",t,e),uE=(()=>{let t=eY(" ")(["appearance-none rounded-none border-b border-transparent bg-white p-1 text-gray-700","transition-colors duration-75 hover:border-gray-500 focus:border-slate-800 focus:outline-none"]),e=eY(" ")(["w-16 text-right",t]),n=(t,n,r,o,i)=>nk("Elem",O,"div",[rm("mx-1 flex flex-wrap justify-end border-b border-gray-500")],[nk("Elem",O,"div",[rm("m-1")],[nk("Text",t)]),nk("Elem",O,"input",[rm(e),ui(eX),ua(A(n)),rd(rA("Step",1)),rf(e9(r)),r_(e9(o)),nE("Handler","focus",t=>M("Just",e0("Action",ur("SelectOnFocus",t)))),og("change")("value")(nl(Z))(t=>i((()=>{let e=nt(t);return"Nothing"===e.tag?0:"Just"===e.tag?e._1:void b()})()))],[])]),r={append:t=>e=>t+e|0},o=tl.foldMap({mempty:0,Semigroup0:()=>r})(t=>t.count),i=t=>{var e,n;if("AddCard"===t.tag)return tI(uc._1,"CatNil"===uc._2.tag?tJ("CatCons",t=>tI(tT("Bind",nG("State",e=>td(void 0,{...e,cards:ec(e.cards)({id:t,name:"",count:0})})),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)):"CatCons"===uc._2.tag?tJ("CatCons",uc._2._1,tE(uc._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Bind",nG("State",e=>td(void 0,{...e,cards:ec(e.cards)({id:t,name:"",count:0})})),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)),uc._2._2._2))):void b());if("RemoveCard"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>{let n={...t,cards:eC(t=>e=>t.id===e.id)(e)(t.cards),others:t.others+e.count|0};return td(n,n)}),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>tI(tT("Bind",nG("Raise",{...t,cards:ei(t=>""!==t.name,t.cards)},void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("UpdateCard"===t.tag){let e=t._1;return tI(uf._1,tJ("CatCons",t=>u_((()=>{let n=en(q,O,t=>t.id===e.id,t.cards);if("Just"===n.tag){if(n._1>=0&&n._1<t.cards.length){let r=t.cards[n._1],o=""===e.name?{...e,count:0}:{...e,count:ug(0)(r.count+t.others|0)(e.count)},i=eo(q,O,n._1,o,t.cards);if("Just"===i.tag){let e=i._1;return M("Just",tI(tT("Bind",nG("State",n=>{let i={...n,cards:e,others:t.others-(o.count-r.count|0)|0};return td(i,i)}),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>tI(tT("Bind",nG("Raise",{...t,cards:ei(t=>""!==t.name,t.cards)},void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm))))}if("Nothing"===i.tag)return O;b()}return O}if("Nothing"===n.tag)return O;b()})()),tE(tm,tm)))}if("UpdateDeck"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>td(t.cards,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>i(ur("UpdateOthers",e-o(t)|0)),tE(tm,tm)))}if("UpdateHand"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>{let n={...t,hand:ug(1)(o(t.cards)+t.others|0)(e)};return td(n,n)}),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>tI(tT("Bind",nG("Raise",{...t,cards:ei(t=>""!==t.name,t.cards)},void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("UpdateOthers"===t.tag){let e=t._1;return tI(tT("Bind",nG("State",t=>{let n=o(t.cards),r=ug(n)(255)(n+e|0),i={...t,others:r-n|0,hand:up(t.hand)(r)};return td(i,i)}),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>tI(tT("Bind",nG("Raise",{...t,cards:ei(t=>""!==t.name,t.cards)},void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm)))}if("SelectOnFocus"===t.tag)return ud.liftEffect(uv(of)((()=>{let e=e2(t._1.target,O,q);return"Just"===e.tag?oc(O,q,"HTMLInputElement",e._1):"Nothing"===e.tag?O:void b()})()));if("StartReorder"===t.tag){let n=t._1,r=un(t._2),o=ud.liftEffect((e="tcg-calculator/card",function(t){return function(n){return function(){return n.setData(e,t)}}})(n)(r)),i=()=>tI(tT("Bind",nG("GetRef",n,nQ),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>ud.liftEffect(uv(t=>{var e;return(e=t,function(t){return function(n){return function(){return r.setDragImage(e,t,n)}}})(5)(15)})(t)),tE(tm,tm)));return tI(o._1,"CatNil"===o._2.tag?tJ("CatCons",i,tE(tm,tm)):"CatCons"===o._2.tag?tJ("CatCons",o._2._1,tE(o._2._2._1,tv("Cons",tJ("CatCons",i,tE(tm,tm)),o._2._2._2))):void b())}if("HandleDragBehavior"===t.tag){let e=ud.liftEffect(od(t._1));return um(un(t._1).types)(["tcg-calculator/card"])?e:tI(tT("Return",void 0),tL)}if("ExecuteReorder"===t.tag){let e=t._1,r=t._2,o=ud.liftEffect((n="tcg-calculator/card",function(t){return function(){return t.getData(n)}})(un(r))),i=t=>{let n=""===t,o=ud.liftEffect(od(r)),i=()=>tI(tT("Bind",nG("State",t=>td(t.cards,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",n=>uh(t=>tI(tT("Bind",nG("State",e=>{let n={...e,cards:t};return td(n,n)}),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>tI(tT("Bind",nG("Raise",{...t,cards:ei(t=>""!==t.name,t.cards)},void 0),t=>tI(tT("Return",t),tL)),tL),tE(tm,tm))))((()=>{if(rO(t)&&t!==e){let r=en(q,O,e=>e.id===t,n);if("Just"===r.tag){let t=en(q,O,t=>t.id===e,n);if("Just"===t.tag)return M("Just",aR(r._1)(t._1)(n));if("Nothing"===t.tag)return O;b()}if("Nothing"===r.tag)return O;b()}return O})()),tE(tm,tm))),a=tI(o._1,"CatNil"===o._2.tag?tJ("CatCons",i,tE(tm,tm)):"CatCons"===o._2.tag?tJ("CatCons",o._2._1,tE(o._2._2._1,tv("Cons",tJ("CatCons",i,tE(tm,tm)),o._2._2._2))):void b());return n?n?tI(tT("Return",void 0),tL):void b():a};return tI(o._1,"CatNil"===o._2.tag?tJ("CatCons",i,tE(tm,tm)):"CatCons"===o._2.tag?tJ("CatCons",o._2._1,tE(o._2._2._1,tv("Cons",tJ("CatCons",i,tE(tm,tm)),o._2._2._2))):void b())}b()};return{initialState:t=>({cards:[],others:40,hand:5}),render:r=>{let i=r.others,a=o(r.cards);return nk("Elem",O,"div",[rm("rounded border-2 border-amber-500 p-1")],[(()=>{let t=a+i|0;return nk("Elem",O,"div",[rm("flex gap-1")],[nk("Elem",O,"div",[rm("mx-1 flex grow flex-wrap text-sky-900")],[ry("fa-layer-group")(["m-1 text-2xl"]),nk("Elem",O,"div",[rm("m-1")],[nk("Text","デッキ情報")])]),n("手札枚数:",r.hand,1,t,uR),n("デッキ枚数:",t,a,255,ub)])})(),nk("Keyed",O,"ul",[rm("m-1"),nE("Handler","dragenter",t=>M("Just",e0("Action",ur("HandleDragBehavior",t)))),nE("Handler","dragover",t=>M("Just",e0("Action",ur("HandleDragBehavior",t))))],S(n=>{let r=n.id;return td(r,nk("Elem",O,"li",[rm("flex"),nE("Ref",t=>M("Just",e0("RefUpdate",r,"Created"===t.tag?M("Just",t._1):"Removed"===t.tag?O:void b()))),(()=>{let t=uN(n.id);return nE("Handler","drop",e=>M("Just",e0("Action",t(e))))})()],[nk("Elem",O,"div",[rm("mx-1 flex items-center")],[nk("Elem",O,"div",[rm("hidden cursor-grab px-1 text-gray-500 active:cursor-grabbing md:block"),rp(!0),(()=>{let t=uS(n.id);return nE("Handler","dragstart",e=>M("Just",e0("Action",t(e))))})()],[nk("Elem",O,"i",[rm("fa-solid fa-grip-vertical")],[])]),rb(nk("Elem",O,"i",[rm("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(ur("RemoveCard",n))]),nk("Elem",O,"div",[rm("flex grow border-b border-gray-500")],[nk("Elem",O,"input",[rv(["grow",t]),ui("InputText"),ua(n.name),og("change")("value")(nl(Z))(t=>ur("UpdateCard",{...n,name:t}))],[]),nk("Elem",O,"input",[rm(e),ui(eX),rd(rA("Step",1)),ua(A(n.count)),rf(0),r_(""===n.name?0:e9(n.count+i|0)),nE("Handler","focus",t=>M("Just",e0("Action",ur("SelectOnFocus",t)))),og("change")("value")(nl(Z))(t=>ur("UpdateCard",(()=>{let e=nt(t);return{...n,count:"Nothing"===e.tag?0:"Just"===e.tag?e._1:void b()}})()))],[])])]))})(r.cards)),nk("Elem",O,"div",[rm("flex gap-1")],[nk("Elem",O,"div",[rm("mx-1 grow")],[rb(nk("Elem",O,"i",[rm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(uy)]),n("その他のカード:",i,0,255-a|0,uw)])])},eval:ra({...ru,handleAction:i,handleQuery:t=>{let e=t._2;return uu(ul(t._1))(()=>us(e))}})}})();function ux(t){return function(e){return t===e}}var uJ=ti(Y)(tl),uL=t=>t,uA=()=>{let t=[];return{emitter:e=>()=>(t=[...t,e],()=>{let n=t;t=eC(ux)(e)(n)}),listener:e=>{let n=uJ(t=>t(e));return()=>n(t)()}}},uB=t=>(function(t,e,n){try{return e(decodeURIComponent(n))}catch(e){return t(e)}})(t=>O,q,t),uk=function(){return window};function uI(t){return function(){return t.document}}function uT(t){return function(){return t.location}}var uM=t=>()=>{var e;return(e=uT(uk())(),function(){e.hash=t})()},uO=()=>{var t;let e=(t=uT(uk())(),function(){return t.hash})(),n=nr("#")(e);return"Nothing"===n.tag?"":"Just"===n.tag?n._1:void b()},uq=t=>e=>()=>{let n=e(uO())(),r=uk(),o=nR(e=>()=>{let e=n,r=uO();return n=t(e)(r)()})();return nw("hashchange")(o)(!1)(r)(),nS("hashchange")(o)(!1)(r)},uP=t=>e=>n=>{let r=r=>{let o=t.foldl(t=>e=>"Just"===t.elem.tag?t:0===t.pos?{elem:M("Just",e),pos:t.pos}:{pos:t.pos+1|0,elem:t.elem})({elem:O,pos:0});return t=>{let i=o(e(t)).elem;if("Nothing"===i.tag)return()=>r;if("Just"===i.tag){let t=i._1,e=n(r)(t);return()=>(e(),M("Just",t))}b()}};return uq(t=>r(t))(r(O))},uF=(t,e,n)=>({tag:t,_1:e,_2:n}),uD={reflectSymbol:()=>"result"},uz={reflectSymbol:()=>"deck"},uU={reflectSymbol:()=>"condition"},uG=os()(uU)(rP),uQ=n$(ot),uj=uQ.liftEffect(rM),uH=ov()(uz)(t7),uW=ov()(uU)(rP),uZ=om()(uU)(rP),uK=ov()(uD)(t7),u$=tN.traverse(tD),uV=ta(tD)(tl),uY=tI(tT("Bind",nG("State",t=>td(t,t)),t=>tI(tT("Return",t),tL)),tL),uX=t=>e=>{let n=e,r=!0,o;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,o=O;continue}if("Node"===e.tag){let i=t8.compare(t)(e._3);if("LT"===i){n=e._5;continue}if("GT"===i){n=e._6;continue}if("EQ"===i){r=!1,o=M("Just",e._4);continue}}b()}return o},u1=uF("Initialize"),u0=uF("PrepareDefaultState"),u2=t=>uF("UpdateDeck",t),u3=uF("AddCondition"),u5=t=>e=>uF("ReceiveConditionUpdated",t,e),u4=uF("Calculate"),u6=uF("SaveState"),u7=(()=>{let t=e=>{if("Initialize"===e.tag){let t=uQ.liftEffect(uA);return tI(t._1,"CatNil"===t._2.tag?tJ("CatCons",t=>{let e=t.emitter;return tI(tT("Bind",nG("Subscribe",t=>e,nQ),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=uQ.liftEffect(uP(tu)(uB)(e=>e=>t.listener(""===e?u0:uF("RestoreState",e))));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",t=>tI(tT("Return",void 0),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",void 0),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tm)))},tE(tm,tm)):"CatCons"===t._2.tag?tJ("CatCons",t._2._1,tE(t._2._2._1,tv("Cons",tJ("CatCons",t=>{let e=t.emitter;return tI(tT("Bind",nG("Subscribe",t=>e,nQ),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=uQ.liftEffect(uP(tu)(uB)(e=>e=>t.listener(""===e?u0:uF("RestoreState",e))));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",t=>tI(tT("Return",void 0),tL),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",t=>tI(tT("Return",void 0),tL),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tm)))},tE(tm,tm)),t._2._2._2))):void b())}if("PrepareDefaultState"===e.tag){let e=e=>{let n={cards:[{id:e,name:"Card1",count:3}],others:37,hand:5};return tI(tT("Bind",nG("State",t=>td(void 0,{deck:n,conditions:[]})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let e=uH(w)()(uC(n));return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",()=>t(u3),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",()=>t(u3),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tm)))};return tI(uj._1,"CatNil"===uj._2.tag?tJ("CatCons",e,tE(tm,tm)):"CatCons"===uj._2.tag?tJ("CatCons",uj._2._1,tE(uj._2._2._1,tv("Cons",tJ("CatCons",e,tE(tm,tm)),uj._2._2._2))):void b())}if("UpdateDeck"===e.tag){let n=e._1;return tI(tT("Bind",nG("State",t=>td(void 0,{...t,deck:n})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>t(u4),tE(tm,tm)))}if("AddCondition"===e.tag){let e=e=>tI(tT("Bind",nG("State",t=>td(void 0,{...t,conditions:ec(t.conditions)(e)})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>t(u4),tE(tm,tm)));return tI(uj._1,"CatNil"===uj._2.tag?tJ("CatCons",e,tE(tm,tm)):"CatCons"===uj._2.tag?tJ("CatCons",uj._2._1,tE(uj._2._2._1,tv("Cons",tJ("CatCons",e,tE(tm,tm)),uj._2._2._2))):void b())}if("RemoveCondition"===e.tag){let n=e._1;return tI(tT("Bind",nG("State",t=>td(void 0,{...t,conditions:eC(rq.eq)(n)(t.conditions)})),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>t(u4),tE(tm,tm)))}if("ToggleDisabled"===e.tag){let n=uW(w)(e._1)(a6);return tI(n._1,"CatNil"===n._2.tag?tJ("CatCons",()=>t(u4),tE(tm,tm)):"CatCons"===n._2.tag?tJ("CatCons",n._2._1,tE(n._2._2._1,tv("Cons",tJ("CatCons",()=>t(u4),tE(tm,tm)),n._2._2._2))):void b())}if("Swap"===e.tag){let t=e._1,n=e._2;return tI(tT("Bind",nG("State",e=>td(void 0,{...e,conditions:ab(t)(n)(e.conditions)})),t=>tI(tT("Return",t),tL)),tL)}if("ReceiveConditionUpdated"===e.tag){if("Updated"===e._2)return t(u4);if("AllConditionDeleted"===e._2)return t(uF("RemoveCondition",e._1));b()}if("Calculate"===e.tag)return tI(tT("Bind",nG("State",t=>td(t.deck,t)),t=>tI(tT("Return",t),tL)),tJ("CatCons",t=>{let e=uZ(w)(a3);return tI(e._1,"CatNil"===e._2.tag?tJ("CatCons",e=>uK(w)()(aI(t)(ee(eO.foldr,e))),tE(tm,tm)):"CatCons"===e._2.tag?tJ("CatCons",e._2._1,tE(e._2._2._1,tv("Cons",tJ("CatCons",e=>uK(w)()(aI(t)(ee(eO.foldr,e))),tE(tm,tm)),e._2._2._2))):void b())},tE(tm,tm)));if("RestoreState"===e.tag){let n=uQ.liftEffect(e3(K).bind((()=>{let t=iu(U,G,e._1),n="Left"===t.tag?z("Left",{path:iC,message:t._1,causes:[]}):"Right"===t.tag?z("Right",t._1):void b();return()=>n})())(ae._1)),r=e=>{if("Left"===e.tag){var n;let r=uQ.liftEffect((n=iE(e._1),function(){console.error(n)}));return tI(r._1,"CatNil"===r._2.tag?tJ("CatCons",()=>t(u0),tE(tm,tm)):"CatCons"===r._2.tag?tJ("CatCons",r._2._1,tE(r._2._2._1,tv("Cons",tJ("CatCons",()=>t(u0),tE(tm,tm)),r._2._2._2))):void b())}if("Right"===e.tag){let n=e._1.deck,r=u$("CatNil"===uj._2.tag?t=>tI(uj._1,tJ("CatCons",t=>tI(tT("Return",e=>({id:t,condition:e})),tL),tE(tm,tv("Cons",tJ("CatCons",e=>tI(tT("Return",e(t)),tL),tE(tm,tm)),tm)))):"CatCons"===uj._2.tag?t=>tI(uj._1,tJ("CatCons",uj._2._1,tE(uj._2._2._1,tv("Cons",tJ("CatCons",e=>tI(tT("Return",e(t)),tL),tE(tm,tm)),tv("Cons",tJ("CatCons",t=>tI(tT("Return",e=>({id:t,condition:e})),tL),tE(tm,tm)),uj._2._2._2))))):t=>{b()})(e._1.condition),o=e=>{let r={deck:n,conditions:S(t=>t.id)(e)};return tI(tT("Bind",nG("State",t=>td(void 0,r)),t=>tI(tT("Return",t),tL)),tJ("CatCons",()=>{let r=uH(w)()(uC(n)),o=()=>{let r=uV(e)(t=>uW(w)(t.id)(a4(n)(t.condition)));return tI(r._1,"CatNil"===r._2.tag?tJ("CatCons",()=>t(u4),tE(tm,tm)):"CatCons"===r._2.tag?tJ("CatCons",r._2._1,tE(r._2._2._1,tv("Cons",tJ("CatCons",()=>t(u4),tE(tm,tm)),r._2._2._2))):void b())};return tI(r._1,"CatNil"===r._2.tag?tJ("CatCons",o,tE(tm,tm)):"CatCons"===r._2.tag?tJ("CatCons",r._2._1,tE(r._2._2._1,tv("Cons",tJ("CatCons",o,tE(tm,tm)),r._2._2._2))):void b())},tE(tm,tm)))};return tI(r._1,"CatNil"===r._2.tag?tJ("CatCons",o,tE(tm,tm)):"CatCons"===r._2.tag?tJ("CatCons",r._2._1,tE(r._2._2._1,tv("Cons",tJ("CatCons",o,tE(tm,tm)),r._2._2._2))):void b())}b()};return tI(n._1,"CatNil"===n._2.tag?tJ("CatCons",r,tE(tm,tm)):"CatCons"===n._2.tag?tJ("CatCons",n._2._1,tE(n._2._2._1,tv("Cons",tJ("CatCons",r,tE(tm,tm)),n._2._2._2))):void b())}if("SaveState"===e.tag)return tI(uY._1,tJ("CatCons",t=>{let e=t.deck,n=t.conditions,r=uZ(w)(a5),o=t=>uQ.liftEffect(uM(iv(ae._2({deck:e,condition:eb(e=>uX(e)(t))(n)})._1)));return tI(r._1,"CatNil"===r._2.tag?tJ("CatCons",o,tE(tm,tm)):"CatCons"===r._2.tag?tJ("CatCons",r._2._1,tE(r._2._2._1,tv("Cons",tJ("CatCons",o,tE(tm,tm)),r._2._2._2))):void b())},tE(tm,tm)));b()};return{initialState:t=>({deck:{cards:[],others:0,hand:0},conditions:[]}),render:t=>{let e=t.deck;return nk("Elem",O,"div",[rm("relative overflow-x-clip")],[nk("Elem",O,"header",[rm("flex items-baseline px-2")],[nk("Elem",O,"h1",[rm("p-1 text-lg")],[nk("Elem",O,"a",[rg(".")],[nk("Text","Draw Calculator")])]),nk("Text","-"),nk("Elem",O,"h2",[rm("p-1")],[nk("Text","TCG 用ドロー確率計算機")])]),nk("Elem",O,"main",[rm("relative mb-[80vh] flex max-w-4xl flex-col gap-3 p-1")],[nk("Elem",O,"div",[rm("flex flex-wrap gap-1")],[nk("Elem",O,"div",[rm("grow")],[os()(uz)(t7)(w)()(uE)()(u2)]),nk("Elem",O,"div",[rm("flex grow basis-0 items-center rounded border-2 border-cyan-400 p-1")],[nk("Elem",O,"div",[rm("flex w-full justify-between gap-1")],[nk("Elem",O,"div",[],[rb(nk("Text","Save"))("border border-rose-500 hover:bg-rose-100")(u6)]),ol()(uD)(t7)(w)()(aT)()])])]),nk("Elem",O,"ul",[rm("flex flex-col gap-1")],tX(t=>n=>nk("Elem",O,"li",[rm("flex items-start gap-1")],[nk("Elem",O,"div",[rm("flex flex-col")],[rb(nk("Elem",O,"i",[rm("fa-solid fa-angle-up")],[]))("text-gray-500 hover:bg-gray-200")(uF("Swap",t-1|0,t)),rb(nk("Elem",O,"i",[rm("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(uF("RemoveCondition",n)),rb(nk("Elem",O,"i",[rm("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(uF("ToggleDisabled",n)),rb(nk("Elem",O,"i",[rm("fa-solid fa-angle-down")],[]))("text-gray-500 hover:bg-gray-200")(uF("Swap",t,t+1|0))]),uG(w)(n)(ut)(e)(u5(n))]))(t.conditions)),nk("Elem",O,"div",[],[rb(nk("Elem",O,"i",[rm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(u3)])]),nk("Elem",O,"footer",[rm("flex items-baseline px-2")],[nk("Elem",O,"a",[rm("m-1 rounded border border-sky-500 px-2 py-1 text-sm"),rg("https://github.com/acple/tcg-calculator"),rc("_blank"),rs("noopener noreferrer")],[nk("Text","→ 使い方とかソース")])])])},eval:ra({...ru,handleAction:t,initialize:M("Just",u1)})}})(),u8=function(t){return function(e){return function(){return e[t]}}};u8("children"),u8("firstElementChild"),u8("lastElementChild"),u8("childElementCount");var u9=t=>e=>{var n;let r=(n=e,function(){return n.querySelector(t)});return()=>e2(r(),O,q)},lt="Loading",le=t=>()=>{let e=t.readyState;return"loading"===e?lt:"interactive"===e?"Interactive":"complete"===e?"Complete":lt},ln=t=>rZ(rK((()=>{let e=u9(t);return()=>e(uI(uk())())()})()))(t=>rj((()=>{if("Just"===t.tag){var e,n;return e=t._1,0===(n=Object.prototype.toString.call(e)).indexOf("[object HTML")&&n.indexOf("Element]")===n.length-8?q(e):O}if("Nothing"===t.tag)return O;b()})())),lr=oa(t=>"Left"===t.tag?rD(t._1):"Right"===t.tag?()=>{}:void b()),lo=rZ(r$(t=>()=>{if("Loading"===le(uI(uk())())()){let e=uk(),n=nR(e=>t(z("Right",void 0)))();nw("DOMContentLoaded")(n)(!1)(e)();let r=rK(nS("DOMContentLoaded")(n)(!1)(e));return t=>r}return t(z("Right",void 0))(),ou}))(()=>rZ(ln("body"))(t=>{let e=rH(rF("Could not find body"));return"Nothing"===t.tag?e:"Just"===t.tag?rj(t._1):void b()})),li=(t,e)=>({tag:"CoyonedaF",_1:t,_2:e}),la=(t,e,n)=>({tag:t,_1:e,_2:n}),lu=ti(Y)(tu),ll=t=>e=>{let n=e,r=!0,o;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,o=O;continue}if("Node"===e.tag){let i=t9.compare(t)(e._3);if("LT"===i){n=e._5;continue}if("GT"===i){n=e._6;continue}if("EQ"===i){r=!1,o=M("Just",e._4);continue}}b()}return o},ls=ti(r6),ld=ls(tC),lc=rU(r8)(r9)(tC)(rz),lf=ls(tu),l_=t=>e=>{let n=e,r=!0,o;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,o=O;continue}if("Node"===e.tag){let i=t9.compare(t)(e._3);if("LT"===i){n=e._5;continue}if("GT"===i){n=e._6;continue}if("EQ"===i){r=!1,o=M("Just",e._4);continue}}b()}return o},lg=t=>e=>{let n=e,r=!0,o;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,o=O;continue}if("Node"===e.tag){let i=t8.compare(t)(e._3);if("LT"===i){n=e._5;continue}if("GT"===i){n=e._6;continue}if("EQ"===i){r=!1,o=M("Just",e._4);continue}}b()}return o},lp=(t=>{let e=t.Monad0(),n=e.Bind1().Apply0().Functor0();return r=>t.tailRecM(t=>{let o=tM(t);return"Return"===o.tag?n.map(te)(e.Applicative0().pure(o._1)):"Bind"===o.tag?n.map(t=>tt("Loop",o._2(t)))(r(o._1)):void b()})})({tailRecM:t=>{let e=n=>rZ(t(n))(t=>"Done"===t.tag?rj(t._1):"Loop"===t.tag?e(t._1):void b());return e},Monad0:()=>r3}),lv=(t=>{let e=t.compare;return t=>n=>r=>{let o=eA(e,n,r),i=t(o._1);return"Nothing"===i.tag?ek(o._2,o._3):"Just"===i.tag?eL(n,i._1,o._2,o._3):void b()}})(t8),lm=t=>e=>()=>{let n=e.value.subscriptions.value;return lu(uL)((()=>{let e=ll(t);return"Just"===n.tag?e(n._1):"Nothing"===n.tag?O:void b()})())()},lh=t=>e=>rZ(rK(()=>t.value))(n=>"Nothing"===n.tag?e:"Just"===n.tag?rK(()=>t.value=M("Just",tv("Cons",e,n._1))):void b()),lC=t=>e=>rZ(rK(()=>t.value={initializers:tm,finalizers:tm}))(()=>rZ(rK(e))(e=>rZ(rK(()=>t.value))(t=>{let n=t.initializers;return rZ(ld(r1)(t.finalizers))(()=>rZ(lc(n))(()=>rj(e)))}))),ly=oa(t=>"Left"===t.tag?rD(t._1):"Right"===t.tag?()=>{}:void b()),lb=t=>e=>rZ(rK(()=>e.value))(e=>{var n;return rK((n=e=>({state:e+1|0,value:t(e)}),function(t){return function(){var e=n(t.value);return t.value=e.state,e.value}})(e.fresh))}),lR=t=>e=>n=>rZ(rK(()=>e.value))(r=>lw(t)(e)(r.component.eval(la("Query",li(t=>M("Just",t),n),t=>O)))),lw=t=>e=>n=>lp(n=>{if("State"===n.tag)return rZ(rK(()=>e.value))(r=>{let o=n._1(r.state);if(ux(r.state)(o._2))return rj(o._1);let i=o._1;return rZ(rK((()=>{let t={...r,state:o._2};return()=>e.value=t})()))(()=>rZ(lC(r.lifecycleHandlers)(t(r.lifecycleHandlers)(e)))(()=>rj(i)))});if("Subscribe"===n.tag)return rZ(lb(nj)(e))(r=>rZ(rK(n._1(r)(n=>{let r=ly(lS(t)(e)(e0("Action",n)));return()=>{r()}})))(t=>rZ(rK(()=>e.value))(e=>rZ(rK((()=>{let n=eT(t9)(r)(t),o=e.subscriptions;return()=>{let t=o.value;o.value="Just"===t.tag?M("Just",n(t._1)):O}})()))(()=>rj(n._2(r))))));if("Unsubscribe"===n.tag){let t=n._2;return rZ(rK(lm(n._1)(e)))(()=>rj(t))}if("Lift"===n.tag)return n._1;if("ChildQuery"===n.tag){let r=n._1;return rZ(rK(()=>e.value))(e=>{let n=r._2;return rW(r._3)(rV(r._1(r9)(e=>rZ(rK(()=>e.value))(e=>lR(t)(e.selfRef)(n)))(e.children)))})}if("Raise"===n.tag){let t=n._2,r=n._1;return rZ(rK(()=>e.value))(e=>{let n=e.handlerRef,o=e.pendingOuts;return rZ(rK(()=>n.value))(e=>rZ(lh(o)(e(r)))(()=>rj(t)))})}if("Par"===n.tag)return rV(nF(r9)(nM)((()=>{let r=lw(t)(e);return nF(nz)(t=>nT("Lift",r(t)))(n._1)})()));if("Fork"===n.tag){let r=n._1;return rZ(lb(nH)(e))(o=>rZ(rK(()=>e.value))(i=>{let a=i.forks;return rZ(rK(()=>({value:!1})))(i=>rZ(r1(r7(rK((()=>{let t=ez(t9)(o);return()=>{let e=a.value;return a.value=t(e),i.value=!0}})()))(lw(t)(e)(r))))(t=>rZ(rK((()=>{let e=eT(t9)(o)(t);return()=>{let t=i.value;if(!t){let t=a.value;a.value=e(t);return}t||b()}})()))(()=>rj(n._2(o)))))}))}if("Join"===n.tag){let t=n._2,r=n._1;return rZ(rK(()=>e.value))(e=>{let n=e.forks;return rZ(rK(()=>n.value))(e=>rZ(lf(oe)(l_(r)(e)))(()=>rj(t)))})}if("Kill"===n.tag){let t=n._2,r=n._1;return rZ(rK(()=>e.value))(e=>{let n=e.forks;return rZ(rK(()=>n.value))(e=>rZ(lf(on(rF("Cancelled")))(l_(r)(e)))(()=>rj(t)))})}if("GetRef"===n.tag){let t=n._1;return rZ(rK(()=>e.value))(e=>rj(n._2(lg(t)(e.refs))))}b()})(n),lS=t=>e=>n=>{if("RefUpdate"===n.tag){let t=n._2,r=n._1;return rK(()=>{let n=e.value;e.value={...n,refs:lv(e=>t)(r)(n.refs)}})}if("Action"===n.tag){let r=n._1;return rZ(rK(()=>e.value))(n=>lw(t)(e)(n.component.eval(la("Action",r,void 0))))}b()},lN=ta(Y)(tu),lE=ti(r6)(tC),lx=ti(Y),lJ=lx(tu),lL=lx(eO),lA=rU(r8)(r9)(tC)(rz),lB=(t=>{let e=ti(t)(eO);return t=>n=>e(t=>n(t))(t)})(Y),lk=(()=>{let t=ti(Y)(tu);return e=>n=>t(e)(n.rendering)})(),lI=()=>({value:{initializers:tm,finalizers:tm}}),lT=t=>()=>{let e=t.value;return t.value=O,lN(e)((()=>{let t=lE(r1);return e=>ly(t((t=>{let e=tm,n=t,r=!0,o;for(;r;){let t=e,i=n;if("Nil"===i.tag){r=!1,o=t;continue}if("Cons"===i.tag){e=tv("Cons",i._1,t),n=i._2;continue}b()}return o})(e)))})())()},lM=t=>{let e=lJ(lL(uL)),n=t.subscriptions;return()=>{e(n.value)(),t.subscriptions.value=O;let r=t.forks.value;return lL((()=>{let t=on(rF("finalized"));return e=>ly(t(e))})())(r)(),t.forks.value=ex}},lO=t=>e=>n=>{let r=t=>e=>n=>{let r=lw(a)(n.selfRef)(n.component.eval(la("Initialize",void 0)));return()=>{let o=t.value;t.value={initializers:tv("Cons",rZ(lA((t=>{let e=tm,n=t,r=!0,o;for(;r;){let t=e,i=n;if("Nil"===i.tag){r=!1,o=t;continue}if("Cons"===i.tag){e=tv("Cons",i._1,t),n=i._2;continue}b()}return o})(o.initializers)))(()=>rZ(r)(()=>rK((()=>{let t=lT(n.pendingQueries);return()=>(t(),lT(n.pendingOuts)())})()))),e),finalizers:o.finalizers}}},o=t=>e=>n=>o=>()=>{let i=lI(),u={value:{}},l={value:M("Just",tm)},s={value:M("Just",tm)},d={value:M("Just",ex)};u.value={component:o,state:o.initialState(n),refs:ex,children:ex,childrenIn:{value:ex},childrenOut:{value:ex},selfRef:u,handlerRef:{value:e},pendingQueries:l,pendingOuts:s,pendingHandlers:{value:O},rendering:O,fresh:{value:1},subscriptions:d,forks:{value:ex},lifecycleHandlers:i};let c=t.value;t.value={initializers:tm,finalizers:c.finalizers};let f=u.value;a(t)(f.selfRef)();let _=u.value;return r(t)(c.initializers)(_)(),u},i=e=>n=>r=>i=>u=>()=>{let l=r.value,s=u.pop(l),d=(()=>{if("Just"===s.tag){r.value=s._1._2;let t=s._1._1.value,e=rj();return t.handlerRef.value=t=>{let r=u.output(t);return"Nothing"===r.tag?e:"Just"===r.tag?n(r._1):void b()},ly(lw(a)(t.selfRef)(t.component.eval(la("Receive",u.input,void 0))))(),s._1._1}if("Nothing"===s.tag)return o(e)((()=>{let t=rj();return e=>{let r=u.output(e);return"Nothing"===r.tag?t:"Just"===r.tag?n(r._1):void b()}})())(u.input)(u.component)();b()})(),c=i.value;(()=>{let t=u.get(c);return"Nothing"!==t.tag&&("Just"===t.tag||void b())})()&&console.warn("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur");let f=i.value;i.value=u.set(d)(f);let _=d.value;return"Nothing"===_.rendering.tag?rD(rF("Halogen internal error: child was not initialized in renderChild"))():"Just"===_.rendering.tag?t.renderChild(_.rendering._1):void b()},a=e=>n=>()=>{let r=n.value,o=r.pendingHandlers.value,l="Nothing"===o.tag||"Just"!==o.tag&&void b();l&&(r.pendingHandlers.value=M("Just",tm)),r.childrenOut.value=ex,r.childrenIn.value=r.children;let s=r.pendingHandlers,d=t.render((()=>{let t=rW(t=>{});return e=>ly(lh(s)(t(lS(a)(r.selfRef)(e))))})())(i(e)((()=>{let t=rW(t=>{});return e=>lh(r.pendingQueries)(lh(s)(t(lS(a)(r.selfRef)(e0("Action",e)))))})())(r.childrenIn)(r.childrenOut))(r.component.render(r.state))(r.rendering)(),c=r.childrenOut.value;lB(r.childrenIn.value)(n=>()=>{let r=n.value;return lk(t.removeChild)(r)(),u(e)(r)()})();let f=r.selfRef.value;r.selfRef.value={...f,rendering:M("Just",d),children:c};let _=tn(t=>()=>{let t=s.value;s.value=M("Just",tm),lJ((()=>{let t=lE(r1);return e=>ly(t((t=>{let e=tm,n=t,r=!0,o;for(;r;){let t=e,i=n;if("Nil"===i.tag){r=!1,o=t;continue}if("Cons"===i.tag){e=tv("Cons",i._1,t),n=i._2;continue}b()}return o})(e)))})())(t)();let e=s.value;return"Nothing"!==e.tag&&("Just"===e.tag?"Nil"===e._1.tag:void b())?(s.value=O,tt("Done",void 0)):tt("Loop",void 0)})();if(l)return _()},u=t=>e=>{let n=lM(e);return()=>{n();let r=t.value;return t.value={initializers:r.initializers,finalizers:tv("Cons",lw(a)(e.selfRef)(e.component.eval(la("Finalize",void 0))),r.finalizers)},lB(e.children)(e=>()=>{let n=e.value;return u(t)(n)()})()}};return rZ(rK(lI))(r=>rZ(rK(()=>({value:!1})))(i=>lC(r)(()=>{let l=uA(),s=o(r)(t=>rK(l.listener(t)))(n)(e)().value;return{query:(()=>{let t=s.selfRef;return e=>rZ(rK(()=>i.value))(n=>n?rj(O):lR(a)(t)(e))})(),messages:l.emitter,dispose:lC(r)(()=>{if(!i.value)return i.value=!0,u(r)(s)(),lN(s.selfRef.value.rendering)(t.dispose)()})}})))},lq=function(t){return function(e){return function(){return e[t]}}};lq("baseURI"),lq("ownerDocument");var lP=lq("parentNode");lq("parentElement"),lq("childNodes"),lq("firstChild"),lq("lastChild"),lq("previousSibling");var lF=lq("nextSibling");function lD(t){return function(e){return function(){e.appendChild(t)}}}lq("nodeValue"),lq("textContent");var lz=ti(Y)(tu),lU=t=>t,lG=t=>e=>n=>{if("Just"===n.tag){if("Just"===e.tag){var r;let o=(r=e._1,function(e){return function(){e.insertBefore(t,r)}})(n._1);return()=>{o()}}if("Nothing"===e.tag){let e=lD(t)(n._1);return()=>{e()}}}return()=>{}},lQ=t=>{let e=t.node,n=lP(e);return()=>{let t=n();return lz(t=>{var n;return n=t,function(){n.removeChild(e)}})(e2(t,O,q))()}},lj=t=>e=>n=>({buildWidget:t=>{let n=rr(tR)(t),r=t=>nd((0,e.value)(t)().node,O,i,t=>{if("Just"===t.tag)return nf(t._1)}),o=t=>{if("ComponentSlot"===t.tag)return r(t._1);if("ThunkSlot"===t.tag){let e=n(t._1);return nd(e._1,M("Just",e),i,t=>{if("Just"===t.tag)return nf(t._1)})}b()},i=(t,e)=>{if("Just"===t.tag){if("ComponentSlot"===e.tag){let n=e._1;return nf(t._1),r(n)}if("ThunkSlot"===e.tag){let n=e._1,r=nc(t._1,n);return nd(r._1,M("Just",r),i,t=>{if("Just"===t.tag)return nf(t._1)})}b()}return o(e)};return o},buildAttributes:nA(t),document:n}),lH=t=>e=>({render:n=>r=>o=>i=>{if("Nothing"===i.tag)return()=>{let i={value:r},a=re(lj(n)(i)(t))(o);return lD(a._1)(e)(),{machine:a,node:a._1,renderChildRef:i}};if("Just"===i.tag){let t=i._1.machine,e=i._1.node,n=i._1.renderChildRef;return()=>{n.value=r;let i=lP(e)(),a=lF(e)(),u=nc(t,o),l=lG(u._1)(e2(a,O,q))(e2(i,O,q));return ux(e)(u._1)||l(),{machine:u,node:u._1,renderChildRef:n}}}b()},renderChild:lU,removeChild:lQ,dispose:lQ}),lW=t=>e=>n=>rZ(rK(()=>uI(uk())()))(r=>lO(lH(r)(n))(t)(e));lr(rZ(lo)(t=>lW(u7)()(t)))()})();
//# sourceMappingURL=index.5f4b3ec2.js.map
