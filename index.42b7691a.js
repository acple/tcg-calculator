(()=>{let t,e,r,n,i;var o,u,a,l,d,c,s,f,p=Object.create,_=Object.defineProperty,g=Object.getOwnPropertyDescriptor,v=Object.getOwnPropertyNames,m=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,y=(t={"node_modules/big-integer/BigInteger.js"(t,e){var r=function(t){var e=c(9007199254740992),n="0123456789abcdefghijklmnopqrstuvwxyz",i="function"==typeof BigInt;function o(t,e,r,n){return void 0===t?o[0]:void 0!==e&&(10!=+e||r)?F(t,e,r,n):j(t)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function a(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function d(t){return -9007199254740992<t&&t<9007199254740992}function c(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function s(t){f(t);var r=t.length;if(r<4&&0>N(t,e))switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+1e7*t[1];default:return t[0]+(t[1]+1e7*t[2])*1e7}return t}function f(t){for(var e=t.length;0===t[--e];);t.length=e+1}function p(t){for(var e=Array(t),r=-1;++r<t;)e[r]=0;return e}function _(t){return t>0?Math.floor(t):Math.ceil(t)}function g(t,e){var r,n,i=t.length,o=e.length,u=Array(i),a=0;for(n=0;n<o;n++)a=(r=t[n]+e[n]+a)>=1e7?1:0,u[n]=r-1e7*a;for(;n<i;)a=1e7===(r=t[n]+a)?1:0,u[n++]=r-1e7*a;return a>0&&u.push(a),u}function v(t,e){return t.length>=e.length?g(t,e):g(e,t)}function m(t,e){var r,n,i=t.length,o=Array(i);for(n=0;n<i;n++)e=Math.floor((r=t[n]-1e7+e)/1e7),o[n]=r-1e7*e,e+=1;for(;e>0;)o[n++]=e%1e7,e=Math.floor(e/1e7);return o}function h(t,e){var r,n,i=t.length,o=e.length,u=Array(i),a=0;for(r=0;r<o;r++)(n=t[r]-a-e[r])<0?(n+=1e7,a=1):a=0,u[r]=n;for(r=o;r<i;r++){if((n=t[r]-a)<0)n+=1e7;else{u[r++]=n;break}u[r]=n}for(;r<i;r++)u[r]=t[r];return f(u),u}function y(t,e,r){var n,i,o=t.length,l=Array(o),d=-e;for(n=0;n<o;n++)d=Math.floor((i=t[n]+d)/1e7),i%=1e7,l[n]=i<0?i+1e7:i;return"number"==typeof(l=s(l))?(r&&(l=-l),new a(l)):new u(l,r)}function b(t,e){var r,n,i,o,u=t.length,a=e.length,l=p(u+a);for(i=0;i<u;++i){o=t[i];for(var d=0;d<a;++d)n=Math.floor((r=o*e[d]+l[i+d])/1e7),l[i+d]=r-1e7*n,l[i+d+1]+=n}return f(l),l}function R(t,e){var r,n,i=t.length,o=Array(i),u=0;for(n=0;n<i;n++)u=Math.floor((r=t[n]*e+u)/1e7),o[n]=r-1e7*u;for(;u>0;)o[n++]=u%1e7,u=Math.floor(u/1e7);return o}function w(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function S(t,e,r){return t<1e7?new u(R(e,t),r):new u(b(e,c(t)),r)}function x(t){var e,r,n,i,o=t.length,u=p(o+o);for(n=0;n<o;n++){r=0-(i=t[n])*i;for(var a=n;a<o;a++)r=Math.floor((e=i*t[a]*2+u[n+a]+r)/1e7),u[n+a]=e-1e7*r;u[n+o]=r}return f(u),u}function E(t,e){var r,n,i,o,u=t.length,a=p(u);for(i=0,r=u-1;r>=0;--r)n=_((o=1e7*i+t[r])/e),i=o-n*e,a[r]=0|n;return[a,0|i]}function J(t,e){var r,n,d=j(e);if(i)return[new l(t.value/d.value),new l(t.value%d.value)];var g=t.value,v=d.value;if(0===v)throw Error("Cannot divide by zero");if(t.isSmall)return d.isSmall?[new a(_(g/v)),new a(g%v)]:[o[0],t];if(d.isSmall){if(1===v)return[t,o[0]];if(-1==v)return[t.negate(),o[0]];var m=Math.abs(v);if(m<1e7){r=s((n=E(g,m))[0]);var y=n[1];return(t.sign&&(y=-y),"number"==typeof r)?(t.sign!==d.sign&&(r=-r),[new a(r),new a(y)]):[new u(r,t.sign!==d.sign),new a(y)]}v=c(m)}var b=N(g,v);if(-1===b)return[o[0],t];if(0===b)return[o[t.sign===d.sign?1:-1],o[0]];r=(n=g.length+v.length<=200?function(t,e){var r,n,i,o,u,a,l,d=t.length,c=e.length,f=p(e.length),_=e[c-1],g=Math.ceil(1e7/(2*_)),v=R(t,g),m=R(e,g);for(v.length<=d&&v.push(0),m.push(0),_=m[c-1],n=d-c;n>=0;n--){for(r=1e7-1,v[n+c]!==_&&(r=Math.floor((1e7*v[n+c]+v[n+c-1])/_)),i=0,o=0,a=m.length,u=0;u<a;u++)i+=r*m[u],l=Math.floor(i/1e7),o+=v[n+u]-(i-1e7*l),i=l,o<0?(v[n+u]=o+1e7,o=-1):(v[n+u]=o,o=0);for(;0!==o;){for(r-=1,i=0,u=0;u<a;u++)(i+=v[n+u]-1e7+m[u])<0?(v[n+u]=i+1e7,i=0):(v[n+u]=i,i=1);o+=i}f[n]=r}return v=E(v,g)[0],[s(f),s(v)]}(g,v):function(t,e){for(var r,n,i,o,u,a=t.length,l=e.length,d=[],c=[];a;){if(c.unshift(t[--a]),f(c),0>N(c,e)){d.push(0);continue}n=c.length,i=1e7*c[n-1]+c[n-2],o=1e7*e[l-1]+e[l-2],n>l&&(i=(i+1)*1e7),r=Math.ceil(i/o);do{if(0>=N(u=R(e,r),c))break;r--}while(r)d.push(r),c=h(c,u)}return d.reverse(),[s(d),s(c)]}(g,v))[0];var w=t.sign!==d.sign,S=n[1],x=t.sign;return"number"==typeof r?(w&&(r=-r),r=new a(r)):r=new u(r,w),"number"==typeof S?(x&&(S=-S),S=new a(S)):S=new u(S,x),[r,S]}function N(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function A(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function L(t,e){for(var n,i,o,u=t.prev(),a=u,l=0;a.isEven();)a=a.divide(2),l++;t:for(i=0;i<e.length;i++)if(!t.lesser(e[i])&&!((o=r(e[i]).modPow(a,t)).isUnit()||o.equals(u))){for(n=l-1;0!=n&&!(o=o.square().mod(t)).isUnit();n--)if(o.equals(u))continue t;return!1}return!0}u.prototype=Object.create(o.prototype),a.prototype=Object.create(o.prototype),l.prototype=Object.create(o.prototype),u.prototype.add=function(t){var e=j(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(m(r,Math.abs(n)),this.sign):new u(v(r,n),this.sign)},u.prototype.plus=u.prototype.add,a.prototype.add=function(t){var e=j(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(d(r+n))return new a(r+n);n=c(Math.abs(n))}return new u(m(n,Math.abs(r)),r<0)},a.prototype.plus=a.prototype.add,l.prototype.add=function(t){return new l(this.value+j(t).value)},l.prototype.plus=l.prototype.add,u.prototype.subtract=function(t){var e,r,n=j(t);if(this.sign!==n.sign)return this.add(n.negate());var i=this.value,o=n.value;return n.isSmall?y(i,Math.abs(o),this.sign):(e=this.sign,(N(i,o)>=0?r=h(i,o):(r=h(o,i),e=!e),"number"==typeof(r=s(r)))?(e&&(r=-r),new a(r)):new u(r,e))},u.prototype.minus=u.prototype.subtract,a.prototype.subtract=function(t){var e=j(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new a(r-n):y(n,Math.abs(r),r>=0)},a.prototype.minus=a.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-j(t).value)},l.prototype.minus=l.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},a.prototype.negate=function(){var t=this.sign,e=new a(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},a.prototype.abs=function(){return new a(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(t){var e,r,n,i=j(t),a=this.value,l=i.value,d=this.sign!==i.sign;if(i.isSmall){if(0===l)return o[0];if(1===l)return this;if(-1===l)return this.negate();if((n=Math.abs(l))<1e7)return new u(R(a,n),d);l=c(n)}return -.012*(e=a.length)-.012*(r=l.length)+15e-6*e*r>0?new u(function t(e,r){var n=Math.max(e.length,r.length);if(n<=30)return b(e,r);n=Math.ceil(n/2);var i=e.slice(n),o=e.slice(0,n),u=r.slice(n),a=r.slice(0,n),l=t(o,a),d=t(i,u),c=t(v(o,i),v(a,u)),s=v(v(l,w(h(h(c,l),d),n)),w(d,2*n));return f(s),s}(a,l),d):new u(b(a,l),d)},u.prototype.times=u.prototype.multiply,a.prototype._multiplyBySmall=function(t){return d(t.value*this.value)?new a(t.value*this.value):S(Math.abs(t.value),c(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?o[0]:1===t.value?this:-1===t.value?this.negate():S(Math.abs(t.value),this.value,this.sign!==t.sign)},a.prototype.multiply=function(t){return j(t)._multiplyBySmall(this)},a.prototype.times=a.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*j(t).value)},l.prototype.times=l.prototype.multiply,u.prototype.square=function(){return new u(x(this.value),!1)},a.prototype.square=function(){var t=this.value*this.value;return d(t)?new a(t):new u(x(c(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},u.prototype.divmod=function(t){var e=J(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=a.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return J(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/j(t).value)},a.prototype.over=a.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return J(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%j(t).value)},a.prototype.remainder=a.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,i=j(t),u=this.value,l=i.value;if(0===l)return o[1];if(0===u)return o[0];if(1===u)return o[1];if(-1===u)return i.isEven()?o[1]:o[-1];if(i.sign)return o[0];if(!i.isSmall)throw Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&d(e=Math.pow(u,l)))return new a(_(e));for(r=this,n=o[1];!0&l&&(n=n.times(r),--l),0!==l;)l/=2,r=r.square();return n},a.prototype.pow=u.prototype.pow,l.prototype.pow=function(t){var e=j(t),r=this.value,n=e.value,i=BigInt(0),u=BigInt(1),a=BigInt(2);if(n===i)return o[1];if(r===i)return o[0];if(r===u)return o[1];if(r===BigInt(-1))return e.isEven()?o[1]:o[-1];if(e.isNegative())return new l(i);for(var d=this,c=o[1];(n&u)===u&&(c=c.times(d),--n),n!==i;)n/=a,d=d.square();return c},u.prototype.modPow=function(t,e){if(t=j(t),(e=j(e)).isZero())throw Error("Cannot take modPow with modulus 0");var r=o[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(o[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return o[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},l.prototype.modPow=a.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=j(t),r=this.value,n=e.value;return e.isSmall?1:N(r,n)},a.prototype.compareAbs=function(t){var e=j(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,r=j(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},u.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=j(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:N(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,a.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=j(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},a.prototype.compareTo=a.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=this.value,r=j(t).value;return e===r?0:e>r?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=a.prototype.eq=a.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=a.prototype.neq=a.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=a.prototype.gt=a.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return 0>this.compare(t)},l.prototype.lt=l.prototype.lesser=a.prototype.lt=a.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return 0>=this.compare(t)},l.prototype.leq=l.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return(1&this.value[0])==0},a.prototype.isEven=function(){return(1&this.value)==0},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return(1&this.value[0])==1},a.prototype.isOdd=function(){return(1&this.value)==1},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},a.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=a.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},a.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=a.prototype.isNegative,u.prototype.isUnit=function(){return!1},a.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},a.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(t){var e=j(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=a.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(t){var e=A(this);if(void 0!==e)return e;var n=this.abs(),i=n.bitLength();if(i<=64)return L(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*i.toJSNumber(),u=Math.ceil(!0===t?2*Math.pow(o,2):o),a=[],l=0;l<u;l++)a.push(r(l+2));return L(n,a)},l.prototype.isPrime=a.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(t,e){var n=A(this);if(void 0!==n)return n;for(var i=this.abs(),o=void 0===t?5:t,u=[],a=0;a<o;a++)u.push(r.randBetween(2,i.minus(2),e));return L(i,u)},l.prototype.isProbablePrime=a.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,n,i,o=r.zero,u=r.one,a=j(t),l=this.abs();!l.isZero();)e=a.divide(l),n=o,i=a,o=u,a=l,u=n.subtract(e.multiply(u)),l=i.subtract(e.multiply(l));if(!a.isUnit())throw Error(this.toString()+" and "+t.toString()+" are not co-prime");return(-1===o.compare(0)&&(o=o.add(t)),this.isNegative())?o.negate():o},l.prototype.modInv=a.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?y(t,1,this.sign):new u(m(t,1),this.sign)},a.prototype.next=function(){var t=this.value;return t+1<9007199254740992?new a(t+1):new u(e,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},u.prototype.prev=function(){var t=this.value;return this.sign?new u(m(t,1),!0):y(t,1,this.sign)},a.prototype.prev=function(){var t=this.value;return t-1>-9007199254740992?new a(t-1):new u(e,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var C=[1];2*C[C.length-1]<=1e7;)C.push(2*C[C.length-1]);var B=C.length,I=C[B-1];function k(t){return 1e7>=Math.abs(t)}function T(t,e,n){e=j(e);for(var i=t.isNegative(),o=e.isNegative(),u=i?t.not():t,a=o?e.not():e,l=0,d=0,c=null,s=null,f=[];!u.isZero()||!a.isZero();)l=(c=J(u,I))[1].toJSNumber(),i&&(l=I-1-l),d=(s=J(a,I))[1].toJSNumber(),o&&(d=I-1-d),u=c[0],a=s[0],f.push(n(l,d));for(var p=0!==n(i?1:0,o?1:0)?r(-1):r(0),_=f.length-1;_>=0;_-=1)p=p.multiply(I).add(r(f[_]));return p}function M(t){var e=t.value,r="number"==typeof e?1073741824|e:"bigint"==typeof e?e|BigInt(1073741824):e[0]+1e7*e[1]|1073758208;return r&-r}function O(t,e){return t=j(t),e=j(e),t.greater(e)?t:e}function q(t,e){return t=j(t),e=j(e),t.lesser(e)?t:e}function P(t,e){if(t=j(t).abs(),e=j(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,i=o[1];t.isEven()&&e.isEven();)r=q(M(t),M(e)),t=t.divide(r),e=e.divide(r),i=i.multiply(r);for(;t.isEven();)t=t.divide(M(t));do{for(;e.isEven();)e=e.divide(M(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero())return i.isUnit()?t:t.multiply(i)}u.prototype.shiftLeft=function(t){var e=j(t).toJSNumber();if(!k(e))throw Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=B;)r=r.multiply(I),e-=B-1;return r.multiply(C[e])},l.prototype.shiftLeft=a.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e,r=j(t).toJSNumber();if(!k(r))throw Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=B;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=J(n,I))[1].isNegative()?e[0].prev():e[0],r-=B-1}return(e=J(n,C[r]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=a.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},l.prototype.not=a.prototype.not=u.prototype.not,u.prototype.and=function(t){return T(this,t,function(t,e){return t&e})},l.prototype.and=a.prototype.and=u.prototype.and,u.prototype.or=function(t){return T(this,t,function(t,e){return t|e})},l.prototype.or=a.prototype.or=u.prototype.or,u.prototype.xor=function(t){return T(this,t,function(t,e){return t^e})},l.prototype.xor=a.prototype.xor=u.prototype.xor,u.prototype.bitLength=function(){var t=this;return(0>t.compareTo(r(0))&&(t=t.negate().subtract(r(1))),0===t.compareTo(r(0)))?r(0):r(function t(e,n){if(0>=n.compareTo(e)){var i=t(e,n.square(n)),o=i.p,u=i.e,a=o.multiply(n);return 0>=a.compareTo(e)?{p:a,e:2*u+1}:{p:o,e:2*u}}return{p:r(1),e:0}}(t,r(2)).e).add(r(1))},l.prototype.bitLength=a.prototype.bitLength=u.prototype.bitLength;var F=function(t,e,r,i){r=r||n,t=String(t),i||(t=t.toLowerCase(),r=r.toLowerCase());var o,u=t.length,a=Math.abs(e),l={};for(o=0;o<r.length;o++)l[r[o]]=o;for(o=0;o<u;o++){var d=t[o];if("-"!==d&&d in l&&l[d]>=a){if("1"===d&&1===a)continue;throw Error(d+" is not a valid digit in base "+e+".")}}e=j(e);var c=[],s="-"===t[0];for(o=s?1:0;o<t.length;o++){var d=t[o];if(d in l)c.push(j(l[d]));else if("<"===d){var f=o;do o++;while(">"!==t[o]&&o<t.length)c.push(j(t.slice(f+1,o)))}else throw Error(d+" is not a valid character")}return D(c,e,s)};function D(t,e,r){var n,i=o[0],u=o[1];for(n=t.length-1;n>=0;n--)i=i.add(t[n].times(u)),u=u.times(e);return r?i.negate():i}function z(t,e){if((e=r(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var i=!1;if(t.isNegative()&&e.isPositive()&&(i=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var o,u=[],a=t;a.isNegative()||a.compareAbs(e)>=0;){a=(o=a.divmod(e)).quotient;var l=o.remainder;l.isNegative()&&(l=e.minus(l).abs(),a=a.next()),u.push(l.toJSNumber())}return u.push(a.toJSNumber()),{value:u.reverse(),isNegative:i}}function U(t,e,r){var i=z(t,e);return(i.isNegative?"-":"")+i.value.map(function(t){var e;return t<(e=(e=r)||n).length?e[t]:"<"+t+">"}).join("")}function G(t){if(d(+t)){var e=+t;if(e===_(e))return i?new l(BigInt(e)):new a(e);throw Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw Error("Invalid integer: "+n.join("e"));if(2===n.length){var o=n[1];if("+"===o[0]&&(o=o.slice(1)),(o=+o)!==_(o)||!d(o))throw Error("Invalid integer: "+o+" is not a valid exponent.");var c=n[0],s=c.indexOf(".");if(s>=0&&(o-=c.length-s-1,c=c.slice(0,s)+c.slice(s+1)),o<0)throw Error("Cannot include negative exponent part for integers");c+=Array(o+1).join("0"),t=c}if(!/^([0-9][0-9]*)$/.test(t))throw Error("Invalid integer: "+t);if(i)return new l(BigInt(r?"-"+t:t));for(var p=[],g=t.length,v=g-7;g>0;)p.push(+t.slice(v,g)),(v-=7)<0&&(v=0),g-=7;return f(p),new u(p,r)}function j(t){return"number"==typeof t?function(t){if(i)return new l(BigInt(t));if(d(t)){if(t!==_(t))throw Error(t+" is not an integer.");return new a(t)}return G(t.toString())}(t):"string"==typeof t?G(t):"bigint"==typeof t?new l(t):t}u.prototype.toArray=function(t){return z(this,t)},a.prototype.toArray=function(t){return z(this,t)},l.prototype.toArray=function(t){return z(this,t)},u.prototype.toString=function(t,e){if(void 0===t&&(t=10),10!==t||e)return U(this,t,e);for(var r,n=this.value,i=n.length,o=String(n[--i]);--i>=0;)r=String(n[i]),o+="0000000".slice(r.length)+r;return(this.sign?"-":"")+o},a.prototype.toString=function(e,r){return(e===t&&(e=10),10!=e||r)?U(this,e,r):String(this.value)},l.prototype.toString=a.prototype.toString,l.prototype.toJSON=u.prototype.toJSON=a.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,a.prototype.valueOf=function(){return this.value},a.prototype.toJSNumber=a.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var H=0;H<1e3;H++)o[H]=j(H),H>0&&(o[-H]=j(-H));return o.one=o[1],o.zero=o[0],o.minusOne=o[-1],o.max=O,o.min=q,o.gcd=P,o.lcm=function(t,e){return t=j(t).abs(),e=j(e).abs(),t.divide(P(t,e)).multiply(e)},o.isInstance=function(t){return t instanceof u||t instanceof a||t instanceof l},o.randBetween=function(t,e,r){t=j(t);var n=r||Math.random,i=q(t,e=j(e)),u=O(t,e).subtract(i).add(1);if(u.isSmall)return i.add(Math.floor(n()*u));for(var a=z(u,1e7).value,l=[],d=!0,c=0;c<a.length;c++){var s=d?a[c]+(c+1<a.length?a[c+1]/1e7:0):1e7,f=_(n()*s);l.push(f),f<a[c]&&(d=!1)}return i.add(o.fromArray(l,1e7,!1))},o.fromArray=function(t,e,r){return D(t.map(j),j(e||10),r)},o}();void 0!==e&&e.hasOwnProperty("exports")&&(e.exports=r),"function"==typeof define&&define.amd&&define(function(){return r})}},function(){return e||(0,t[v(t)[0]])((e={exports:{}}).exports,e),e.exports});function b(){throw Error("Failed pattern match")}var R=t=>e=>t,w={tag:"Proxy"},S=function(t){return function(e){for(var r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t(e[i]);return n}},x={map:S},E=t=>t,J=function(t){return function(e){for(var r=[],n=0,i=t.length;n<i;n++)Array.prototype.push.apply(r,e(t[n]));return r}},N=function(t){return function(e){return e[t]}},A=function(t){return function(e){return function(r){var n={};for(var i in r)({}).hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n[t]=e,n}}},L=function(t){return t.toString()},C=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},B=function(t){var e=t.length;return'"'+t.replace(/[\0-\x1F\x7F"\\]/g,function(r,n){switch(r){case'"':case"\\":return"\\"+r;case"\x07":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\v":return"\\v"}var i=n+1,o=i<e&&t[i]>="0"&&t[i]<="9"?"\\&":"";return"\\"+r.charCodeAt(0).toString(10)+o})+'"'},I=(t,e)=>({tag:t,_1:e}),k={tag:"NoArguments"},T=(t,e)=>({tag:t,_1:e}),M=T("Nothing"),O=t=>T("Just",t),q={map:t=>e=>"Just"===e.tag?T("Just",t(e._1)):M},P={apply:t=>e=>"Just"===t.tag?"Just"===e.tag?T("Just",t._1(e._1)):M:"Nothing"===t.tag?M:void b(),Functor0:()=>q},F={pure:O,Apply0:()=>P},D=(t,e)=>({tag:t,_1:e}),z=t=>D("Left",t),U=t=>D("Right",t),G={map:t=>e=>t(e)},j={apply:t=>e=>t(e),Functor0:()=>G},H={bind:t=>e=>e(t),Apply0:()=>j},Q={pure:t=>t,Apply0:()=>j},W={Applicative0:()=>Q,Bind1:()=>H},Z={apply:t=>e=>()=>{let r=t(),n=e();return K.pure(r(n))()},Functor0:()=>$},K={pure:function(t){return function(){return t}},Apply0:()=>Z},$={map:t=>e=>()=>t(e())},V=(t,e)=>({tag:t,_1:e}),Y=t=>V("Done",t),X=t=>e=>{let r=t(e);return()=>{var e;let n=r();(e=()=>{let e=n;return"Loop"===e.tag?(n=t(e._1)(),!1):"Done"===e.tag||void b()},function(){for(;!e(););})();let i=n;if("Done"===i.tag)return i._1;b()}},tt=function(t){return function(e){return function(r){for(var n=e,i=r.length,o=i-1;o>=0;o--)n=t(r[o])(n);return n}}},te=function(t){return function(e){return function(r){for(var n=e,i=r.length,o=0;o<i;o++)n=t(n)(r[o]);return n}}},tr=t=>{let e=t.Apply0();return r=>n=>r.foldr(t=>{let r=n(t);return t=>e.apply(e.Functor0().map(t=>E)(r))(t)})(t.pure())},tn=t=>{let e=tr(t);return t=>{let r=e(t);return t=>e=>r(e)(t)}},ti=t=>e=>{let r=t.foldl(t=>r=>"Just"===t.elem.tag?t:t.pos===e?{elem:T("Just",r),pos:t.pos}:{pos:t.pos+1|0,elem:t.elem})({elem:M,pos:0});return t=>r(t).elem},to={foldr:t=>e=>r=>"Nothing"===r.tag?e:"Just"===r.tag?t(r._1)(e):void b(),foldl:t=>e=>r=>"Nothing"===r.tag?e:"Just"===r.tag?t(e)(r._1):void b(),foldMap:t=>{let e=t.mempty;return t=>r=>"Nothing"===r.tag?e:"Just"===r.tag?t(r._1):void b()}},tu={foldr:tt,foldl:te,foldMap:t=>{let e=t.mempty;return r=>tu.foldr(e=>n=>t.Semigroup0().append(r(e))(n))(e)}},ta=(t,e)=>({tag:"NonEmpty",_1:t,_2:e}),tl=(t,e)=>({tag:"Tuple",_1:t,_2:e}),td=t=>e=>tl(t,e),tc=t=>t._2,ts={map:t=>e=>tl(e._1,t(e._2))},tf=t=>t._1,tp=t=>({apply:e=>r=>tl(t.append(e._1)(r._1),e._2(r._2)),Functor0:()=>ts}),t_=(t,e,r)=>({tag:t,_1:e,_2:r}),tg=t_("Nil"),tv=t=>e=>t_("Cons",t,e),tm={foldr:t=>e=>{let r=tm.foldl(e=>r=>t(r)(e))(e),n=t=>{let e=tg,r=t,n=!0,i;for(;n;){let t=e,o=r;if("Nil"===o.tag){n=!1,i=t;continue}if("Cons"===o.tag){e=t_("Cons",o._1,t),r=o._2;continue}b()}return i};return t=>r(n(t))},foldl:t=>e=>r=>{let n=e,i=r,o=!0,u;for(;o;){let e=n,r=i;if("Nil"===r.tag){o=!1,u=e;continue}if("Cons"===r.tag){n=t(e)(r._1),i=r._2;continue}b()}return u},foldMap:t=>{let e=t.mempty;return r=>tm.foldl(e=>{let n=t.Semigroup0().append(e);return t=>n(r(t))})(e)}},th={append:t=>e=>tm.foldr(tv)(e)(t)},ty=(t=>{let e={foldMap:e=>{let r=t.foldMap(e);return t=>n=>e.Semigroup0().append(t(n._1))(r(t)(n._2))},foldl:e=>r=>n=>t.foldl(e)(e(r)(n._1))(n._2),foldr:e=>r=>n=>e(n._1)(t.foldr(e)(r)(n._2))};return{foldMap1:e=>r=>n=>t.foldl(t=>n=>e.append(t)(r(n)))(r(n._1))(n._2),foldr1:e=>r=>{let n=e(r._1),i=t.foldr(t=>{let r=e(t);return e=>T("Just","Nothing"===e.tag?t:"Just"===e.tag?r(e._1):void b())})(M)(r._2);return"Nothing"===i.tag?r._1:"Just"===i.tag?n(i._1):void b()},foldl1:e=>r=>t.foldl(e)(r._1)(r._2),Foldable0:()=>e}})(tm),tb=t=>{let e=tg,r=t,n=!0,i;for(;n;){let t=e,o=r;if("Nil"===o.tag){n=!1,i=t;continue}if("Cons"===o.tag){e=t_("Cons",o._1,t),r=o._2;continue}b()}return i},tR=function(t){return t},tw=function(){function t(t){return[t]}function e(t){return function(e){return[t,e]}}function r(t){return function(e){return function(r){return[t,e,r]}}}function n(t){return function(e){return t.concat(e)}}return function(i){return function(o){return function(u){return function(a){return function(l){return function d(c,s){switch(s-c){case 0:return u([]);case 1:return o(t)(a(l[c]));case 2:return i(o(e)(a(l[c])))(a(l[c+1]));case 3:return i(i(o(r)(a(l[c])))(a(l[c+1])))(a(l[c+2]));default:var f=c+2*Math.floor((s-c)/4);return i(o(n)(d(c,f)))(d(f,s))}}(0,l.length)}}}}}}(),tS=t=>t,tx={traverse:t=>{let e=t.Apply0();return tw(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>tx.traverse(t)(tS),Functor0:()=>x,Foldable1:()=>tu},tE=(t,e)=>({tag:"CatQueue",_1:t,_2:e}),tJ=t=>{let e=t,r=!0,n;for(;r;){let t=e;if("Nil"===t._1.tag){if("Nil"===t._2.tag){r=!1,n=M;continue}e=tE(tb(t._2),tg);continue}if("Cons"===t._1.tag){r=!1,n=T("Just",tl(t._1._1,tE(t._1._2,t._2)));continue}b()}return n},tN=(t,e,r)=>({tag:t,_1:e,_2:r}),tA=tN("CatNil"),tL=t=>e=>"CatNil"===t.tag?e:"CatNil"===e.tag?t:"CatCons"===t.tag?tN("CatCons",t._1,tE(t._2._1,t_("Cons",e,t._2._2))):void b(),tC=t=>e=>r=>{let n=t=>e=>r=>{let n=t,i=e,o=r,u=!0,a;for(;u;){let t=n,e=i,r=o;if("Nil"===r.tag){u=!1,a=e;continue}if("Cons"===r.tag){n=t,i=t(e)(r._1),o=r._2;continue}b()}return a};return(i=>{let o=r,u=i,a=!0,l;for(;a;){let r=u,i=tJ(o);if("Nothing"===i.tag){a=!1,l=n(t=>e=>e(t))(e)(r);continue}if("Just"===i.tag){o=i._1._2,u=t_("Cons",t(i._1._1),r);continue}b()}return l})(tg)},tB=t=>"CatNil"===t.tag?M:"CatCons"===t.tag?T("Just",tl(t._1,"Nil"===t._2._1.tag&&"Nil"===t._2._2.tag?tA:tC(tL)(tA)(t._2))):void b(),tI=t=>e=>"CatNil"===t.tag?tN("CatCons",e,tE(tg,tg)):"CatCons"===t.tag?tN("CatCons",t._1,tE(t._2._1,t_("Cons",tN("CatCons",e,tE(tg,tg)),t._2._2))):void b(),tk=(t,e)=>({tag:"Free",_1:t,_2:e}),tT=(t,e,r)=>({tag:t,_1:e,_2:r}),tM=t=>{let e=t,r=!0,n;for(;r;){let t=e;if("Return"===t._1.tag){let i=tB(t._2);if("Nothing"===i.tag){r=!1,n=tT("Return",t._1._1);continue}if("Just"===i.tag){e=(()=>{let e=i._1._1(t._1._1);return tk(e._1,"CatNil"===e._2.tag?i._1._2:"CatNil"===i._1._2.tag?e._2:"CatCons"===e._2.tag?tN("CatCons",e._2._1,tE(e._2._2._1,t_("Cons",i._1._2,e._2._2._2))):void b())})();continue}b()}if("Bind"===t._1.tag){r=!1,n=tT("Bind",t._1._1,e=>{let r=t._1._2(e);return tk(r._1,"CatNil"===r._2.tag?t._2:"CatNil"===t._2.tag?r._2:"CatCons"===r._2.tag?tN("CatCons",r._2._1,tE(r._2._2._1,t_("Cons",t._2,r._2._2._2))):void b())});continue}b()}return n},tO={Applicative0:()=>tD,Bind1:()=>tP},tq={map:t=>e=>tP.bind(e)(e=>tD.pure(t(e)))},tP={bind:t=>e=>tk(t._1,tI(t._2)(e)),Apply0:()=>tF},tF={apply:t=>e=>tk(t._1,tI(t._2)(t=>tk(e._1,tI(e._2)(e=>tD.pure(t(e)))))),Functor0:()=>tq},tD={pure:t=>tk(tT("Return",t),tA),Apply0:()=>tF},tz=t=>({append:e=>r=>tF.apply(tk(e._1,tI(e._2)(e=>tk(tT("Return",t.append(e)),tA))))(r)}),tU=t=>{let e=tz(t.Semigroup0());return{mempty:tk(tT("Return",t.mempty),tA),Semigroup0:()=>e}},tG=t=>({bind:e=>r=>t.Bind1().bind(e)(e=>"Nothing"===e.tag?t.Applicative0().pure(M):"Just"===e.tag?r(e._1):void b()),Apply0:()=>tj(t)}),tj=t=>{let e=t.Bind1().Apply0().Functor0(),r={map:t=>r=>e.map(q.map(t))(r)};return{apply:(()=>{let e=tG(t);return r=>n=>e.bind(r)(r=>e.bind(n)(e=>tH(t).pure(r(e))))})(),Functor0:()=>r}},tH=t=>({pure:e=>t.Applicative0().pure(T("Just",e)),Apply0:()=>tj(t)}),tQ=t=>{let e=t.Monad0(),r={Applicative0:()=>tH(e),Bind1:()=>tG(e)};return{state:r=>e.Bind1().bind(t.state(r))(t=>e.Applicative0().pure(T("Just",t))),Monad0:()=>r}},tW=t=>{let e=t.Bind1(),r=e.Apply0().Functor0(),n={map:t=>e=>r.map(q.map(t))(e)};return{alt:r=>n=>e.bind(r)(e=>"Nothing"===e.tag?n:t.Applicative0().pure(e)),Functor0:()=>n}},tZ=t=>{let e=tW(t);return{empty:t.Applicative0().pure(M),Alt0:()=>e}},tK=t=>{let e=tH(t),r=tZ(t);return{Applicative0:()=>e,Plus1:()=>r}},t$=function(t,e,r,n){return r>=0&&r<n.length?t(n[r]):e},tV=function(t,e,r){var n=t>=0&&t<r.length;return n&&(r[t]=e),n},tY=(l=function(t,e,r,n){return n.splice.apply(n,[t,e].concat(r))},function(t){return function(e){return function(r){return function(n){return function(){return l(t,e,r,n)}}}}}),tX=(d=function(t,e){return e.push(t)},function(t){return function(e){return function(){return d(t,e)}}}),t1=function(t){return function(e){for(var r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t(i)(e[i]);return n}},t0={mapWithIndex:t1,Functor0:()=>x},t2=function(t){return function(e){return t===e}},t3={eq:t=>t=>!0},t5={eq:t2},t4={eq:t2},t7=function(t){return function(e){return function(r){return function(n){return function(i){return n<i?t:n===i?e:r}}}}},t6={compare:t=>t=>"EQ",Eq0:()=>t3},t9={compare:t7("LT")("EQ")("GT"),Eq0:()=>t5},t8={compare:t7("LT")("EQ")("GT"),Eq0:()=>t4},et=function(t,e){for(var r=t>e?-1:1,n=Array(r*(e-t)+1),i=t,o=0;i!==e;)n[o++]=i,i+=r;return n[o]=i,n};Array.prototype.fill;var ee=function(){function t(t,e){this.head=t,this.tail=e}var e={};function r(e){return function(r){return new t(e,r)}}return function(t,n){return function(t){for(var r=[],n=0,i=t;i!==e;)r[n++]=i.head,i=i.tail;return r}(t(r)(e)(n))}}(),er=function(t,e,r,n){for(var i=0,o=n.length;i<o;i++)if(r(n[i]))return t(i);return e},en=function(t,e,r,n){if(r<0||r>=n.length)return e;var i=n.slice();return i.splice(r,1),t(i)},ei=function(t,e,r,n,i){if(r<0||r>=i.length)return e;var o=i.slice();return o[r]=n,t(o)},eo=function(t,e){return e.filter(t)},eu=function(t,e,r){var n;return r.length<2?r:(!function t(e,r,n,i,o,u){var a,l,d,c,s,f;for((a=o+(u-o>>1))-o>1&&t(e,r,i,n,o,a),u-a>1&&t(e,r,i,n,a,u),l=o,d=a,c=o;l<a&&d<u;)s=i[l],f=i[d],r(e(s)(f))>0?(n[c++]=f,++d):(n[c++]=s,++l);for(;l<a;)n[c++]=i[l++];for(;d<u;)n[c++]=i[d++]}(t,e,n=r.slice(0),r.slice(0),0,r.length),n)},ea=function(t,e,r){for(var n=e.length<r.length?e.length:r.length,i=Array(n),o=0;o<n;o++)i[o]=t(e[o])(r[o]);return i},el=function(t,e){for(var r=e.length,n=0;n<r;n++)if(!t(e[n]))return!1;return!0},ed=t=>e=>eu(t,t=>"GT"===t?1:"EQ"===t?0:"LT"===t?-1:void b(),e),ec=t=>e=>ed(r=>n=>t.compare(e(r))(e(n))),es=t=>e=>(()=>{let r=tX(e);return()=>{let e=[...t];return r(e)(),e}})()(),ef=t=>{let e=t.length-1|0;return e>=0&&e<t.length?T("Just",t[e]):M},ep=t=>e=>r=>t>=0&&t<r.length?ei(O,M,t,e(r[t]),r):M,e_=t=>e=>{let r=ed(e=>r=>t(e._2)(r._2))(t1(td)(e));return 0<r.length?S(tc)(ec(t8)(tf)((()=>{let e=[r[0]];for(let n of r){let r=t((()=>{let t=ef(e);if("Just"===t.tag)return t._1._2;b()})())(n._2);("LT"===r||"GT"===r||"EQ"!==r)&&e.push(n)}return e})())):[]},eg=t=>e=>{let r=er(O,M,t,e);return"Just"===r.tag?T("Just",e[r._1]):M},ev=t=>e=>r=>{let n=er(O,M,r=>t.eq(r)(e),r);return"Nothing"===n.tag||"Just"!==n.tag&&void b()},em=t=>e=>r=>{let n=er(O,M,r=>t.eq(r)(e),r);return"Nothing"!==n.tag&&("Just"===n.tag||void b())},eh=t=>e=>r=>{if(0===r.length)return[];let n=er(O,M,t(e),r);if("Nothing"===n.tag)return r;if("Just"===n.tag){let t=en(O,M,n._1,r);if("Just"===t.tag)return t._1}b()},ey=t=>e=>J(e)(t),eb=t=>ey(e=>{let r=t(e);return"Nothing"===r.tag?[]:"Just"===r.tag?[r._1]:void b()}),eR={unfoldr1:(c=t=>"Nothing"===t.tag||"Just"!==t.tag&&void b(),function(t){return function(e){return function(r){return function(n){return function(i){for(var o=[],u=i;;){var a=n(u);o.push(e(a));var l=r(a);if(c(l))return o;u=t(l)}}}}}})(t=>{if("Just"===t.tag)return t._1;b()})(tf)(tc)},ew=(t,e,r,n,i,o,u)=>({tag:t,_1:e,_2:r,_3:n,_4:i,_5:o,_6:u}),eS=(t,e,r)=>({tag:"Split",_1:t,_2:e,_3:r}),ex=(t,e,r)=>({tag:"SplitLast",_1:t,_2:e,_3:r}),eE=t=>t,eJ=ew("Leaf"),eN=(t,e,r,n)=>{if("Leaf"===r.tag){if("Leaf"===n.tag)return ew("Node",1,1,t,e,r,n);if("Node"===n.tag)return ew("Node",1+n._1|0,1+n._2|0,t,e,r,n);b()}if("Node"===r.tag){if("Leaf"===n.tag)return ew("Node",1+r._1|0,1+r._2|0,t,e,r,n);if("Node"===n.tag)return ew("Node",r._1>n._1?1+r._1|0:1+n._1|0,(1+r._2|0)+n._2|0,t,e,r,n)}b()},eA=(t,e,r,n)=>{if("Leaf"===r.tag)return"Leaf"===n.tag?ew("Node",1,1,t,e,eJ,eJ):"Node"===n.tag&&n._1>1?"Node"===n._5.tag&&("Leaf"===n._6.tag?n._5._1>0:"Node"===n._6.tag?n._5._1>n._6._1:void b())?eN(n._5._3,n._5._4,eN(t,e,r,n._5._5),eN(n._3,n._4,n._5._6,n._6)):eN(n._3,n._4,eN(t,e,r,n._5),n._6):eN(t,e,r,n);if("Node"===r.tag)return"Node"===n.tag?n._1>(r._1+1|0)?"Node"===n._5.tag&&("Leaf"===n._6.tag?n._5._1>0:"Node"===n._6.tag?n._5._1>n._6._1:void b())?eN(n._5._3,n._5._4,eN(t,e,r,n._5._5),eN(n._3,n._4,n._5._6,n._6)):eN(n._3,n._4,eN(t,e,r,n._5),n._6):r._1>(n._1+1|0)?"Node"===r._6.tag&&("Leaf"===r._5.tag?0<=r._6._1:"Node"===r._5.tag?r._5._1<=r._6._1:void b())?eN(r._6._3,r._6._4,eN(r._3,r._4,r._5,r._6._5),eN(t,e,r._6._6,n)):eN(r._3,r._4,r._5,eN(t,e,r._6,n)):eN(t,e,r,n):"Leaf"===n.tag&&r._1>1?"Node"===r._6.tag&&("Leaf"===r._5.tag?0<=r._6._1:"Node"===r._5.tag?r._5._1<=r._6._1:void b())?eN(r._6._3,r._6._4,eN(r._3,r._4,r._5,r._6._5),eN(t,e,r._6._6,n)):eN(r._3,r._4,r._5,eN(t,e,r._6,n)):eN(t,e,r,n);b()},eL=(t,e,r)=>{if("Leaf"===r.tag)return eS(M,eJ,eJ);if("Node"===r.tag){let n=t(e)(r._3);if("LT"===n){let n=eL(t,e,r._5);return eS(n._1,n._2,eA(r._3,r._4,n._3,r._6))}if("GT"===n){let n=eL(t,e,r._6);return eS(n._1,eA(r._3,r._4,r._5,n._2),n._3)}if("EQ"===n)return eS(T("Just",r._4),r._5,r._6)}b()},eC=(t,e,r,n)=>{if("Leaf"===n.tag)return ex(t,e,r);if("Node"===n.tag){let i=eC(n._3,n._4,n._5,n._6);return ex(i._1,i._2,eA(t,e,r,i._3))}b()},eB=(t,e)=>{if("Leaf"===t.tag)return e;if("Node"===t.tag){let r=eC(t._3,t._4,t._5,t._6);return eA(r._1,r._2,r._3,e)}b()},eI=(t,e,r,n)=>{if("Leaf"===r.tag)return n;if("Leaf"===n.tag)return r;if("Node"===n.tag){let i=eL(t,n._3,r),o=eI(t,e,i._2,n._5),u=eI(t,e,i._3,n._6);if("Just"===i._1.tag)return eA(n._3,e(i._1._1)(n._4),o,u);if("Nothing"===i._1.tag)return eA(n._3,n._4,o,u)}b()},ek=t=>e=>r=>{let n=r,i=!0,o;for(;i;){let r=n;if("Leaf"===r.tag){i=!1,o=M;continue}if("Node"===r.tag){let u=t.compare(e)(r._3);if("LT"===u){n=r._5;continue}if("GT"===u){n=r._6;continue}if("EQ"===u){i=!1,o=T("Just",r._4);continue}}b()}return o},eT=t=>e=>r=>{let n=i=>{if("Leaf"===i.tag)return ew("Node",1,1,e,r,eJ,eJ);if("Node"===i.tag){let o=t.compare(e)(i._3);if("LT"===o)return eA(i._3,i._4,n(i._5),i._6);if("GT"===o)return eA(i._3,i._4,i._5,n(i._6));if("EQ"===o)return ew("Node",i._1,i._2,e,r,i._5,i._6)}b()};return n},eM={map:t=>{let e=r=>"Leaf"===r.tag?eJ:"Node"===r.tag?ew("Node",r._1,r._2,r._3,t(r._4),e(r._5),e(r._6)):void b();return e}},eO={foldr:t=>e=>{let r=(e,n)=>"Leaf"===e.tag?n:"Node"===e.tag?r(e._5,t(e._4)(r(e._6,n))):void b();return t=>r(t,e)},foldl:t=>e=>{let r=(e,n)=>"Leaf"===n.tag?e:"Node"===n.tag?r(t(r(e,n._5))(n._4),n._6):void b();return t=>r(e,t)},foldMap:t=>{let e=t.mempty,r=t.Semigroup0();return t=>{let n=i=>"Leaf"===i.tag?e:"Node"===i.tag?r.append(n(i._5))(r.append(t(i._4))(n(i._6))):void b();return n}}},eq={traverse:t=>{let e=t.Apply0();return r=>{let n=i=>{if("Leaf"===i.tag)return t.pure(eJ);if("Node"===i.tag){let t=i._1,o=i._3,u=i._2;return e.apply(e.apply(e.Functor0().map(e=>r=>n=>ew("Node",t,u,o,r,e,n))(n(i._5)))(r(i._4)))(n(i._6))}b()};return n}},sequence:t=>eq.traverse(t)(eE),Functor0:()=>eM,Foldable1:()=>eO},eP=t=>e=>r=>n=>i=>o=>{let u=(()=>{if("Just"===n.tag){let e=n._1;return r=>"LT"===t.compare(r)(e)}if("Nothing"===n.tag)return t=>!1;b()})(),a=(()=>{if("Just"===i.tag){let e=i._1;return r=>"GT"===t.compare(r)(e)}if("Nothing"===i.tag)return t=>!1;b()})(),l=(()=>{if("Just"===n.tag){if("Just"===i.tag){let e=i._1,r=n._1;return n=>"GT"!==t.compare(r)(n)&&"GT"!==t.compare(n)(e)}if("Nothing"===i.tag){let e=n._1;return r=>"GT"!==t.compare(e)(r)}b()}if("Nothing"===n.tag){if("Just"===i.tag){let e=i._1;return r=>"GT"!==t.compare(r)(e)}if("Nothing"===i.tag)return t=>!0}b()})(),d=t=>"Leaf"===t.tag?r:"Node"===t.tag?e(e(u(t._3)?r:d(t._5))(l(t._3)?o(t._3)(t._4):r))(a(t._3)?r:d(t._6)):void b();return d},eF=t=>e=>eP(t)(e.Semigroup0().append)(e.mempty),eD=t=>t=>{let e=r=>"Leaf"===r.tag?eJ:"Node"===r.tag?t(r._3)?eA(r._3,r._4,e(r._5),e(r._6)):eB(e(r._5),e(r._6)):void b();return e},ez=t=>e=>{let r=n=>{if("Leaf"===n.tag)return eJ;if("Node"===n.tag){let i=t.compare(e)(n._3);if("LT"===i)return eA(n._3,n._4,r(n._5),n._6);if("GT"===i)return eA(n._3,n._4,n._5,r(n._6));if("EQ"===i)return eB(n._5,n._6)}b()};return r},eU=t=>{let e={alt:(()=>{let e=t.compare;return t=>r=>eI(e,R,t,r)})(),Functor0:()=>eM};return{empty:eJ,Alt0:()=>e}},eG=(t,e,r)=>({tag:"OrdBox",_1:t,_2:e,_3:r}),ej=t=>e=>r=>eG(t,e,r),eH={eq:t=>e=>t._1(t._3)(e._3)},eQ=(t=>{let e=t.Eq0();return r=>{let n=r.Eq0(),i={eq:t=>r=>e.eq(t._1)(r._1)&&n.eq(t._2)(r._2)};return{compare:e=>n=>{let i=t.compare(e._1)(n._1);return"LT"===i?"LT":"GT"===i?"GT":r.compare(e._2)(n._2)},Eq0:()=>i}}})(t9)({compare:t=>e=>t._2(t._3)(e._3),Eq0:()=>eH}),eW=(t=>{let e=t.compare;return t=>r=>{let n=eL(e,t,r);return"Just"===n._1.tag?T("Just",tl(n._1._1,eB(n._2,n._3))):M}})(eQ),eZ=()=>t=>e=>{let r=eF(eQ)((()=>{let t=eU(e),r=t.Alt0(),n={append:t=>e=>r.alt(t)(e)};return{mempty:t.empty,Semigroup0:()=>n}})());return e=>n=>{let i=t.reflectSymbol(e);return r(M)(M)(t=>e=>i===t._1?ew("Node",1,1,t._2._3,e,eJ,eJ):eJ)(n)}},eK=()=>t=>e=>{let r=ej(e.Eq0().eq)(e.compare);return e=>n=>i=>eW(tl(t.reflectSymbol(e),r(n)))(i)},e$=()=>t=>e=>{let r=ej(e.Eq0().eq)(e.compare);return e=>n=>i=>ek(eQ)(tl(t.reflectSymbol(e),r(n)))(i)},eV=()=>t=>e=>{let r=ej(e.Eq0().eq)(e.compare);return e=>n=>i=>o=>eT(eQ)(tl(t.reflectSymbol(e),r(n)))(i)(o)},eY=function(t){return function(e){return e.join(t)}},eX="InputNumber",e1=t=>"InputButton"===t?"button":"InputCheckbox"===t?"checkbox":"InputColor"===t?"color":"InputDate"===t?"date":"InputDatetimeLocal"===t?"datetime-local":"InputEmail"===t?"email":"InputFile"===t?"file":"InputHidden"===t?"hidden":"InputImage"===t?"image":"InputMonth"===t?"month":"InputNumber"===t?"number":"InputPassword"===t?"password":"InputRadio"===t?"radio":"InputRange"===t?"range":"InputReset"===t?"reset":"InputSearch"===t?"search":"InputSubmit"===t?"submit":"InputTel"===t?"tel":"InputText"===t?"text":"InputTime"===t?"time":"InputUrl"===t?"url":"InputWeek"===t?"week":void b(),e0=(t,e,r)=>({tag:t,_1:e,_2:r});function e2(t,e,r){return null==t?e:r(t)}var e3=t=>({bind:e=>r=>t.Bind1().bind(e)(e=>"Left"===e.tag?t.Applicative0().pure(D("Left",e._1)):"Right"===e.tag?r(e._1):void b()),Apply0:()=>e5(t)}),e5=t=>{let e=t.Bind1().Apply0().Functor0(),r={map:t=>e.map(e=>"Left"===e.tag?D("Left",e._1):"Right"===e.tag?D("Right",t(e._1)):void b())};return{apply:(()=>{let e=e3(t);return r=>n=>e.bind(r)(r=>e.bind(n)(e=>e4(t).pure(r(e))))})(),Functor0:()=>r}},e4=t=>({pure:e=>t.Applicative0().pure(D("Right",e)),Apply0:()=>e5(t)}),e7=t=>{let e={Applicative0:()=>e4(t),Bind1:()=>e3(t)};return{throwError:e=>t.Applicative0().pure(D("Left",e)),Monad0:()=>e}},e6=isFinite,e9=Math.floor,e8=function(t){return t},rt=(o=10,u=RegExp("^[\\+\\-]?"+("[0-"+(o-1).toString()+"]")+"+$","i"),function(t){if(!u.test(t))return M;var e=parseInt(t,o);return(0|e)===e?O(e):M}),re=function(t){return(0|t)===t?O(t):M},rr=t=>{if(!e6(t))return 0;if(t>=e8(2147483647))return 2147483647;if(t<=e8(-2147483648))return -2147483648;let e=re(t);return"Nothing"===e.tag?0:"Just"===e.tag?e._1:void b()},rn=t=>e=>{var r;let n=(r=t.length,function(t){return{before:t.substring(0,r),after:t.substring(r)}})(e);return n.before===t?T("Just",n.after):M};function ri(t){return Object.prototype.toString.call(t).slice(8,-1)}var ro=(t,e,r)=>({tag:t,_1:e,_2:r}),ru=t=>"ForeignError"===t.tag?t._1:"ErrorAtIndex"===t.tag?"Error at array index "+L(t._1)+": "+ru(t._2):"ErrorAtProperty"===t.tag?"Error at property "+B(t._1)+": "+ru(t._2):"TypeMismatch"===t.tag?"Type mismatch: expected "+t._1+", found "+t._2:void b(),ra=t=>e=>r=>ri(r)===e?e4(t).pure(r):e7(t).throwError(ta(ro("TypeMismatch",e,ri(r)),tg)),rl=t=>ra(t)("String"),rd={foldrWithIndex:t=>e=>{let r=tt(e=>{let r=e._1,n=e._2;return e=>t(r)(n)(e)})(e),n=t1(td);return t=>r(n(t))},foldlWithIndex:t=>e=>{let r=te(e=>r=>t(r._1)(e)(r._2))(e),n=t1(td);return t=>r(n(t))},foldMapWithIndex:t=>{let e=t.mempty;return r=>rd.foldrWithIndex(e=>n=>i=>t.Semigroup0().append(r(e)(n))(i))(e)},Foldable0:()=>tu},rc=(t,e,r,n)=>({tag:"Step",_1:t,_2:e,_3:r,_4:n}),rs=(t,e)=>{let r=t._2;return t._3(r,e)},rf=t=>{let e=t._2;return t._4(e)};function rp(t,e,r){for(var n={},i=0;i<t.length;i++){var o=t[i],u=e(o);n[u]=r(u,i,o)}return n}function r_(t,e,r,n,i,o){for(var u={},a=0;a<e.length;a++){var l=e[a],d=r(l);t.hasOwnProperty(d)?u[d]=n(d,a,t[d],l):u[d]=o(d,a,l)}for(var d in t)d in u||i(d,t[d]);return u}function rg(t,e,r){return null!=t?r.createElementNS(t,e):r.createElement(e)}function rv(t,e,r){var n=r.childNodes.item(t)||null;n!==e&&r.insertBefore(e,n)}function rm(t,e){e&&t.parentNode===e&&e.removeChild(t)}function rh(t){return t.parentNode}function ry(t,e,r,n){null!=t?n.setAttributeNS(t,e,r):n.setAttribute(e,r)}function rb(t,e,r){null!=t?r.removeAttributeNS(t,e):r.removeAttribute(e)}var rR=void 0;function rw(t){return function(){return function(e){return t(e)()}}}function rS(t){return function(e){return function(r){return function(n){return function(){return n.addEventListener(t,e,r)}}}}}function rx(t){return function(e){return function(r){return function(n){return function(){return n.removeEventListener(t,e,r)}}}}}var rE=(t,e)=>({tag:t,_1:e}),rJ=(t,e,r,n)=>({tag:t,_1:e,_2:r,_3:n}),rN=t=>e=>rJ("Property",t,e),rA=(t,e)=>e.hasAttribute(t)?rb(null,t,e):"string"==typeof e[t]?void(e[t]=""):"rowSpan"===t||"colSpan"===t?void(e[t]=1):void(e[t]=rR),rL=t=>"Attribute"===t.tag?"Just"===t._1.tag?"attr/"+t._1._1+":"+t._2:"attr/:"+t._2:"Property"===t.tag?"prop/"+t._1:"Handler"===t.tag?"handler/"+t._1:"Ref"===t.tag?"ref":void b(),rC=t=>e=>{let r=r=>{var n;let i="ref"in(n=r.props)?O(n.ref):M;if("Just"===i.tag&&"Ref"===i._1.tag){let r=i._1._1(rE("Removed",e));if("Just"===r.tag)return t(r._1)()}},n=r=>(n,i,o)=>{var u,a,l;if("Attribute"===o.tag){let t=o._2,r=o._3;return ry("Nothing"===o._1.tag?null:"Just"===o._1.tag?o._1._1:void b(),t,r,e),o}if("Property"===o.tag){let t=o._1,r=o._2;return e[t]=r,o}if("Handler"===o.tag){if(u=o._1,r.hasOwnProperty(u))return r[o._1]._2.value=o._2,o;let n={value:o._2},i=rw(e=>()=>{let r=(0,n.value)(e);if("Just"===r.tag)return t(r._1)()})();return a=o._1,l=tl(i,n),r[a]=l,!function(t,e,r){r.addEventListener(t,e,!1)}(o._1,i,e),o}if("Ref"===o.tag){let r=o._1(rE("Created",e));return"Just"===r.tag&&t(r._1)(),o}b()},i=(t,o)=>{let u={},a=t.events,l=r_(t.props,o,rL,(t,r,n,i)=>{var o,l;if("Attribute"===n.tag){if("Attribute"===i.tag){if(n._3===i._3)return i;ry("Nothing"===i._1.tag?null:"Just"===i._1.tag?i._1._1:void b(),i._2,i._3,e)}return i}if("Property"===n.tag){if("Property"===i.tag){if(n._2===i._2||"value"===i._1&&e.value===i._2)return i;o=i._1,l=i._2,e[o]=l}return i}if("Handler"===n.tag&&"Handler"===i.tag){let t=i._2,e=i._1,r=a[e];r._2.value=t,u[e]=r}return i},(t,r)=>{if("Attribute"===r.tag){let t=r._2;return rb("Nothing"===r._1.tag?null:"Just"===r._1.tag?r._1._1:void b(),t,e)}if("Property"===r.tag)return rA(r._1,e);if("Handler"===r.tag){let t=r._1,n=a[t]._1;return function(t,e,r){r.removeEventListener(t,e,!1)}(t,n,e)}"Ref"!==r.tag&&b()},n(u));return rc(void 0,{events:u,props:l},i,r)};return t=>{let e={},o=rp(t,rL,n(e));return rc(void 0,{events:e,props:o},i,r)}},rB=(t,e,r)=>({tag:"Graft",_1:t,_2:e,_3:r}),rI=(t,e,r,n,i)=>({tag:t,_1:e,_2:r,_3:n,_4:i}),rk=t=>{let e=r=>{if("Text"===r.tag)return rI("Text",r._1);if("Elem"===r.tag)return rI("Elem",r._1,r._2,t._1(r._3),S(e)(r._4));if("Keyed"===r.tag)return rI("Keyed",r._1,r._2,t._1(r._3),S(t=>tl(t._1,e(t._2)))(r._4));if("Widget"===r.tag)return rI("Widget",t._2(r._1));if("Grafted"===r.tag){let e=r._1;return rI("Grafted",rB(r=>t._1(e._1(r)),r=>t._2(e._2(r)),e._3))}b()};return e(t._3)},rT=(t,e,r)=>({tag:t,_1:e,_2:r}),rM=t=>t,rO=t=>e=>r=>n=>i=>o=>{let u,a=t,l=e,d=r,c=n,s=i,f=o,p=!0;for(;p;){let t=a,e=l,r=d,n=c,i=s,o=f;if("Pure"===i.tag){p=!1,u=tl(t_("Cons",{func:t.pure(i._1),count:o},e),r);continue}if("Lift"===i.tag){p=!1,u=tl(t_("Cons",{func:n(i._1),count:o},e),r);continue}if("Ap"===i.tag){a=t,l=e,d=ta(i._2,t_("Cons",r._1,r._2)),c=n,s=i._1,f=o+1|0;continue}b()}return u},rq=t=>e=>r=>n=>{let i=t,o=e,u=r,a=n,l=!0,d;for(;l;){let t=i,e=o,r=u,n=a;if("Nil"===e.tag){l=!1,d=D("Left",n);continue}if("Cons"===e.tag){let c=t.Apply0().apply(e._1.func)(n);if(1===e._1.count){if("Nil"===e._2.tag){l=!1,d=D("Left",c);continue}i=t,o=e._2,u=r,a=c;continue}if("Nil"===r.tag){l=!1,d=D("Left",c);continue}if("Cons"===r.tag){l=!1,d=D("Right",tl(t_("Cons",{func:c,count:e._1.count-1|0},e._2),ta(r._1,r._2)));continue}}b()}return d},rP={map:t=>e=>rT("Ap",rT("Pure",t),e)},rF=t=>e=>r=>(r=>{let n=r,i=!0,o;for(;i;){let r=n;if("Pure"===r._2._1.tag){let e=rq(t)(r._1)(r._2._2)(t.pure(r._2._1._1));if("Left"===e.tag){i=!1,o=e._1;continue}if("Right"===e.tag){n=e._1;continue}b()}if("Lift"===r._2._1.tag){let u=rq(t)(r._1)(r._2._2)(e(r._2._1._1));if("Left"===u.tag){i=!1,o=u._1;continue}if("Right"===u.tag){n=u._1;continue}b()}if("Ap"===r._2._1.tag){n=rO(t)(r._1)(ta(r._2._1._2,r._2._2))(e)(r._2._1._1)(1);continue}b()}return o})(tl(tg,ta(r,tg))),rD={apply:t=>e=>rT("Ap",t,e),Functor0:()=>rP},rz={pure:t=>rT("Pure",t),Apply0:()=>rD},rU=(t,e,r)=>({tag:"ChildQuery",_1:t,_2:e,_3:r}),rG=(t,e,r)=>({tag:t,_1:e,_2:r}),rj=t=>t,rH=t=>t,rQ=t=>t,rW=()=>t=>e=>{let r=eZ()(t)(e);return t=>n=>{let i=(t,r)=>"Leaf"===t.tag?r:"Node"===t.tag?i(t._5,(()=>{let n=i(t._6,r);return"Nothing"===t._4.tag?n:"Just"===t._4.tag?eT(e)(t._3)(t._4._1)(n):void b()})()):void b();return tk(tT("Bind",rG("ChildQuery",rU(e=>{let n=eq.traverse(e);return o=>{let u=e.Apply0().Functor0().map(t=>i(t,eJ)),a=n(o),l=r(t);return t=>u(a(l(t)))}},n,rj)),t=>tk(tT("Return",t),tA)),tA)}},rZ=()=>t=>e=>{let r=e$()(t)(e);return t=>e=>n=>tk(tT("Bind",rG("ChildQuery",rU(n=>i=>{let o=n.pure(M),u=r(t)(e);return t=>{let e=u(t);return"Nothing"===e.tag?o:"Just"===e.tag?i(e._1):void b()}},n,rj)),t=>tk(tT("Return",t),tA)),tA)},rK={state:t=>tk(tT("Bind",rG("State",t),t=>tk(tT("Return",t),tA)),tA),Monad0:()=>tO},r$=t=>({liftEffect:e=>tk(tT("Bind",rG("Lift",t.liftEffect(e)),t=>tk(tT("Return",t),tA)),tA),Monad0:()=>tO}),rV=t=>tk(tT("Bind",rG("Kill",t,void 0),t=>tk(tT("Return",t),tA)),tA),rY=t=>rf(t.widget),rX=(t,e)=>{if("Grafted"===e.tag)return rX(t,rk(e._1));if("Widget"===e.tag){let r=e._1,n=rs(t.widget,r);return rc(n._1,{build:t.build,widget:n},rX,rY)}return rY(t),t.build(e)},r1=t=>{let e=t.node,r=rh(e);return rm(e,r)},r0=(t,e)=>{if("Grafted"===e.tag)return r0(t,rk(e._1));if("Text"===e.tag){if(t.value===e._1)return rc(t.node,t,r0,r1);let r=e._1;return t.node.textContent=r,rc(t.node,{build:t.build,node:t.node,value:r},r0,r1)}return r1(t),t.build(e)},r2=t=>{let e=t.attrs,r=t.children,n=t.node,i=rh(n);return rm(n,i),!function(t,e){for(var r=Object.keys(t),n=0;n<r.length;n++){var i=r[n];e(i,t[i])}}(r,(t,e)=>rf(e)),rf(e)},r3=t=>{let e=t.attrs,r=t.children,n=t.node,i=rh(n);return rm(n,i),!function(t,e){for(var r=0;r<t.length;r++)e(t[r])}(r,rf),rf(e)},r5=(t,e,r,n)=>e===n&&("Just"===t.tag?"Just"===r.tag&&t._1===r._1:"Nothing"===t.tag&&"Nothing"===r.tag),r4=(t,e)=>{if("Grafted"===e.tag)return r4(t,rk(e._1));if("Elem"===e.tag&&r5(t.ns,t.name,e._1,e._2)){if(0===t.children.length&&0===e._4.length){let r=rs(t.attrs,e._3);return rc(t.node,{build:t.build,node:t.node,attrs:r,ns:e._1,name:e._2,children:t.children},r4,r3)}let r=function(t,e,r,n,i){for(var o=[],u=t.length,a=e.length,l=0;;){if(l<u)l<a?o.push(r(l,t[l],e[l])):n(l,t[l]);else if(l<a)o.push(i(l,e[l]));else break;l++}return o}(t.children,e._4,(e,r,n)=>{let i=rs(r,n);return rv(e,i._1,t.node),i},(t,e)=>rf(e),(e,r)=>{let n=t.build(r);return rv(e,n._1,t.node),n}),n=rs(t.attrs,e._3);return rc(t.node,{build:t.build,node:t.node,attrs:n,ns:e._1,name:e._2,children:r},r4,r3)}return r3(t),t.build(e)},r7=(t,e)=>{if("Grafted"===e.tag)return r7(t,rk(e._1));if("Keyed"===e.tag&&r5(t.ns,t.name,e._1,e._2)){let r=e._4.length;if(0===t.length&&0===r){let r=rs(t.attrs,e._3);return rc(t.node,{build:t.build,node:t.node,attrs:r,ns:e._1,name:e._2,children:t.children,length:0},r7,r2)}let n=r_(t.children,e._4,tf,(e,r,n,i)=>{let o=rs(n,i._2);return rv(r,o._1,t.node),o},(t,e)=>rf(e),(e,r,n)=>{let i=n._2,o=t.build(i);return rv(r,o._1,t.node),o}),i=rs(t.attrs,e._3);return rc(t.node,{build:t.build,node:t.node,attrs:i,ns:e._1,name:e._2,children:n,length:r},r7,r2)}return r2(t),t.build(e)},r6=(t,e,r)=>{let n=t.buildWidget(t)(r);return rc(n._1,{build:e,widget:n},rX,rY)},r9=(t,e,r)=>{let n=t.document.createTextNode(r);return rc(n,{build:e,node:n,value:r},r0,r1)},r8=(t,e,r,n,i,o)=>{let u=rg("Nothing"===r.tag?null:"Just"===r.tag?r._1:void b(),n,t.document),a=rp(o,tf,(t,r,n)=>{let i=e(n._2);return rv(r,i._1,u),i}),l=t.buildAttributes(u)(i);return rc(u,{build:e,node:u,attrs:l,ns:r,name:n,children:a,length:o.length},r7,r2)},nt=(t,e,r,n,i,o)=>{let u=rg("Nothing"===r.tag?null:"Just"===r.tag?r._1:void b(),n,t.document),a=function(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e(n,t[n]));return r}(o,(t,r)=>{let n=e(r);return rv(t,n._1,u),n}),l=t.buildAttributes(u)(i);return rc(u,{build:e,node:u,attrs:l,ns:r,name:n,children:a},r4,r3)},ne=t=>{let e=r=>{if("Text"===r.tag)return r9(t,e,r._1);if("Elem"===r.tag){let n=r._3,i=r._4,o=r._2;return nt(t,e,r._1,o,n,i)}if("Keyed"===r.tag){let n=r._3,i=r._4,o=r._2;return r8(t,e,r._1,o,n,i)}return"Widget"===r.tag?r6(t,e,r._1):"Grafted"===r.tag?e(rk(r._1)):void b()};return e},nr=(t,e)=>t._1===e._1&&t._2===e._2&&t._2(t._4,e._4),nn=t=>{let e=(r,n)=>{if(nr(r.thunk,n))return rc(r.vdom._1,r,e,t=>rf(t.vdom));let i=t(n._3(n._4)),o=rs(r.vdom,i);return rc(o._1,{vdom:o,thunk:n},e,t=>rf(t.vdom))};return r=>n=>{let i=t(n._3(n._4)),o=ne(r)(i);return rc(o._1,{thunk:n,vdom:o},e,t=>rf(t.vdom))}},ni=(t,e)=>({tag:t,_1:e}),no=tr(tD)(to),nu=t=>e=>{if("Initialize"===e.tag){let r=e._1,n=no(t.handleAction)(t.initialize);return tk(n._1,tI(n._2)(t=>tk(tT("Return",r),tA)))}if("Finalize"===e.tag){let r=e._1,n=no(t.handleAction)(t.finalize);return tk(n._1,tI(n._2)(t=>tk(tT("Return",r),tA)))}if("Receive"===e.tag){let r=e._2,n=no(t.handleAction)(t.receive(e._1));return tk(n._1,tI(n._2)(t=>tk(tT("Return",r),tA)))}if("Action"===e.tag){let r=e._2,n=t.handleAction(e._1);return tk(n._1,tI(n._2)(t=>tk(tT("Return",r),tA)))}if("Query"===e.tag){let r=e._2(),n=t.handleQuery(e._1._2);return tk(n._1,tI(n._2)(t=>tk(tT("Return","Nothing"===t.tag?r:"Just"===t.tag?e._1._1(t._1):void b()),tA)))}b()},na={handleAction:t=>tk(tT("Return",void 0),tA),handleQuery:t=>tk(tT("Return",M),tA),receive:t=>M,initialize:M,finalize:M},nl=()=>t=>e=>{let r=e$()(t)(e),n=eK()(t)(e),i=eV()(t)(e);return t=>e=>o=>u=>a=>({get:r(t)(e),pop:n(t)(e),set:i(t)(e),component:o,input:u,output:a})},nd=rN("rel"),nc=(()=>{let t=rN("step");return e=>t("Any"===e.tag?"any":"Step"===e.tag?C(e._1):void b())})(),ns=rN("target"),nf=rN("min"),np=rN("max"),n_=rN("href"),ng=rN("draggable"),nv=(()=>{let t=rN("className"),e=eY(" "),r=S(tR);return n=>t(e(r(n)))})(),nm=rN("className"),nh=t=>()=>()=>e=>r=>n=>A(t.reflectSymbol(e))(r)(n),ny=t=>e=>rI("Elem",M,"i",[nv(["fa-solid "+t,...e])],[]),nb=t=>e=>r=>rI("Elem",M,"button",[nv(["rounded w-full h-full py-1 px-2 transition-colors duration-75",e]),rJ("Handler","click",t=>T("Just",e0("Action",r)))],[t]),nR=(t,e)=>({tag:t,_1:e}),nw=(t,e)=>({tag:"SetItems",_1:t,_2:e}),nS=(()=>{let t=tQ(rK);return e=>t.state(t=>tl(void 0,e))})(),nx=tH(tO).pure,nE=nh({reflectSymbol:()=>"selected"})()(),nJ=t=>tk(tT("Bind",rG("State",e=>tl(void 0,t(e))),t=>tk(tT("Return",t),tA)),tA),nN=t=>tk(tT("Bind",rG("State",e=>{let r=t(e);return tl(r,r)}),t=>tk(tT("Return",t),tA)),tA),nA=t=>tk(tT("Bind",rG("State",e=>tl(t(e),e)),t=>tk(tT("Return",t),tA)),tA),nL=t=>e=>nw(t,e),nC=nR("EnterEdit"),nB=nR("LeaveEdit"),nI=(t,e)=>({tag:t,_1:e}),nk=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,nT=[];for(s=0;s<256;++s)nT.push((s+256).toString(16).slice(1));var nM=new Uint8Array(16),nO={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},nq=function(t,e,r){if(nO.randomUUID&&!e&&!t)return nO.randomUUID();var n=(t=t||{}).random||(t.rng||function(){if(!f&&!(f="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(nM)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return function(t,e=0){return(nT[t[e+0]]+nT[t[e+1]]+nT[t[e+2]]+nT[t[e+3]]+"-"+nT[t[e+4]]+nT[t[e+5]]+"-"+nT[t[e+6]]+nT[t[e+7]]+"-"+nT[t[e+8]]+nT[t[e+9]]+"-"+nT[t[e+10]]+nT[t[e+11]]+nT[t[e+12]]+nT[t[e+13]]+nT[t[e+14]]+nT[t[e+15]]).toLowerCase()}(n)},nP=function(t){return"string"==typeof t&&nk.test(t)},nF={eq:t=>e=>t===e},nD={compare:t=>e=>t9.compare(t)(e),Eq0:()=>nF};function nz(t){return Error(t)}function nU(t){return function(){throw t}}var nG=t=>t,nj=t=>e=>{let r=tr(e);return e=>{let n=r(e);return e=>{let r=n(r=>t.parallel(e(r)));return e=>t.sequential(r(e))}}},nH=function(t){throw Error(t)},nQ=function(){var t={},e="Pure",r="Throw",n="Catch",i="Sync",o="Async",u="Bind",a="Bracket",l="Fork",d="Sequential",c="Apply",s="Cons",f="Resume",p="Release",_="Finalizer",g="Finalized",v="Forked";function m(t,e,r,n){this.tag=t,this._1=e,this._2=r,this._3=n}function h(t){var e=function(e,r,n){return new m(t,e,r,n)};return e.tag=t,e}function y(t){return new m(e,void 0)}var b=function(){var t=0,e=0,r=Array(1024),n=!1;function i(){var i;for(n=!0;0!==t;)t--,i=r[e],r[e]=void 0,e=(e+1)%1024,i();n=!1}return{isDraining:function(){return n},enqueue:function(o){var u;1024===t&&(u=n,i(),n=u),r[(e+t)%1024]=o,t++,n||i()}}}();return m.EMPTY=t,m.Pure=h(e),m.Throw=h(r),m.Catch=h(n),m.Sync=h(i),m.Async=h(o),m.Bind=h(u),m.Bracket=h(a),m.Fork=h(l),m.Seq=h(d),m.ParMap=h("Map"),m.ParApply=h(c),m.ParAlt=h("Alt"),m.Fiber=function h(R,w,S){var x=0,E=0,J=S,N=null,A=null,L=null,C=null,B=null,I=0,k=0,T=null,M=!0;function O(S){for(var k,q,P;;)switch(k=null,q=null,P=null,E){case 2:E=1;try{J=L(J),null===C?L=null:(L=C._1,C=C._2)}catch(t){E=5,N=R.left(t),J=null}break;case 3:R.isLeft(J)?(E=5,N=J,J=null):null===L?E=5:(E=2,J=R.fromRight(J));break;case 1:switch(J.tag){case u:L&&(C=new m(s,L,C)),L=J._2,E=1,J=J._1;break;case e:null===L?(E=5,J=R.right(J._1)):(E=2,J=J._1);break;case i:E=3,J=function(t,e,r){try{return e(r())}catch(e){return t(e)}}(R.left,R.right,J._1);break;case o:E=4,J=function(t,e,r){try{return e(r)()}catch(e){return r(t(e))(),y}}(R.left,J._1,function(t){return function(){x===S&&(x++,b.enqueue(function(){x===S+1&&(E=3,J=t,O(x))}))}});return;case r:E=5,N=R.left(J._1),J=null;break;case n:B=null===L?new m(s,J,B,A):new m(s,J,new m(s,new m(f,L,C),B,A),A),L=null,C=null,E=1,J=J._1;break;case a:I++,B=null===L?new m(s,J,B,A):new m(s,J,new m(s,new m(f,L,C),B,A),A),L=null,C=null,E=1,J=J._1;break;case l:E=3,k=h(R,w,J._2),w&&w.register(k),J._1&&k.run(),J=R.right(k);break;case d:E=1,J=function(e,r,n){return new m(o,function(i){return function(){return function(e,r,n,i){var u=0,a={},l=0,d={},f=Error("[ParAff] Early exit"),p=null,_=t;function g(r,n,i){var o,u,l=n,d=null,f=null,p=0,_={};e:for(;;)switch(o=null,l.tag){case v:if(l._3===t&&(o=a[l._1],_[p++]=o.kill(r,function(t){return function(){0==--p&&i(t)()}})),null===d)break e;l=d._2,null===f?d=null:(d=f._1,f=f._2);break;case"Map":l=l._2;break;case c:case"Alt":d&&(f=new m(s,d,f)),d=l,l=l._1}if(0===p)i(e.right(void 0))();else for(u=0,o=p;u<o;u++)_[u]=_[u]();return _}return function(){var o,y,b=1,R=n,w=null,S=null;e:for(;;)switch(o=null,y=null,b){case 1:switch(R.tag){case"Map":w&&(S=new m(s,w,S)),w=new m("Map",R._1,t,t),R=R._2;break;case c:w&&(S=new m(s,w,S)),w=new m(c,t,R._2,t),R=R._1;break;case"Alt":w&&(S=new m(s,w,S)),w=new m("Alt",t,R._2,t),R=R._1;break;default:y=u++,b=5,o=R,R=new m(v,y,new m(s,w,S),t),(o=h(e,r,o)).onComplete({rethrow:!1,handler:function(r){return function(n){return function(){delete a[r._1],r._3=n,function r(n,o,u){var a,s,_,v,m,h;for(e.isLeft(n)?(a=n,s=null):(s=n,a=null);;){if(_=null,v=null,m=null,h=null,null!==p)return;if(null===o){i(a||s)();return}if(o._3!==t)return;switch(o.tag){case"Map":null===a?(o._3=e.right(o._1(e.fromRight(s))),s=o._3):o._3=a;break;case c:if(_=o._1._3,v=o._2._3,a){if(o._3=a,m=!0,d[h=l++]=g(f,a===_?o._2:o._1,function(){return function(){delete d[h],m?m=!1:null===u?r(a,null,null):r(a,u._1,u._2)}}),m){m=!1;return}}else{if(_===t||v===t)return;s=e.right(e.fromRight(_)(e.fromRight(v))),o._3=s}break;case"Alt":if(_=o._1._3,v=o._2._3,_===t&&e.isLeft(v)||v===t&&e.isLeft(_))return;if(_!==t&&e.isLeft(_)&&v!==t&&e.isLeft(v))a=s===_?v:_,s=null,o._3=a;else if(o._3=s,m=!0,d[h=l++]=g(f,s===_?o._2:o._1,function(){return function(){delete d[h],m?m=!1:null===u?r(s,null,null):r(s,u._1,u._2)}}),m){m=!1;return}}null===u?o=null:(o=u._1,u=u._2)}}(n,r._2._1,r._2._2)}}}(R)})(),a[y]=o,r&&r.register(o)}break;case 5:if(null===w)break e;w._1===t?(w._1=R,b=1,R=w._2,w._2=t):(w._2=R,R=w,null===S?w=null:(w=S._1,S=S._2))}for(y=0,_=R;y<u;y++)a[y].run()}(),function(t){return new m(o,function(r){return function(){return function(t,r){for(var n in p=e.left(t),d)if(d.hasOwnProperty(n))for(n in i=d[n])i.hasOwnProperty(n)&&i[n]();d=null;var i,u=g(t,_,r);return function(t){return new m(o,function(t){return function(){for(var t in u)u.hasOwnProperty(t)&&u[t]();return y}})}}(t,r)}})}}(e,r,n,i)}})}(R,w,J._1)}break;case 5:if(L=null,C=null,null===B)E=6,J=A||N||J;else switch(k=B._3,P=B._1,B=B._2,P.tag){case n:A&&A!==k&&0===I?E=5:N&&(E=1,J=P._2(R.fromLeft(N)),N=null);break;case f:A&&A!==k&&0===I||N?E=5:(L=P._1,C=P._2,E=2,J=R.fromRight(J));break;case a:I--,null===N&&(q=R.fromRight(J),B=new m(s,new m(p,P._2,q),B,k),(A===k||I>0)&&(E=1,J=P._3(q)));break;case p:B=new m(s,new m(g,J,N),B,A),E=1,J=A&&A!==k&&0===I?P._1.killed(R.fromLeft(A))(P._2):N?P._1.failed(R.fromLeft(N))(P._2):P._1.completed(R.fromRight(J))(P._2),N=null,I++;break;case _:I++,B=new m(s,new m(g,J,N),B,A),E=1,J=P._1;break;case g:I--,E=5,J=P._1,N=P._2}break;case 6:for(var F in T)T.hasOwnProperty(F)&&(M=M&&T[F].rethrow,function(t){try{t()}catch(t){setTimeout(function(){throw t},0)}}(T[F].handler(J)));T=null,A&&N?setTimeout(function(){throw R.fromLeft(N)},0):R.isLeft(J)&&M&&setTimeout(function(){if(M)throw R.fromLeft(J)},0);return;case 0:E=1;break;case 4:return}}function q(t){return function(){if(6===E)return M=M&&t.rethrow,t.handler(J)(),function(){};var e=k++;return(T=T||{})[e]=t,function(){null!==T&&delete T[e]}}}return{kill:function(t,e){return function(){if(6===E)return e(R.right(void 0))(),function(){};var r=q({rethrow:!1,handler:function(){return e(R.right(void 0))}})();switch(E){case 0:A=R.left(t),E=6,J=A,O(x);break;case 4:null===A&&(A=R.left(t)),0===I&&(4===E&&(B=new m(s,new m(_,J(t)),B,A)),E=5,J=null,N=null,O(++x));break;default:null===A&&(A=R.left(t)),0===I&&(E=5,J=null,N=null)}return r}},join:function(t){return function(){var e=q({rethrow:!1,handler:t})();return 0===E&&O(x),e}},onComplete:q,isSuspended:function(){return 0===E},run:function(){0===E&&(b.isDraining()?O(x):b.enqueue(function(){O(x)}))}}},m.Supervisor=function(t){var e={},r=0,n=0;return{register:function(t){var i=r++;t.onComplete({rethrow:!0,handler:function(t){return function(){n--,delete e[i]}}})(),e[i]=t,n++},isEmpty:function(){return 0===n},killAll:function(o,u){return function(){if(0===n)return u();var a=0,l={};for(var d in e)e.hasOwnProperty(d)&&(a++,function(r){l[r]=e[r].kill(o,function(e){return function(){delete l[r],a--,t.isLeft(e)&&t.fromLeft(e)&&setTimeout(function(){throw t.fromLeft(e)},0),0===a&&u()}})()}(d));return e={},r=0,n=0,function(t){return new m(i,function(){for(var t in l)l.hasOwnProperty(t)&&l[t]()})}}}}},m.Scheduler=b,m.nonCanceler=y,m}(),nW=nQ.Pure,nZ=nQ.Throw;function nK(t){return function(e){return e.tag===nQ.Pure.tag?nQ.Pure(t(e._1)):nQ.Bind(e,function(e){return nQ.Pure(t(e))})}}function n$(t){return function(e){return nQ.Bind(t,e)}}var nV=nQ.Sync,nY=nQ.Async,nX=nQ.Seq,n1={map:function(t){return function(e){return nQ.ParMap(t,e)}}},n0={map:nK},n2=function(t){return nQ.Fork(!0,t)},n3={isLeft:t=>"Left"===t.tag||"Right"!==t.tag&&void b(),fromLeft:t=>"Left"===t.tag?t._1:"Right"===t.tag?nH("unsafeFromLeft: Right"):void b(),fromRight:t=>"Right"===t.tag?t._1:"Left"===t.tag?nH("unsafeFromRight: Left"):void b(),left:z,right:U},n5={apply:function(t){return function(e){return nQ.ParApply(t,e)}},Functor0:()=>n1},n4={Applicative0:()=>n9,Bind1:()=>n7},n7={bind:n$,Apply0:()=>n6},n6={apply:t=>e=>n$(t)(t=>n$(e)(e=>n9.pure(t(e)))),Functor0:()=>n0},n9={pure:nW,Apply0:()=>n6},n8=t=>e=>{var r;return(r=nW(),function(t){return function(e){return nQ.Bracket(r,t,e)}})({killed:e=>e=>t,failed:e=>e=>t,completed:e=>e=>t})(t=>e)},it={parallel:tR,sequential:nX,Apply0:()=>n6,Apply1:()=>n5},ie={pure:t=>nW(t),Apply0:()=>n5},ir={liftEffect:nV,Monad0:()=>n4},ii=t=>nY(e=>{let r=t.join(e);return()=>{let t=nV(r());return e=>t}}),io=t=>e=>n$(nV(e.isSuspended))(r=>r?nV((()=>{let r=e.kill(t,t=>()=>{});return()=>{r()}})()):nY(r=>{let n=e.kill(t,r);return()=>{let t=nV(n());return e=>t}})),iu={throwError:nZ,Monad0:()=>n4},ia=(t=>{let e=t.MonadThrow0().Monad0();return r=>t.catchError(e.Bind1().Apply0().Functor0().map(U)(r))(t=>e.Applicative0().pure(D("Left",t)))})({catchError:function(t){return function(e){return nQ.Catch(t,e)}},MonadThrow0:()=>iu}),il=t=>e=>{var r;let n=(r=n$(ia(e))(e=>nV(t(e))),function(){return nQ.Fiber(n3,null,r)});return()=>{let t=n();return t.run(),t}},id=t=>e=>{let r=il(t)(e);return()=>{r()}},ic=(()=>{let t=nW();return e=>t})(),is=()=>t=>e=>{let r=nl()(t)(e);return t=>e=>n=>i=>rI("Widget",ni("ComponentSlot",r(t)(e)(n)(i)(t=>M)))},ip=()=>t=>e=>{let r=nl()(t)(e);return t=>e=>n=>i=>o=>rI("Widget",ni("ComponentSlot",r(t)(e)(n)(i)(t=>T("Just",o(t)))))};function i_(t){return function(){return t.preventDefault()}}function ig(t,e,r,n){if("undefined"!=typeof window){var i=window[r];if(null!=i&&n instanceof i)return e(n)}for(var o=n;null!=o;){var u=Object.getPrototypeOf(o),a=u.constructor.name;if(a===r)return e(n);if("Object"===a)break;o=u}return t}function iv(t){return function(){t.select()}}var im=(t=>{let e=e4(t).pure;return r=>n=>{var i;return i=e7(t).throwError(ta(ro("TypeMismatch","object",typeof n),tg)),null==n?i:e(n[r])}})(W),ih=t=>e=>rJ("Handler",t,t=>{let r=e(t);return"Just"===r.tag?T("Just",e0("Action",r._1)):M}),iy=t=>e=>r=>n=>ih(t)(t=>{let i=e2(t.currentTarget,M,O);if("Just"===i.tag){let t=e3(W).bind(im(e)(i._1))(r);if("Left"===t.tag)return M;if("Right"===t.tag)return T("Just",n(t._1));b()}if("Nothing"===i.tag)return M;b()}),ib=t=>t,iR=()=>t=>e=>{let r=rZ()(t)(e);return t=>e=>n=>{let i=r(t)(e)(n());return tk(i._1,tI(i._2)(t=>tk(tT("Return",void 0),tA)))}},iw=()=>t=>e=>{let r=rW()(t)(e);return t=>e=>r(t)(e(ib))},iS={genericShowArgs:t=>[]},ix=t=>e=>({"genericShow'":r=>{let n=e.reflectSymbol(w),i=t.genericShowArgs(r);return 0===i.length?n:"("+[n,...i].join(" ")+")"}}),iE="AtLeast",iJ="JustDraw",iN="Remains",iA="JustRemains",iL="Choice",iC="LeftOne",iB="LeftAll",iI=t=>"AtLeast"===t?I("Inl",k):"JustDraw"===t?I("Inr",I("Inl",k)):"Remains"===t?I("Inr",I("Inr",I("Inl",k))):"JustRemains"===t?I("Inr",I("Inr",I("Inr",I("Inl",k)))):"Choice"===t?I("Inr",I("Inr",I("Inr",I("Inr",I("Inl",k))))):"LeftOne"===t?I("Inr",I("Inr",I("Inr",I("Inr",I("Inr",I("Inl",k)))))):"LeftAll"===t?I("Inr",I("Inr",I("Inr",I("Inr",I("Inr",I("Inr",k)))))):void b(),ik={show:(()=>{let t=ix(iS)({reflectSymbol:()=>"AtLeast"}),e=ix(iS)({reflectSymbol:()=>"JustDraw"}),r=(()=>{let r=(()=>{let t=ix(iS)({reflectSymbol:()=>"Remains"}),r=(()=>{let e=ix(iS)({reflectSymbol:()=>"JustRemains"}),r=(()=>{let t=ix(iS)({reflectSymbol:()=>"Choice"}),r=(()=>{let e=ix(iS)({reflectSymbol:()=>"LeftOne"}),r=(()=>{let t=ix(iS)({reflectSymbol:()=>"LeftAll"});return{"genericShow'":r=>"Inl"===r.tag?e["genericShow'"](r._1):"Inr"===r.tag?t["genericShow'"](r._1):void b()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void b()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?r["genericShow'"](t._1):void b()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void b()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?r["genericShow'"](t._1):void b()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void b()}})();return t=>r["genericShow'"](iI(t))})()},iT=t=>"AtLeast"===t?T("Just",iE):"JustDraw"===t?T("Just",iJ):"Remains"===t?T("Just",iN):"JustRemains"===t?T("Just",iA):"Choice"===t?T("Just",iL):"LeftOne"===t?T("Just",iC):"LeftAll"===t?T("Just",iB):M,iM=(t,e)=>({tag:t,_1:e}),iO=(t,e,r,n)=>({tag:t,_1:e,_2:r,_3:n}),iq=rN("value"),iP={reflectSymbol:()=>"selector"},iF=ip()(iP)(t6),iD=(t=>{let e=rI("Elem",M,"div",[],[nb(rI("Elem",M,"i",[nm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(nC)]);return{initialState:(()=>{let t=S(nE(w)(!1));return e=>({items:t(e),isEditMode:!1})})(),render:t=>{let r=t.isEditMode;return rI("Elem",M,"div",[nm("mx-1 flex")],[el(t=>!t.selected,t.items)||r?e:rI("Text",""),rI("Elem",M,"div",[nm(r?"fixed inset-0 bg-black opacity-20":"hidden"),rJ("Handler","click",t=>T("Just",e0("Action",nB)))],[]),rI("Elem",M,"ul",[nm(r?"break-anywhere absolute flex min-w-48 flex-col gap-0.5 bg-white p-4 shadow-md":"break-anywhere flex w-full flex-wrap gap-1"),rJ("Handler","click",t=>T("Just",e0("Action",nC)))],S(t=>rI("Elem",M,"li",[nm(t.selected||r?"min-w-0":"hidden")],[rI("Elem",M,"button",[nv(["h-full w-full rounded border px-3 py-1 transition-colors duration-75",t.selected?"border-sky-700 bg-sky-500 text-white hover:bg-sky-600":"border-gray-800 bg-gray-300 text-black hover:bg-gray-400"]),(()=>{let e=nR("Toggle",t.id);return rJ("Handler","click",t=>T("Just",e0("Action",e)))})()],[rI("Text",t.value)])]))(t.items))])},eval:nu({...na,handleAction:e=>{if("EnterEdit"===e.tag)return nJ(t=>({...t,isEditMode:!0}));if("LeaveEdit"===e.tag){let t=nN(t=>({...t,isEditMode:!1}));return tk(t._1,tI(t._2)(t=>tk(tT("Bind",rG("Raise",S(t=>t.id)(eo(t=>t.selected,t.items)),void 0),t=>tk(tT("Return",t),tA)),tA)))}if("Toggle"===e.tag){let r=e._1,n=nA(t=>t.isEditMode),i=nJ(e=>({...e,items:S(e=>t.eq(e.id)(r)?{...e,selected:!e.selected}:e)(e.items)}));return tk(n._1,tI(n._2)(t=>t?i:tk(tT("Return",void 0),tA)))}if("Receive"===e.tag){let r=e._1;return nJ(e=>{let n=e.items;return{...e,items:S(e=>{let r=e.id;return{id:r,value:e.value,selected:(()=>{let e=eg(e=>t.eq(e.id)(r))(n);return"Nothing"!==e.tag&&("Just"===e.tag?e._1.selected:void b())})()}})(r)}})}b()},handleQuery:t=>{let e=t._2;return tG(tO).bind(nS({items:t._1,isEditMode:!1}))(()=>nx(e))},receive:t=>T("Just",nR("Receive",t))})}})(nF),iz=(()=>{let t=rN("type");return e=>t(e1(e))})(),iU=(()=>{let t={append:t=>e=>t+e|0};return tu.foldMap({mempty:0,Semigroup0:()=>t})})(),iG=t=>e=>{let r=t8.compare(t)(e);return"LT"===r||"EQ"===r?t:"GT"===r?e:void b()},ij=t=>e=>tk(e._1,tI(e._2)(e=>tk(tT("Return","Just"===e.tag?T("Just",t(e._1)):M),tA))),iH=(()=>{let t=tQ(rK);return e=>t.state(t=>tl(e(t),t))})(),iQ=em({eq:t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name}),iW=iR()(iP)(t6),iZ=t=>e=>r=>{let n=t8.compare(t)(r),i="LT"===n?r:"EQ"===n||"GT"===n?t:void b(),o=t8.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void b()},iK=tk(tT("Bind",rG("State",t=>tl(t,t)),t=>tk(tT("Return",t),tA)),tA),i$=tr(tD)(to),iV=t=>tk(tT("Bind",rG("State",e=>{let r=t(e);return tl(r,r)}),t=>tk(tT("Return",t),tA)),tA),iY=r$(ir).liftEffect,iX=tr(K)(to),i1=t=>iO("GetCondition",t),i0=t=>e=>r=>iO("RestoreState",t,e,r),i2={tag:"Updated"},i3=iM("Initialize"),i5=t=>iM("UpdateConditionMode",t),i4=t=>iM("UpdateCardSelected",t),i7=t=>iM("UpdateCardCount",t),i6={initialState:t=>({cards:t,condition:{mode:iE,count:0,cards:[]},min:0,max:0}),render:t=>rI("Elem",M,"div",[nm("flex flex-wrap items-center justify-end")],[rI("Elem",M,"div",[nm("w-48 grow rounded border p-0.5")],[iF(w)()(iD)(S(t=>({id:t.id,value:t.name}))(t.cards))(i4)]),rI("Elem",M,"div",[nm("flex items-center")],[rI("Elem",M,"div",[nm("mx-1")],[rI("Text","を")]),rI("Elem",M,"input",[nv(["w-12 appearance-none rounded border border-gray-400 bg-transparent p-1 text-right","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),iz(eX),nc(nI("Step",1)),iq(L(t.condition.count)),nf(e8(t.min)),np(e8(t.max)),rJ("Handler","focus",t=>T("Just",e0("Action",iM("SelectOnFocus",t)))),iy("change")("value")(rl(W))(i7)],[]),rI("Elem",M,"select",[nv(["w-full appearance-none rounded border border-gray-400 bg-transparent px-3 py-1","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),iq(ik.show(t.condition.mode)),iy("change")("value")(rl(W))(i5)],[rI("Elem",M,"option",[iq(ik.show(iE))],[rI("Text","枚以上ドローする")]),rI("Elem",M,"option",[iq(ik.show(iJ))],[rI("Text","枚ちょうどドローする")]),rI("Elem",M,"option",[iq(ik.show(iN))],[rI("Text","枚以上デッキに残す")]),rI("Elem",M,"option",[iq(ik.show(iA))],[rI("Text","枚ちょうどデッキに残す")]),rI("Elem",M,"option",[iq(ik.show(iL))],[rI("Text","種類以上ドローする")]),rI("Elem",M,"option",[iq(ik.show(iC))],[rI("Text","種類以上デッキに残す")]),rI("Elem",M,"option",[iq(ik.show(iB))],[rI("Text","種類以上ドローしない")])])])]),eval:nu({...na,handleAction:t=>{if("Initialize"===t.tag)return tk(iK._1,tI(iK._2)(t=>{let e=iU(t=>t.count);if("AtLeast"===t.condition.mode){let r=e(t.condition.cards),n={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:iZ(iG(1)(r))(r)(t.condition.count)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}if("JustDraw"===t.condition.mode){let r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:iZ(0)(e(t.condition.cards))(t.condition.count)},min:0,max:e(t.condition.cards)};return tk(tT("Bind",rG("State",t=>tl(void 0,r)),t=>tk(tT("Return",t),tA)),tA)}if("Remains"===t.condition.mode){let r=e(t.condition.cards),n={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:iZ(iG(1)(r))(r)(t.condition.count)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}if("JustRemains"===t.condition.mode){let r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:iZ(0)(e(t.condition.cards))(t.condition.count)},min:0,max:e(t.condition.cards)};return tk(tT("Bind",rG("State",t=>tl(void 0,r)),t=>tk(tT("Return",t),tA)),tA)}if("Choice"===t.condition.mode){let e=t.condition.cards.length,r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,r)),t=>tk(tT("Return",t),tA)),tA)}if("LeftOne"===t.condition.mode){let e=t.condition.cards.length,r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,r)),t=>tk(tT("Return",t),tA)),tA)}if("LeftAll"===t.condition.mode){let e=t.condition.cards.length,r={cards:t.cards,condition:{mode:t.condition.mode,cards:t.condition.cards,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,r)),t=>tk(tT("Return",t),tA)),tA)}b()}));if("UpdateCardSelected"===t.tag){let e=t._1;return tk(iK._1,tI(tI(iK._2)(t=>{let r=eo(t=>em(nF)(t.id)(e),t.cards),n=iU(t=>t.count);if("AtLeast"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tA)}if("JustDraw"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tk(tT("Bind",rG("State",t=>tl(void 0,e)),t=>tk(tT("Return",t),tA)),tA)}if("Remains"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tA)}if("JustRemains"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tk(tT("Bind",rG("State",t=>tl(void 0,e)),t=>tk(tT("Return",t),tA)),tA)}if("Choice"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}if("LeftOne"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}if("LeftAll"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}b()}))(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("UpdateConditionMode"===t.tag)return i$(t=>tk(iK._1,tI(iK._2)(e=>{let r=iU(t=>t.count);if("AtLeast"===t){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:iZ(iG(1)(n))(n)(e.condition.count)},min:iG(1)(n),max:n};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("JustDraw"===t){let n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:iZ(0)(r(e.condition.cards))(e.condition.count)},min:0,max:r(e.condition.cards)};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("Remains"===t){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:iZ(iG(1)(n))(n)(e.condition.count)},min:iG(1)(n),max:n};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("JustRemains"===t){let n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:iZ(0)(r(e.condition.cards))(e.condition.count)},min:0,max:r(e.condition.cards)};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("Choice"===t){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:iZ(iG(1)(r))(r)(e.condition.count)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("LeftOne"===t){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:iZ(iG(1)(r))(r)(e.condition.count)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("LeftAll"===t){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:t,cards:e.condition.cards,count:iZ(iG(1)(r))(r)(e.condition.count)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}b()})))(iT(t._1));if("UpdateCardCount"===t.tag)return i$(t=>tk(iK._1,tI(iK._2)(e=>{let r=iU(t=>t.count);if("AtLeast"===e.condition.mode){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:iZ(iG(1)(n))(n)(t)},min:iG(1)(n),max:n};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("JustDraw"===e.condition.mode){let n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:iZ(0)(r(e.condition.cards))(t)},min:0,max:r(e.condition.cards)};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("Remains"===e.condition.mode){let n=r(e.condition.cards),i={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:iZ(iG(1)(n))(n)(t)},min:iG(1)(n),max:n};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("JustRemains"===e.condition.mode){let n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:iZ(0)(r(e.condition.cards))(t)},min:0,max:r(e.condition.cards)};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("Choice"===e.condition.mode){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:iZ(iG(1)(r))(r)(t)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("LeftOne"===e.condition.mode){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:iZ(iG(1)(r))(r)(t)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}if("LeftAll"===e.condition.mode){let r=e.condition.cards.length,n={cards:e.cards,condition:{mode:e.condition.mode,cards:e.condition.cards,count:iZ(iG(1)(r))(r)(t)},min:iG(1)(r),max:r};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>tk(tT("Bind",rG("Raise",i2,void 0),t=>tk(tT("Return",t),tA)),tA)))}b()})))(rt(t._1));if("Receive"===t.tag){let e=t._1,r=iV(t=>({...t,cards:e}));return tk(r._1,tI(r._2)(t=>{let e=S(t=>t.id)(t.condition.cards);return tk(iK._1,tI(iK._2)(t=>{let r=eo(t=>em(nF)(t.id)(e),t.cards),n=iU(t=>t.count);if("AtLeast"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tA)}if("JustDraw"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tk(tT("Bind",rG("State",t=>tl(void 0,e)),t=>tk(tT("Return",t),tA)),tA)}if("Remains"===t.condition.mode){let e=n(r),i={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,i)),t=>tk(tT("Return",t),tA)),tA)}if("JustRemains"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(0)(n(r))(t.condition.count)},min:0,max:n(r)};return tk(tT("Bind",rG("State",t=>tl(void 0,e)),t=>tk(tT("Return",t),tA)),tA)}if("Choice"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}if("LeftOne"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}if("LeftAll"===t.condition.mode){let e=r.length,n={cards:t.cards,condition:{mode:t.condition.mode,cards:r,count:iZ(iG(1)(e))(e)(t.condition.count)},min:iG(1)(e),max:e};return tk(tT("Bind",rG("State",t=>tl(void 0,n)),t=>tk(tT("Return",t),tA)),tA)}b()}))}))}if("SelectOnFocus"===t.tag)return iY(iX(iv)((()=>{let e=e2(t._1.target,M,O);return"Just"===e.tag?ig(M,O,"HTMLInputElement",e._1):"Nothing"===e.tag?M:void b()})()));b()},handleQuery:t=>{if("GetCondition"===t.tag)return ij(e=>t._1(e))(iH(t=>t.condition));if("RestoreState"===t.tag){let e=iU(t=>t.count);if("AtLeast"===t._2.mode){let r=e(t._2.cards);return tk(tT("Bind",rG("State",e=>tl(void 0,{cards:t._1,condition:t._2,min:iG(1)(r),max:r})),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)))}if("JustDraw"===t._2.mode)return tk(tT("Bind",rG("State",r=>tl(void 0,{cards:t._1,condition:t._2,min:0,max:e(t._2.cards)})),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)));if("Remains"===t._2.mode){let r=e(t._2.cards);return tk(tT("Bind",rG("State",e=>tl(void 0,{cards:t._1,condition:t._2,min:iG(1)(r),max:r})),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)))}if("JustRemains"===t._2.mode)return tk(tT("Bind",rG("State",r=>tl(void 0,{cards:t._1,condition:t._2,min:0,max:e(t._2.cards)})),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)));if("Choice"===t._2.mode){let e=t._2.cards.length;return tk(tT("Bind",rG("State",r=>tl(void 0,{cards:t._1,condition:t._2,min:iG(1)(e),max:e})),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)))}if("LeftOne"===t._2.mode){let e=t._2.cards.length;return tk(tT("Bind",rG("State",r=>tl(void 0,{cards:t._1,condition:t._2,min:iG(1)(e),max:e})),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)))}if("LeftAll"===t._2.mode){let e=t._2.cards.length;return tk(tT("Bind",rG("State",r=>tl(void 0,{cards:t._1,condition:t._2,min:iG(1)(e),max:e})),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)))}return tk(tT("Bind",rG("State",t=>{b()}),t=>tk(tT("Return",t),tA)),tI(tI(tA)(()=>{let e=iW(w)()(nL(S(e=>({id:e.id,value:e.name,selected:iQ(e)(t._2.cards)}))(t._1)));return tk(e._1,tI(e._2)(()=>tk(tT("Return",t._3),tA)))}))(t=>tk(tT("Return",T("Just",t)),tA)))}b()},receive:t=>T("Just",iM("Receive",t)),initialize:T("Just",i3)})},i9=((t,e,r,n)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let r of v(e))h.call(t,r)||void 0===r||_(t,r,{get:()=>e[r],enumerable:!(n=g(e,r))||n.enumerable});return t})(_(null!=(r=y())?p(m(r)):{},"default",{value:r,enumerable:!0}),r);function i8(t){return(0,i9.default)(t)}function ot(t){return t.toJSNumber()}function oe(t){return function(e){return t.add(e)}}function or(t){return function(e){return t.multiply(e)}}function on(t){return function(e){return t.minus(e)}}function oi(t){return function(e){return t.mod(e)}}function oo(t){return function(e){return t.divide(e)}}var ou=function(t){return t.toString(10)},oa={add:oe,zero:i8(0),mul:or,one:i8(1)},ol={sub:on,Semiring0:()=>oa},od=(a=10,function(t){try{var e=(0,i9.default)(t,10);return O(e)}catch(t){return M}}),oc={Ring0:()=>ol},os={div:t=>e=>oo(on(t)(os.mod(t)(e)))(e),mod:t=>e=>{let r=e.abs();return oi(oe(oi(t)(r))(r))(r)},degree:t=>rr(e9(ot(t.abs()))),CommutativeRing0:()=>oc},of={append:t=>t=>{}},op={traverseWithIndex:t=>{let e=op.Traversable2().sequence(t);return t=>{let r=op.FunctorWithIndex0().mapWithIndex(t);return t=>e(r(t))}},FunctorWithIndex0:()=>t0,FoldableWithIndex1:()=>rd,Traversable2:()=>tx},o_=t=>t,og=(t,e)=>({tag:"Codec",_1:t,_2:e}),ov=Object.prototype.toString,om=Object.prototype.hasOwnProperty,oh=(t,e,r)=>{try{return e(JSON.parse(r))}catch(e){return t(e.message)}},oy=(t,e)=>isNaN(e)||!isFinite(e)?t:e,ob=(t,e,r,n,i,o,u)=>{if(null==u)return t(null);let a=typeof u;return"boolean"===a?e(u):"number"===a?r(u):"string"===a?n(u):"[object Array]"===ov.call(u)?i(u):o(u)},oR=t=>t,ow=t=>t,oS=(t,e,r)=>{let n={};for(var i=0;i<r.length;i++)n[t(r[i])]=e(r[i]);return n},ox=(t,e,r,n)=>om.call(n,r)?e(n[r]):t,oE=t=>t,oJ=t=>JSON.stringify(t),oN=t=>M,oA=(t,e,r)=>({tag:t,_1:e,_2:r}),oL=oA("Tip"),oC=t=>e=>oA("AtKey",t,e),oB=t=>e=>oA("AtIndex",t,e),oI={eq:t=>e=>"Tip"===t.tag?"Tip"===e.tag:"AtKey"===t.tag?"AtKey"===e.tag&&t._1===e._1&&oI.eq(t._2)(e._2):"AtIndex"===t.tag&&"AtIndex"===e.tag&&t._1===e._1&&oI.eq(t._2)(e._2)},ok=t=>e=>{let r=t,n=e,i=!0,o;for(;i;){let t=r,e=n;if("AtKey"===e.tag){if("AtKey"===t.tag){if(t._1===e._1){r=t._2,n=e._2;continue}i=!1,o=M;continue}if("Tip"===t.tag){i=!1,o=T("Just",e);continue}i=!1,o=M;continue}if("AtIndex"===e.tag&&"AtIndex"===t.tag){if(t._1===e._1){r=t._2,n=e._2;continue}i=!1,o=M;continue}if("Tip"===t.tag){i=!1,o=T("Just",e);continue}i=!1,o=M}return o},oT=t=>{let e=t=>"Tip"===t.tag?"":"AtKey"===t.tag?"."+t._1+e(t._2):"AtIndex"===t.tag?"["+L(t._1)+"]"+e(t._2):void b();return"$"+e(t)},oM=t=>e=>({...e,path:t(e.path),causes:S(oM(t))(e.causes)}),oO=t=>{let e=S(e=>{var r;return(r=1===t.causes.length?"\n  ":"\n    ",function(t){return t.replace(RegExp("\n".replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),r)})(oO(oM(e=>{let r=ok(t.path)(e);return"Nothing"===r.tag?e:"Just"===r.tag?r._1:void b()})(e)))})(t.causes),r=t.causes.length;return(oI.eq(t.path)(oL)?""+t.message:oT(t.path)+": "+t.message)+(0===r?"":1===r?":\n  "+eY("\n  ")(e):":\n  - "+eY("\n  - ")(e))};String.fromCharCode(65535),"undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&String.prototype[Symbol.iterator],String.prototype.fromCodePoint,String.prototype.codePointAt;var oq=e4(W),oP=e3(W),oF=op.traverseWithIndex(oq),oD=og((()=>{let t=oq.pure({});return e=>t})(),(t=>{let e=tp(t.Semigroup0());return{pure:td(t.mempty),Apply0:()=>e}})({mempty:tg,Semigroup0:()=>th}).pure),oz=t=>e=>r=>og(r=>{let n=e(r);return"Just"===n.tag?D("Right",n._1):"Nothing"===n.tag?D("Left",{path:oL,message:"Expected value of type "+t,causes:[]}):void b()},t=>tl(r(t),t)),oU=oz("String")(t=>ob(oN,oN,oN,O,oN,oN,t))(oE),oG=oz("Object")(t=>ob(oN,oN,oN,oN,oN,O,t))(oE),oj=oz("Array")(t=>ob(oN,oN,oN,oN,O,oN,t))(oE),oH=oz("Int")(t=>{let e=ob(oN,oN,O,oN,oN,oN,t);return"Just"===e.tag?re(e._1):"Nothing"===e.tag?M:void b()})(t=>oy(0,e8(t))),oQ=t=>og(e=>oP.bind(oG._1(e))(t._1),e=>tl(oG._2(oS(tf,tc,ee(tm.foldr,t._2(e)._1)))._1,e)),oW=t=>e=>r=>n=>og(r=>{let i=n._1(r);if("Left"===i.tag)return D("Left",{path:i._1.path,message:"Could not decode "+t,causes:[i._1]});if("Right"===i.tag){let r=e(i._1);if("Just"===r.tag)return D("Right",r._1);if("Nothing"===r.tag)return D("Left",{path:oL,message:"Could not decode "+t+", unexpected value found",causes:[]})}b()},t=>tl(n._2(r(t))._1,t)),oZ=t=>()=>e=>r=>n=>{let i=t.reflectSymbol(e);return og(t=>oP.bind(n._1(t))(e=>oP.bind((()=>{let e=ox(M,O,i,t);if("Just"===e.tag){let t=r._1(e._1);return"Left"===t.tag?D("Left",oM(oC(i))(t._1)):t}if("Nothing"===e.tag)return D("Left",{path:oA("AtKey",i,oL),message:"No value found",causes:[]});b()})())(t=>oq.pure(A(i)(t)(e)))),t=>tl(t_("Cons",tl(i,r._2(N(i)(t))._1),n._2(t)._1),t))},oK=oz("Boolean")(t=>ob(oN,O,oN,oN,oN,oN,t))(oE),o$=t=>og(e=>oP.bind(oj._1(e))(e=>oF(e=>r=>{let n=t._1(r);return"Left"===n.tag?D("Left",oM(oB(e))(n._1)):n})(oR(e))),e=>tl(oE(ow(S(e=>t._2(e)._1)(e))),e)),oV={rowListCodec:t=>t=>oD},oY=t=>()=>()=>e=>({rowListCodec:r=>r=>oZ(e)()(w)(N(e.reflectSymbol(w))(r))(t.rowListCodec(w)(r))}),oX={reflectSymbol:()=>"disabled"},o1={reflectSymbol:()=>"conditions"},o0={reflectSymbol:()=>"count"},o2={reflectSymbol:()=>"cards"},o3=(()=>{let t=oY(oY(oV)()()({reflectSymbol:()=>"deck"}))()()(o1).rowListCodec(w);return e=>oQ(t(e))})(),o5=oW("Id")(t=>nP(t)?T("Just",t):M)(t=>t)(oU),o4=(n=ik.show,t=>og(e=>{let r=oU._1(e);return(()=>{if("Left"===r.tag){let t=r._1;return e=>D("Left",t)}if("Right"===r.tag){let t=r._1;return e=>e(t)}b()})()(e=>{let r=t(e);return"Nothing"===r.tag?D("Left",{path:oL,message:"Unexpected value '"+e+"' found",causes:[]}):"Just"===r.tag?D("Right",r._1):void b()})},t=>tl(oU._2(n(t))._1,t)))(iT),o7=oQ(oY(oY(oV)()()(oX))()()(o1).rowListCodec(w)({conditions:o$(oQ(oY(oY(oY(oY(oV)()()({reflectSymbol:()=>"mode"}))()()(oX))()()(o0))()()(o2).rowListCodec(w)({mode:o4,count:oH,cards:o$(o5),disabled:oK}))),disabled:oK})),o6=oQ(oY(oY(oY(oV)()()({reflectSymbol:()=>"name"}))()()({reflectSymbol:()=>"id"}))()()(o0).rowListCodec(w)({id:o5,name:oU,count:oH})),o9=(()=>{let t=oQ(oY(oY(oY(oV)()()({reflectSymbol:()=>"mode"}))()()(o0))()()(o2).rowListCodec(w)({mode:o4,count:oH,cards:o$(o6)}));return og(e=>{let r=t._1(e);return"Left"===r.tag?D("Left",r._1):"Right"===r.tag?D("Right",r._1):void b()},e=>{let r=t._2(e);return tl(r._1,r._2)})})(),o8=oW("Conditions")(t=>t.length>0?T("Just",t):M)(o_)(o$(o9)),ut=oQ(oY(oY(oY(oV)()()({reflectSymbol:()=>"others"}))()()({reflectSymbol:()=>"hand"}))()()(o2).rowListCodec(w)({cards:o$(o6),others:oH,hand:oH})),ue=o3({deck:ut,conditions:o$(o7)}),ur=o3({deck:ut,conditions:o$(o8)});function un(t){return function(){t.terminate()}}var ui=t=>e=>{var r;return r={name:e.name,credentials:"Omit"===e.credentials?"omit":"SameOrigin"===e.credentials?"same-origin":"Include"===e.credentials?"include":void b(),type:"Classic"===e.type?"classic":"Module"===e.type?"module":void b()},function(){return new Worker(t,r)}},uo={name:"",credentials:"Omit",type:"Classic"},uu=(()=>{let t=ty.foldMap1({append:t=>e=>r=>t(r)+r+e(r)});return e=>r=>n=>t(t=>{let e=r(t);return t=>e})(n)(e)})(),ua=t=>nY(e=>{let r=ui("bundle/worker.js")({...uo,type:"Module"});return()=>{var n,i,o;let u=r();(n=t=>e((()=>{let e=uu("\n")(ru),r=ra(W)("String")(t.data);if("Left"===r.tag)return D("Left",nz(e(r._1)));if("Right"===r.tag){let t=nz("BigInt.fromString"),e=od(r._1);if("Nothing"===e.tag)return D("Left",t);if("Just"===e.tag)return D("Right",e._1)}b()})()),function(t){return function(){t.onmessage=function(t){n(t)()}}})(u)(),(i=t=>{let r=un(u);return()=>(r(),e(D("Left",nz((()=>{let e=ig(M,O,"ErrorEvent",t);return"Nothing"===e.tag?"Unknown worker error":"Just"===e.tag?e._1.message:void b()})())))())},function(t){return function(){t.onerror=function(t){i(t)()}}})(u)(),(o=ur._2(t)._1,function(t){return function(e){return function(){e.postMessage(o,t.length>0?t:void 0)}}})([])(u)();let a=nV(un(u));return t=>a}});function ul(t){return function(e){return function(r){return t.apply(r,[e])}}}var ud=ul(Number.prototype.toPrecision),uc=ul(Number.prototype.toFixed),us=ul(Number.prototype.toExponential),uf=(t,e)=>({tag:t,_1:e}),up=t=>e=>r=>{let n=t8.compare(t)(r),i="LT"===n?r:"EQ"===n||"GT"===n?t:void b(),o=t8.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void b()},u_=t=>"Precision"===t.tag?ud(t._1):"Fixed"===t.tag?uc(t._1):"Exponential"===t.tag?us(t._1):void b(),ug=t=>e=>r=>()=>{let n=t$(O,M,t,r),i=t$(O,M,e,r);"Just"===n.tag&&"Just"===i.tag&&(tV(t,i._1,r),tV(e,n._1,r))},uv=t=>e=>r=>{let n=[...r];return ug(t)(e)(n)(),n},um=t=>e=>r=>{if(t===e)return r;let n=[...r],i=tY(t)(1)([])(n)();return tY(e)(0)(i)(n)(),n},uh=te(or)(oa.one),uy=(i=t=>ea(oe,[oa.zero,...t],[...t,oa.zero]),t=>eR.unfoldr1(t=>tl(t._1,t._2>0?T("Just",tl(i(t._1),t._2-1|0)):M))(tl(t,64-1|0)))([oa.one]),ub=t=>e=>{let r=t,n=e,i=!0,o;for(;i;){let t=r,e=n;if(t<0||e<0){i=!1,o=oa.zero;continue}if(0===e){i=!1,o=oa.one;continue}if(1===e){i=!1,o=i8(t);continue}if((t-e|0)<e){r=t,n=t-e|0;continue}if(t<64){i=!1,o=uy[t][e];continue}let u=S(i8),a=uh(u(et((t-e|0)+1|0,t))),l=uh(u(et(1,e)));i=!1,o=oo(on(a)(os.mod(a)(l)))(l)}return o},uR=(t=>{let e={append:e=>r=>t.add(e)(r)};return tu.foldMap({mempty:t.zero,Semigroup0:()=>e})})({add:function(t){return function(e){return t+e|0}},zero:0,mul:function(t){return function(e){return t*e|0}},one:1}),uw=t=>e=>{let r=e_(t=>e=>t9.compare(t.id)(e.id))(J(J(e)(o_))(t=>t.cards));return{...t,cards:r,others:t.others+uR(t=>t.count)(tt(eh(t=>e=>t.id===e.id))(t.cards)(r))|0}},uS=t=>ub(uR(t=>t.count)(t.cards)+t.others|0)(t.hand),ux=(t,e,r)=>({tag:"Calculate",_1:t,_2:e,_3:r}),uE=(t=>{let e=r$(t.MonadEffect0());return{liftAff:e=>tk(tT("Bind",rG("Lift",t.liftAff(e)),t=>tk(tT("Return",t),tA)),tA),MonadEffect0:()=>e}})({liftAff:t=>t,MonadEffect0:()=>ir}).liftAff,uJ=t=>tk(tT("Bind",rG("Lift",iu.throwError(t)),t=>tk(tT("Return",t),tA)),tA),uN=t=>tk(tT("Bind",rG("State",e=>tl(t(e),e)),t=>tk(tT("Return",t),tA)),tA),uA=t=>tk(tT("Bind",rG("State",e=>tl(void 0,t(e))),t=>tk(tT("Return",t),tA)),tA),uL=tr(tD)(to),uC=t=>e=>r=>ux(t,e,r),uB={initialState:t=>({combination:oa.zero,total:oa.zero,calculation:M}),render:t=>{var e;return rI("Elem",M,"div",[nm("flex min-w-60 items-center")],[rI("Elem",M,"div",[nm("mx-1 flex w-36 items-center justify-end gap-1")],"Just"===t.calculation.tag?[rI("Elem",M,"div",[nm("text-2xl")],[rI("Text","Calculating")]),rI("Elem",M,"i",[nm("fa-solid fa-spinner fa-pulse")],[])]:[rI("Elem",M,"div",[nm("text-2xl")],[rI("Text",(e=t.total,function(t){return e.equals(t)})(oa.zero)?"N/A":u_(uf("Fixed",up(0)(20)(4)))(100*(ot(t.combination)/ot(t.total)))+"%")])]),rI("Elem",M,"div",[nm("mx-1 flex min-w-20 flex-col items-end divide-y divide-gray-400")],[rI("Elem",M,"div",[nm("px-1")],[rI("Text",ou(t.combination))]),rI("Elem",M,"div",[nm("px-1")],[rI("Text",ou(t.total))])])])},eval:nu({...na,handleQuery:t=>{let e=t._3,r=uw(t._1)(t._2),n=uE(ia(ua({deck:r,conditions:t._2})));return tk(tT("Bind",rG("Fork",tk(n._1,tI(n._2)(t=>{if("Left"===t.tag){let e=t._1;return tk(tT("Bind",rG("State",t=>tl(void 0,{combination:oa.zero,total:oa.zero,calculation:M})),t=>tk(tT("Return",t),tA)),tI(tA)(()=>uJ(e)))}if("Right"===t.tag){let e={combination:t._1,total:uS(r),calculation:M};return tk(tT("Bind",rG("State",t=>tl(void 0,e)),t=>tk(tT("Return",t),tA)),tA)}b()})),rj),t=>tk(tT("Return",t),tA)),tI(tI(tA)(t=>{let r=uN(t=>t.calculation);return tk(r._1,tI(r._2)(r=>{let n=uA(e=>({...e,calculation:T("Just",t)}));return tk(n._1,tI(n._2)(()=>{let t=uL(rV)(r);return tk(t._1,tI(t._2)(()=>tk(tT("Return",e),tA)))}))}))}))(t=>tk(tT("Return",T("Just",t)),tA)))}})},uI=(t,e)=>({tag:t,_1:e}),uk=(t,e,r,n)=>({tag:t,_1:e,_2:r,_3:n}),uT={reflectSymbol:()=>"line"},uM=ip()(uT)(nD),uO={reflectSymbol:()=>"result"},uq=is()(uO)(t6),uP=(t=>{let e=t.foldr;return t=>{let r=ee(e,t);return r.length>0?T("Just",r):M}})(eO),uF=t=>tk(tT("Bind",rG("State",e=>tl(t(e),e)),t=>tk(tT("Return",t),tA)),tA),uD=iw()(uT)(nD),uz=iR()(uO)(t6),uU=tj(tO).apply,uG=t=>e=>tk(e._1,tI(e._2)(e=>tk(tT("Return","Just"===e.tag?T("Just",t(e._1)):M),tA))),uj=tG(tO),uH=(()=>{let t=tK(tO),e=t.Plus1().empty;return r=>r?t.Applicative0().pure():e})(),uQ=tQ(rK),uW=(()=>{let t=tx.traverse(F);return e=>r=>t(r)(e)})(),uZ=tk(tT("Bind",rG("State",t=>tl(t,t)),t=>tk(tT("Return",t),tA)),tA),uK=tx.traverse(tD),u$=nh({reflectSymbol:()=>"id"})()(),uV=r$(ir).liftEffect(nq),uY=tn(tD)(tu),uX=iR()(uT)(nD),u1=tH(tO).pure,u0=t=>tk(tT("Bind",rG("State",e=>tl(void 0,t(e))),t=>tk(tT("Return",t),tA)),tA),u2=t=>tk(tT("Bind",rG("State",e=>{let r=t(e);return tl(r,r)}),t=>tk(tT("Return",t),tA)),tA),u3=t=>uk("GetConditions",t),u5=t=>uk("Export",t),u4=t=>e=>r=>uk("RestoreState",t,e,r),u7=t=>uk("ToggleDisabled",t),u6=uI("Initialize"),u9=uI("AddCondition"),u8=uI("Calculate"),at=(()=>{let t=rI("Elem",M,"div",[nm("px-1")],[nb(rI("Elem",M,"i",[nm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(u9)]),e=tF.apply((()=>{let t=S(t=>t.id),e=uF(t=>t.conditions);return tk(e._1,tI(tI(e._2)(e=>tk(tT("Return",t(eo(t=>t.disabled,e))),tA)))(t=>tk(tT("Return",e=>uP(eD(nD)(e=>ev(nF)(e)(t))(e))),tA)))})())(uD(w)(i1)),r=uF(t=>t.deck),n=tk(r._1,tI(r._2)(t=>tk(e._1,tI(tI(e._2)(t=>tk(tT("Return",ee(to.foldr,t)),tA)))(e=>uz(w)()(uC(t)(e)))))),i=t=>{if("Initialize"===t.tag){let t=i(u9);return tk(t._1,tI(t._2)(()=>n))}if("AddCondition"===t.tag){let t=uF(t=>t.conditions);return tk(t._1,tI(t._2)(t=>tk(uV._1,tI(uV._2)(e=>u0(r=>({...r,conditions:es(t)({id:e,disabled:!1})}))))))}if("RemoveCondition"===t.tag){let e=t._1,r=u2(t=>({...t,conditions:eo(t=>t.id!==e,t.conditions)}));return tk(r._1,tI(r._2)(t=>0===t.conditions.length?tk(tT("Bind",rG("Raise","AllConditionDeleted",void 0),t=>tk(tT("Return",t),tA)),tA):i(u8)))}if("ToggleItemDisabled"===t.tag){let e=t._1,r=u0(t=>{let r=er(O,M,t=>t.id===e,t.conditions);if("Just"===r.tag){let e=ep(r._1)(t=>({...t,disabled:!t.disabled}))(t.conditions);if("Just"===e.tag)return{...t,conditions:e._1};if("Nothing"===e.tag)return t;b()}if("Nothing"===r.tag)return t;b()});return tk(r._1,tI(r._2)(()=>i(u8)))}if("Receive"===t.tag){let e=t._1,r=u0(t=>({...t,deck:e}));return tk(r._1,tI(r._2)(()=>n))}if("Calculate"===t.tag)return tk(n._1,tI(n._2)(()=>tk(tT("Bind",rG("Raise","Updated",void 0),t=>tk(tT("Return",t),tA)),tA)));b()};return{initialState:t=>({conditions:[],deck:t,disabled:!1}),render:e=>rI("Elem",M,"div",[nv(["grow rounded border-2 border-violet-300 p-1",e.disabled?"bg-slate-100 text-gray-400":"bg-white text-gray-700"])],[rI("Elem",M,"div",[nm("flex items-center justify-end gap-1")],[rI("Elem",M,"div",[nm(e.disabled?"mr-auto w-0 py-1 pl-3 text-xl":"hidden")],[rI("Text","Disabled")]),rI("Elem",M,"div",[nm(e.disabled?"text-gray-400":"text-black")],[uq(w)()(uB)()])]),rI("Elem",M,"ul",[nm("my-1")],S((()=>{let t=e.deck.cards;return e=>rI("Elem",M,"li",[nv(["flex gap-1 rounded px-1",e.disabled?"bg-slate-100 text-gray-400 line-through":"bg-transparent"])],[rI("Elem",M,"div",[nm("mx-1 flex")],[nb(rI("Elem",M,"i",[nm("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(uI("RemoveCondition",e.id)),nb(rI("Elem",M,"i",[nm("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(uI("ToggleItemDisabled",e.id))]),rI("Elem",M,"div",[nm("min-w-0 grow")],[uM(w)(e.id)(i6)(t)(t=>u8)])])})())(e.conditions)),t]),eval:nu({...na,handleAction:i,handleQuery:t=>{if("GetConditions"===t.tag)return uU(uG(e=>e=>t._1(e))(uj.bind(uQ.state(t=>tl(t.disabled,t)))(t=>uH(!t))))(e);if("Export"===t.tag)return tF.apply(tk(uZ._1,tI(uZ._2)(e=>tk(tT("Return",(()=>{let r=e.conditions,n=e.disabled;return e=>{let i=uW(r)(t=>{let r=ek(nD)(t.id)(e);return"Just"===r.tag?T("Just",{mode:r._1.mode,count:r._1.count,cards:S(t=>t.id)(r._1.cards),disabled:t.disabled}):M});return"Just"===i.tag?T("Just",t._1({conditions:i._1,disabled:n})):M}})()),tA))))(uD(w)(i1));if("RestoreState"===t.tag){let e=t._3,r=t._1,i=t._2.disabled,o=uK((()=>{let t=tI(uV._2)(t=>tk(tT("Return",u$(w)(t)),tA));return e=>tk(uV._1,tI(t)(t=>tk(tT("Return",t(e)),tA)))})())(t._2.conditions);return tk(o._1,tI(tI(o._2)(t=>{let o={conditions:S(t=>({id:t.id,disabled:t.disabled}))(t),deck:r,disabled:i};return tk(tT("Bind",rG("State",t=>tl(void 0,o)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>{let i=uY(t)(t=>uX(w)(t.id)(i0(r.cards)({mode:t.mode,count:t.count,cards:eb(t=>eg(e=>e.id===t)(r.cards))(t.cards)})));return tk(i._1,tI(i._2)(()=>tk(n._1,tI(n._2)(()=>tk(tT("Return",e),tA)))))}))}))(t=>tk(tT("Return",T("Just",t)),tA)))}if("ToggleDisabled"===t.tag){let e=t._1;return uj.bind(uQ.state(t=>tl(void 0,{...t,disabled:!t.disabled})))(()=>u1(e))}b()},receive:t=>T("Just",uI("Receive",t)),initialize:T("Just",u6)})}})(),ae={mempty:void 0,Semigroup0:()=>of};function ar(t){return t.dataTransfer}var an=(t,e,r)=>({tag:t,_1:e,_2:r}),ai=(t,e)=>({tag:"SetDeck",_1:t,_2:e}),ao=(()=>{let t=rN("type");return e=>t(e1(e))})(),au=rN("value"),aa=tG(tO).bind,al=(()=>{let t=tQ(rK);return e=>t.state(t=>tl(void 0,e))})(),ad=tH(tO).pure,ac=r$(ir),as=ac.liftEffect(nq),af=t=>tk(tT("Bind",rG("State",e=>tl(void 0,t(e))),t=>tk(tT("Return",t),tA)),tA),ap=t=>tk(tT("Bind",rG("State",e=>{let r=t(e);return tl(r,r)}),t=>tk(tT("Return",t),tA)),tA),a_=tk(tT("Bind",rG("State",t=>tl(t,t)),t=>tk(tT("Return",t),tA)),tA),ag=(()=>{let t=tU(ae).mempty;return e=>"Nothing"===e.tag?t:"Just"===e.tag?e._1:void b()})(),av=t=>e=>r=>{let n=t8.compare(t)(r),i="LT"===n?r:"EQ"===n||"GT"===n?t:void b(),o=t8.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void b()},am=t=>tk(tT("Bind",rG("State",e=>tl(t(e),e)),t=>tk(tT("Return",t),tA)),tA),ah=t=>e=>{let r=t8.compare(t)(e);return"LT"===r||"EQ"===r?t:"GT"===r?e:void b()},ay=tr(K)(to),ab=tr(tD)(to),aR=t=>e=>ai(t,e),aw=an("AddCard"),aS=t=>an("UpdateDeck",t),ax=t=>an("UpdateHand",t),aE=t=>an("UpdateOthers",t),aJ=t=>e=>an("StartReorder",t,e),aN=t=>e=>an("ExecuteReorder",t,e),aA=(()=>{let t=eY(" ")(["appearance-none rounded-none border-b border-transparent bg-white p-1 text-gray-700","transition-colors duration-75 hover:border-gray-500 focus:border-slate-800 focus:outline-none"]),e=eY(" ")(["w-16 text-right",t]),r=(t,r,n,i,o)=>rI("Elem",M,"div",[nm("mx-1 flex flex-wrap justify-end border-b border-gray-500")],[rI("Elem",M,"div",[nm("m-1")],[rI("Text",t)]),rI("Elem",M,"input",[nm(e),ao(eX),au(L(r)),nc(nI("Step",1)),nf(e8(n)),np(e8(i)),rJ("Handler","focus",t=>T("Just",e0("Action",an("SelectOnFocus",t)))),iy("change")("value")(rl(W))(t=>o((()=>{let e=rt(t);return"Nothing"===e.tag?0:"Just"===e.tag?e._1:void b()})()))],[])]),n={append:t=>e=>t+e|0},i=tu.foldMap({mempty:0,Semigroup0:()=>n})(t=>t.count),o=t=>{var e,r,n;if("AddCard"===t.tag)return tk(as._1,tI(as._2)(t=>af(e=>({...e,cards:es(e.cards)({id:t,name:"",count:0})}))));if("RemoveCard"===t.tag){let e=t._1,r=ap(t=>({...t,cards:eh(t=>e=>t.id===e.id)(e)(t.cards),others:t.others+e.count|0}));return tk(r._1,tI(r._2)(t=>tk(tT("Bind",rG("Raise",{...t,cards:eo(t=>""!==t.name,t.cards)},void 0),t=>tk(tT("Return",t),tA)),tA)))}if("UpdateCard"===t.tag){let e=t._1;return tk(a_._1,tI(a_._2)(t=>ag((()=>{let r=er(O,M,t=>t.id===e.id,t.cards);if("Just"===r.tag){if(r._1>=0&&r._1<t.cards.length){let n=""===e.name?{...e,count:0}:{...e,count:av(0)(t.cards[r._1].count+t.others|0)(e.count)},i=ei(O,M,r._1,n,t.cards);if("Just"===i.tag){let e=i._1;return T("Just",(()=>{let i=ap(i=>({...i,cards:e,others:t.others-(n.count-t.cards[r._1].count|0)|0}));return tk(i._1,tI(i._2)(t=>tk(tT("Bind",rG("Raise",{...t,cards:eo(t=>""!==t.name,t.cards)},void 0),t=>tk(tT("Return",t),tA)),tA)))})())}if("Nothing"===i.tag)return M;b()}return M}if("Nothing"===r.tag)return M;b()})())))}if("UpdateDeck"===t.tag){let e=t._1,r=am(t=>t.cards);return tk(r._1,tI(r._2)(t=>o(an("UpdateOthers",e-i(t)|0))))}if("UpdateHand"===t.tag){let e=t._1,r=ap(t=>({...t,hand:av(1)(i(t.cards)+t.others|0)(e)}));return tk(r._1,tI(r._2)(t=>tk(tT("Bind",rG("Raise",{...t,cards:eo(t=>""!==t.name,t.cards)},void 0),t=>tk(tT("Return",t),tA)),tA)))}if("UpdateOthers"===t.tag){let e=t._1,r=ap(t=>{let r=i(t.cards),n=av(r)(255)(r+e|0);return{...t,others:n-r|0,hand:ah(t.hand)(n)}});return tk(r._1,tI(r._2)(t=>tk(tT("Bind",rG("Raise",{...t,cards:eo(t=>""!==t.name,t.cards)},void 0),t=>tk(tT("Return",t),tA)),tA)))}if("SelectOnFocus"===t.tag)return ac.liftEffect(ay(iv)((()=>{let e=e2(t._1.target,M,O);return"Just"===e.tag?ig(M,O,"HTMLInputElement",e._1):"Nothing"===e.tag?M:void b()})()));if("StartReorder"===t.tag){let r=t._1,n=ar(t._2),i=ac.liftEffect((e="tcg-calculator/card",function(t){return function(r){return function(){return r.setData(e,t)}}})(r)(n));return tk(i._1,tI(i._2)(()=>tk(tT("Bind",rG("GetRef",r,rj),t=>tk(tT("Return",t),tA)),tI(tA)(t=>ac.liftEffect(ay(t=>{var e;return(e=5,function(e){return function(){return n.setDragImage(t,5,e)}})(15)})(t))))))}if("HandleDragBehavior"===t.tag){let e=ac.liftEffect(i_(t._1));return(n=ar(t._1).types,function(t){if(n.length!==t.length)return!1;for(var e=0;e<n.length;e++)if(!t2(n[e])(t[e]))return!1;return!0})(["tcg-calculator/card"])?e:tk(tT("Return",void 0),tA)}if("ExecuteReorder"===t.tag){let e=t._1,n=t._2,i=ac.liftEffect((r="tcg-calculator/card",function(t){return function(){return t.getData(r)}})(ar(n)));return tk(i._1,tI(i._2)(t=>{let r=""===t,i=ac.liftEffect(i_(n)),o=tk(i._1,tI(i._2)(()=>{let r=am(t=>t.cards);return tk(r._1,tI(r._2)(r=>ab(t=>{let e=ap(e=>({...e,cards:t}));return tk(e._1,tI(e._2)(t=>tk(tT("Bind",rG("Raise",{...t,cards:eo(t=>""!==t.name,t.cards)},void 0),t=>tk(tT("Return",t),tA)),tA)))})((()=>{if(nP(t)&&t!==e){let n=er(O,M,e=>e.id===t,r);if("Just"===n.tag){let t=er(O,M,t=>t.id===e,r);if("Just"===t.tag)return T("Just",um(n._1)(t._1)(r));if("Nothing"===t.tag)return M;b()}if("Nothing"===n.tag)return M;b()}return M})())))}));return r?r?tk(tT("Return",void 0),tA):void b():o}))}b()};return{initialState:t=>({cards:[],others:40,hand:5}),render:n=>{let o=n.others,u=i(n.cards);return rI("Elem",M,"div",[nm("rounded border-2 border-amber-500 p-1")],[(()=>{let t=u+o|0;return rI("Elem",M,"div",[nm("flex gap-1")],[rI("Elem",M,"div",[nm("mx-1 flex grow flex-wrap text-sky-900")],[ny("fa-layer-group")(["m-1 text-2xl"]),rI("Elem",M,"div",[nm("m-1")],[rI("Text","デッキ情報")])]),r("手札枚数:",n.hand,1,t,ax),r("デッキ枚数:",t,u,255,aS)])})(),rI("Keyed",M,"ul",[nm("m-1"),rJ("Handler","dragenter",t=>T("Just",e0("Action",an("HandleDragBehavior",t)))),rJ("Handler","dragover",t=>T("Just",e0("Action",an("HandleDragBehavior",t))))],S(r=>{let n=r.id;return tl(n,rI("Elem",M,"li",[nm("flex"),rJ("Ref",t=>T("Just",e0("RefUpdate",n,"Created"===t.tag?T("Just",t._1):"Removed"===t.tag?M:void b()))),(()=>{let t=aN(r.id);return rJ("Handler","drop",e=>T("Just",e0("Action",t(e))))})()],[rI("Elem",M,"div",[nm("mx-1 flex items-center")],[rI("Elem",M,"div",[nm("hidden cursor-grab px-1 text-gray-500 active:cursor-grabbing md:block"),ng(!0),(()=>{let t=aJ(r.id);return rJ("Handler","dragstart",e=>T("Just",e0("Action",t(e))))})()],[rI("Elem",M,"i",[nm("fa-solid fa-grip-vertical")],[])]),nb(rI("Elem",M,"i",[nm("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(an("RemoveCard",r))]),rI("Elem",M,"div",[nm("flex grow border-b border-gray-500")],[rI("Elem",M,"input",[nv(["grow",t]),ao("InputText"),au(r.name),iy("change")("value")(rl(W))(t=>an("UpdateCard",{...r,name:t}))],[]),rI("Elem",M,"input",[nm(e),ao(eX),nc(nI("Step",1)),au(L(r.count)),nf(0),np(""===r.name?0:e8(r.count+o|0)),rJ("Handler","focus",t=>T("Just",e0("Action",an("SelectOnFocus",t)))),iy("change")("value")(rl(W))(t=>an("UpdateCard",(()=>{let e=rt(t);return{...r,count:"Nothing"===e.tag?0:"Just"===e.tag?e._1:void b()}})()))],[])])]))})(n.cards)),rI("Elem",M,"div",[nm("flex gap-1")],[rI("Elem",M,"div",[nm("mx-1 grow")],[nb(rI("Elem",M,"i",[nm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(aw)]),r("その他のカード:",o,0,255-u|0,aE)])])},eval:nu({...na,handleAction:o,handleQuery:t=>{let e=t._2;return aa(al(t._1))(()=>ad(e))}})}})();function aL(t){return function(e){return t===e}}var aC=tr(K)(tu),aB=t=>t,aI=()=>{let t=[];return{emitter:e=>()=>(t=[...t,e],()=>{let r=t;t=eh(aL)(e)(r)}),listener:e=>{let r=aC(t=>t(e));return()=>r(t)()}}},ak=t=>(function(t,e,r){try{return e(decodeURIComponent(r))}catch(e){return t(e)}})(t=>M,O,t),aT=function(){return window};function aM(t){return function(){return t.document}}function aO(t){return function(){return t.location}}var aq=t=>()=>{var e;return(e=aO(aT())(),function(){e.hash=t})()},aP=()=>{var t;let e=(t=aO(aT())(),function(){return t.hash})(),r=rn("#")(e);return"Nothing"===r.tag?"":"Just"===r.tag?r._1:void b()},aF=t=>e=>()=>{let r=e(aP())(),n=aT(),i=rw(e=>()=>{let e=r,n=aP();return r=t(e)(n)()})();return rS("hashchange")(i)(!1)(n)(),rx("hashchange")(i)(!1)(n)},aD=t=>e=>r=>{let n=n=>{let i=ti(t)(0);return t=>{let o=i(e(t));if("Nothing"===o.tag)return()=>n;if("Just"===o.tag){let t=o._1,e=r(n)(t);return()=>(e(),T("Just",t))}b()}};return aF(t=>n(t))(n(M))},az=(t,e,r)=>({tag:t,_1:e,_2:r}),aU={reflectSymbol:()=>"result"},aG={reflectSymbol:()=>"deck"},aj={reflectSymbol:()=>"condition"},aH=ip()(aj)(nD),aQ=r$(ir),aW=aQ.liftEffect(nq),aZ=iR()(aG)(t6),aK=t=>tk(tT("Bind",rG("State",e=>tl(void 0,t(e))),t=>tk(tT("Return",t),tA)),tA),a$=iR()(aj)(nD),aV=t=>tk(tT("Bind",rG("State",e=>tl(t(e),e)),t=>tk(tT("Return",t),tA)),tA),aY=iw()(aj)(nD),aX=iR()(aU)(t6),a1=tx.traverse(tD),a0=tn(tD)(tu),a2=tk(tT("Bind",rG("State",t=>tl(t,t)),t=>tk(tT("Return",t),tA)),tA),a3=az("Initialize"),a5=az("PrepareDefaultState"),a4=t=>az("UpdateDeck",t),a7=az("AddCondition"),a6=t=>e=>az("ReceiveConditionUpdated",t,e),a9=az("Calculate"),a8=az("SaveState"),lt=(()=>{let t=rI("Elem",M,"div",[nm("flex grow basis-0 items-center rounded border-2 border-cyan-400 p-1")],[rI("Elem",M,"div",[nm("flex w-full justify-end gap-1")],[rI("Elem",M,"div",[],[nb(rI("Text","Save"))("border border-rose-500 hover:bg-rose-100")(a8)]),is()(aU)(t6)(w)()(uB)()])]),e=rI("Elem",M,"div",[nm("grow")],[ip()(aG)(t6)(w)()(aA)()(a4)]),r=rI("Elem",M,"div",[],[nb(rI("Elem",M,"i",[nm("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(a7)]),n=t=>{if("Initialize"===t.tag){let t=aQ.liftEffect(aI);return tk(t._1,tI(t._2)(t=>{let e=t.emitter;return tk(tT("Bind",rG("Subscribe",t=>e,rj),t=>tk(tT("Return",t),tA)),tI(tA)(()=>{let e=aQ.liftEffect(aD(to)(ak)(e=>e=>t.listener(""===e?a5:az("RestoreState",e))));return tk(e._1,tI(e._2)(t=>tk(tT("Return",void 0),tA)))}))}))}if("PrepareDefaultState"===t.tag)return tk(aW._1,tI(aW._2)(t=>{let e={cards:[{id:t,name:"Card1",count:3}],others:37,hand:5};return tk(tT("Bind",rG("State",t=>tl(void 0,{deck:e,conditions:[]})),t=>tk(tT("Return",t),tA)),tI(tA)(()=>{let t=aZ(w)()(aR(e));return tk(t._1,tI(t._2)(()=>n(a7)))}))}));if("UpdateDeck"===t.tag){let e=t._1,r=aK(t=>({...t,deck:e}));return tk(r._1,tI(r._2)(()=>n(a9)))}if("AddCondition"===t.tag)return tk(aW._1,tI(aW._2)(t=>{let e=aK(e=>({...e,conditions:es(e.conditions)(t)}));return tk(e._1,tI(e._2)(()=>n(a9)))}));if("RemoveCondition"===t.tag){let e=t._1,r=aK(t=>({...t,conditions:eh(nF.eq)(e)(t.conditions)}));return tk(r._1,tI(r._2)(()=>n(a9)))}if("ToggleDisabled"===t.tag){let e=a$(w)(t._1)(u7);return tk(e._1,tI(e._2)(()=>n(a9)))}if("Swap"===t.tag){let e=t._1,r=t._2;return aK(t=>({...t,conditions:uv(e)(r)(t.conditions)}))}if("ReceiveConditionUpdated"===t.tag){if("Updated"===t._2)return n(a9);if("AllConditionDeleted"===t._2)return n(az("RemoveCondition",t._1));b()}if("Calculate"===t.tag){let t=aV(t=>t.deck);return tk(t._1,tI(t._2)(t=>{let e=aY(w)(u3);return tk(e._1,tI(e._2)(e=>aX(w)()(uC(t)(ee(eO.foldr,e)))))}))}if("RestoreState"===t.tag){let r=oh(z,U,t._1),i="Left"===r.tag?D("Left",{path:oL,message:r._1,causes:[]}):"Right"===r.tag?ue._1(r._1):void b();if("Left"===i.tag){var e;let t=aQ.liftEffect((e=oO(i._1),function(){console.error(e)}));return tk(t._1,tI(t._2)(()=>n(a5)))}if("Right"===i.tag){let t=i._1.deck,e=a1((()=>{let t=tI(aW._2)(t=>tk(tT("Return",e=>({id:t,condition:e})),tA));return e=>tk(aW._1,tI(t)(t=>tk(tT("Return",t(e)),tA)))})())(i._1.conditions);return tk(e._1,tI(e._2)(e=>{let r={deck:t,conditions:S(t=>t.id)(e)};return tk(tT("Bind",rG("State",t=>tl(void 0,r)),t=>tk(tT("Return",t),tA)),tI(tA)(()=>{let r=aZ(w)()(aR(t));return tk(r._1,tI(r._2)(()=>{let r=a0(e)(e=>a$(w)(e.id)(u4(t)(e.condition)));return tk(r._1,tI(r._2)(()=>n(a9)))}))}))}))}b()}if("SaveState"===t.tag)return tk(a2._1,tI(a2._2)(t=>{let e=t.deck,r=t.conditions,n=aY(w)(u5);return tk(n._1,tI(n._2)(t=>aQ.liftEffect(aq(oJ(ue._2({deck:e,conditions:eb(e=>ek(nD)(e)(t))(r)})._1)))))}));b()};return{initialState:t=>({deck:{cards:[],others:0,hand:0},conditions:[]}),render:n=>{let i=n.deck;return rI("Elem",M,"div",[nm("relative overflow-x-clip")],[rI("Elem",M,"header",[nm("flex items-baseline px-2")],[rI("Elem",M,"h1",[nm("p-1 text-lg")],[rI("Elem",M,"a",[n_(".")],[rI("Text","Draw Calculator")])]),rI("Text","-"),rI("Elem",M,"h2",[nm("p-1")],[rI("Text","TCG 用ドロー確率計算機")])]),rI("Elem",M,"main",[nm("relative mb-[80vh] flex max-w-4xl flex-col gap-3 p-1")],[rI("Elem",M,"div",[nm("flex flex-wrap gap-1")],[e,t]),rI("Elem",M,"ul",[nm("flex flex-col gap-1")],t1(t=>e=>rI("Elem",M,"li",[nm("flex items-start gap-1")],[rI("Elem",M,"div",[nm("flex flex-col")],[nb(rI("Elem",M,"i",[nm("fa-solid fa-angle-up")],[]))("text-gray-500 hover:bg-gray-200")(az("Swap",t-1|0,t)),nb(rI("Elem",M,"i",[nm("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(az("RemoveCondition",e)),nb(rI("Elem",M,"i",[nm("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(az("ToggleDisabled",e)),nb(rI("Elem",M,"i",[nm("fa-solid fa-angle-down")],[]))("text-gray-500 hover:bg-gray-200")(az("Swap",t,t+1|0))]),aH(w)(e)(at)(i)(a6(e))]))(n.conditions)),r]),rI("Elem",M,"footer",[nm("flex items-baseline px-2")],[rI("Elem",M,"a",[nm("m-1 rounded border border-sky-500 px-2 py-1 text-sm"),n_("https://github.com/acple/tcg-calculator"),ns("_blank"),nd("noopener noreferrer")],[rI("Text","→ 使い方とかソース")])])])},eval:nu({...na,handleAction:n,initialize:T("Just",a3)})}})(),le=function(t){return function(e){return function(){return e[t]}}};le("children"),le("firstElementChild"),le("lastElementChild"),le("childElementCount");var lr=t=>e=>()=>e2(e.querySelector(t),M,O),ln="Loading",li=t=>"loading"===t?T("Just",ln):"interactive"===t?T("Just","Interactive"):"complete"===t?T("Just","Complete"):M,lo=t=>()=>{let e=li(t.readyState);return"Nothing"===e.tag?ln:"Just"===e.tag?e._1:void b()},lu=t=>n$(nV((()=>{let e=lr(t);return()=>e(aM(aT())())()})()))(t=>nW((()=>{if("Just"===t.tag){var e,r;return e=t._1,0===(r=Object.prototype.toString.call(e)).indexOf("[object HTML")&&r.indexOf("Element]")===r.length-8?O(e):M}if("Nothing"===t.tag)return M;b()})())),la=id(t=>"Left"===t.tag?nU(t._1):"Right"===t.tag?()=>{}:void b()),ll=n$(nY(t=>()=>{if("Loading"===lo(aM(aT())())()){let e=aT(),r=rw(e=>t(D("Right",void 0)))();rS("DOMContentLoaded")(r)(!1)(e)();let n=nV(rx("DOMContentLoaded")(r)(!1)(e));return t=>n}return t(D("Right",void 0))(),ic}))(()=>n$(lu("body"))(t=>{let e=nZ(nz("Could not find body"));return"Nothing"===t.tag?e:"Just"===t.tag?nW(t._1):void b()})),ld=(t,e)=>({tag:"CoyonedaF",_1:t,_2:e}),lc=(t,e,r)=>({tag:t,_1:e,_2:r}),ls=tr(K)(to),lf=tr(n9),lp=lf(tm),l_=nj(it)(ie)(tm)(nG),lg=lf(to),lv=(t=>{let e=t.Monad0(),r=e.Bind1().Apply0().Functor0();return n=>t.tailRecM(t=>{let i=tM(t);return"Return"===i.tag?r.map(Y)(e.Applicative0().pure(i._1)):"Bind"===i.tag?r.map(t=>V("Loop",i._2(t)))(n(i._1)):void b()})})({tailRecM:t=>{let e=r=>n$(t(r))(t=>"Done"===t.tag?nW(t._1):"Loop"===t.tag?e(t._1):void b());return e},Monad0:()=>n4}),lm=(t=>{let e=t.compare;return t=>r=>n=>{let i=eL(e,r,n),o=t(i._1);return"Nothing"===o.tag?eB(i._2,i._3):"Just"===o.tag?eA(r,o._1,i._2,i._3):void b()}})(t9),lh=t=>e=>()=>{let r=e.value.subscriptions.value;return ls(aB)((()=>{let e=ek(t8)(t);return"Just"===r.tag?e(r._1):"Nothing"===r.tag?M:void b()})())()},ly=t=>e=>n$(nV(()=>t.value))(r=>"Nothing"===r.tag?e:"Just"===r.tag?nV(()=>t.value=T("Just",t_("Cons",e,r._1))):void b()),lb=t=>e=>n$(nV(()=>t.value={initializers:tg,finalizers:tg}))(()=>n$(nV(e))(e=>n$(nV(()=>t.value))(t=>{let r=t.initializers;return n$(lp(n2)(t.finalizers))(()=>n$(l_(r))(()=>nW(e)))}))),lR=id(t=>"Left"===t.tag?nU(t._1):"Right"===t.tag?()=>{}:void b()),lw=t=>e=>n$(nV(()=>e.value))(e=>{var r;return nV((r=e=>({state:e+1|0,value:t(e)}),function(t){return function(){var e=r(t.value);return t.value=e.state,e.value}})(e.fresh))}),lS=t=>e=>r=>n$(nV(()=>e.value))(n=>lx(t)(e)(n.component.eval(lc("Query",ld(t=>T("Just",t),r),t=>M)))),lx=t=>e=>r=>lv(r=>{if("State"===r.tag)return n$(nV(()=>e.value))(n=>{let i=r._1(n.state);if(aL(n.state)(i._2))return nW(i._1);let o=i._1;return n$(nV((()=>{let t={...n,state:i._2};return()=>e.value=t})()))(()=>n$(lb(n.lifecycleHandlers)(t(n.lifecycleHandlers)(e)))(()=>nW(o)))});if("Subscribe"===r.tag)return n$(lw(rH)(e))(n=>n$(nV(r._1(n)(r=>{let n=lR(lE(t)(e)(e0("Action",r)));return()=>{n()}})))(t=>n$(nV(()=>e.value))(e=>n$(nV((()=>{let r=q.map(eT(t8)(n)(t)),i=e.subscriptions;return()=>{let t=i.value;i.value=r(t)}})()))(()=>nW(r._2(n))))));if("Unsubscribe"===r.tag){let t=r._2;return n$(nV(lh(r._1)(e)))(()=>nW(t))}if("Lift"===r.tag)return r._1;if("ChildQuery"===r.tag){let n=r._1;return n$(nV(()=>e.value))(e=>{let r=n._2;return nK(n._3)(nX(n._1(ie)(e=>n$(nV(()=>e.value))(e=>lS(t)(e.selfRef)(r)))(e.children)))})}if("Raise"===r.tag){let t=r._2,n=r._1;return n$(nV(()=>e.value))(e=>{let r=e.handlerRef,i=e.pendingOuts;return n$(nV(()=>r.value))(e=>n$(ly(i)(e(n)))(()=>nW(t)))})}if("Par"===r.tag)return nX(rF(ie)(rM)((()=>{let n=lx(t)(e);return rF(rz)(t=>rT("Lift",n(t)))(r._1)})()));if("Fork"===r.tag){let n=r._1;return n$(lw(rQ)(e))(i=>n$(nV(()=>e.value))(o=>{let u=o.forks;return n$(nV(()=>({value:!1})))(o=>n$(n2(n8(nV((()=>{let t=ez(t8)(i);return()=>{let e=u.value;return u.value=t(e),o.value=!0}})()))(lx(t)(e)(n))))(t=>n$(nV((()=>{let e=eT(t8)(i)(t);return()=>{let t=o.value;if(!t){let t=u.value;u.value=e(t);return}t||b()}})()))(()=>nW(r._2(i)))))}))}if("Join"===r.tag){let t=r._2,n=r._1;return n$(nV(()=>e.value))(e=>{let r=e.forks;return n$(nV(()=>r.value))(e=>n$(lg(ii)(ek(t8)(n)(e)))(()=>nW(t)))})}if("Kill"===r.tag){let t=r._2,n=r._1;return n$(nV(()=>e.value))(e=>{let r=e.forks;return n$(nV(()=>r.value))(e=>n$(lg(io(nz("Cancelled")))(ek(t8)(n)(e)))(()=>nW(t)))})}if("GetRef"===r.tag){let t=r._1;return n$(nV(()=>e.value))(e=>nW(r._2(ek(t9)(t)(e.refs))))}b()})(r),lE=t=>e=>r=>{if("RefUpdate"===r.tag){let t=r._2,n=r._1;return nV(()=>{let r=e.value;e.value={...r,refs:lm(e=>t)(n)(r.refs)}})}if("Action"===r.tag){let n=r._1;return n$(nV(()=>e.value))(r=>lx(t)(e)(r.component.eval(lc("Action",n,void 0))))}b()},lJ=t=>e=>r=>n=>()=>{let i={value:{}},o={value:T("Just",tg)},u={value:T("Just",tg)},a={value:T("Just",eJ)};return i.value={component:t,state:t.initialState(e),refs:eJ,children:eJ,childrenIn:{value:eJ},childrenOut:{value:eJ},selfRef:i,handlerRef:{value:r},pendingQueries:o,pendingOuts:u,pendingHandlers:{value:M},rendering:M,fresh:{value:1},subscriptions:a,forks:{value:eJ},lifecycleHandlers:n},i},lN=tn(K)(to),lA=tr(n9)(tm),lL=tr(K),lC=lL(to),lB=lL(eO),lI=nj(it)(ie)(tm)(nG),lk=(t=>{let e=tr(t)(eO);return t=>r=>e(t=>r(t))(t)})(K),lT=(()=>{let t=tr(K)(to);return e=>r=>t(e)(r.rendering)})(),lM=()=>({value:{initializers:tg,finalizers:tg}}),lO=t=>()=>{let e=t.value;return t.value=M,lN(e)((()=>{let t=lA(n2);return e=>lR(t(tb(e)))})())()},lq=t=>{let e=lC(lB(aB)),r=t.subscriptions;return()=>{e(r.value)(),t.subscriptions.value=M;let n=t.forks.value;return lB((()=>{let t=io(nz("finalized"));return e=>lR(t(e))})())(n)(),t.forks.value=eJ}},lP=t=>e=>r=>{let n=t=>e=>r=>{let n=lx(u)(r.selfRef)(r.component.eval(lc("Initialize",void 0)));return()=>{let i=t.value;t.value={initializers:t_("Cons",n$(lI(tb(i.initializers)))(()=>n$(n)(()=>nV((()=>{let t=lO(r.pendingQueries);return()=>(t(),lO(r.pendingOuts)())})()))),e),finalizers:i.finalizers}}},i=t=>e=>r=>i=>()=>{let o=lM(),a=lJ(i)(r)(e)(o)(),l=t.value;t.value={initializers:tg,finalizers:l.finalizers};let d=a.value;u(t)(d.selfRef)();let c=a.value;return n(t)(l.initializers)(c)(),a},o=e=>r=>n=>o=>a=>()=>{let l=n.value,d=a.pop(l),c=(()=>{if("Just"===d.tag){n.value=d._1._2;let t=d._1._1.value,e=nW();return t.handlerRef.value=t=>{let n=a.output(t);return"Nothing"===n.tag?e:"Just"===n.tag?r(n._1):void b()},lR(lx(u)(t.selfRef)(t.component.eval(lc("Receive",a.input,void 0))))(),d._1._1}if("Nothing"===d.tag)return i(e)((()=>{let t=nW();return e=>{let n=a.output(e);return"Nothing"===n.tag?t:"Just"===n.tag?r(n._1):void b()}})())(a.input)(a.component)();b()})(),s=o.value;(()=>{let t=a.get(s);return"Nothing"!==t.tag&&("Just"===t.tag||void b())})()&&console.warn("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur");let f=o.value;o.value=a.set(c)(f);let p=c.value;return"Nothing"===p.rendering.tag?nU(nz("Halogen internal error: child was not initialized in renderChild"))():"Just"===p.rendering.tag?t.renderChild(p.rendering._1):void b()},u=e=>r=>()=>{let n=r.value,i=n.pendingHandlers.value,l="Nothing"===i.tag||"Just"!==i.tag&&void b();l&&(n.pendingHandlers.value=T("Just",tg)),n.childrenOut.value=eJ,n.childrenIn.value=n.children;let d=n.pendingHandlers,c=t.render((()=>{let t=nK(t=>{});return e=>lR(ly(d)(t(lE(u)(n.selfRef)(e))))})())(o(e)((()=>{let t=nK(t=>{});return e=>ly(n.pendingQueries)(ly(d)(t(lE(u)(n.selfRef)(e0("Action",e)))))})())(n.childrenIn)(n.childrenOut))(n.component.render(n.state))(n.rendering)(),s=n.childrenOut.value;lk(n.childrenIn.value)(r=>()=>{let n=r.value;return lT(t.removeChild)(n)(),a(e)(n)()})();let f=n.selfRef.value;n.selfRef.value={...f,rendering:T("Just",c),children:s};let p=X(t=>()=>{let t=d.value;d.value=T("Just",tg),lC((()=>{let t=lA(n2);return e=>lR(t(tb(e)))})())(t)();let e=d.value;return"Nothing"!==e.tag&&("Just"===e.tag?"Nil"===e._1.tag:void b())?(d.value=M,V("Done",void 0)):V("Loop",void 0)})();if(l)return p()},a=t=>e=>{let r=lq(e);return()=>{r();let n=t.value;return t.value={initializers:n.initializers,finalizers:t_("Cons",lx(u)(e.selfRef)(e.component.eval(lc("Finalize",void 0))),n.finalizers)},lk(e.children)(e=>()=>{let r=e.value;return a(t)(r)()})()}};return n$(nV(lM))(n=>n$(nV(()=>({value:!1})))(o=>lb(n)(()=>{let l=aI(),d=i(n)(t=>nV(l.listener(t)))(r)(e)().value;return{query:(()=>{let t=d.selfRef;return e=>n$(nV(()=>o.value))(r=>r?nW(M):lS(u)(t)(e))})(),messages:l.emitter,dispose:lb(n)(()=>{if(!o.value)return o.value=!0,a(n)(d)(),lN(d.selfRef.value.rendering)(t.dispose)()})}})))},lF=function(t){return function(e){return function(){return e[t]}}};lF("baseURI"),lF("ownerDocument");var lD=lF("parentNode");lF("parentElement"),lF("childNodes"),lF("firstChild"),lF("lastChild"),lF("previousSibling");var lz=lF("nextSibling");function lU(t){return function(e){return function(){e.appendChild(t)}}}lF("nodeValue"),lF("textContent");var lG=tr(K)(to),lj=t=>t,lH=t=>e=>r=>{if("Just"===r.tag){if("Just"===e.tag){var n;let i=(n=e._1,function(e){return function(){e.insertBefore(t,n)}})(r._1);return()=>{i()}}if("Nothing"===e.tag){let e=lU(t)(r._1);return()=>{e()}}}return()=>{}},lQ=t=>{let e=t.node,r=lD(e);return()=>{let t=r();return lG(t=>function(){t.removeChild(e)})(e2(t,M,O))()}},lW=t=>e=>r=>({buildWidget:t=>{let r=nn(tR)(t),n=t=>rc((0,e.value)(t)().node,M,o,t=>{if("Just"===t.tag)return rf(t._1)}),i=t=>{if("ComponentSlot"===t.tag)return n(t._1);if("ThunkSlot"===t.tag){let e=r(t._1);return rc(e._1,T("Just",e),o,t=>{if("Just"===t.tag)return rf(t._1)})}b()},o=(t,e)=>{if("Just"===t.tag){if("ComponentSlot"===e.tag){let r=e._1;return rf(t._1),n(r)}if("ThunkSlot"===e.tag){let r=e._1,n=rs(t._1,r);return rc(n._1,T("Just",n),o,t=>{if("Just"===t.tag)return rf(t._1)})}b()}return i(e)};return i},buildAttributes:rC(t),document:r}),lZ=t=>e=>({render:r=>n=>i=>o=>{if("Nothing"===o.tag)return()=>{let o={value:n},u=ne(lW(r)(o)(t))(i);return lU(u._1)(e)(),{machine:u,node:u._1,renderChildRef:o}};if("Just"===o.tag){let t=o._1.machine,e=o._1.node,r=o._1.renderChildRef;return()=>{r.value=n;let o=lD(e)(),u=lz(e)(),a=rs(t,i),l=lH(a._1)(e2(u,M,O))(e2(o,M,O));return aL(e)(a._1)||l(),{machine:a,node:a._1,renderChildRef:r}}}b()},renderChild:lj,removeChild:lQ,dispose:lQ}),lK=t=>e=>r=>n$(nV(()=>aM(aT())()))(n=>lP(lZ(n)(r))(t)(e));la(n$(ll)(t=>lK(lt)()(t)))()})();
//# sourceMappingURL=index.42b7691a.js.map
