(()=>{let t,e,r,n,o;var i,u,a,l=Object.create,p=Object.defineProperty,f=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,c=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,h=(t={"node_modules/big-integer/BigInteger.js"(t,e){var r=function(t){var e=f(0x20000000000000),n="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function i(t,e,r,n){return void 0===t?i[0]:void 0!==e&&(10!=+e||r)?Z(t,e,r,n):G(t)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function a(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function p(t){return -0x20000000000000<t&&t<0x20000000000000}function f(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function s(t){c(t);var r=t.length;if(r<4&&0>x(t,e))switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+1e7*t[1];default:return t[0]+(t[1]+1e7*t[2])*1e7}return t}function c(t){for(var e=t.length;0===t[--e];);t.length=e+1}function g(t){for(var e=Array(t),r=-1;++r<t;)e[r]=0;return e}function h(t){return t>0?Math.floor(t):Math.ceil(t)}function v(t,e){var r,n,o=t.length,i=e.length,u=Array(o),a=0;for(n=0;n<i;n++)a=+((r=t[n]+e[n]+a)>=1e7),u[n]=r-1e7*a;for(;n<o;)a=+(1e7===(r=t[n]+a)),u[n++]=r-1e7*a;return a>0&&u.push(a),u}function d(t,e){return t.length>=e.length?v(t,e):v(e,t)}function y(t,e){var r,n,o=t.length,i=Array(o);for(n=0;n<o;n++)e=Math.floor((r=t[n]-1e7+e)/1e7),i[n]=r-1e7*e,e+=1;for(;e>0;)i[n++]=e%1e7,e=Math.floor(e/1e7);return i}function _(t,e){var r,n,o=t.length,i=e.length,u=Array(o),a=0;for(r=0;r<i;r++)(n=t[r]-a-e[r])<0?(n+=1e7,a=1):a=0,u[r]=n;for(r=i;r<o;r++){if((n=t[r]-a)<0)n+=1e7;else{u[r++]=n;break}u[r]=n}for(;r<o;r++)u[r]=t[r];return c(u),u}function m(t,e,r){var n,o,i=t.length,l=Array(i),p=-e;for(n=0;n<i;n++)p=Math.floor((o=t[n]+p)/1e7),o%=1e7,l[n]=o<0?o+1e7:o;return"number"==typeof(l=s(l))?(r&&(l=-l),new a(l)):new u(l,r)}function b(t,e){var r,n,o,i,u=t.length,a=e.length,l=g(u+a);for(o=0;o<u;++o){i=t[o];for(var p=0;p<a;++p)n=Math.floor((r=i*e[p]+l[o+p])/1e7),l[o+p]=r-1e7*n,l[o+p+1]+=n}return c(l),l}function w(t,e){var r,n,o=t.length,i=Array(o),u=0;for(n=0;n<o;n++)u=Math.floor((r=t[n]*e+u)/1e7),i[n]=r-1e7*u;for(;u>0;)i[n++]=u%1e7,u=Math.floor(u/1e7);return i}function S(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function N(t,e,r){return t<1e7?new u(w(e,t),r):new u(b(e,f(t)),r)}function I(t){var e,r,n,o,i=t.length,u=g(i+i);for(n=0;n<i;n++){r=0-(o=t[n])*o;for(var a=n;a<i;a++)r=Math.floor((e=o*t[a]*2+u[n+a]+r)/1e7),u[n+a]=e-1e7*r;u[n+i]=r}return c(u),u}function L(t,e){var r,n,o,i,u=t.length,a=g(u);for(o=0,r=u-1;r>=0;--r)n=h((i=1e7*o+t[r])/e),o=i-n*e,a[r]=0|n;return[a,0|o]}function A(t,e){var r,n,p=G(e);if(o)return[new l(t.value/p.value),new l(t.value%p.value)];var v=t.value,d=p.value;if(0===d)throw Error("Cannot divide by zero");if(t.isSmall)return p.isSmall?[new a(h(v/d)),new a(v%d)]:[i[0],t];if(p.isSmall){if(1===d)return[t,i[0]];if(-1==d)return[t.negate(),i[0]];var y=Math.abs(d);if(y<1e7){r=s((n=L(v,y))[0]);var m=n[1];return(t.sign&&(m=-m),"number"==typeof r)?(t.sign!==p.sign&&(r=-r),[new a(r),new a(m)]):[new u(r,t.sign!==p.sign),new a(m)]}d=f(y)}var b=x(v,d);if(-1===b)return[i[0],t];if(0===b)return[i[t.sign===p.sign?1:-1],i[0]];r=(n=v.length+d.length<=200?function(t,e){var r,n,o,i,u,a,l,p=t.length,f=e.length,c=g(e.length),h=e[f-1],v=Math.ceil(1e7/(2*h)),d=w(t,v),y=w(e,v);for(d.length<=p&&d.push(0),y.push(0),h=y[f-1],n=p-f;n>=0;n--){for(r=1e7-1,d[n+f]!==h&&(r=Math.floor((1e7*d[n+f]+d[n+f-1])/h)),o=0,i=0,a=y.length,u=0;u<a;u++)o+=r*y[u],l=Math.floor(o/1e7),i+=d[n+u]-(o-1e7*l),o=l,i<0?(d[n+u]=i+1e7,i=-1):(d[n+u]=i,i=0);for(;0!==i;){for(r-=1,o=0,u=0;u<a;u++)(o+=d[n+u]-1e7+y[u])<0?(d[n+u]=o+1e7,o=0):(d[n+u]=o,o=1);i+=o}c[n]=r}return d=L(d,v)[0],[s(c),s(d)]}(v,d):function(t,e){for(var r,n,o,i,u,a=t.length,l=e.length,p=[],f=[];a;){if(f.unshift(t[--a]),c(f),0>x(f,e)){p.push(0);continue}n=f.length,o=1e7*f[n-1]+f[n-2],i=1e7*e[l-1]+e[l-2],n>l&&(o=(o+1)*1e7),r=Math.ceil(o/i);do{if(0>=x(u=w(e,r),f))break;r--}while(r)p.push(r),f=_(f,u)}return p.reverse(),[s(p),s(f)]}(v,d))[0];var S=t.sign!==p.sign,N=n[1],I=t.sign;return"number"==typeof r?(S&&(r=-r),r=new a(r)):r=new u(r,S),"number"==typeof N?(I&&(N=-N),N=new a(N)):N=new u(N,I),[r,N]}function x(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function J(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function E(t,e){for(var n,o,i,u=t.prev(),a=u,l=0;a.isEven();)a=a.divide(2),l++;t:for(o=0;o<e.length;o++)if(!t.lesser(e[o])&&!((i=r(e[o]).modPow(a,t)).isUnit()||i.equals(u))){for(n=l-1;0!=n&&!(i=i.square().mod(t)).isUnit();n--)if(i.equals(u))continue t;return!1}return!0}u.prototype=Object.create(i.prototype),a.prototype=Object.create(i.prototype),l.prototype=Object.create(i.prototype),u.prototype.add=function(t){var e=G(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(y(r,Math.abs(n)),this.sign):new u(d(r,n),this.sign)},u.prototype.plus=u.prototype.add,a.prototype.add=function(t){var e=G(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(p(r+n))return new a(r+n);n=f(Math.abs(n))}return new u(y(n,Math.abs(r)),r<0)},a.prototype.plus=a.prototype.add,l.prototype.add=function(t){return new l(this.value+G(t).value)},l.prototype.plus=l.prototype.add,u.prototype.subtract=function(t){var e,r,n=G(t);if(this.sign!==n.sign)return this.add(n.negate());var o=this.value,i=n.value;return n.isSmall?m(o,Math.abs(i),this.sign):(e=this.sign,(x(o,i)>=0?r=_(o,i):(r=_(i,o),e=!e),"number"==typeof(r=s(r)))?(e&&(r=-r),new a(r)):new u(r,e))},u.prototype.minus=u.prototype.subtract,a.prototype.subtract=function(t){var e=G(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new a(r-n):m(n,Math.abs(r),r>=0)},a.prototype.minus=a.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-G(t).value)},l.prototype.minus=l.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},a.prototype.negate=function(){var t=this.sign,e=new a(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},a.prototype.abs=function(){return new a(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(t){var e,r,n,o=G(t),a=this.value,l=o.value,p=this.sign!==o.sign;if(o.isSmall){if(0===l)return i[0];if(1===l)return this;if(-1===l)return this.negate();if((n=Math.abs(l))<1e7)return new u(w(a,n),p);l=f(n)}return -.012*(e=a.length)-.012*(r=l.length)+15e-6*e*r>0?new u(function t(e,r){var n=Math.max(e.length,r.length);if(n<=30)return b(e,r);n=Math.ceil(n/2);var o=e.slice(n),i=e.slice(0,n),u=r.slice(n),a=r.slice(0,n),l=t(i,a),p=t(o,u),f=t(d(i,o),d(a,u)),s=d(d(l,S(_(_(f,l),p),n)),S(p,2*n));return c(s),s}(a,l),p):new u(b(a,l),p)},u.prototype.times=u.prototype.multiply,a.prototype._multiplyBySmall=function(t){return p(t.value*this.value)?new a(t.value*this.value):N(Math.abs(t.value),f(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?i[0]:1===t.value?this:-1===t.value?this.negate():N(Math.abs(t.value),this.value,this.sign!==t.sign)},a.prototype.multiply=function(t){return G(t)._multiplyBySmall(this)},a.prototype.times=a.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*G(t).value)},l.prototype.times=l.prototype.multiply,u.prototype.square=function(){return new u(I(this.value),!1)},a.prototype.square=function(){var t=this.value*this.value;return p(t)?new a(t):new u(I(f(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},u.prototype.divmod=function(t){var e=A(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=a.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return A(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/G(t).value)},a.prototype.over=a.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return A(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%G(t).value)},a.prototype.remainder=a.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,o=G(t),u=this.value,l=o.value;if(0===l)return i[1];if(0===u)return i[0];if(1===u)return i[1];if(-1===u)return o.isEven()?i[1]:i[-1];if(o.sign)return i[0];if(!o.isSmall)throw Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&p(e=Math.pow(u,l)))return new a(h(e));for(r=this,n=i[1];!0&l&&(n=n.times(r),--l),0!==l;)l/=2,r=r.square();return n},a.prototype.pow=u.prototype.pow,l.prototype.pow=function(t){var e=G(t),r=this.value,n=e.value,o=BigInt(0),u=BigInt(1),a=BigInt(2);if(n===o)return i[1];if(r===o)return i[0];if(r===u)return i[1];if(r===BigInt(-1))return e.isEven()?i[1]:i[-1];if(e.isNegative())return new l(o);for(var p=this,f=i[1];(n&u)===u&&(f=f.times(p),--n),n!==o;)n/=a,p=p.square();return f},u.prototype.modPow=function(t,e){if(t=G(t),(e=G(e)).isZero())throw Error("Cannot take modPow with modulus 0");var r=i[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(i[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return i[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},l.prototype.modPow=a.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=G(t),r=this.value,n=e.value;return e.isSmall?1:x(r,n)},a.prototype.compareAbs=function(t){var e=G(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,r=G(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},u.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=G(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:x(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,a.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=G(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},a.prototype.compareTo=a.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=this.value,r=G(t).value;return e===r?0:e>r?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=a.prototype.eq=a.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=a.prototype.neq=a.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=a.prototype.gt=a.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return 0>this.compare(t)},l.prototype.lt=l.prototype.lesser=a.prototype.lt=a.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return 0>=this.compare(t)},l.prototype.leq=l.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return(1&this.value[0])==0},a.prototype.isEven=function(){return(1&this.value)==0},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return(1&this.value[0])==1},a.prototype.isOdd=function(){return(1&this.value)==1},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},a.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=a.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},a.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=a.prototype.isNegative,u.prototype.isUnit=function(){return!1},a.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},a.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(t){var e=G(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=a.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(t){var e=J(this);if(void 0!==e)return e;var n=this.abs(),o=n.bitLength();if(o<=64)return E(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*o.toJSNumber(),u=Math.ceil(!0===t?2*Math.pow(i,2):i),a=[],l=0;l<u;l++)a.push(r(l+2));return E(n,a)},l.prototype.isPrime=a.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(t,e){var n=J(this);if(void 0!==n)return n;for(var o=this.abs(),i=void 0===t?5:t,u=[],a=0;a<i;a++)u.push(r.randBetween(2,o.minus(2),e));return E(o,u)},l.prototype.isProbablePrime=a.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,n,o,i=r.zero,u=r.one,a=G(t),l=this.abs();!l.isZero();)e=a.divide(l),n=i,o=a,i=u,a=l,u=n.subtract(e.multiply(u)),l=o.subtract(e.multiply(l));if(!a.isUnit())throw Error(this.toString()+" and "+t.toString()+" are not co-prime");return(-1===i.compare(0)&&(i=i.add(t)),this.isNegative())?i.negate():i},l.prototype.modInv=a.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?m(t,1,this.sign):new u(y(t,1),this.sign)},a.prototype.next=function(){var t=this.value;return t+1<0x20000000000000?new a(t+1):new u(e,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},u.prototype.prev=function(){var t=this.value;return this.sign?new u(y(t,1),!0):m(t,1,this.sign)},a.prototype.prev=function(){var t=this.value;return t-1>-0x20000000000000?new a(t-1):new u(e,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var q=[1];2*q[q.length-1]<=1e7;)q.push(2*q[q.length-1]);var M=q.length,O=q[M-1];function T(t){return 1e7>=Math.abs(t)}function C(t,e,n){e=G(e);for(var o=t.isNegative(),i=e.isNegative(),u=o?t.not():t,a=i?e.not():e,l=0,p=0,f=null,s=null,c=[];!u.isZero()||!a.isZero();)l=(f=A(u,O))[1].toJSNumber(),o&&(l=O-1-l),p=(s=A(a,O))[1].toJSNumber(),i&&(p=O-1-p),u=f[0],a=s[0],c.push(n(l,p));for(var g=0!==n(+!!o,+!!i)?r(-1):r(0),h=c.length-1;h>=0;h-=1)g=g.multiply(O).add(r(c[h]));return g}u.prototype.shiftLeft=function(t){var e=G(t).toJSNumber();if(!T(e))throw Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=M;)r=r.multiply(O),e-=M-1;return r.multiply(q[e])},l.prototype.shiftLeft=a.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e,r=G(t).toJSNumber();if(!T(r))throw Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=M;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=A(n,O))[1].isNegative()?e[0].prev():e[0],r-=M-1}return(e=A(n,q[r]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=a.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},l.prototype.not=a.prototype.not=u.prototype.not,u.prototype.and=function(t){return C(this,t,function(t,e){return t&e})},l.prototype.and=a.prototype.and=u.prototype.and,u.prototype.or=function(t){return C(this,t,function(t,e){return t|e})},l.prototype.or=a.prototype.or=u.prototype.or,u.prototype.xor=function(t){return C(this,t,function(t,e){return t^e})},l.prototype.xor=a.prototype.xor=u.prototype.xor;function P(t){var e=t.value,r="number"==typeof e?0x40000000|e:"bigint"==typeof e?e|BigInt(0x40000000):e[0]+1e7*e[1]|0x40004000;return r&-r}function B(t,e){return t=G(t),e=G(e),t.greater(e)?t:e}function R(t,e){return t=G(t),e=G(e),t.lesser(e)?t:e}function j(t,e){if(t=G(t).abs(),e=G(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,o=i[1];t.isEven()&&e.isEven();)r=R(P(t),P(e)),t=t.divide(r),e=e.divide(r),o=o.multiply(r);for(;t.isEven();)t=t.divide(P(t));do{for(;e.isEven();)e=e.divide(P(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero())return o.isUnit()?t:t.multiply(o)}u.prototype.bitLength=function(){var t=this;return(0>t.compareTo(r(0))&&(t=t.negate().subtract(r(1))),0===t.compareTo(r(0)))?r(0):r(function t(e,n){if(0>=n.compareTo(e)){var o=t(e,n.square(n)),i=o.p,u=o.e,a=i.multiply(n);return 0>=a.compareTo(e)?{p:a,e:2*u+1}:{p:i,e:2*u}}return{p:r(1),e:0}}(t,r(2)).e).add(r(1))},l.prototype.bitLength=a.prototype.bitLength=u.prototype.bitLength;var Z=function(t,e,r,o){r=r||n,t=String(t),o||(t=t.toLowerCase(),r=r.toLowerCase());var i,u=t.length,a=Math.abs(e),l={};for(i=0;i<r.length;i++)l[r[i]]=i;for(i=0;i<u;i++){var p=t[i];if("-"!==p&&p in l&&l[p]>=a){if("1"===p&&1===a)continue;throw Error(p+" is not a valid digit in base "+e+".")}}e=G(e);var f=[],s="-"===t[0];for(i=+!!s;i<t.length;i++){var p=t[i];if(p in l)f.push(G(l[p]));else if("<"===p){var c=i;do i++;while(">"!==t[i]&&i<t.length)f.push(G(t.slice(c+1,i)))}else throw Error(p+" is not a valid character")}return F(f,e,s)};function F(t,e,r){var n,o=i[0],u=i[1];for(n=t.length-1;n>=0;n--)o=o.add(t[n].times(u)),u=u.times(e);return r?o.negate():o}function z(t,e){if((e=r(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var o=!1;if(t.isNegative()&&e.isPositive()&&(o=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:o};for(var i,u=[],a=t;a.isNegative()||a.compareAbs(e)>=0;){a=(i=a.divmod(e)).quotient;var l=i.remainder;l.isNegative()&&(l=e.minus(l).abs(),a=a.next()),u.push(l.toJSNumber())}return u.push(a.toJSNumber()),{value:u.reverse(),isNegative:o}}function D(t,e,r){var o=z(t,e);return(o.isNegative?"-":"")+o.value.map(function(t){var e;return t<(e=(e=r)||n).length?e[t]:"<"+t+">"}).join("")}function U(t){if(p(+t)){var e=+t;if(e===h(e))return o?new l(BigInt(e)):new a(e);throw Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];if("+"===i[0]&&(i=i.slice(1)),(i*=1)!==h(i)||!p(i))throw Error("Invalid integer: "+i+" is not a valid exponent.");var f=n[0],s=f.indexOf(".");if(s>=0&&(i-=f.length-s-1,f=f.slice(0,s)+f.slice(s+1)),i<0)throw Error("Cannot include negative exponent part for integers");f+=Array(i+1).join("0"),t=f}if(!/^([0-9][0-9]*)$/.test(t))throw Error("Invalid integer: "+t);if(o)return new l(BigInt(r?"-"+t:t));for(var g=[],v=t.length,d=v-7;v>0;)g.push(+t.slice(d,v)),(d-=7)<0&&(d=0),v-=7;return c(g),new u(g,r)}function G(t){return"number"==typeof t?function(t){if(o)return new l(BigInt(t));if(p(t)){if(t!==h(t))throw Error(t+" is not an integer.");return new a(t)}return U(t.toString())}(t):"string"==typeof t?U(t):"bigint"==typeof t?new l(t):t}u.prototype.toArray=function(t){return z(this,t)},a.prototype.toArray=function(t){return z(this,t)},l.prototype.toArray=function(t){return z(this,t)},u.prototype.toString=function(e,r){if(e===t&&(e=10),10!==e||r)return D(this,e,r);for(var n,o=this.value,i=o.length,u=String(o[--i]);--i>=0;)n=String(o[i]),u+="0000000".slice(n.length)+n;return(this.sign?"-":"")+u},a.prototype.toString=function(e,r){return(e===t&&(e=10),10!=e||r)?D(this,e,r):String(this.value)},l.prototype.toString=a.prototype.toString,l.prototype.toJSON=u.prototype.toJSON=a.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,a.prototype.valueOf=function(){return this.value},a.prototype.toJSNumber=a.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var W=0;W<1e3;W++)i[W]=G(W),W>0&&(i[-W]=G(-W));return i.one=i[1],i.zero=i[0],i.minusOne=i[-1],i.max=B,i.min=R,i.gcd=j,i.lcm=function(t,e){return t=G(t).abs(),e=G(e).abs(),t.divide(j(t,e)).multiply(e)},i.isInstance=function(t){return t instanceof u||t instanceof a||t instanceof l},i.randBetween=function(t,e,r){t=G(t);var n=r||Math.random,o=R(t,e=G(e)),u=B(t,e).subtract(o).add(1);if(u.isSmall)return o.add(Math.floor(n()*u));for(var a=z(u,1e7).value,l=[],p=!0,f=0;f<a.length;f++){var s=p?a[f]+(f+1<a.length?a[f+1]/1e7:0):1e7,c=h(n()*s);l.push(c),c<a[f]&&(p=!1)}return o.add(i.fromArray(l,1e7,!1))},i.fromArray=function(t,e,r){return F(t.map(G),G(e||10),r)},i}();void 0!==e&&e.hasOwnProperty("exports")&&(e.exports=r),"function"==typeof define&&define.amd&&define(function(){return r})}},function(){return e||(0,t[s(t)[0]])((e={exports:{}}).exports,e),e.exports});function v(t){let e,r=0;return()=>{if(2===r)return e;if(1===r)throw Error("Binding demanded before initialized");return r=1,e=t(),r=2,e}}function d(){throw Error("Failed pattern match")}var y=function(t){return function(e){return e[t]}},_={tag:"Proxy"},m=function(t){return function(e){return t===e}},b={eq:m},w={eq:m},S=function(t){return function(e){for(var r=e.length,n=Array(r),o=0;o<r;o++)n[o]=t(e[o]);return n}},N={map:S},I=function(t){return function(e){return function(r){return function(n){return function(o){return n<o?t:n===o?e:r}}}}},L={compare:I("LT")("EQ")("GT"),Eq0:()=>b},A={compare:I("LT")("EQ")("GT"),Eq0:()=>w},x=function(t){return function(e){return e.join(t)}},J=(t,e)=>({tag:t,_1:e}),E={tag:"NoArguments"},q=(t,e)=>({tag:t,_1:e}),M=q("Nothing"),O=t=>q("Just",t),T=(t,e)=>({tag:t,_1:e}),C=(i=M,function(t){return(0|t)===t?O(t):i}),P=(t,e)=>({tag:"Tuple",_1:t,_2:e}),B=t=>e=>P(t,e),R=t=>t._2,j={map:t=>e=>P(e._1,t(e._2))},Z=t=>t._1,F=t=>({apply:e=>r=>P(t.append(e._1)(r._1),e._2(r._2)),Functor0:()=>j}),z=Object.prototype.toString,D=Object.prototype.hasOwnProperty,U=(t,e)=>isNaN(e)||!isFinite(e)?t:e,G=(t,e,r,n,o,i,u)=>{if(null==u)return t(null);let a=typeof u;return"boolean"===a?e(u):"number"===a?r(u):"string"===a?n(u):"[object Array]"===z.call(u)?o(u):i(u)},W=t=>t,Q=t=>t,k=(t,e,r)=>{let n={};for(var o=0;o<r.length;o++)n[t(r[o])]=e(r[o]);return n},K=(t,e,r,n)=>D.call(n,r)?e(n[r]):t,$=t=>t,H=t=>M,V=(t,e,r)=>({tag:t,_1:e,_2:r}),X=V("Tip"),Y=t=>e=>V("AtKey",t,e),tt=t=>e=>V("AtIndex",t,e),te={eq:t=>e=>"Tip"===t.tag?"Tip"===e.tag:"AtKey"===t.tag?"AtKey"===e.tag&&t._1===e._1&&te.eq(t._2)(e._2):"AtIndex"===t.tag&&"AtIndex"===e.tag&&t._1===e._1&&te.eq(t._2)(e._2)},tr=t=>e=>{let r=t,n=e,o=!0,i;for(;o;){let t=r,e=n;if("AtKey"===e.tag){if("AtKey"===t.tag){if(t._1===e._1){r=t._2,n=e._2;continue}o=!1,i=M;continue}if("Tip"===t.tag){o=!1,i=q("Just",e);continue}o=!1,i=M;continue}if("AtIndex"===e.tag&&"AtIndex"===t.tag){if(t._1===e._1){r=t._2,n=e._2;continue}o=!1,i=M;continue}if("Tip"===t.tag){o=!1,i=q("Just",e);continue}o=!1,i=M}return i},tn=t=>{let e=t=>"Tip"===t.tag?"":"AtKey"===t.tag?"."+t._1+e(t._2):"AtIndex"===t.tag?"["+t._1.toString()+"]"+e(t._2):void d();return"$"+e(t)},to=t=>e=>({...e,path:t(e.path),causes:S(to(t))(e.causes)}),ti=t=>{let e=S(e=>{var r;return(r=1===t.causes.length?"\n  ":"\n    ",function(t){return t.replace(RegExp("\n".replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),r)})(ti(to(e=>{let r=tr(t.path)(e);return"Nothing"===r.tag?e:"Just"===r.tag?r._1:void d()})(e)))})(t.causes),r=t.causes.length;return(te.eq(t.path)(X)?""+t.message:tn(t.path)+": "+t.message)+(0===r?"":1===r?":\n  "+x("\n  ")(e):":\n  - "+x("\n  - ")(e))},tu=((t,e,r,n)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let r of s(e))g.call(t,r)||void 0===r||p(t,r,{get:()=>e[r],enumerable:!(n=f(e,r))||n.enumerable});return t})(p(null!=(r=h())?l(c(r)):{},"default",{value:r,enumerable:!0}),r);function ta(t){return(0,tu.default)(t)}function tl(t){return function(e){return t.add(e)}}function tp(t){return function(e){return t.multiply(e)}}var tf={add:tl,zero:ta(0),mul:tp,one:ta(1)},ts="function"==typeof Array.prototype.flatMap?function(t){return function(e){return t.flatMap(e)}}:function(t){return function(e){for(var r=[],n=t.length,o=0;o<n;o++)for(var i=e(t[o]),u=i.length,a=0;a<u;a++)r.push(i[a]);return r}},tc={map:t=>e=>t(e)},tg={apply:t=>e=>t(e),Functor0:()=>tc},th={bind:t=>e=>e(t),Apply0:()=>tg},tv={pure:t=>t,Apply0:()=>tg},td={Applicative0:()=>tv,Bind1:()=>th},ty=function(t,e,r,n){return r>=0&&r<n.length?t(n[r]):e},t_=function(t,e,r){var n=t>=0&&t<r.length;return n&&(r[t]=e),n},tm=function(t){return function(e){return function(r){return function(n){return function(){var o,i,u,a;return o=t,i=e,u=r,(a=n).splice.apply(a,[o,i].concat(u))}}}}},tb=(t,e)=>({tag:"Iterator",_1:t,_2:e}),tw=t=>e=>r=>()=>{let n=!1,o=e._2;for(;!n;){let i=o.value,u=e._1(i);if("Just"===u.tag&&t(u._1)){r.push(u._1),e._2.value;let t=e._2.value;e._2.value=t+1|0;continue}n=!0}},tS=t=>e=>()=>{let r=!1,n=t._2;for(;!r;){let o=n.value,i=n.value;n.value=i+1|0;let u=t._1(o);if("Just"===u.tag){e(u._1)();continue}if("Nothing"===u.tag){r=!0;continue}d()}},tN=function(t){return function(e){return function(r){for(var n=e,o=r.length,i=o-1;i>=0;i--)n=t(r[i])(n);return n}}},tI=function(t){return function(e){return function(r){for(var n=e,o=r.length,i=0;i<o;i++)n=t(n)(r[i]);return n}}},tL=t=>t,tA={foldr:tN,foldl:tI,foldMap:t=>{let e=t.mempty;return r=>tA.foldr(e=>n=>t.Semigroup0().append(r(e))(n))(e)}},tx=function(t){return function(e){for(var r=e.length,n=Array(r),o=0;o<r;o++)n[o]=t(o)(e[o]);return n}},tJ={mapWithIndex:tx,Functor0:()=>N},tE=function(){function t(t){return[t]}function e(t){return function(e){return[t,e]}}function r(t){return function(e){return function(r){return[t,e,r]}}}function n(t){return function(e){return t.concat(e)}}return function(o){return function(i){return function(u){return function(a){return function(l){return function p(f,s){switch(s-f){case 0:return u([]);case 1:return i(t)(a(l[f]));case 2:return o(i(e)(a(l[f])))(a(l[f+1]));case 3:return o(o(i(r)(a(l[f])))(a(l[f+1])))(a(l[f+2]));default:var c=f+2*Math.floor((s-f)/4);return o(i(n)(p(f,c)))(p(c,s))}}(0,l.length)}}}}}}(),tq=t=>t,tM={traverse:t=>{let e=t.Apply0();return tE(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>tM.traverse(t)(tq),Functor0:()=>N,Foldable1:()=>tA},tO=function(t,e){for(var r=t>e?-1:1,n=Array(r*(e-t)+1),o=t,i=0;o!==e;)n[i++]=o,o+=r;return n[i]=o,n},tT="function"==typeof Array.prototype.fill?function(t,e){return t<1?[]:Array(t).fill(e)}:function(t,e){for(var r=[],n=0,o=0;o<t;o++)r[n++]=e;return r},tC=function(){function t(t,e){this.head=t,this.tail=e}var e={};function r(e){return function(r){return new t(e,r)}}return function(t,n){return function(t){for(var r=[],n=0,o=t;o!==e;)r[n++]=o.head,o=o.tail;return r}(t(r)(e)(n))}}(),tP=function(t){return t.length},tB=function(t,e,r,n){for(var o=0,i=n.length;o<i;o++)if(r(n[o]))return t(o);return e},tR=function(t,e,r,n){for(var o=n.length-1;o>=0;o--)if(r(n[o]))return t(o);return e},tj=function(t,e){return e.filter(t)},tZ=function(t,e,r){var n;return r.length<2?r:(!function t(e,r,n,o,i,u){var a,l,p,f,s,c;for((a=i+(u-i>>1))-i>1&&t(e,r,o,n,i,a),u-a>1&&t(e,r,o,n,a,u),l=i,p=a,f=i;l<a&&p<u;)s=o[l],c=o[p],r(e(s)(c))>0?(n[f++]=c,++p):(n[f++]=s,++l);for(;l<a;)n[f++]=o[l++];for(;p<u;)n[f++]=o[p++]}(t,e,n=r.slice(0),r.slice(0),0,r.length),n)},tF=function(t,e,r){for(var n=e.length<r.length?e.length:r.length,o=Array(n),i=0;i<n;i++)o[i]=t(e[i])(r[i]);return o},tz=function(t,e){for(var r=e.length,n=0;n<r;n++)if(t(e[n]))return!0;return!1},tD=function(t,e){for(var r=e.length,n=0;n<r;n++)if(!t(e[n]))return!1;return!0},tU=t=>e=>r=>tF(t,e,r),tG=t=>e=>tZ(t,t=>"GT"===t?1:"EQ"===t?0:"LT"===t?-1:void d(),e),tW=t=>e=>tG(r=>n=>t.compare(e(r))(e(n))),tQ=t=>[t],tk=t=>e=>{let r=tG(e=>r=>t(e._2)(r._2))(tx(B)(e));return 0<r.length?S(R)(tW(A)(Z)((()=>{let e=[r[0]];for(let n of r){let r=t((()=>{let t=e.length-1|0;if(t>=0&&t<e.length)return e[t]._2;d()})())(n._2);("LT"===r||"GT"===r||"EQ"!==r)&&e.push(n)}return e})())):[]},tK=t=>e=>{let r=[],n=tb(t=>t>=0&&t<e.length?q("Just",e[t]):M,{value:0});return tS(n)(e=>()=>{let o=[];o.push(e),tw(t(e))(n)(o)(),r.push(o)})(),r},t$=t=>{let e=tK(e=>r=>"EQ"===t(e)(r));return r=>e(tG(t)(r))},tH=t=>e=>{let r=tB(O,M,t,e);return"Just"===r.tag?q("Just",e[r._1]):M},tV=t=>e=>tD(t,e),tX={foldrWithIndex:t=>e=>{let r=tN(e=>{let r=e._1,n=e._2;return e=>t(r)(n)(e)})(e),n=tx(B);return t=>r(n(t))},foldlWithIndex:t=>e=>{let r=tI(e=>r=>t(r._1)(e)(r._2))(e),n=tx(B);return t=>r(n(t))},foldMapWithIndex:t=>{let e=t.mempty;return r=>tX.foldrWithIndex(e=>n=>o=>t.Semigroup0().append(r(e)(n))(o))(e)},Foldable0:()=>tA},tY={traverseWithIndex:t=>{let e=tY.Traversable2().sequence(t);return t=>{let r=tY.FunctorWithIndex0().mapWithIndex(t);return t=>e(r(t))}},FunctorWithIndex0:()=>tJ,FoldableWithIndex1:()=>tX,Traversable2:()=>tM},t0={unfoldr1:(u=t=>"Nothing"===t.tag||"Just"!==t.tag&&void d(),function(t){return function(e){return function(r){return function(n){return function(o){for(var i=[],a=o;;){var l=n(a);i.push(e(l));var p=r(l);if(u(p))return i;a=t(p)}}}}}})(t=>{if("Just"===t.tag)return t._1;d()})(Z)(R)},t1=function(t,e){for(var r=e[e.length-1],n=e.length-2;n>=0;n--)r=t(e[n])(r);return r},t2=function(t,e){for(var r=e[0],n=e.length,o=1;o<n;o++)r=t(r)(e[o]);return r},t7={foldMap1:t=>{let e=t.append;return t=>{let r=S(t),n=t7.foldl1(e);return t=>n(r(t))}},foldr1:t=>e=>t1(t,e),foldl1:t=>e=>t2(t,e),Foldable0:()=>tA},t5={ff:!1,tt:!0,implies:t=>e=>t5.disj(t5.not(t))(e),conj:function(t){return function(e){return t&&e}},disj:function(t){return function(e){return t||e}},not:function(t){return!t}},t6=(t,e,r)=>({tag:t,_1:e,_2:r}),t3=t6("Nil"),t4=t=>e=>t6("Cons",t,e),t9={foldr:t=>e=>{let r=t9.foldl(e=>r=>t(r)(e))(e),n=t=>{let e=t3,r=t,n=!0,o;for(;n;){let t=e,i=r;if("Nil"===i.tag){n=!1,o=t;continue}if("Cons"===i.tag){e=t6("Cons",i._1,t),r=i._2;continue}d()}return o};return t=>r(n(t))},foldl:t=>e=>r=>{let n=e,o=r,i=!0,u;for(;i;){let e=n,r=o;if("Nil"===r.tag){i=!1,u=e;continue}if("Cons"===r.tag){n=t(e)(r._1),o=r._2;continue}d()}return u},foldMap:t=>{let e=t.mempty;return r=>t9.foldl(e=>{let n=t.Semigroup0().append(e);return t=>n(r(t))})(e)}},t8={append:t=>e=>t9.foldr(t4)(e)(t)},et=(t,e,r,n,o,i,u)=>({tag:t,_1:e,_2:r,_3:n,_4:o,_5:i,_6:u}),ee=et("Leaf"),er=(t,e,r,n)=>{if("Leaf"===r.tag){if("Leaf"===n.tag)return et("Node",1,1,t,e,r,n);if("Node"===n.tag)return et("Node",1+n._1|0,1+n._2|0,t,e,r,n);d()}if("Node"===r.tag){if("Leaf"===n.tag)return et("Node",1+r._1|0,1+r._2|0,t,e,r,n);if("Node"===n.tag)return et("Node",r._1>n._1?1+r._1|0:1+n._1|0,(1+r._2|0)+n._2|0,t,e,r,n)}d()},en=(t,e,r,n)=>{if("Leaf"===r.tag)return"Leaf"===n.tag?et("Node",1,1,t,e,ee,ee):"Node"===n.tag&&n._1>1?"Node"===n._5.tag&&("Leaf"===n._6.tag?n._5._1>0:"Node"===n._6.tag?n._5._1>n._6._1:void d())?er(n._5._3,n._5._4,er(t,e,r,n._5._5),er(n._3,n._4,n._5._6,n._6)):er(n._3,n._4,er(t,e,r,n._5),n._6):er(t,e,r,n);if("Node"===r.tag){if("Node"===n.tag)return n._1>(r._1+1|0)?"Node"===n._5.tag&&("Leaf"===n._6.tag?n._5._1>0:"Node"===n._6.tag?n._5._1>n._6._1:void d())?er(n._5._3,n._5._4,er(t,e,r,n._5._5),er(n._3,n._4,n._5._6,n._6)):er(n._3,n._4,er(t,e,r,n._5),n._6):r._1>(n._1+1|0)?"Node"===r._6.tag&&("Leaf"===r._5.tag?0<=r._6._1:"Node"===r._5.tag?r._5._1<=r._6._1:void d())?er(r._6._3,r._6._4,er(r._3,r._4,r._5,r._6._5),er(t,e,r._6._6,n)):er(r._3,r._4,r._5,er(t,e,r._6,n)):er(t,e,r,n);return"Leaf"===n.tag&&r._1>1?"Node"===r._6.tag&&("Leaf"===r._5.tag?0<=r._6._1:"Node"===r._5.tag?r._5._1<=r._6._1:void d())?er(r._6._3,r._6._4,er(r._3,r._4,r._5,r._6._5),er(t,e,r._6._6,n)):er(r._3,r._4,r._5,er(t,e,r._6,n)):er(t,e,r,n)}d()},eo=t=>e=>r=>{let n=o=>{if("Leaf"===o.tag)return et("Node",1,1,e,r,ee,ee);if("Node"===o.tag){let i=t.compare(e)(o._3);if("LT"===i)return en(o._3,o._4,n(o._5),o._6);if("GT"===i)return en(o._3,o._4,o._5,n(o._6));if("EQ"===i)return et("Node",o._1,o._2,e,r,o._5,o._6)}d()};return n};String.fromCharCode(65535);var ei=function(t){var e=null;return function(){return void 0===t||(e=t(),t=void 0),e}},eu=function(t){return t()},ea=(t,e,r)=>({tag:"NatTrie",_1:t,_2:e,_3:r}),el={tabulate:t=>{let e=t=>r=>{if("Nil"===t.tag)return r._1;if("Cons"===t.tag){if(!t._1){let n=r._2,o=e(t._2);return ei(t=>eu(o(eu(n))))}if(t._1){let n=r._3,o=e(t._2);return ei(t=>eu(o(eu(n))))}}d()},r=e=>ea(ei(r=>t(e)),ei(t=>r(2*e|0)),ei(t=>r((2*e|0)+1|0))),n=r(0),o=t=>{let e=t3,r=t,n=!0,o;for(;n;){let t=e,i=r;if(0===i){n=!1,o=t;continue}e=t6("Cons",(1&i)!=0,t),r=i>>>1}return o};return t=>e(o(t))(n)}},ep=t=>e=>({tabulate:r=>{let n=t.tabulate(t=>e.tabulate(e=>r(P(t,e))));return t=>{let e=t._2,r=n(t._1);return ei(t=>eu(eu(r)(e)))}}}),ef=t=>e=>{let r=t.tabulate(e);return t=>eu(r(t))},es=t=>e=>{let r=ef(ep(t)(e));return t=>{let e=r(e=>t(e._1)(e._2));return t=>r=>e(P(t,r))}},ec=(t,e,r)=>({tag:t,_1:e,_2:r}),eg=ec("Nil"),eh={map:t=>e=>ei(r=>{let n=eu(e);return"Nil"===n.tag?eg:"Cons"===n.tag?ec("Cons",t(n._1),eh.map(t)(n._2)):void d()})},ev=t=>e=>{let r=v(()=>ei(n=>eu((()=>{let n=eh.map(t)(r());return ei(t=>ec("Cons",e,n))})())));return r()},ed=t=>{let e;return e=eu(t),t=>{let r=e,n=t,o=!0,i;for(;o;){let t=r,e=n;if("Nil"===t.tag){o=!1,i=M;continue}if("Cons"===t.tag){if(0===e){o=!1,i=q("Just",t._1);continue}r=eu(t._2),n=e-1|0;continue}d()}return i}},ey=t=>e=>r=>()=>{let n=ty(O,M,t,r),o=ty(O,M,e,r);"Just"===n.tag&&"Just"===o.tag&&(t_(t,o._1,r),t_(e,n._1,r))},e_=t=>e=>{let r=A.compare(t)(e);return"LT"===r||"EQ"===r?t:"GT"===r?e:void d()},em=t=>t,eb=(()=>{let t=v(()=>es(el)(el)(e=>r=>0===e?[[]]:ts(tO(r,1))(r=>S(t=>[r,...t])(t()(e-r|0)(e_(e-r|0)(r)))))),e=t();return t=>t<0?[]:e(t)(t)})(),ew=t=>e=>{let r,n;if(0===t)return[[]];if(e.length===t)return[e];if(e.length<t)return[];if(1===t)return S(tQ)(e);let o=(t=>M,0===e.length?M:(n=e[0],t=>q("Just",{head:n,tail:t}))(e.slice(1)));if("Just"===o.tag){let e=o._1.head;return[...S(t=>[e,...t])(ew(t-1|0)(o._1.tail)),...ew(t)(o._1.tail)]}return[]},eS=(()=>{let t=ev(t=>tF(tl,[tf.one,...t],t[0].isOdd()?[...t,t[t.length-1|0]]:t))([ta(2)]);return e=>r=>{let n=e,o=r,i=!0,u;for(;i;){let e=n,r=o;if(e<0||e<r){i=!1,u=tf.zero;continue}if((e-r|0)<r){n=e,o=e-r|0;continue}if(0===r){i=!1,u=tf.one;continue}if(1===r){i=!1,u=ta(e);continue}let a=ed(t)(e-2|0),l=r-1|0;if("Just"===a.tag){if(l>=0&&l<a._1.length){i=!1,u=a._1[l];continue}i=!1,u=tf.zero;continue}if("Nothing"===a.tag){i=!1,u=tf.zero;continue}d()}return u}})(),eN={genericShowArgs:t=>[]},eI=t=>e=>({"genericShow'":r=>{let n=e.reflectSymbol(_),o=t.genericShowArgs(r);if(0===o.length)return n;return"("+[n,...o].join(" ")+")"}}),eL="JustDraw",eA={show:(()=>{let t=eI(eN)({reflectSymbol:()=>"AtLeast"}),e=eI(eN)({reflectSymbol:()=>"JustDraw"}),r=(()=>{let r=(()=>{let t=eI(eN)({reflectSymbol:()=>"Remains"}),r=(()=>{let e=eI(eN)({reflectSymbol:()=>"JustRemains"}),r=(()=>{let t=eI(eN)({reflectSymbol:()=>"Choice"}),r=(()=>{let e=eI(eN)({reflectSymbol:()=>"LeftOne"}),r=(()=>{let t=eI(eN)({reflectSymbol:()=>"LeftAll"});return{"genericShow'":r=>"Inl"===r.tag?e["genericShow'"](r._1):"Inr"===r.tag?t["genericShow'"](r._1):void d()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void d()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?r["genericShow'"](t._1):void d()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void d()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?r["genericShow'"](t._1):void d()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?r["genericShow'"](e._1):void d()}})();return t=>r["genericShow'"]("AtLeast"===t?J("Inl",E):"JustDraw"===t?J("Inr",J("Inl",E)):"Remains"===t?J("Inr",J("Inr",J("Inl",E))):"JustRemains"===t?J("Inr",J("Inr",J("Inr",J("Inl",E)))):"Choice"===t?J("Inr",J("Inr",J("Inr",J("Inr",J("Inl",E))))):"LeftOne"===t?J("Inr",J("Inr",J("Inr",J("Inr",J("Inr",J("Inl",E)))))):"LeftAll"===t?J("Inr",J("Inr",J("Inr",J("Inr",J("Inr",J("Inr",E)))))):void d())})()},ex=(n=t5,tA.foldMap((()=>{let t={append:t=>e=>n.conj(t)(e)};return{mempty:n.tt,Semigroup0:()=>t}})())(tL)),eJ=t=>e=>t>=e,eE=tA.foldl(t=>e=>eo(A)(e._1)(e._2)(t))(ee),eq=t=>e=>{let r=e,n=!0,o;for(;n;){let e=r;if("Leaf"===e.tag){n=!1,o=M;continue}if("Node"===e.tag){let i=A.compare(t)(e._3);if("LT"===i){r=e._5;continue}if("GT"===i){r=e._6;continue}if("EQ"===i){n=!1,o=q("Just",e._4);continue}}d()}return o},eM=t0.unfoldr1(t=>P(t,(()=>{var e;let r=tR(O,M,em,tF(t=>e=>"GT"===A.compare(t)(e),t,(e=t.length,t.slice(1,e))));if("Just"===r.tag){if(r._1>=0&&r._1<t.length){let e=t[r._1],n=tR(O,M,t=>"GT"===A.compare(e)(t),t);if("Just"===n.tag){let e=n._1;return q("Just",(()=>{let n=[...t];ey(r._1)(e)(n)();let o=r._1+1|0,i=t.length-1|0;if(o>=i);else{let t=tm(o)((i-o|0)+1|0)([])(n)();tm(o)(0)(t.slice().reverse())(n)()}return n})())}if("Nothing"===n.tag)return M;d()}return M}if("Nothing"===r.tag)return M;d()})())),eO=t=>e=>{let r=A.compare(t)(e);return"LT"===r||"EQ"===r?t:"GT"===r?e:void d()},eT=t=>e=>{let r=A.compare(t)(e);return"LT"===r?e:"EQ"===r||"GT"===r?t:void d()},eC=tI(tp)(tf.one),eP=t=>{let e={append:e=>r=>t.add(e)(r)};return tA.foldMap({mempty:t.zero,Semigroup0:()=>e})},eB=eP({add:function(t){return function(e){return t+e|0}},zero:0,mul:function(t){return function(e){return t*e|0}},one:1}),eR=eP(tf),ej=t=>tV(e=>{let r=e.card.id,n=tH(t=>t.card.id===r)(t),o="Nothing"===n.tag?0:"Just"===n.tag?n._1.draw:void d();return e.min<=o&&o<=e.max}),eZ=t=>e=>{if(0===e.length)return[];if(1===e.length&&0===e[0].length)return[[]];let r=t.length,n=tj((()=>{let e=tU(eJ)(tG(t=>e=>A.compare(e)(t))(S(t=>t.count)(t)));return t=>t.length<=r&&ex(e(t))})(),e),o=eE(S(e=>P(e,ew(e)(t)))(tk(A.compare)(S(tP)(n))));return ts(n)(t=>{let e=eq(t.length)(o),r="Nothing"===e.tag?[]:"Just"===e.tag?e._1:void d();return ts(eM(t))(t=>tj(tV(t=>t.draw<=t.card.count),S(tU(t=>e=>({draw:t,card:e}))(t))(r)))})},eF=t=>{let e=t,r=!0,n;for(;r;){let t=e;if("AtLeast"===t.mode){r=!1,n=S(t=>S(t=>({card:t.card,min:t.draw,max:t.card.count}))(t))(eZ(t.cards)(eb(t.count)));continue}if("JustDraw"===t.mode){r=!1,n=S(e=>S(t=>{let r=tH(e=>e.card.id===t.id)(e),n="Nothing"===r.tag?0:"Just"===r.tag?r._1.draw:void d();return{card:t,min:n,max:n}})(t.cards))(eZ(t.cards)(eb(t.count)));continue}if("Remains"===t.mode){r=!1,n=S(e=>S(t=>({card:t,min:0,max:(()=>{let r=tH(e=>e.card.id===t.id)(e);return"Nothing"===r.tag?0:"Just"===r.tag?r._1.draw:void d()})()}))(t.cards))(eZ(t.cards)(eb(eB(t=>t.count)(t.cards)-t.count|0)));continue}if("JustRemains"===t.mode){e={mode:eL,count:eB(t=>t.count)(t.cards)-t.count|0,cards:t.cards};continue}if("Choice"===t.mode){r=!1,n=S(t=>S(t=>({card:t.card,min:1,max:t.card.count}))(t))(eZ(t.cards)([tT(t.count,1)]));continue}if("LeftOne"===t.mode){r=!1,n=S(t=>S(t=>({card:t.card,min:0,max:t.card.count-1|0}))(t))(eZ(t.cards)([tT(t.count,1)]));continue}if("LeftAll"===t.mode){r=!1,n=S(t=>S(t=>({card:t.card,min:0,max:0}))(t))(eZ(t.cards)([tT(t.count,0)]));continue}d()}return n},ez=t=>e=>S(t7.foldl1(t=>e=>({card:t.card,min:t.min+e.min|0,max:eO(t.max)(e.max)})))(t$(t=>e=>L.compare(t.card.id)(e.card.id))([...t,...e])),eD=tV(t=>t.min<=t.max&&t.min<=t.card.count),eU=t=>ts(tO(eO(t.hand)(eB(t=>t.count)(t.cards)),eT(0)(t.hand-t.others|0)))(e=>eZ(t.cards)(eb(e))),eG=t=>e=>tp(eC(S(t=>eS(t.card.count)(t.draw))(e)))(eS(t.others)(t.hand-eB(t=>t.draw)(e)|0)),eW=t=>t2(t=>e=>ts(t)(t=>ts(e)(e=>{let r=ez(t)(e);return eD(r)?[r]:[]})),S(eF)(t)),eQ=t=>e=>{let r=ts(e)(eW);return eR(eG(t))(tj(t=>tz(ej(t),r),eU(t)))},ek=t=>({bind:e=>r=>t.Bind1().bind(e)(e=>"Left"===e.tag?t.Applicative0().pure(T("Left",e._1)):"Right"===e.tag?r(e._1):void d()),Apply0:()=>eK(t)}),eK=t=>{let e=t.Bind1().Apply0().Functor0(),r={map:t=>e.map(e=>"Left"===e.tag?T("Left",e._1):"Right"===e.tag?T("Right",t(e._1)):void d())};return{apply:(()=>{let e=ek(t);return r=>n=>e.bind(r)(r=>e.bind(n)(e=>e$(t).pure(r(e))))})(),Functor0:()=>r}},e$=t=>({pure:e=>t.Applicative0().pure(T("Right",e)),Apply0:()=>eK(t)}),eH=(t,e)=>({tag:"Codec",_1:t,_2:e});"undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&String.prototype[Symbol.iterator],String.prototype.fromCodePoint,String.prototype.codePointAt;var eV=e$(td),eX=ek(td),eY=tY.traverseWithIndex(eV),e0=eH((()=>{let t=eV.pure({});return e=>t})(),(t=>{let e=F(t.Semigroup0());return{pure:B(t.mempty),Apply0:()=>e}})({mempty:t3,Semigroup0:()=>t8}).pure),e1=eH(t=>{let e=G(H,H,H,O,H,H,t);return"Just"===e.tag?T("Right",e._1):"Nothing"===e.tag?T("Left",{path:X,message:"Expected value of type String",causes:[]}):void d()},t=>P($(t),t)),e2=eH(t=>{let e=G(H,H,H,H,H,O,t);return"Just"===e.tag?T("Right",e._1):"Nothing"===e.tag?T("Left",{path:X,message:"Expected value of type Object",causes:[]}):void d()},t=>P($(t),t)),e7=eH(t=>{let e=G(H,H,H,H,O,H,t);return"Just"===e.tag?T("Right",e._1):"Nothing"===e.tag?T("Left",{path:X,message:"Expected value of type Array",causes:[]}):void d()},t=>P($(t),t)),e5=eH(t=>{let e=G(H,H,O,H,H,H,t),r="Just"===e.tag?C(e._1):"Nothing"===e.tag?M:void d();return"Just"===r.tag?T("Right",r._1):"Nothing"===r.tag?T("Left",{path:X,message:"Expected value of type Int",causes:[]}):void d()},t=>P(U(0,t),t)),e6=t=>eH(e=>eX.bind(e2._1(e))(t._1),e=>P(e2._2(k(Z,R,tC(t9.foldr,t._2(e)._1)))._1,e)),e3=t=>()=>e=>r=>{let n=t.reflectSymbol(_);return eH(t=>eX.bind(r._1(t))(r=>eX.bind((()=>{let r=K(M,O,n,t);if("Just"===r.tag){let t=e._1(r._1);return"Left"===t.tag?T("Left",to(Y(n))(t._1)):t}if("Nothing"===r.tag)return T("Left",{path:V("AtKey",n,X),message:"No value found",causes:[]});d()})())(t=>{var e;return eV.pure((e=t,function(t){var r={};for(var o in t)({}).hasOwnProperty.call(t,o)&&(r[o]=t[o]);return r[n]=e,r})(r))})),t=>P(t6("Cons",P(n,e._2(y(n)(t))._1),r._2(t)._1),t))},e4=t=>eH(e=>eX.bind(e7._1(e))(e=>eY(e=>r=>{let n=t._1(r);return"Left"===n.tag?T("Left",to(tt(e))(n._1)):n})(W(e))),e=>P($(Q(S(e=>t._2(e)._1)(e))),e)),e9={rowListCodec:t=>e0},e8=t=>()=>()=>e=>({rowListCodec:r=>e3(e)()(y(e.reflectSymbol(_))(r))(t.rowListCodec(r))}),rt=()=>t=>e=>e6(t.rowListCodec(e)),re=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,rr={reflectSymbol:()=>"count"},rn={reflectSymbol:()=>"cards"},ro=rt()(e8(e8(e8(e9)()()({reflectSymbol:()=>"others"}))()()({reflectSymbol:()=>"hand"}))()()(rn)),ri=rt()(e8(e8(e9)()()({reflectSymbol:()=>"deck"}))()()({reflectSymbol:()=>"condition"})),ru=eH(t=>{let e=e1._1(t);if("Left"===e.tag)return T("Left",{path:e._1.path,message:"Could not decode Id",causes:[e._1]});if("Right"===e.tag){var r;return"string"==typeof(r=e._1)&&re.test(r)?T("Right",e._1):T("Left",{path:X,message:"Could not decode Id, unexpected value found",causes:[]})}d()},t=>P(e1._2(t)._1,t)),ra=(o=eA.show,t=>eH(e=>{let r=e1._1(e);return(()=>{if("Left"===r.tag){let t=r._1;return e=>T("Left",t)}if("Right"===r.tag){let t=r._1;return e=>e(t)}d()})()(e=>{let r=t(e);return"Nothing"===r.tag?T("Left",{path:X,message:"Unexpected value '"+e+"' found",causes:[]}):"Just"===r.tag?T("Right",r._1):void d()})},t=>P(e1._2(o(t))._1,t)))(t=>"AtLeast"===t?q("Just","AtLeast"):"JustDraw"===t?q("Just",eL):"Remains"===t?q("Just","Remains"):"JustRemains"===t?q("Just","JustRemains"):"Choice"===t?q("Just","Choice"):"LeftOne"===t?q("Just","LeftOne"):"LeftAll"===t?q("Just","LeftAll"):M),rl=e6(e8(e8(e8(e9)()()({reflectSymbol:()=>"name"}))()()({reflectSymbol:()=>"id"}))()()(rr).rowListCodec({id:ru,name:e1,count:e5})),rp=(t=>{let e=e4(t);return eH(t=>{let r=e._1(t);return"Left"===r.tag?T("Left",{path:r._1.path,message:"Could not decode NonEmptyArray",causes:[r._1]}):"Right"===r.tag?r._1.length>0?T("Right",r._1):T("Left",{path:X,message:"Could not decode NonEmptyArray, unexpected value found",causes:[]}):void d()},t=>P(e._2(t)._1,t))})(e6(e8(e8(e8(e9)()()({reflectSymbol:()=>"mode"}))()()(rr))()()(rn).rowListCodec({mode:ra,count:e5,cards:e4(rl)}))),rf=e4(rp),rs=ri({deck:ro({cards:e4(rl),others:e5,hand:e5}),condition:rf});(a=t=>{let e=rs._1(t.data),r=(()=>{var t,r;if("Left"===e.tag)return t=ti(e._1),function(){console.error(t)};if("Right"===e.tag)return(r=eQ(e._1.deck)(e._1.condition).toString(10),function(t){return function(){self.postMessage(r,t.length>0?t:void 0)}})([]);d()})();return()=>(r(),void self.close())},function(){self.onmessage=function(t){a(t)()}})()})();
//# sourceMappingURL=worker.js.map
