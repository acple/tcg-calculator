(()=>{let t,e,n,r,i,o;var a,u,l,d=Object.create,s=Object.defineProperty,c=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,_=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,g=(t={"node_modules/big-integer/BigInteger.js"(t,e){var n=function(t){var e=s(0x20000000000000),r="0123456789abcdefghijklmnopqrstuvwxyz",i="function"==typeof BigInt;function o(t,e,n,r){return void 0===t?o[0]:void 0!==e&&(10!=+e||n)?F(t,e,n,r):Q(t)}function a(t,e){this.value=t,this.sign=e,this.isSmall=!1}function u(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function d(t){return -0x20000000000000<t&&t<0x20000000000000}function s(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function c(t){f(t);var n=t.length;if(n<4&&0>x(t,e))switch(n){case 0:return 0;case 1:return t[0];case 2:return t[0]+1e7*t[1];default:return t[0]+(t[1]+1e7*t[2])*1e7}return t}function f(t){for(var e=t.length;0===t[--e];);t.length=e+1}function _(t){for(var e=Array(t),n=-1;++n<t;)e[n]=0;return e}function p(t){return t>0?Math.floor(t):Math.ceil(t)}function g(t,e){var n,r,i=t.length,o=e.length,a=Array(i),u=0;for(r=0;r<o;r++)u=+((n=t[r]+e[r]+u)>=1e7),a[r]=n-1e7*u;for(;r<i;)u=+(1e7===(n=t[r]+u)),a[r++]=n-1e7*u;return u>0&&a.push(u),a}function v(t,e){return t.length>=e.length?g(t,e):g(e,t)}function m(t,e){var n,r,i=t.length,o=Array(i);for(r=0;r<i;r++)e=Math.floor((n=t[r]-1e7+e)/1e7),o[r]=n-1e7*e,e+=1;for(;e>0;)o[r++]=e%1e7,e=Math.floor(e/1e7);return o}function h(t,e){var n,r,i=t.length,o=e.length,a=Array(i),u=0;for(n=0;n<o;n++)(r=t[n]-u-e[n])<0?(r+=1e7,u=1):u=0,a[n]=r;for(n=o;n<i;n++){if((r=t[n]-u)<0)r+=1e7;else{a[n++]=r;break}a[n]=r}for(;n<i;n++)a[n]=t[n];return f(a),a}function C(t,e,n){var r,i,o=t.length,l=Array(o),d=-e;for(r=0;r<o;r++)d=Math.floor((i=t[r]+d)/1e7),i%=1e7,l[r]=i<0?i+1e7:i;return"number"==typeof(l=c(l))?(n&&(l=-l),new u(l)):new a(l,n)}function y(t,e){var n,r,i,o,a=t.length,u=e.length,l=_(a+u);for(i=0;i<a;++i){o=t[i];for(var d=0;d<u;++d)r=Math.floor((n=o*e[d]+l[i+d])/1e7),l[i+d]=n-1e7*r,l[i+d+1]+=r}return f(l),l}function b(t,e){var n,r,i=t.length,o=Array(i),a=0;for(r=0;r<i;r++)a=Math.floor((n=t[r]*e+a)/1e7),o[r]=n-1e7*a;for(;a>0;)o[r++]=a%1e7,a=Math.floor(a/1e7);return o}function R(t,e){for(var n=[];e-- >0;)n.push(0);return n.concat(t)}function S(t,e,n){return t<1e7?new a(b(e,t),n):new a(y(e,s(t)),n)}function w(t){var e,n,r,i,o=t.length,a=_(o+o);for(r=0;r<o;r++){n=0-(i=t[r])*i;for(var u=r;u<o;u++)n=Math.floor((e=i*t[u]*2+a[r+u]+n)/1e7),a[r+u]=e-1e7*n;a[r+o]=n}return f(a),a}function N(t,e){var n,r,i,o,a=t.length,u=_(a);for(i=0,n=a-1;n>=0;--n)r=p((o=1e7*i+t[n])/e),i=o-r*e,u[n]=0|r;return[u,0|i]}function E(t,e){var n,r,d=Q(e);if(i)return[new l(t.value/d.value),new l(t.value%d.value)];var g=t.value,v=d.value;if(0===v)throw Error("Cannot divide by zero");if(t.isSmall)return d.isSmall?[new u(p(g/v)),new u(g%v)]:[o[0],t];if(d.isSmall){if(1===v)return[t,o[0]];if(-1==v)return[t.negate(),o[0]];var m=Math.abs(v);if(m<1e7){n=c((r=N(g,m))[0]);var C=r[1];return(t.sign&&(C=-C),"number"==typeof n)?(t.sign!==d.sign&&(n=-n),[new u(n),new u(C)]):[new a(n,t.sign!==d.sign),new u(C)]}v=s(m)}var y=x(g,v);if(-1===y)return[o[0],t];if(0===y)return[o[t.sign===d.sign?1:-1],o[0]];n=(r=g.length+v.length<=200?function(t,e){var n,r,i,o,a,u,l,d=t.length,s=e.length,f=_(e.length),p=e[s-1],g=Math.ceil(1e7/(2*p)),v=b(t,g),m=b(e,g);for(v.length<=d&&v.push(0),m.push(0),p=m[s-1],r=d-s;r>=0;r--){for(n=1e7-1,v[r+s]!==p&&(n=Math.floor((1e7*v[r+s]+v[r+s-1])/p)),i=0,o=0,u=m.length,a=0;a<u;a++)i+=n*m[a],l=Math.floor(i/1e7),o+=v[r+a]-(i-1e7*l),i=l,o<0?(v[r+a]=o+1e7,o=-1):(v[r+a]=o,o=0);for(;0!==o;){for(n-=1,i=0,a=0;a<u;a++)(i+=v[r+a]-1e7+m[a])<0?(v[r+a]=i+1e7,i=0):(v[r+a]=i,i=1);o+=i}f[r]=n}return v=N(v,g)[0],[c(f),c(v)]}(g,v):function(t,e){for(var n,r,i,o,a,u=t.length,l=e.length,d=[],s=[];u;){if(s.unshift(t[--u]),f(s),0>x(s,e)){d.push(0);continue}r=s.length,i=1e7*s[r-1]+s[r-2],o=1e7*e[l-1]+e[l-2],r>l&&(i=(i+1)*1e7),n=Math.ceil(i/o);do{if(0>=x(a=b(e,n),s))break;n--}while(n)d.push(n),s=h(s,a)}return d.reverse(),[c(d),c(s)]}(g,v))[0];var R=t.sign!==d.sign,S=r[1],w=t.sign;return"number"==typeof n?(R&&(n=-n),n=new u(n)):n=new a(n,R),"number"==typeof S?(w&&(S=-S),S=new u(S)):S=new a(S,w),[n,S]}function x(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n])return t[n]>e[n]?1:-1;return 0}function J(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function A(t,e){for(var r,i,o,a=t.prev(),u=a,l=0;u.isEven();)u=u.divide(2),l++;t:for(i=0;i<e.length;i++)if(!t.lesser(e[i])&&!((o=n(e[i]).modPow(u,t)).isUnit()||o.equals(a))){for(r=l-1;0!=r&&!(o=o.square().mod(t)).isUnit();r--)if(o.equals(a))continue t;return!1}return!0}a.prototype=Object.create(o.prototype),u.prototype=Object.create(o.prototype),l.prototype=Object.create(o.prototype),a.prototype.add=function(t){var e=Q(t);if(this.sign!==e.sign)return this.subtract(e.negate());var n=this.value,r=e.value;return e.isSmall?new a(m(n,Math.abs(r)),this.sign):new a(v(n,r),this.sign)},a.prototype.plus=a.prototype.add,u.prototype.add=function(t){var e=Q(t),n=this.value;if(n<0!==e.sign)return this.subtract(e.negate());var r=e.value;if(e.isSmall){if(d(n+r))return new u(n+r);r=s(Math.abs(r))}return new a(m(r,Math.abs(n)),n<0)},u.prototype.plus=u.prototype.add,l.prototype.add=function(t){return new l(this.value+Q(t).value)},l.prototype.plus=l.prototype.add,a.prototype.subtract=function(t){var e,n,r=Q(t);if(this.sign!==r.sign)return this.add(r.negate());var i=this.value,o=r.value;return r.isSmall?C(i,Math.abs(o),this.sign):(e=this.sign,(x(i,o)>=0?n=h(i,o):(n=h(o,i),e=!e),"number"==typeof(n=c(n)))?(e&&(n=-n),new u(n)):new a(n,e))},a.prototype.minus=a.prototype.subtract,u.prototype.subtract=function(t){var e=Q(t),n=this.value;if(n<0!==e.sign)return this.add(e.negate());var r=e.value;return e.isSmall?new u(n-r):C(r,Math.abs(n),n>=0)},u.prototype.minus=u.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-Q(t).value)},l.prototype.minus=l.prototype.subtract,a.prototype.negate=function(){return new a(this.value,!this.sign)},u.prototype.negate=function(){var t=this.sign,e=new u(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},a.prototype.abs=function(){return new a(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},a.prototype.multiply=function(t){var e,n,r,i=Q(t),u=this.value,l=i.value,d=this.sign!==i.sign;if(i.isSmall){if(0===l)return o[0];if(1===l)return this;if(-1===l)return this.negate();if((r=Math.abs(l))<1e7)return new a(b(u,r),d);l=s(r)}return -.012*(e=u.length)-.012*(n=l.length)+15e-6*e*n>0?new a(function t(e,n){var r=Math.max(e.length,n.length);if(r<=30)return y(e,n);r=Math.ceil(r/2);var i=e.slice(r),o=e.slice(0,r),a=n.slice(r),u=n.slice(0,r),l=t(o,u),d=t(i,a),s=t(v(o,i),v(u,a)),c=v(v(l,R(h(h(s,l),d),r)),R(d,2*r));return f(c),c}(u,l),d):new a(y(u,l),d)},a.prototype.times=a.prototype.multiply,u.prototype._multiplyBySmall=function(t){return d(t.value*this.value)?new u(t.value*this.value):S(Math.abs(t.value),s(Math.abs(this.value)),this.sign!==t.sign)},a.prototype._multiplyBySmall=function(t){return 0===t.value?o[0]:1===t.value?this:-1===t.value?this.negate():S(Math.abs(t.value),this.value,this.sign!==t.sign)},u.prototype.multiply=function(t){return Q(t)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*Q(t).value)},l.prototype.times=l.prototype.multiply,a.prototype.square=function(){return new a(w(this.value),!1)},u.prototype.square=function(){var t=this.value*this.value;return d(t)?new u(t):new a(w(s(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},a.prototype.divmod=function(t){var e=E(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=u.prototype.divmod=a.prototype.divmod,a.prototype.divide=function(t){return E(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/Q(t).value)},u.prototype.over=u.prototype.divide=a.prototype.over=a.prototype.divide,a.prototype.mod=function(t){return E(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%Q(t).value)},u.prototype.remainder=u.prototype.mod=a.prototype.remainder=a.prototype.mod,a.prototype.pow=function(t){var e,n,r,i=Q(t),a=this.value,l=i.value;if(0===l)return o[1];if(0===a)return o[0];if(1===a)return o[1];if(-1===a)return i.isEven()?o[1]:o[-1];if(i.sign)return o[0];if(!i.isSmall)throw Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&d(e=Math.pow(a,l)))return new u(p(e));for(n=this,r=o[1];!0&l&&(r=r.times(n),--l),0!==l;)l/=2,n=n.square();return r},u.prototype.pow=a.prototype.pow,l.prototype.pow=function(t){var e=Q(t),n=this.value,r=e.value,i=BigInt(0),a=BigInt(1),u=BigInt(2);if(r===i)return o[1];if(n===i)return o[0];if(n===a)return o[1];if(n===BigInt(-1))return e.isEven()?o[1]:o[-1];if(e.isNegative())return new l(i);for(var d=this,s=o[1];(r&a)===a&&(s=s.times(d),--r),r!==i;)r/=u,d=d.square();return s},a.prototype.modPow=function(t,e){if(t=Q(t),(e=Q(e)).isZero())throw Error("Cannot take modPow with modulus 0");var n=o[1],r=this.mod(e);for(t.isNegative()&&(t=t.multiply(o[-1]),r=r.modInv(e));t.isPositive();){if(r.isZero())return o[0];t.isOdd()&&(n=n.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return n},l.prototype.modPow=u.prototype.modPow=a.prototype.modPow,a.prototype.compareAbs=function(t){var e=Q(t),n=this.value,r=e.value;return e.isSmall?1:x(n,r)},u.prototype.compareAbs=function(t){var e=Q(t),n=Math.abs(this.value),r=e.value;return e.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,n=Q(t).value;return(e=e>=0?e:-e)===(n=n>=0?n:-n)?0:e>n?1:-1},a.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=Q(t),n=this.value,r=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:x(n,r)*(this.sign?-1:1)},a.prototype.compareTo=a.prototype.compare,u.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=Q(t),n=this.value,r=e.value;return e.isSmall?n==r?0:n>r?1:-1:n<0!==e.sign?n<0?-1:1:n<0?1:-1},u.prototype.compareTo=u.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return -1;if(t===-1/0)return 1;var e=this.value,n=Q(t).value;return e===n?0:e>n?1:-1},l.prototype.compareTo=l.prototype.compare,a.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=u.prototype.eq=u.prototype.equals=a.prototype.eq=a.prototype.equals,a.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=a.prototype.neq=a.prototype.notEquals,a.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=u.prototype.gt=u.prototype.greater=a.prototype.gt=a.prototype.greater,a.prototype.lesser=function(t){return 0>this.compare(t)},l.prototype.lt=l.prototype.lesser=u.prototype.lt=u.prototype.lesser=a.prototype.lt=a.prototype.lesser,a.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals,a.prototype.lesserOrEquals=function(t){return 0>=this.compare(t)},l.prototype.leq=l.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals,a.prototype.isEven=function(){return(1&this.value[0])==0},u.prototype.isEven=function(){return(1&this.value)==0},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},a.prototype.isOdd=function(){return(1&this.value[0])==1},u.prototype.isOdd=function(){return(1&this.value)==1},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},a.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=u.prototype.isPositive,a.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=u.prototype.isNegative,a.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},a.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},a.prototype.isDivisibleBy=function(t){var e=Q(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=u.prototype.isDivisibleBy=a.prototype.isDivisibleBy,a.prototype.isPrime=function(t){var e=J(this);if(void 0!==e)return e;var r=this.abs(),i=r.bitLength();if(i<=64)return A(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*i.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(o,2):o),u=[],l=0;l<a;l++)u.push(n(l+2));return A(r,u)},l.prototype.isPrime=u.prototype.isPrime=a.prototype.isPrime,a.prototype.isProbablePrime=function(t,e){var r=J(this);if(void 0!==r)return r;for(var i=this.abs(),o=void 0===t?5:t,a=[],u=0;u<o;u++)a.push(n.randBetween(2,i.minus(2),e));return A(i,a)},l.prototype.isProbablePrime=u.prototype.isProbablePrime=a.prototype.isProbablePrime,a.prototype.modInv=function(t){for(var e,r,i,o=n.zero,a=n.one,u=Q(t),l=this.abs();!l.isZero();)e=u.divide(l),r=o,i=u,o=a,u=l,a=r.subtract(e.multiply(a)),l=i.subtract(e.multiply(l));if(!u.isUnit())throw Error(this.toString()+" and "+t.toString()+" are not co-prime");return(-1===o.compare(0)&&(o=o.add(t)),this.isNegative())?o.negate():o},l.prototype.modInv=u.prototype.modInv=a.prototype.modInv,a.prototype.next=function(){var t=this.value;return this.sign?C(t,1,this.sign):new a(m(t,1),this.sign)},u.prototype.next=function(){var t=this.value;return t+1<0x20000000000000?new u(t+1):new a(e,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},a.prototype.prev=function(){var t=this.value;return this.sign?new a(m(t,1),!0):C(t,1,this.sign)},u.prototype.prev=function(){var t=this.value;return t-1>-0x20000000000000?new u(t-1):new a(e,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var L=[1];2*L[L.length-1]<=1e7;)L.push(2*L[L.length-1]);var B=L.length,k=L[B-1];function I(t){return 1e7>=Math.abs(t)}function T(t,e,r){e=Q(e);for(var i=t.isNegative(),o=e.isNegative(),a=i?t.not():t,u=o?e.not():e,l=0,d=0,s=null,c=null,f=[];!a.isZero()||!u.isZero();)l=(s=E(a,k))[1].toJSNumber(),i&&(l=k-1-l),d=(c=E(u,k))[1].toJSNumber(),o&&(d=k-1-d),a=s[0],u=c[0],f.push(r(l,d));for(var _=0!==r(+!!i,+!!o)?n(-1):n(0),p=f.length-1;p>=0;p-=1)_=_.multiply(k).add(n(f[p]));return _}a.prototype.shiftLeft=function(t){var e=Q(t).toJSNumber();if(!I(e))throw Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var n=this;if(n.isZero())return n;for(;e>=B;)n=n.multiply(k),e-=B-1;return n.multiply(L[e])},l.prototype.shiftLeft=u.prototype.shiftLeft=a.prototype.shiftLeft,a.prototype.shiftRight=function(t){var e,n=Q(t).toJSNumber();if(!I(n))throw Error(String(n)+" is too large for shifting.");if(n<0)return this.shiftLeft(-n);for(var r=this;n>=B;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(e=E(r,k))[1].isNegative()?e[0].prev():e[0],n-=B-1}return(e=E(r,L[n]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=u.prototype.shiftRight=a.prototype.shiftRight,a.prototype.not=function(){return this.negate().prev()},l.prototype.not=u.prototype.not=a.prototype.not,a.prototype.and=function(t){return T(this,t,function(t,e){return t&e})},l.prototype.and=u.prototype.and=a.prototype.and,a.prototype.or=function(t){return T(this,t,function(t,e){return t|e})},l.prototype.or=u.prototype.or=a.prototype.or,a.prototype.xor=function(t){return T(this,t,function(t,e){return t^e})},l.prototype.xor=u.prototype.xor=a.prototype.xor;function M(t){var e=t.value,n="number"==typeof e?0x40000000|e:"bigint"==typeof e?e|BigInt(0x40000000):e[0]+1e7*e[1]|0x40004000;return n&-n}function O(t,e){return t=Q(t),e=Q(e),t.greater(e)?t:e}function q(t,e){return t=Q(t),e=Q(e),t.lesser(e)?t:e}function P(t,e){if(t=Q(t).abs(),e=Q(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var n,r,i=o[1];t.isEven()&&e.isEven();)n=q(M(t),M(e)),t=t.divide(n),e=e.divide(n),i=i.multiply(n);for(;t.isEven();)t=t.divide(M(t));do{for(;e.isEven();)e=e.divide(M(e));t.greater(e)&&(r=e,e=t,t=r),e=e.subtract(t)}while(!e.isZero())return i.isUnit()?t:t.multiply(i)}a.prototype.bitLength=function(){var t=this;return(0>t.compareTo(n(0))&&(t=t.negate().subtract(n(1))),0===t.compareTo(n(0)))?n(0):n(function t(e,r){if(0>=r.compareTo(e)){var i=t(e,r.square(r)),o=i.p,a=i.e,u=o.multiply(r);return 0>=u.compareTo(e)?{p:u,e:2*a+1}:{p:o,e:2*a}}return{p:n(1),e:0}}(t,n(2)).e).add(n(1))},l.prototype.bitLength=u.prototype.bitLength=a.prototype.bitLength;var F=function(t,e,n,i){n=n||r,t=String(t),i||(t=t.toLowerCase(),n=n.toLowerCase());var o,a=t.length,u=Math.abs(e),l={};for(o=0;o<n.length;o++)l[n[o]]=o;for(o=0;o<a;o++){var d=t[o];if("-"!==d&&d in l&&l[d]>=u){if("1"===d&&1===u)continue;throw Error(d+" is not a valid digit in base "+e+".")}}e=Q(e);var s=[],c="-"===t[0];for(o=+!!c;o<t.length;o++){var d=t[o];if(d in l)s.push(Q(l[d]));else if("<"===d){var f=o;do o++;while(">"!==t[o]&&o<t.length)s.push(Q(t.slice(f+1,o)))}else throw Error(d+" is not a valid character")}return U(s,e,c)};function U(t,e,n){var r,i=o[0],a=o[1];for(r=t.length-1;r>=0;r--)i=i.add(t[r].times(a)),a=a.times(e);return n?i.negate():i}function D(t,e){if((e=n(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var i=!1;if(t.isNegative()&&e.isPositive()&&(i=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var o,a=[],u=t;u.isNegative()||u.compareAbs(e)>=0;){u=(o=u.divmod(e)).quotient;var l=o.remainder;l.isNegative()&&(l=e.minus(l).abs(),u=u.next()),a.push(l.toJSNumber())}return a.push(u.toJSNumber()),{value:a.reverse(),isNegative:i}}function z(t,e,n){var i=D(t,e);return(i.isNegative?"-":"")+i.value.map(function(t){var e;return t<(e=(e=n)||r).length?e[t]:"<"+t+">"}).join("")}function G(t){if(d(+t)){var e=+t;if(e===p(e))return i?new l(BigInt(e)):new u(e);throw Error("Invalid integer: "+t)}var n="-"===t[0];n&&(t=t.slice(1));var r=t.split(/e/i);if(r.length>2)throw Error("Invalid integer: "+r.join("e"));if(2===r.length){var o=r[1];if("+"===o[0]&&(o=o.slice(1)),(o*=1)!==p(o)||!d(o))throw Error("Invalid integer: "+o+" is not a valid exponent.");var s=r[0],c=s.indexOf(".");if(c>=0&&(o-=s.length-c-1,s=s.slice(0,c)+s.slice(c+1)),o<0)throw Error("Cannot include negative exponent part for integers");s+=Array(o+1).join("0"),t=s}if(!/^([0-9][0-9]*)$/.test(t))throw Error("Invalid integer: "+t);if(i)return new l(BigInt(n?"-"+t:t));for(var _=[],g=t.length,v=g-7;g>0;)_.push(+t.slice(v,g)),(v-=7)<0&&(v=0),g-=7;return f(_),new a(_,n)}function Q(t){if("number"==typeof t){if(i)return new l(BigInt(t));if(d(t)){if(t!==p(t))throw Error(t+" is not an integer.");return new u(t)}return G(t.toString())}return"string"==typeof t?G(t):"bigint"==typeof t?new l(t):t}a.prototype.toArray=function(t){return D(this,t)},u.prototype.toArray=function(t){return D(this,t)},l.prototype.toArray=function(t){return D(this,t)},a.prototype.toString=function(e,n){if(e===t&&(e=10),10!==e||n)return z(this,e,n);for(var r,i=this.value,o=i.length,a=String(i[--o]);--o>=0;)r=String(i[o]),a+="0000000".slice(r.length)+r;return(this.sign?"-":"")+a},u.prototype.toString=function(e,n){return(e===t&&(e=10),10!=e||n)?z(this,e,n):String(this.value)},l.prototype.toString=u.prototype.toString,l.prototype.toJSON=a.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},a.prototype.valueOf=function(){return parseInt(this.toString(),10)},a.prototype.toJSNumber=a.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var j=0;j<1e3;j++)o[j]=Q(j),j>0&&(o[-j]=Q(-j));return o.one=o[1],o.zero=o[0],o.minusOne=o[-1],o.max=O,o.min=q,o.gcd=P,o.lcm=function(t,e){return t=Q(t).abs(),e=Q(e).abs(),t.divide(P(t,e)).multiply(e)},o.isInstance=function(t){return t instanceof a||t instanceof u||t instanceof l},o.randBetween=function(t,e,n){t=Q(t);var r=n||Math.random,i=q(t,e=Q(e)),a=O(t,e).subtract(i).add(1);if(a.isSmall)return i.add(Math.floor(r()*a));for(var u=D(a,1e7).value,l=[],d=!0,s=0;s<u.length;s++){var c=d?u[s]+(s+1<u.length?u[s+1]/1e7:0):1e7,f=p(r()*c);l.push(f),f<u[s]&&(d=!1)}return i.add(o.fromArray(l,1e7,!1))},o.fromArray=function(t,e,n){return U(t.map(Q),Q(e||10),n)},o}();void 0!==e&&e.hasOwnProperty("exports")&&(e.exports=n),"function"==typeof define&&define.amd&&define(function(){return n})}},function(){return e||(0,t[f(t)[0]])((e={exports:{}}).exports,e),e.exports});function v(t){let e,n=0;return()=>{if(2===n)return e;if(1===n)throw Error("Binding demanded before initialized");return n=1,e=t(),n=2,e}}function m(){throw Error("Failed pattern match")}var h=t=>e=>t,C={tag:"Proxy"},y=function(t){return function(e){for(var n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t(e[i]);return r}},b={map:t=>e=>n=>t(e(n))},R={map:y},S=t=>t,w={apply:t=>e=>n=>t(n)(e(n)),Functor0:()=>b},N="function"==typeof Array.prototype.flatMap?function(t){return function(e){return t.flatMap(e)}}:function(t){return function(e){for(var n=[],r=t.length,i=0;i<r;i++)for(var o=e(t[i]),a=o.length,u=0;u<a;u++)n.push(o[u]);return n}},E={pure:t=>e=>t,Apply0:()=>w},x=function(t){return function(e){return e[t]}},J=function(t){return function(e){return function(n){var r={};for(var i in n)({}).hasOwnProperty.call(n,i)&&(r[i]=n[i]);return r[t]=e,r}}},A=function(t){return t.toString()},L=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},B=(t,e)=>({tag:t,_1:e}),k={tag:"NoArguments"},I=(t,e)=>({tag:t,_1:e}),T=I("Nothing"),M=t=>I("Just",t),O={map:t=>e=>"Just"===e.tag?I("Just",t(e._1)):T},q={apply:t=>e=>"Just"===t.tag?"Just"===e.tag?I("Just",t._1(e._1)):T:"Nothing"===t.tag?T:void m(),Functor0:()=>O},P={pure:M,Apply0:()=>q},F=(t,e)=>({tag:t,_1:e}),U=t=>F("Left",t),D=t=>F("Right",t),z={map:t=>e=>t(e)},G={apply:t=>e=>t(e),Functor0:()=>z},Q={bind:t=>e=>e(t),Apply0:()=>G},j={pure:t=>t,Apply0:()=>G},H={Applicative0:()=>j,Bind1:()=>Q},W={Applicative0:()=>$,Bind1:()=>Z},Z={bind:function(t){return function(e){return function(){return e(t())()}}},Apply0:()=>K},K={apply:t=>e=>()=>{let n=t(),r=e();return $.pure(n(r))()},Functor0:()=>V},$={pure:function(t){return function(){return t}},Apply0:()=>K},V={map:t=>e=>()=>t(e())},Y=(t,e)=>({tag:t,_1:e}),X=t=>Y("Done",t),tt=t=>e=>{let n=t(e);return()=>{var e;let r=n();(e=()=>{let e=r;return"Loop"===e.tag?(r=t(e._1)(),!1):"Done"===e.tag||void m()},function(){for(;!e(););})();let i=r;if("Done"===i.tag)return i._1;m()}},te=function(t){return function(e){return function(n){for(var r=e,i=n.length,o=i-1;o>=0;o--)r=t(n[o])(r);return r}}},tn=function(t){return function(e){return function(n){for(var r=e,i=n.length,o=0;o<i;o++)r=t(r)(n[o]);return r}}},tr=t=>{let e=t.Apply0();return n=>r=>n.foldr(t=>{let n=r(t);return t=>e.apply(e.Functor0().map(t=>S)(n))(t)})(t.pure())},ti=t=>{let e=tr(t);return t=>{let n=e(t);return t=>e=>n(e)(t)}},to={foldr:t=>e=>n=>"Nothing"===n.tag?e:"Just"===n.tag?t(n._1)(e):void m(),foldl:t=>e=>n=>"Nothing"===n.tag?e:"Just"===n.tag?t(e)(n._1):void m(),foldMap:t=>{let e=t.mempty;return t=>n=>"Nothing"===n.tag?e:"Just"===n.tag?t(n._1):void m()}},ta={foldr:te,foldl:tn,foldMap:t=>{let e=t.mempty;return n=>ta.foldr(e=>r=>t.Semigroup0().append(n(e))(r))(e)}},tu=(t,e)=>({tag:"NonEmpty",_1:t,_2:e}),tl=(t,e)=>({tag:"Tuple",_1:t,_2:e}),td=t=>e=>tl(t,e),ts=t=>t._2,tc={map:t=>e=>tl(e._1,t(e._2))},tf=t=>t._1,t_=t=>({apply:e=>n=>tl(t.append(e._1)(n._1),e._2(n._2)),Functor0:()=>tc}),tp=(t,e,n)=>({tag:t,_1:e,_2:n}),tg=tp("Nil"),tv=t=>e=>tp("Cons",t,e),tm={foldr:t=>e=>{let n=tm.foldl(e=>n=>t(n)(e))(e),r=t=>{let e=tg,n=t,r=!0,i;for(;r;){let t=e,o=n;if("Nil"===o.tag){r=!1,i=t;continue}if("Cons"===o.tag){e=tp("Cons",o._1,t),n=o._2;continue}m()}return i};return t=>n(r(t))},foldl:t=>e=>n=>{let r=e,i=n,o=!0,a;for(;o;){let e=r,n=i;if("Nil"===n.tag){o=!1,a=e;continue}if("Cons"===n.tag){r=t(e)(n._1),i=n._2;continue}m()}return a},foldMap:t=>{let e=t.mempty;return n=>tm.foldl(e=>{let r=t.Semigroup0().append(e);return t=>r(n(t))})(e)}},th={append:t=>e=>tm.foldr(tv)(e)(t)},tC=function(t){return t},ty=function(){function t(t){return[t]}function e(t){return function(e){return[t,e]}}function n(t){return function(e){return function(n){return[t,e,n]}}}function r(t){return function(e){return t.concat(e)}}return function(i){return function(o){return function(a){return function(u){return function(l){return function d(s,c){switch(c-s){case 0:return a([]);case 1:return o(t)(u(l[s]));case 2:return i(o(e)(u(l[s])))(u(l[s+1]));case 3:return i(i(o(n)(u(l[s])))(u(l[s+1])))(u(l[s+2]));default:var f=s+2*Math.floor((c-s)/4);return i(o(r)(d(s,f)))(d(f,c))}}(0,l.length)}}}}}}(),tb=t=>t,tR={traverse:t=>{let e=t.Apply0();return ty(e.apply)(e.Functor0().map)(t.pure)},sequence:t=>tR.traverse(t)(tb),Functor0:()=>R,Foldable1:()=>ta},tS=(t,e)=>({tag:"CatQueue",_1:t,_2:e}),tw=t=>{let e=t,n=!0,r;for(;n;){let t=e;if("Nil"===t._1.tag){let i;if("Nil"===t._2.tag){n=!1,r=T;continue}e=tS((i=tg,t=>{let e=i,n=t,r=!0,o;for(;r;){let t=e,i=n;if("Nil"===i.tag){r=!1,o=t;continue}if("Cons"===i.tag){e=tp("Cons",i._1,t),n=i._2;continue}m()}return o})(t._2),tg);continue}if("Cons"===t._1.tag){n=!1,r=I("Just",tl(t._1._1,tS(t._1._2,t._2)));continue}m()}return r},tN=(t,e,n)=>({tag:t,_1:e,_2:n}),tE=tN("CatNil"),tx=t=>e=>"CatNil"===t.tag?e:"CatNil"===e.tag?t:"CatCons"===t.tag?tN("CatCons",t._1,tS(t._2._1,tp("Cons",e,t._2._2))):void m(),tJ=t=>e=>n=>{let r=t=>e=>n=>{let r=t,i=e,o=n,a=!0,u;for(;a;){let t=r,e=i,n=o;if("Nil"===n.tag){a=!1,u=e;continue}if("Cons"===n.tag){r=t,i=t(e)(n._1),o=n._2;continue}m()}return u};return(i=>{let o=n,a=i,u=!0,l;for(;u;){let n=a,i=tw(o);if("Nothing"===i.tag){u=!1,l=r(t=>e=>e(t))(e)(n);continue}if("Just"===i.tag){o=i._1._2,a=tp("Cons",t(i._1._1),n);continue}m()}return l})(tg)},tA=t=>"CatNil"===t.tag?T:"CatCons"===t.tag?I("Just",tl(t._1,"Nil"===t._2._1.tag&&"Nil"===t._2._2.tag?tE:tJ(tx)(tE)(t._2))):void m(),tL=(t,e)=>({tag:"Free",_1:t,_2:e}),tB=(t,e,n)=>({tag:t,_1:e,_2:n}),tk=t=>{let e=t,n=!0,r;for(;n;){let t=e;if("Return"===t._1.tag){let i=tA(t._2);if("Nothing"===i.tag){n=!1,r=tB("Return",t._1._1);continue}if("Just"===i.tag){e=(()=>{let e=i._1._1(t._1._1);return tL(e._1,"CatNil"===e._2.tag?i._1._2:"CatNil"===i._1._2.tag?e._2:"CatCons"===e._2.tag?tN("CatCons",e._2._1,tS(e._2._2._1,tp("Cons",i._1._2,e._2._2._2))):void m())})();continue}m()}if("Bind"===t._1.tag){n=!1,r=tB("Bind",t._1._1,e=>{let n=t._1._2(e);return tL(n._1,"CatNil"===n._2.tag?t._2:"CatNil"===t._2.tag?n._2:"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",t._2,n._2._2._2))):void m())});continue}m()}return r},tI={Applicative0:()=>tq,Bind1:()=>tM},tT={map:t=>e=>tM.bind(e)(e=>tq.pure(t(e)))},tM={bind:t=>e=>tL(t._1,"CatNil"===t._2.tag?tN("CatCons",e,tS(tg,tg)):"CatCons"===t._2.tag?tN("CatCons",t._2._1,tS(t._2._2._1,tp("Cons",tN("CatCons",e,tS(tg,tg)),t._2._2._2))):void m()),Apply0:()=>tO},tO={apply:t=>e=>{let n=t=>tL(e._1,"CatNil"===e._2.tag?tN("CatCons",e=>tq.pure(t(e)),tS(tg,tg)):"CatCons"===e._2.tag?tN("CatCons",e._2._1,tS(e._2._2._1,tp("Cons",tN("CatCons",e=>tq.pure(t(e)),tS(tg,tg)),e._2._2._2))):void m());return tL(t._1,"CatNil"===t._2.tag?tN("CatCons",n,tS(tg,tg)):"CatCons"===t._2.tag?tN("CatCons",t._2._1,tS(t._2._2._1,tp("Cons",tN("CatCons",n,tS(tg,tg)),t._2._2._2))):void m())},Functor0:()=>tT},tq={pure:t=>tL(tB("Return",t),tE),Apply0:()=>tO},tP=t=>({append:e=>n=>tO.apply(tL(e._1,"CatNil"===e._2.tag?tN("CatCons",e=>tL(tB("Return",t.append(e)),tE),tS(tg,tg)):"CatCons"===e._2.tag?tN("CatCons",e._2._1,tS(e._2._2._1,tp("Cons",tN("CatCons",e=>tL(tB("Return",t.append(e)),tE),tS(tg,tg)),e._2._2._2))):void m()))(n)}),tF=t=>{let e=tP(t.Semigroup0());return{mempty:tL(tB("Return",t.mempty),tE),Semigroup0:()=>e}},tU=t=>({bind:e=>n=>t.Bind1().bind(e)(e=>"Nothing"===e.tag?t.Applicative0().pure(T):"Just"===e.tag?n(e._1):void m()),Apply0:()=>tD(t)}),tD=t=>{let e=t.Bind1().Apply0().Functor0(),n={map:t=>n=>e.map(e=>"Just"===e.tag?I("Just",t(e._1)):T)(n)};return{apply:(()=>{let e=tU(t);return n=>r=>e.bind(n)(n=>e.bind(r)(e=>tz(t).pure(n(e))))})(),Functor0:()=>n}},tz=t=>({pure:e=>t.Applicative0().pure(I("Just",e)),Apply0:()=>tD(t)}),tG=t=>{let e=t.Monad0(),n={Applicative0:()=>tz(e),Bind1:()=>tU(e)};return{state:n=>e.Bind1().bind(t.state(n))(t=>e.Applicative0().pure(I("Just",t))),Monad0:()=>n}},tQ=t=>{let e=t.Bind1(),n=e.Apply0().Functor0(),r=(()=>{let r={map:t=>e=>n.map(e=>"Just"===e.tag?I("Just",t(e._1)):T)(e)};return{alt:n=>r=>e.bind(n)(e=>"Nothing"===e.tag?r:t.Applicative0().pure(e)),Functor0:()=>r}})();return{empty:t.Applicative0().pure(T),Alt0:()=>r}},tj=t=>{let e=tz(t),n=tQ(t);return{Applicative0:()=>e,Plus1:()=>n}},tH=function(t,e,n,r){return n>=0&&n<r.length?t(r[n]):e},tW=function(t,e,n){var r=t>=0&&t<n.length;return r&&(n[t]=e),r},tZ=(a=function(t,e,n,r){return r.splice.apply(r,[t,e].concat(n))},function(t){return function(e){return function(n){return function(r){return function(){return a(t,e,n,r)}}}}}),tK=(u=function(t,e){return e.push(t)},function(t){return function(e){return function(){return u(t,e)}}}),t$=function(t){return function(e){for(var n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t(i)(e[i]);return r}},tV={mapWithIndex:t$,Functor0:()=>R},tY=function(t){return function(e){return t===e}},tX=function(t){return function(e){return function(n){if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!t(e[r])(n[r]))return!1;return!0}}},t1={eq:t=>t=>!0},t0={eq:tY},t2={eq:tY},t3=function(t){return function(e){return function(n){return function(r){return function(i){return r<i?t:r===i?e:n}}}}},t5={compare:t=>t=>"EQ",Eq0:()=>t1},t4={compare:t3("LT")("EQ")("GT"),Eq0:()=>t0},t6={compare:t3("LT")("EQ")("GT"),Eq0:()=>t2};Array.prototype.fill;var t7=function(){function t(t,e){this.head=t,this.tail=e}var e={};function n(e){return function(n){return new t(e,n)}}return function(t,r){return function(t){for(var n=[],r=0,i=t;i!==e;)n[r++]=i.head,i=i.tail;return n}(t(n)(e)(r))}}(),t8=function(t,e,n,r){for(var i=0,o=r.length;i<o;i++)if(n(r[i]))return t(i);return e},t9=function(t,e,n,r){if(n<0||n>=r.length)return e;var i=r.slice();return i.splice(n,1),t(i)},et=function(t,e,n,r,i){if(n<0||n>=i.length)return e;var o=i.slice();return o[n]=r,t(o)},ee=function(t,e){return e.filter(t)},en=function(t,e,n){var r;return n.length<2?n:(!function t(e,n,r,i,o,a){var u,l,d,s,c,f;for((u=o+(a-o>>1))-o>1&&t(e,n,i,r,o,u),a-u>1&&t(e,n,i,r,u,a),l=o,d=u,s=o;l<u&&d<a;)c=i[l],f=i[d],n(e(c)(f))>0?(r[s++]=f,++d):(r[s++]=c,++l);for(;l<u;)r[s++]=i[l++];for(;d<a;)r[s++]=i[d++]}(t,e,r=n.slice(0),n.slice(0),0,n.length),r)},er=function(t,e,n){for(var r=e.length<n.length?e.length:n.length,i=Array(r),o=0;o<r;o++)i[o]=t(e[o])(n[o]);return i},ei=function(t,e){for(var n=e.length,r=0;r<n;r++)if(!t(e[r]))return!1;return!0},eo=t=>e=>en(t,t=>"GT"===t?1:"EQ"===t?0:"LT"===t?-1:void m(),e),ea=t=>e=>eo(n=>r=>t.compare(e(n))(e(r))),eu=t=>e=>(()=>{let n=tK(e);return()=>{let e=[...t];return n(e)(),e}})()(),el=t=>e=>n=>t>=0&&t<n.length?et(M,T,t,e(n[t]),n):T,ed=t=>e=>{let n=eo(e=>n=>t(e._2)(n._2))(t$(td)(e));return 0<n.length?y(ts)(ea(t6)(tf)((()=>{let e=[n[0]];for(let r of n){let n=t((()=>{let t=e.length-1|0;if(t>=0&&t<e.length)return e[t]._2;m()})())(r._2);("LT"===n||"GT"===n||"EQ"!==n)&&e.push(r)}return e})())):[]},es=t=>e=>{let n=t8(M,T,t,e);return"Just"===n.tag?I("Just",e[n._1]):T},ec=t=>e=>ee(t,e),ef=t=>e=>n=>{let r=t8(M,T,n=>t.eq(n)(e),n);return"Nothing"===r.tag||"Just"!==r.tag&&void m()},e_=t=>e=>n=>{let r=t8(M,T,n=>t.eq(n)(e),n);return"Nothing"!==r.tag&&("Just"===r.tag||void m())},ep=t=>e=>n=>{if(0===n.length)return[];let r=t8(M,T,t(e),n);if("Nothing"===r.tag)return n;if("Just"===r.tag){let t=t9(M,T,r._1,n);if("Just"===t.tag)return t._1}m()},eg=t=>e=>N(e)(t),ev=t=>eg(e=>{let n=t(e);return"Nothing"===n.tag?[]:"Just"===n.tag?[n._1]:void m()}),em=(t,e,n,r,i,o,a)=>({tag:t,_1:e,_2:n,_3:r,_4:i,_5:o,_6:a}),eh=(t,e,n)=>({tag:"Split",_1:t,_2:e,_3:n}),eC=(t,e,n)=>({tag:"SplitLast",_1:t,_2:e,_3:n}),ey=t=>t,eb=em("Leaf"),eR=(t,e,n,r)=>{if("Leaf"===n.tag){if("Leaf"===r.tag)return em("Node",1,1,t,e,n,r);if("Node"===r.tag)return em("Node",1+r._1|0,1+r._2|0,t,e,n,r);m()}if("Node"===n.tag){if("Leaf"===r.tag)return em("Node",1+n._1|0,1+n._2|0,t,e,n,r);if("Node"===r.tag)return em("Node",n._1>r._1?1+n._1|0:1+r._1|0,(1+n._2|0)+r._2|0,t,e,n,r)}m()},eS=(t,e,n,r)=>{if("Leaf"===n.tag)return"Leaf"===r.tag?em("Node",1,1,t,e,eb,eb):"Node"===r.tag&&r._1>1?"Node"===r._5.tag&&("Leaf"===r._6.tag?r._5._1>0:"Node"===r._6.tag?r._5._1>r._6._1:void m())?eR(r._5._3,r._5._4,eR(t,e,n,r._5._5),eR(r._3,r._4,r._5._6,r._6)):eR(r._3,r._4,eR(t,e,n,r._5),r._6):eR(t,e,n,r);if("Node"===n.tag){if("Node"===r.tag)return r._1>(n._1+1|0)?"Node"===r._5.tag&&("Leaf"===r._6.tag?r._5._1>0:"Node"===r._6.tag?r._5._1>r._6._1:void m())?eR(r._5._3,r._5._4,eR(t,e,n,r._5._5),eR(r._3,r._4,r._5._6,r._6)):eR(r._3,r._4,eR(t,e,n,r._5),r._6):n._1>(r._1+1|0)?"Node"===n._6.tag&&("Leaf"===n._5.tag?0<=n._6._1:"Node"===n._5.tag?n._5._1<=n._6._1:void m())?eR(n._6._3,n._6._4,eR(n._3,n._4,n._5,n._6._5),eR(t,e,n._6._6,r)):eR(n._3,n._4,n._5,eR(t,e,n._6,r)):eR(t,e,n,r);return"Leaf"===r.tag&&n._1>1?"Node"===n._6.tag&&("Leaf"===n._5.tag?0<=n._6._1:"Node"===n._5.tag?n._5._1<=n._6._1:void m())?eR(n._6._3,n._6._4,eR(n._3,n._4,n._5,n._6._5),eR(t,e,n._6._6,r)):eR(n._3,n._4,n._5,eR(t,e,n._6,r)):eR(t,e,n,r)}m()},ew=(t,e,n)=>{if("Leaf"===n.tag)return eh(T,eb,eb);if("Node"===n.tag){let r=t(e)(n._3);if("LT"===r){let r=ew(t,e,n._5);return eh(r._1,r._2,eS(n._3,n._4,r._3,n._6))}if("GT"===r){let r=ew(t,e,n._6);return eh(r._1,eS(n._3,n._4,n._5,r._2),r._3)}if("EQ"===r)return eh(I("Just",n._4),n._5,n._6)}m()},eN=(t,e,n,r)=>{if("Leaf"===r.tag)return eC(t,e,n);if("Node"===r.tag){let i=eN(r._3,r._4,r._5,r._6);return eC(i._1,i._2,eS(t,e,n,i._3))}m()},eE=(t,e)=>{if("Leaf"===t.tag)return e;if("Node"===t.tag){let n=eN(t._3,t._4,t._5,t._6);return eS(n._1,n._2,n._3,e)}m()},ex=(t,e,n,r)=>{if("Leaf"===n.tag)return r;if("Leaf"===r.tag)return n;if("Node"===r.tag){let i=ew(t,r._3,n),o=ex(t,e,i._2,r._5),a=ex(t,e,i._3,r._6);if("Just"===i._1.tag)return eS(r._3,e(i._1._1)(r._4),o,a);if("Nothing"===i._1.tag)return eS(r._3,r._4,o,a)}m()},eJ=t=>e=>n=>{let r=i=>{if("Leaf"===i.tag)return em("Node",1,1,e,n,eb,eb);if("Node"===i.tag){let o=t.compare(e)(i._3);if("LT"===o)return eS(i._3,i._4,r(i._5),i._6);if("GT"===o)return eS(i._3,i._4,i._5,r(i._6));if("EQ"===o)return em("Node",i._1,i._2,e,n,i._5,i._6)}m()};return r},eA={map:t=>{let e=n=>"Leaf"===n.tag?eb:"Node"===n.tag?em("Node",n._1,n._2,n._3,t(n._4),e(n._5),e(n._6)):void m();return e}},eL={foldr:t=>e=>{let n=(e,r)=>"Leaf"===e.tag?r:"Node"===e.tag?n(e._5,t(e._4)(n(e._6,r))):void m();return t=>n(t,e)},foldl:t=>e=>{let n=(e,r)=>"Leaf"===r.tag?e:"Node"===r.tag?n(t(n(e,r._5))(r._4),r._6):void m();return t=>n(e,t)},foldMap:t=>{let e=t.mempty,n=t.Semigroup0();return t=>{let r=i=>"Leaf"===i.tag?e:"Node"===i.tag?n.append(r(i._5))(n.append(t(i._4))(r(i._6))):void m();return r}}},eB={traverse:t=>{let e=t.Apply0();return n=>{let r=i=>{if("Leaf"===i.tag)return t.pure(eb);if("Node"===i.tag){let t=i._1,o=i._3,a=i._2;return e.apply(e.apply(e.Functor0().map(e=>n=>r=>em("Node",t,a,o,n,e,r))(r(i._5)))(n(i._4)))(r(i._6))}m()};return r}},sequence:t=>eB.traverse(t)(ey),Functor0:()=>eA,Foldable1:()=>eL},ek=t=>e=>n=>r=>i=>o=>{let a=(()=>{if("Just"===r.tag){let e=r._1;return n=>"LT"===t.compare(n)(e)}if("Nothing"===r.tag)return t=>!1;m()})(),u=(()=>{if("Just"===i.tag){let e=i._1;return n=>"GT"===t.compare(n)(e)}if("Nothing"===i.tag)return t=>!1;m()})(),l=(()=>{if("Just"===r.tag){if("Just"===i.tag){let e=i._1,n=r._1;return r=>"GT"!==t.compare(n)(r)&&"GT"!==t.compare(r)(e)}if("Nothing"===i.tag){let e=r._1;return n=>"GT"!==t.compare(e)(n)}m()}if("Nothing"===r.tag){if("Just"===i.tag){let e=i._1;return n=>"GT"!==t.compare(n)(e)}if("Nothing"===i.tag)return t=>!0}m()})(),d=t=>"Leaf"===t.tag?n:"Node"===t.tag?e(e(a(t._3)?n:d(t._5))(l(t._3)?o(t._3)(t._4):n))(u(t._3)?n:d(t._6)):void m();return d},eI=t=>e=>ek(t)(e.Semigroup0().append)(e.mempty),eT=t=>e=>{let n=r=>{if("Leaf"===r.tag)return eb;if("Node"===r.tag){let i=t.compare(e)(r._3);if("LT"===i)return eS(r._3,r._4,n(r._5),r._6);if("GT"===i)return eS(r._3,r._4,r._5,n(r._6));if("EQ"===i)return eE(r._5,r._6)}m()};return n},eM=t=>{let e={alt:(()=>{let e=t.compare;return t=>n=>ex(e,h,t,n)})(),Functor0:()=>eA};return{empty:eb,Alt0:()=>e}},eO=(t,e,n)=>({tag:"OrdBox",_1:t,_2:e,_3:n}),eq=t=>e=>n=>eO(t,e,n),eP=(()=>{let t={eq:t=>e=>t._1===e._1&&t._2._1(t._2._3)(e._2._3)};return{compare:t=>e=>{let n=t4.compare(t._1)(e._1);return"LT"===n?"LT":"GT"===n?"GT":t._2._2(t._2._3)(e._2._3)},Eq0:()=>t}})(),eF=(t=>{let e=t.compare;return t=>n=>{let r=ew(e,t,n);return"Just"===r._1.tag?I("Just",tl(r._1._1,eE(r._2,r._3))):T}})(eP),eU=t=>e=>{let n=e,r=!0,i;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,i=T;continue}if("Node"===e.tag){let o=eP.compare(t)(e._3);if("LT"===o){n=e._5;continue}if("GT"===o){n=e._6;continue}if("EQ"===o){r=!1,i=I("Just",e._4);continue}}m()}return i},eD=()=>t=>e=>{let n=eI(eP)((()=>{let t=eM(e),n=t.Alt0(),r={append:t=>e=>n.alt(t)(e)};return{mempty:t.empty,Semigroup0:()=>r}})());return e=>r=>{let i=t.reflectSymbol(e);return n(T)(T)(t=>e=>i===t._1?em("Node",1,1,t._2._3,e,eb,eb):eb)(r)}},ez=()=>t=>e=>{let n=eq(e.Eq0().eq)(e.compare);return e=>r=>i=>eF(tl(t.reflectSymbol(e),n(r)))(i)},eG=()=>t=>e=>{let n=eq(e.Eq0().eq)(e.compare);return e=>r=>i=>eU(tl(t.reflectSymbol(e),n(r)))(i)},eQ=()=>t=>e=>{let n=eq(e.Eq0().eq)(e.compare);return e=>r=>i=>o=>eJ(eP)(tl(t.reflectSymbol(e),n(r)))(i)(o)},ej=function(t){return function(e){return e.join(t)}},eH="InputNumber",eW=t=>"InputButton"===t?"button":"InputCheckbox"===t?"checkbox":"InputColor"===t?"color":"InputDate"===t?"date":"InputDatetimeLocal"===t?"datetime-local":"InputEmail"===t?"email":"InputFile"===t?"file":"InputHidden"===t?"hidden":"InputImage"===t?"image":"InputMonth"===t?"month":"InputNumber"===t?"number":"InputPassword"===t?"password":"InputRadio"===t?"radio":"InputRange"===t?"range":"InputReset"===t?"reset":"InputSearch"===t?"search":"InputSubmit"===t?"submit":"InputTel"===t?"tel":"InputText"===t?"text":"InputTime"===t?"time":"InputUrl"===t?"url":"InputWeek"===t?"week":void m(),eZ=(t,e,n)=>({tag:t,_1:e,_2:n});function eK(t,e,n){return null==t?e:n(t)}var e$=t=>({bind:e=>n=>t.Bind1().bind(e)(e=>"Left"===e.tag?t.Applicative0().pure(F("Left",e._1)):"Right"===e.tag?n(e._1):void m()),Apply0:()=>eV(t)}),eV=t=>{let e=t.Bind1().Apply0().Functor0(),n={map:t=>e.map(e=>"Left"===e.tag?F("Left",e._1):"Right"===e.tag?F("Right",t(e._1)):void m())};return{apply:(()=>{let e=e$(t);return n=>r=>e.bind(n)(n=>e.bind(r)(e=>eY(t).pure(n(e))))})(),Functor0:()=>n}},eY=t=>({pure:e=>t.Applicative0().pure(F("Right",e)),Apply0:()=>eV(t)}),eX=t=>{let e={Applicative0:()=>eY(t),Bind1:()=>e$(t)};return{throwError:e=>t.Applicative0().pure(F("Left",e)),Monad0:()=>e}},e1=function(t){return t},e0=(function(t){return function(e){var n=RegExp("^[\\+\\-]?"+(e<11?"[0-"+(e-1).toString()+"]":11===e?"[0-9a]":"[0-9a-"+String.fromCharCode(86+e)+"]")+"+$","i");return function(r){if(!n.test(r))return t;var i=parseInt(r,e);return(0|i)===i?M(i):t}}})(T)(10),e2=function(t){return function(e){return(0|e)===e?M(e):t}}(T),e3=t=>e=>{var n;let r=(n=t.length,function(t){return{before:t.substring(0,n),after:t.substring(n)}})(e);return r.before===t?I("Just",r.after):T};function e5(t){return Object.prototype.toString.call(t).slice(8,-1)}var e4=(t,e,n)=>({tag:t,_1:e,_2:n}),e6=t=>e=>n=>e5(n)===e?eY(t).pure(n):eX(t).throwError(tu(e4("TypeMismatch",e,e5(n)),tg)),e7=t=>e6(t)("String"),e8={foldrWithIndex:t=>e=>{let n=te(e=>{let n=e._1,r=e._2;return e=>t(n)(r)(e)})(e),r=t$(td);return t=>n(r(t))},foldlWithIndex:t=>e=>{let n=tn(e=>n=>t(n._1)(e)(n._2))(e),r=t$(td);return t=>n(r(t))},foldMapWithIndex:t=>{let e=t.mempty;return n=>e8.foldrWithIndex(e=>r=>i=>t.Semigroup0().append(n(e)(r))(i))(e)},Foldable0:()=>ta},e9=(t,e,n,r)=>({tag:"Step",_1:t,_2:e,_3:n,_4:r}),nt=(t,e)=>{let n=t._2;return t._3(n,e)},ne=t=>{let e=t._2;return t._4(e)};function nn(t,e,n){for(var r={},i=0;i<t.length;i++){var o=t[i],a=e(o);r[a]=n(a,i,o)}return r}function nr(t,e,n,r,i,o){for(var a={},u=0;u<e.length;u++){var l=e[u],d=n(l);t.hasOwnProperty(d)?a[d]=r(d,u,t[d],l):a[d]=o(d,u,l)}for(var d in t)d in a||i(d,t[d]);return a}function ni(t,e,n){return null!=t?n.createElementNS(t,e):n.createElement(e)}function no(t,e,n){var r=n.childNodes.item(t)||null;r!==e&&n.insertBefore(e,r)}function na(t,e){e&&t.parentNode===e&&e.removeChild(t)}function nu(t){return t.parentNode}function nl(t,e,n,r){null!=t?r.setAttributeNS(t,e,n):r.setAttribute(e,n)}function nd(t,e,n){null!=t?n.removeAttributeNS(t,e):n.removeAttribute(e)}var ns=void 0;function nc(t){return function(){return function(e){return t(e)()}}}function nf(t){return function(e){return function(n){return function(r){return function(){return r.addEventListener(t,e,n)}}}}}var n_=(t,e)=>({tag:t,_1:e}),np=(t,e,n,r)=>({tag:t,_1:e,_2:n,_3:r}),ng=t=>e=>np("Property",t,e),nv=(t,e)=>e.hasAttribute(t)?nd(null,t,e):"string"==typeof e[t]?void(e[t]=""):"rowSpan"===t||"colSpan"===t?void(e[t]=1):void(e[t]=ns),nm=t=>"Attribute"===t.tag?"Just"===t._1.tag?"attr/"+t._1._1+":"+t._2:"attr/:"+t._2:"Property"===t.tag?"prop/"+t._1:"Handler"===t.tag?"handler/"+t._1:"Ref"===t.tag?"ref":void m(),nh=t=>e=>{let n=n=>{var r;let i="ref"in(r=n.props)?M(r.ref):T;if("Just"===i.tag&&"Ref"===i._1.tag){let n=i._1._1(n_("Removed",e));if("Just"===n.tag)return t(n._1)()}},r=n=>(r,i,o)=>{var a,u,l,d;if("Attribute"===o.tag){let t=o._2,n=o._3;return nl("Nothing"===o._1.tag?null:"Just"===o._1.tag?o._1._1:void m(),t,n,e),o}if("Property"===o.tag){let t=o._1,n=o._2;return e[t]=n,o}if("Handler"===o.tag){if(a=o._1,n.hasOwnProperty(a))return n[o._1]._2.value=o._2,o;let r={value:o._2},i=nc(e=>()=>{let n=(0,r.value)(e);if("Just"===n.tag)return t(n._1)()})();return u=o._1,l=tl(i,r),n[u]=l,d=o._1,e.addEventListener(d,i,!1),o}if("Ref"===o.tag){let n=o._1(n_("Created",e));return"Just"===n.tag&&t(n._1)(),o}m()},i=(t,o)=>{let a={},u=t.events,l=nr(t.props,o,nm,(t,n,r,i)=>{var o,l;if("Attribute"===r.tag){if("Attribute"===i.tag){if(r._3===i._3)return i;nl("Nothing"===i._1.tag?null:"Just"===i._1.tag?i._1._1:void m(),i._2,i._3,e)}return i}if("Property"===r.tag){if("Property"===i.tag){if(r._2===i._2||"value"===i._1&&e.value===i._2)return i;o=i._1,l=i._2,e[o]=l}return i}if("Handler"===r.tag&&"Handler"===i.tag){let t=i._2,e=i._1,n=u[e];n._2.value=t,a[e]=n}return i},(t,n)=>{if("Attribute"===n.tag){let t=n._2;return nd("Nothing"===n._1.tag?null:"Just"===n._1.tag?n._1._1:void m(),t,e)}if("Property"===n.tag)return nv(n._1,e);if("Handler"===n.tag){let t=n._1,r=u[t]._1;return void e.removeEventListener(t,r,!1)}"Ref"!==n.tag&&m()},r(a));return e9(void 0,{events:a,props:l},i,n)};return t=>{let e={},o=nn(t,nm,r(e));return e9(void 0,{events:e,props:o},i,n)}},nC=(t,e,n)=>({tag:"Graft",_1:t,_2:e,_3:n}),ny=(t,e,n,r,i)=>({tag:t,_1:e,_2:n,_3:r,_4:i}),nb=t=>{let e=n=>{if("Text"===n.tag)return ny("Text",n._1);if("Elem"===n.tag)return ny("Elem",n._1,n._2,t._1(n._3),y(e)(n._4));if("Keyed"===n.tag)return ny("Keyed",n._1,n._2,t._1(n._3),y(t=>tl(t._1,e(t._2)))(n._4));if("Widget"===n.tag)return ny("Widget",t._2(n._1));if("Grafted"===n.tag){let e=n._1;return ny("Grafted",nC(n=>t._1(e._1(n)),n=>t._2(e._2(n)),e._3))}m()};return e(t._3)},nR=(t,e,n)=>({tag:t,_1:e,_2:n}),nS=t=>t,nw=t=>e=>n=>r=>i=>o=>{let a,u=t,l=e,d=n,s=r,c=i,f=o,_=!0;for(;_;){let t=u,e=l,n=d,r=s,i=c,o=f;if("Pure"===i.tag){_=!1,a=tl(tp("Cons",{func:t.pure(i._1),count:o},e),n);continue}if("Lift"===i.tag){_=!1,a=tl(tp("Cons",{func:r(i._1),count:o},e),n);continue}if("Ap"===i.tag){u=t,l=e,d=tu(i._2,tp("Cons",n._1,n._2)),s=r,c=i._1,f=o+1|0;continue}m()}return a},nN=t=>e=>n=>r=>{let i=t,o=e,a=n,u=r,l=!0,d;for(;l;){let t=i,e=o,n=a,r=u;if("Nil"===e.tag){l=!1,d=F("Left",r);continue}if("Cons"===e.tag){let s=t.Apply0().apply(e._1.func)(r);if(1===e._1.count){if("Nil"===e._2.tag){l=!1,d=F("Left",s);continue}i=t,o=e._2,a=n,u=s;continue}if("Nil"===n.tag){l=!1,d=F("Left",s);continue}if("Cons"===n.tag){l=!1,d=F("Right",tl(tp("Cons",{func:s,count:e._1.count-1|0},e._2),tu(n._1,n._2)));continue}}m()}return d},nE={map:t=>e=>nR("Ap",nR("Pure",t),e)},nx=t=>e=>n=>(n=>{let r=n,i=!0,o;for(;i;){let n=r;if("Pure"===n._2._1.tag){let e=nN(t)(n._1)(n._2._2)(t.pure(n._2._1._1));if("Left"===e.tag){i=!1,o=e._1;continue}if("Right"===e.tag){r=e._1;continue}m()}if("Lift"===n._2._1.tag){let a=nN(t)(n._1)(n._2._2)(e(n._2._1._1));if("Left"===a.tag){i=!1,o=a._1;continue}if("Right"===a.tag){r=a._1;continue}m()}if("Ap"===n._2._1.tag){r=nw(t)(n._1)(tu(n._2._1._2,n._2._2))(e)(n._2._1._1)(1);continue}m()}return o})(tl(tg,tu(n,tg))),nJ={apply:t=>e=>nR("Ap",t,e),Functor0:()=>nE},nA={pure:t=>nR("Pure",t),Apply0:()=>nJ},nL=(t,e,n)=>({tag:"ChildQuery",_1:t,_2:e,_3:n}),nB=(t,e,n)=>({tag:t,_1:e,_2:n}),nk=t=>t,nI=t=>t,nT=t=>t,nM=t=>tL(tB("Bind",nB("Raise",t,void 0),t=>tL(tB("Return",t),tE)),tE),nO=()=>t=>e=>{let n=eD()(t)(e);return t=>r=>{let i=(t,n)=>"Leaf"===t.tag?n:"Node"===t.tag?i(t._5,(()=>{let r=i(t._6,n);return"Nothing"===t._4.tag?r:"Just"===t._4.tag?eJ(e)(t._3)(t._4._1)(r):void m()})()):void m();return tL(tB("Bind",nB("ChildQuery",nL(e=>{let r=eB.traverse(e);return o=>{let a=e.Apply0().Functor0().map(t=>i(t,eb)),u=r(o),l=n(t);return t=>a(u(l(t)))}},r,nk)),t=>tL(tB("Return",t),tE)),tE)}},nq=()=>t=>e=>{let n=eG()(t)(e);return t=>e=>r=>tL(tB("Bind",nB("ChildQuery",nL(r=>i=>{let o=r.pure(T),a=n(t)(e);return t=>{let e=a(t);return"Nothing"===e.tag?o:"Just"===e.tag?i(e._1):void m()}},r,nk)),t=>tL(tB("Return",t),tE)),tE)},nP={state:t=>tL(tB("Bind",nB("State",t),t=>tL(tB("Return",t),tE)),tE),Monad0:()=>tI},nF=t=>({liftEffect:e=>tL(tB("Bind",nB("Lift",t.liftEffect(e)),t=>tL(tB("Return",t),tE)),tE),Monad0:()=>tI}),nU=t=>tL(tB("Bind",nB("Kill",t,void 0),t=>tL(tB("Return",t),tE)),tE),nD=t=>ne(t.widget),nz=(t,e)=>{if("Grafted"===e.tag)return nz(t,nb(e._1));if("Widget"===e.tag){let n=e._1,r=nt(t.widget,n);return e9(r._1,{build:t.build,widget:r},nz,nD)}return nD(t),t.build(e)},nG=t=>{let e=t.node,n=nu(e);return na(e,n)},nQ=(t,e)=>{if("Grafted"===e.tag)return nQ(t,nb(e._1));if("Text"===e.tag){if(t.value===e._1)return e9(t.node,t,nQ,nG);let n=e._1;return t.node.textContent=n,e9(t.node,{build:t.build,node:t.node,value:n},nQ,nG)}return nG(t),t.build(e)},nj=t=>{let e=t.attrs,n=t.children,r=t.node,i=nu(r);return na(r,i),!function(t,e){for(var n=Object.keys(t),r=0;r<n.length;r++){var i=n[r];e(i,t[i])}}(n,(t,e)=>ne(e)),ne(e)},nH=t=>{let e=t.attrs,n=t.children,r=t.node,i=nu(r);na(r,i);for(var o=0;o<n.length;o++)ne(n[o]);return ne(e)},nW=(t,e,n,r)=>e===r&&("Just"===t.tag?"Just"===n.tag&&t._1===n._1:"Nothing"===t.tag&&"Nothing"===n.tag),nZ=(t,e)=>{if("Grafted"===e.tag)return nZ(t,nb(e._1));if("Elem"===e.tag&&nW(t.ns,t.name,e._1,e._2)){if(0===t.children.length&&0===e._4.length){let n=nt(t.attrs,e._3);return e9(t.node,{build:t.build,node:t.node,attrs:n,ns:e._1,name:e._2,children:t.children},nZ,nH)}let n=function(t,e,n,r,i){for(var o=[],a=t.length,u=e.length,l=0;;){if(l<a)l<u?o.push(n(l,t[l],e[l])):r(l,t[l]);else if(l<u)o.push(i(l,e[l]));else break;l++}return o}(t.children,e._4,(e,n,r)=>{let i=nt(n,r);return no(e,i._1,t.node),i},(t,e)=>ne(e),(e,n)=>{let r=t.build(n);return no(e,r._1,t.node),r}),r=nt(t.attrs,e._3);return e9(t.node,{build:t.build,node:t.node,attrs:r,ns:e._1,name:e._2,children:n},nZ,nH)}return nH(t),t.build(e)},nK=(t,e)=>{if("Grafted"===e.tag)return nK(t,nb(e._1));if("Keyed"===e.tag&&nW(t.ns,t.name,e._1,e._2)){let n=e._4.length;if(0===t.length&&0===n){let n=nt(t.attrs,e._3);return e9(t.node,{build:t.build,node:t.node,attrs:n,ns:e._1,name:e._2,children:t.children,length:0},nK,nj)}let r=nr(t.children,e._4,tf,(e,n,r,i)=>{let o=nt(r,i._2);return no(n,o._1,t.node),o},(t,e)=>ne(e),(e,n,r)=>{let i=r._2,o=t.build(i);return no(n,o._1,t.node),o}),i=nt(t.attrs,e._3);return e9(t.node,{build:t.build,node:t.node,attrs:i,ns:e._1,name:e._2,children:r,length:n},nK,nj)}return nj(t),t.build(e)},n$=(t,e,n)=>{let r=t.buildWidget(t)(n);return e9(r._1,{build:e,widget:r},nz,nD)},nV=(t,e,n)=>{let r=t.document.createTextNode(n);return e9(r,{build:e,node:r,value:n},nQ,nG)},nY=(t,e,n,r,i,o)=>{let a=ni("Nothing"===n.tag?null:"Just"===n.tag?n._1:void m(),r,t.document),u=nn(o,tf,(t,n,r)=>{let i=e(r._2);return no(n,i._1,a),i}),l=t.buildAttributes(a)(i);return e9(a,{build:e,node:a,attrs:l,ns:n,name:r,children:u,length:o.length},nK,nj)},nX=(t,e,n,r,i,o)=>{let a=ni("Nothing"===n.tag?null:"Just"===n.tag?n._1:void m(),r,t.document),u=function(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e(r,t[r]));return n}(o,(t,n)=>{let r=e(n);return no(t,r._1,a),r}),l=t.buildAttributes(a)(i);return e9(a,{build:e,node:a,attrs:l,ns:n,name:r,children:u},nZ,nH)},n1=t=>{let e=n=>{if("Text"===n.tag)return nV(t,e,n._1);if("Elem"===n.tag){let r=n._3,i=n._4,o=n._2;return nX(t,e,n._1,o,r,i)}if("Keyed"===n.tag){let r=n._3,i=n._4,o=n._2;return nY(t,e,n._1,o,r,i)}return"Widget"===n.tag?n$(t,e,n._1):"Grafted"===n.tag?e(nb(n._1)):void m()};return e},n0=(t,e)=>t._1===e._1&&t._2===e._2&&t._2(t._4,e._4),n2=t=>{let e=(n,r)=>{if(n0(n.thunk,r))return e9(n.vdom._1,n,e,t=>ne(t.vdom));let i=t(r._3(r._4)),o=nt(n.vdom,i);return e9(o._1,{vdom:o,thunk:r},e,t=>ne(t.vdom))};return n=>r=>{let i=t(r._3(r._4)),o=n1(n)(i);return e9(o._1,{thunk:r,vdom:o},e,t=>ne(t.vdom))}},n3=(t,e)=>({tag:t,_1:e}),n5=tr(tq)(to),n4=t=>e=>{if("Initialize"===e.tag){let n=n5(t.handleAction)(t.initialize);return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",t=>tL(tB("Return",e._1),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Return",e._1),tE),tS(tg,tg)),n._2._2._2))):void m())}if("Finalize"===e.tag){let n=n5(t.handleAction)(t.finalize);return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",t=>tL(tB("Return",e._1),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Return",e._1),tE),tS(tg,tg)),n._2._2._2))):void m())}if("Receive"===e.tag){let n=n5(t.handleAction)(t.receive(e._1));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",t=>tL(tB("Return",e._2),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Return",e._2),tE),tS(tg,tg)),n._2._2._2))):void m())}if("Action"===e.tag){let n=t.handleAction(e._1);return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",t=>tL(tB("Return",e._2),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Return",e._2),tE),tS(tg,tg)),n._2._2._2))):void m())}if("Query"===e.tag){let n=e._2(),r=t.handleQuery(e._1._2);return tL(r._1,"CatNil"===r._2.tag?tN("CatCons",t=>tL(tB("Return","Nothing"===t.tag?n:"Just"===t.tag?e._1._1(t._1):void m()),tE),tS(tg,tg)):"CatCons"===r._2.tag?tN("CatCons",r._2._1,tS(r._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Return","Nothing"===t.tag?n:"Just"===t.tag?e._1._1(t._1):void m()),tE),tS(tg,tg)),r._2._2._2))):void m())}m()},n6={handleAction:t=>tL(tB("Return",void 0),tE),handleQuery:t=>tL(tB("Return",T),tE),receive:t=>T,initialize:T,finalize:T},n7=()=>t=>e=>{let n=eG()(t)(e),r=ez()(t)(e),i=eQ()(t)(e);return t=>e=>o=>a=>u=>({get:n(t)(e),pop:r(t)(e),set:i(t)(e),component:o,input:a,output:u})},n8=ng("rel"),n9=(()=>{let t=ng("step");return e=>t("Any"===e.tag?"any":"Step"===e.tag?L(e._1):void m())})(),rt=ng("target"),re=ng("min"),rn=ng("max"),rr=ng("href"),ri=ng("draggable"),ro=(()=>{let t=ng("className"),e=ej(" "),n=y(tC);return r=>t(e(n(r)))})(),ra=ng("className"),ru=t=>e=>ny("Elem",T,"i",[ro(["fa-solid "+t,...e])],[]),rl=t=>e=>n=>ny("Elem",T,"button",[ro(["rounded w-full h-full py-1 px-2 transition-colors duration-75",e]),np("Handler","click",t=>I("Just",eZ("Action",n)))],[t]),rd=(t,e)=>({tag:t,_1:e}),rs=(t,e)=>({tag:"SetItems",_1:t,_2:e}),rc=(()=>{let t=tG(nP);return e=>t.state(t=>tl(void 0,e))})(),rf=tz(tI).pure,r_=(n={reflectSymbol:()=>"selected"},()=>()=>t=>e=>r=>J(n.reflectSymbol(t))(e)(r))()(),rp=t=>e=>rs(t,e),rg=rd("EnterEdit"),rv=rd("LeaveEdit"),rm=(t,e)=>({tag:t,_1:e}),rh={append:t=>t=>{}},rC={mempty:void 0,Semigroup0:()=>rh},ry=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,rb=[];for(let t=0;t<256;++t)rb.push((t+256).toString(16).slice(1));var rR=new Uint8Array(16),rS={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},rw=function(t,e,n){if(rS.randomUUID&&!e&&!t)return rS.randomUUID();let r=(t=t||{}).random??t.rng?.()??function(){if(!l){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");l=crypto.getRandomValues.bind(crypto)}return l(rR)}();if(r.length<16)throw Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){if((n=n||0)<0||n+16>e.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let t=0;t<16;++t)e[n+t]=r[t];return e}return function(t,e=0){return(rb[t[e+0]]+rb[t[e+1]]+rb[t[e+2]]+rb[t[e+3]]+"-"+rb[t[e+4]]+rb[t[e+5]]+"-"+rb[t[e+6]]+rb[t[e+7]]+"-"+rb[t[e+8]]+rb[t[e+9]]+"-"+rb[t[e+10]]+rb[t[e+11]]+rb[t[e+12]]+rb[t[e+13]]+rb[t[e+14]]+rb[t[e+15]]).toLowerCase()}(r)},rN={eq:t=>e=>t===e},rE={compare:t=>e=>t4.compare(t)(e),Eq0:()=>rN};function rx(t){return Error(t)}function rJ(t){return function(){throw t}}var rA=t=>t,rL=t=>e=>{let n=tr(e);return e=>{let r=n(e);return e=>{let n=r(n=>t.parallel(e(n)));return e=>t.sequential(n(e))}}},rB=function(t){throw Error(t)},rk=function(){var t={},e="Pure",n="Throw",r="Catch",i="Sync",o="Async",a="Bind",u="Bracket",l="Fork",d="Sequential",s="Apply",c="Cons",f="Resume",_="Release",p="Finalizer",g="Finalized",v="Forked";function m(t,e,n,r){this.tag=t,this._1=e,this._2=n,this._3=r}function h(t){var e=function(e,n,r){return new m(t,e,n,r)};return e.tag=t,e}function C(t){return new m(e,void 0)}var y=function(){var t=0,e=0,n=Array(1024),r=!1;function i(){var i;for(r=!0;0!==t;)t--,i=n[e],n[e]=void 0,e=(e+1)%1024,i();r=!1}return{isDraining:function(){return r},enqueue:function(o){var a;1024===t&&(a=r,i(),r=a),n[(e+t)%1024]=o,t++,r||i()}}}();return m.EMPTY=t,m.Pure=h(e),m.Throw=h(n),m.Catch=h(r),m.Sync=h(i),m.Async=h(o),m.Bind=h(a),m.Bracket=h(u),m.Fork=h(l),m.Seq=h(d),m.ParMap=h("Map"),m.ParApply=h(s),m.ParAlt=h("Alt"),m.Fiber=function h(b,R,S){var w=0,N=0,E=S,x=null,J=null,A=null,L=null,B=null,k=0,I=0,T=null,M=!0;function O(S){for(var I,q,P;;)switch(I=null,q=null,P=null,N){case 2:N=1;try{E=A(E),null===L?A=null:(A=L._1,L=L._2)}catch(t){N=5,x=b.left(t),E=null}break;case 3:b.isLeft(E)?(N=5,x=E,E=null):null===A?N=5:(N=2,E=b.fromRight(E));break;case 1:switch(E.tag){case a:A&&(L=new m(c,A,L)),A=E._2,N=1,E=E._1;break;case e:null===A?(N=5,E=b.right(E._1)):(N=2,E=E._1);break;case i:N=3,E=function(t,e,n){try{return e(n())}catch(e){return t(e)}}(b.left,b.right,E._1);break;case o:N=4,E=function(t,e,n){try{return e(n)()}catch(e){return n(t(e))(),C}}(b.left,E._1,function(t){return function(){w===S&&(w++,y.enqueue(function(){w===S+1&&(N=3,E=t,O(w))}))}});return;case n:N=5,x=b.left(E._1),E=null;break;case r:B=null===A?new m(c,E,B,J):new m(c,E,new m(c,new m(f,A,L),B,J),J),A=null,L=null,N=1,E=E._1;break;case u:k++,B=null===A?new m(c,E,B,J):new m(c,E,new m(c,new m(f,A,L),B,J),J),A=null,L=null,N=1,E=E._1;break;case l:N=3,I=h(b,R,E._2),R&&R.register(I),E._1&&I.run(),E=b.right(I);break;case d:N=1,E=function(e,n,r){return new m(o,function(i){return function(){return function(e,n,r,i){var a=0,u={},l=0,d={},f=Error("[ParAff] Early exit"),_=null,p=t;function g(n,r,i){var o,a,l=r,d=null,f=null,_=0,p={};e:for(;;)switch(o=null,l.tag){case v:if(l._3===t&&(o=u[l._1],p[_++]=o.kill(n,function(t){return function(){0==--_&&i(t)()}})),null===d)break e;l=d._2,null===f?d=null:(d=f._1,f=f._2);break;case"Map":l=l._2;break;case s:case"Alt":d&&(f=new m(c,d,f)),d=l,l=l._1}if(0===_)i(e.right(void 0))();else for(a=0,o=_;a<o;a++)p[a]=p[a]();return p}return!function(){var o,C,y=1,b=r,R=null,S=null;e:for(;;)switch(o=null,C=null,y){case 1:switch(b.tag){case"Map":R&&(S=new m(c,R,S)),R=new m("Map",b._1,t,t),b=b._2;break;case s:R&&(S=new m(c,R,S)),R=new m(s,t,b._2,t),b=b._1;break;case"Alt":R&&(S=new m(c,R,S)),R=new m("Alt",t,b._2,t),b=b._1;break;default:C=a++,y=5,o=b,b=new m(v,C,new m(c,R,S),t),(o=h(e,n,o)).onComplete({rethrow:!1,handler:function(n){return function(r){return function(){delete u[n._1],n._3=r,function n(r,o,a){var u,c,p,v,m,h;for(e.isLeft(r)?(u=r,c=null):(c=r,u=null);;){if(p=null,v=null,m=null,h=null,null!==_)return;if(null===o)return void i(u||c)();if(o._3!==t)return;switch(o.tag){case"Map":null===u?(o._3=e.right(o._1(e.fromRight(c))),c=o._3):o._3=u;break;case s:if(p=o._1._3,v=o._2._3,u){if(o._3=u,m=!0,d[h=l++]=g(f,u===p?o._2:o._1,function(){return function(){delete d[h],m?m=!1:null===a?n(u,null,null):n(u,a._1,a._2)}}),m){m=!1;return}}else{if(p===t||v===t)return;c=e.right(e.fromRight(p)(e.fromRight(v))),o._3=c}break;case"Alt":if(p=o._1._3,v=o._2._3,p===t&&e.isLeft(v)||v===t&&e.isLeft(p))return;if(p!==t&&e.isLeft(p)&&v!==t&&e.isLeft(v))u=c===p?v:p,c=null,o._3=u;else if(o._3=c,m=!0,d[h=l++]=g(f,c===p?o._2:o._1,function(){return function(){delete d[h],m?m=!1:null===a?n(c,null,null):n(c,a._1,a._2)}}),m){m=!1;return}}null===a?o=null:(o=a._1,a=a._2)}}(r,n._2._1,n._2._2)}}}(b)})(),u[C]=o,n&&n.register(o)}break;case 5:if(null===R)break e;R._1===t?(R._1=b,y=1,b=R._2,R._2=t):(R._2=b,b=R,null===S?R=null:(R=S._1,S=S._2))}for(C=0,p=b;C<a;C++)u[C].run()}(),function(t){return new m(o,function(n){return function(){for(var r in _=e.left(t),d)if(d.hasOwnProperty(r))for(r in i=d[r])i.hasOwnProperty(r)&&i[r]();d=null;var i,a=g(t,p,n);return function(t){return new m(o,function(t){return function(){for(var t in a)a.hasOwnProperty(t)&&a[t]();return C}})}}})}}(e,n,r,i)}})}(b,R,E._1)}break;case 5:if(A=null,L=null,null===B)N=6,E=J||x||E;else switch(I=B._3,P=B._1,B=B._2,P.tag){case r:J&&J!==I&&0===k?N=5:x&&(N=1,E=P._2(b.fromLeft(x)),x=null);break;case f:J&&J!==I&&0===k||x?N=5:(A=P._1,L=P._2,N=2,E=b.fromRight(E));break;case u:k--,null===x&&(q=b.fromRight(E),B=new m(c,new m(_,P._2,q),B,I),(J===I||k>0)&&(N=1,E=P._3(q)));break;case _:B=new m(c,new m(g,E,x),B,J),N=1,E=J&&J!==I&&0===k?P._1.killed(b.fromLeft(J))(P._2):x?P._1.failed(b.fromLeft(x))(P._2):P._1.completed(b.fromRight(E))(P._2),x=null,k++;break;case p:k++,B=new m(c,new m(g,E,x),B,J),N=1,E=P._1;break;case g:k--,N=5,E=P._1,x=P._2}break;case 6:for(var F in T)if(T.hasOwnProperty(F)){M=M&&T[F].rethrow;var U=T[F].handler(E);try{U()}catch(t){setTimeout(function(){throw t},0)}}T=null,J&&x?setTimeout(function(){throw b.fromLeft(x)},0):b.isLeft(E)&&M&&setTimeout(function(){if(M)throw b.fromLeft(E)},0);return;case 0:N=1;break;case 4:return}}function q(t){return function(){if(6===N)return M=M&&t.rethrow,t.handler(E)(),function(){};var e=I++;return(T=T||{})[e]=t,function(){null!==T&&delete T[e]}}}return{kill:function(t,e){return function(){if(6===N)return e(b.right(void 0))(),function(){};var n=q({rethrow:!1,handler:function(){return e(b.right(void 0))}})();switch(N){case 0:J=b.left(t),N=6,E=J,O(w);break;case 4:null===J&&(J=b.left(t)),0===k&&(4===N&&(B=new m(c,new m(p,E(t)),B,J)),N=5,E=null,x=null,O(++w));break;default:null===J&&(J=b.left(t)),0===k&&(N=5,E=null,x=null)}return n}},join:function(t){return function(){var e=q({rethrow:!1,handler:t})();return 0===N&&O(w),e}},onComplete:q,isSuspended:function(){return 0===N},run:function(){0===N&&(y.isDraining()?O(w):y.enqueue(function(){O(w)}))}}},m.Supervisor=function(t){var e={},n=0,r=0;return{register:function(t){var i=n++;t.onComplete({rethrow:!0,handler:function(t){return function(){r--,delete e[i]}}})(),e[i]=t,r++},isEmpty:function(){return 0===r},killAll:function(o,a){return function(){if(0===r)return a();var u=0,l={};for(var d in e)e.hasOwnProperty(d)&&(u++,function(n){l[n]=e[n].kill(o,function(e){return function(){delete l[n],u--,t.isLeft(e)&&t.fromLeft(e)&&setTimeout(function(){throw t.fromLeft(e)},0),0===u&&a()}})()}(d));return e={},n=0,r=0,function(t){return new m(i,function(){for(var t in l)l.hasOwnProperty(t)&&l[t]()})}}}}},m.Scheduler=y,m.nonCanceler=C,m}(),rI=rk.Pure,rT=rk.Throw;function rM(t){return function(e){return e.tag===rk.Pure.tag?rk.Pure(t(e._1)):rk.Bind(e,function(e){return rk.Pure(t(e))})}}function rO(t){return function(e){return rk.Bind(t,e)}}var rq=rk.Sync,rP=rk.Async,rF=rk.Seq,rU={map:function(t){return function(e){return rk.ParMap(t,e)}}},rD={map:rM},rz=function(t){return rk.Fork(!0,t)},rG={isLeft:t=>"Left"===t.tag||"Right"!==t.tag&&void m(),fromLeft:t=>"Left"===t.tag?t._1:"Right"===t.tag?rB("unsafeFromLeft: Right"):void m(),fromRight:t=>"Right"===t.tag?t._1:"Left"===t.tag?rB("unsafeFromRight: Left"):void m(),left:U,right:D},rQ={apply:function(t){return function(e){return rk.ParApply(t,e)}},Functor0:()=>rU},rj={Applicative0:()=>rZ,Bind1:()=>rH},rH={bind:rO,Apply0:()=>rW},rW={apply:t=>e=>rO(t)(t=>rO(e)(e=>rZ.pure(t(e)))),Functor0:()=>rD},rZ={pure:rI,Apply0:()=>rW},rK=t=>e=>{var n;return(n=rI(),function(t){return function(e){return rk.Bracket(n,t,e)}})({killed:e=>e=>t,failed:e=>e=>t,completed:e=>e=>t})(t=>e)},r$={parallel:tC,sequential:rF,Apply0:()=>rW,Apply1:()=>rQ},rV={pure:t=>rI(t),Apply0:()=>rQ},rY={liftEffect:rq,Monad0:()=>rj},rX=t=>rP(e=>{let n=t.join(e);return()=>{let t=rq(n());return e=>t}}),r1=t=>e=>rO(rq(e.isSuspended))(n=>n?rq((()=>{let n=e.kill(t,t=>()=>{});return()=>{n()}})()):rP(n=>{let r=e.kill(t,n);return()=>{let t=rq(r());return e=>t}})),r0={throwError:rT,Monad0:()=>rj},r2=(t=>{let e=t.MonadThrow0().Monad0();return n=>t.catchError(e.Bind1().Apply0().Functor0().map(D)(n))(t=>e.Applicative0().pure(F("Left",t)))})({catchError:function(t){return function(e){return rk.Catch(t,e)}},MonadThrow0:()=>r0}),r3=t=>e=>{var n;let r=(n=rO(r2(e))(e=>rq(t(e))),function(){return rk.Fiber(rG,null,n)});return()=>{let t=r();return t.run(),t}},r5=t=>e=>{let n=r3(t)(e);return()=>{n()}},r4=(()=>{let t=rI();return e=>t})(),r6=()=>t=>e=>{let n=n7()(t)(e);return t=>e=>r=>i=>ny("Widget",n3("ComponentSlot",n(t)(e)(r)(i)(t=>T)))},r7=()=>t=>e=>{let n=n7()(t)(e);return t=>e=>r=>i=>o=>ny("Widget",n3("ComponentSlot",n(t)(e)(r)(i)(t=>I("Just",o(t)))))};function r8(t){return function(){return t.preventDefault()}}function r9(t,e,n,r){if("undefined"!=typeof window){var i=window[n];if(null!=i&&r instanceof i)return e(r)}for(var o=r;null!=o;){var a=Object.getPrototypeOf(o),u=a.constructor.name;if(u===n)return e(r);if("Object"===u)break;o=a}return t}function it(t){return function(){t.select()}}var ie=(t=>{let e=eY(t).pure;return n=>r=>{var i;return i=eX(t).throwError(tu(e4("TypeMismatch","object",typeof r),tg)),null==r?i:e(r[n])}})(H),ir=t=>e=>n=>r=>np("Handler",t,t=>{let i=eK(t.currentTarget,T,M);if("Just"===i.tag){let t=e$(H).bind(ie(e)(i._1))(n);if("Left"===t.tag)return T;if("Right"===t.tag)return I("Just",eZ("Action",r(t._1)));m()}if("Nothing"===i.tag)return T;m()}),ii=t=>t,io=()=>t=>e=>{let n=nq()(t)(e);return t=>e=>r=>{let i=n(t)(e)(r());return tL(i._1,"CatNil"===i._2.tag?tN("CatCons",t=>tL(tB("Return",void 0),tE),tS(tg,tg)):"CatCons"===i._2.tag?tN("CatCons",i._2._1,tS(i._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Return",void 0),tE),tS(tg,tg)),i._2._2._2))):void m())}},ia=()=>t=>e=>{let n=nO()(t)(e);return t=>e=>n(t)(e(ii))},iu={traverseWithIndex:t=>{let e=iu.Traversable2().sequence(t);return t=>{let n=iu.FunctorWithIndex0().mapWithIndex(t);return t=>e(n(t))}},FunctorWithIndex0:()=>tV,FoldableWithIndex1:()=>e8,Traversable2:()=>tR},il=t=>t,id=t=>e=>ee(t,e),is={genericShowArgs:t=>[]},ic=t=>e=>({"genericShow'":n=>{let r=e.reflectSymbol(C),i=t.genericShowArgs(n);return 0===i.length?r:"("+function(t){return t.join(" ")}([r,...i])+")"}}),i_="AtLeast",ip="JustDraw",ig="Remains",iv="JustRemains",im="Choice",ih="LeftOne",iC="LeftAll",iy={show:(()=>{let t=ic(is)({reflectSymbol:()=>"AtLeast"}),e=ic(is)({reflectSymbol:()=>"JustDraw"}),n=(()=>{let n=(()=>{let t=ic(is)({reflectSymbol:()=>"Remains"}),n=(()=>{let e=ic(is)({reflectSymbol:()=>"JustRemains"}),n=(()=>{let t=ic(is)({reflectSymbol:()=>"Choice"}),n=(()=>{let e=ic(is)({reflectSymbol:()=>"LeftOne"}),n=(()=>{let t=ic(is)({reflectSymbol:()=>"LeftAll"});return{"genericShow'":n=>"Inl"===n.tag?e["genericShow'"](n._1):"Inr"===n.tag?t["genericShow'"](n._1):void m()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?n["genericShow'"](e._1):void m()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?n["genericShow'"](t._1):void m()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?n["genericShow'"](e._1):void m()}})();return{"genericShow'":t=>"Inl"===t.tag?e["genericShow'"](t._1):"Inr"===t.tag?n["genericShow'"](t._1):void m()}})();return{"genericShow'":e=>"Inl"===e.tag?t["genericShow'"](e._1):"Inr"===e.tag?n["genericShow'"](e._1):void m()}})();return t=>n["genericShow'"]("AtLeast"===t?B("Inl",k):"JustDraw"===t?B("Inr",B("Inl",k)):"Remains"===t?B("Inr",B("Inr",B("Inl",k))):"JustRemains"===t?B("Inr",B("Inr",B("Inr",B("Inl",k)))):"Choice"===t?B("Inr",B("Inr",B("Inr",B("Inr",B("Inl",k))))):"LeftOne"===t?B("Inr",B("Inr",B("Inr",B("Inr",B("Inr",B("Inl",k)))))):"LeftAll"===t?B("Inr",B("Inr",B("Inr",B("Inr",B("Inr",B("Inr",k)))))):void m())})()},ib=(()=>{let t=id(t=>!t.disabled),e=eo(t=>e=>t4.compare(t.id)(e.id)),n=y(t=>t.condition);return r=>{let i=n(e(t(r)));return i.length>0?I("Just",i):T}})(),iR=(()=>{let t=ec(t=>!t.disabled),e=eo(t=>e=>t4.compare(t.id)(e.id)),n=ev(t=>ib(t.conditions));return r=>n(e(t(r)))})(),iS=(t,e)=>({tag:t,_1:e}),iw=(t,e,n)=>({tag:t,_1:e,_2:n}),iN=ng("value"),iE={reflectSymbol:()=>"selector"},ix=r7()(iE)(t5),iJ={initialState:(()=>{let t=y(r_(C)(!1));return e=>({items:t(e),isEditMode:!1})})(),render:t=>{let e=t.isEditMode;return ny("Elem",T,"div",[ra("mx-1 flex")],[ei(t=>!t.selected,t.items)||e?ny("Elem",T,"div",[],[rl(ny("Elem",T,"i",[ra("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(rg)]):ny("Text",""),ny("Elem",T,"div",[ra(e?"fixed inset-0 bg-black opacity-20":"hidden"),np("Handler","click",t=>I("Just",eZ("Action",rv)))],[]),ny("Elem",T,"ul",[ra(e?"absolute flex min-w-48 flex-col gap-0.5 bg-white p-4 wrap-anywhere shadow-md":"flex w-full flex-wrap gap-1 wrap-anywhere"),np("Handler","click",t=>I("Just",eZ("Action",rg)))],y(t=>ny("Elem",T,"li",[ra(t.selected||e?"min-w-0":"hidden")],[ny("Elem",T,"button",[ro(["h-full w-full rounded border px-3 py-1 whitespace-pre-wrap transition-colors duration-75",t.selected?"border-sky-700 bg-sky-500 text-white hover:bg-sky-600":"border-gray-800 bg-gray-300 text-black hover:bg-gray-400"]),(()=>{let e=rd("Toggle",t.key);return np("Handler","click",t=>I("Just",eZ("Action",e)))})()],[ny("Text",t.value)])]))(t.items))])},eval:n4({...n6,handleAction:t=>{if("EnterEdit"===t.tag)return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,isEditMode:!0})),t=>tL(tB("Return",t),tE)),tE);if("LeaveEdit"===t.tag)return tL(tB("Bind",nB("State",t=>{let e={...t,isEditMode:!1};return tl(e,e)}),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>tL(tB("Bind",nB("Raise",y(t=>t.key)(ee(t=>t.selected,t.items)),void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)));if("Toggle"===t.tag){let e=t._1,n=tL(tB("Bind",nB("State",t=>tl(void 0,{...t,items:y(t=>rN.eq(t.key)(e)?{...t,selected:!t.selected}:t)(t.items)})),t=>tL(tB("Return",t),tE)),tE);return tL(tB("Bind",nB("State",t=>tl(t.isEditMode,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>t?n:tL(tB("Return",void 0),tE),tS(tg,tg)))}if("Receive"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>tl(void 0,(()=>{let n=t.items;return{...t,items:y(t=>{let e=t.key;return{key:e,value:t.value,selected:(()=>{let t=es(t=>rN.eq(t.key)(e))(n);return"Nothing"!==t.tag&&("Just"===t.tag?t._1.selected:void m())})()}})(e)}})())),t=>tL(tB("Return",t),tE)),tE)}m()},handleQuery:t=>{let e=t._2;return tU(tI).bind(rc({items:t._1,isEditMode:!1}))(()=>rf(e))},receive:t=>I("Just",rd("Receive",t))})},iA=(()=>{let t=ng("type");return e=>t(eW(e))})(),iL=(()=>{let t={append:t=>e=>t+e|0};return ta.foldMap({mempty:0,Semigroup0:()=>t})})(),iB=t=>e=>{let n=t6.compare(t)(e);return"LT"===n||"EQ"===n?t:"GT"===n?e:void m()},ik=(()=>{let t=tG(nP);return e=>t.state(t=>tl(e(t),t))})(),iI=e_({eq:t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name}),iT=io()(iE)(t5),iM=t=>e=>n=>{let r=t6.compare(t)(n),i="LT"===r?n:"EQ"===r||"GT"===r?t:void m(),o=t6.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void m()},iO=tL(tB("Bind",nB("State",t=>tl(t,t)),t=>tL(tB("Return",t),tE)),tE),iq=(()=>{let t=tF(rC).mempty;return e=>n=>"Nothing"===n.tag?t:"Just"===n.tag?e(n._1):void m()})(),iP=nF(rY).liftEffect,iF=t=>iw("GetCondition",t),iU=t=>e=>iw("UpdateState",t,e),iD={tag:"Updated"},iz=iS("Initialize"),iG=t=>iS("UpdateConditionMode",t),iQ=t=>iS("UpdateCardSelected",t),ij=t=>iS("UpdateCardCount",t),iH={initialState:t=>({cards:t,condition:{mode:i_,count:0,cards:[]},min:0,max:0}),render:t=>ny("Elem",T,"div",[ra("flex flex-wrap items-center justify-end")],[ny("Elem",T,"div",[ra("w-48 grow rounded border border-gray-200 p-0.5")],[ix(C)()(iJ)(y(t=>({key:t.id,value:t.name}))(t.cards))(iQ)]),ny("Elem",T,"div",[ra("flex items-center")],[ny("Elem",T,"div",[ra("mx-1")],[ny("Text","を")]),ny("Elem",T,"input",[ro(["w-12 appearance-none rounded border border-gray-400 bg-transparent p-1 text-right","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),iA(eH),n9(rm("Step",1)),iN(A(t.condition.count)),re(e1(t.min)),rn(e1(t.max)),np("Handler","focus",t=>I("Just",eZ("Action",iS("SelectOnFocus",t)))),ir("change")("value")(e7(H))(ij)],[]),ny("Elem",T,"select",[ro(["w-full appearance-none rounded border border-gray-400 bg-transparent px-3 py-1","transition ease-in-out hover:border-gray-500 focus:border-blue-600 focus:outline-none"]),iN(iy.show(t.condition.mode)),ir("change")("value")(e7(H))(iG)],[ny("Elem",T,"option",[iN(iy.show(i_))],[ny("Text","枚以上ドローする")]),ny("Elem",T,"option",[iN(iy.show(ip))],[ny("Text","枚ちょうどドローする")]),ny("Elem",T,"option",[iN(iy.show(ig))],[ny("Text","枚以上デッキに残す")]),ny("Elem",T,"option",[iN(iy.show(iv))],[ny("Text","枚ちょうどデッキに残す")]),ny("Elem",T,"option",[iN(iy.show(im))],[ny("Text","種類以上ドローする")]),ny("Elem",T,"option",[iN(iy.show(ih))],[ny("Text","種類以上デッキに残す")]),ny("Elem",T,"option",[iN(iy.show(iC))],[ny("Text","種類以上ドローしない")])])])]),eval:n4({...n6,handleAction:t=>{if("Initialize"===t.tag)return tL(iO._1,tN("CatCons",t=>{let e=t.condition.cards,n=ee(t=>e_(rN)(t.id)(e),t.cards),r=iL(t=>t.count);if("AtLeast"===t.condition.mode){let e=r(n),i={cards:t.cards,condition:{mode:t.condition.mode,count:iM(iB(1)(e))(e)(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:iB(1)(e),max:e};return tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tE)}if("JustDraw"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,count:iM(0)(r(n))(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:0,max:r(n)};return tL(tB("Bind",nB("State",t=>tl(void 0,e)),t=>tL(tB("Return",t),tE)),tE)}if("Remains"===t.condition.mode){let e=r(n),i={cards:t.cards,condition:{mode:t.condition.mode,count:iM(iB(1)(e))(e)(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:iB(1)(e),max:e};return tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tE)}if("JustRemains"===t.condition.mode){let e={cards:t.cards,condition:{mode:t.condition.mode,count:iM(0)(r(n))(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:0,max:r(n)};return tL(tB("Bind",nB("State",t=>tl(void 0,e)),t=>tL(tB("Return",t),tE)),tE)}if("Choice"===t.condition.mode||"LeftOne"===t.condition.mode||"LeftAll"===t.condition.mode){let e=n.length,r={cards:t.cards,condition:{mode:t.condition.mode,count:iM(iB(1)(e))(e)(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:iB(1)(e),max:e};return tL(tB("Bind",nB("State",t=>tl(void 0,r)),t=>tL(tB("Return",t),tE)),tE)}m()},tS(tg,tg)));if("UpdateCardSelected"===t.tag){let e=eo(rE.compare)(t._1);return tL(iO._1,tN("CatCons",t=>{let n=ee(t=>e_(rN)(t.id)(e),t.cards),r=iL(t=>t.count);if("AtLeast"===t.condition.mode){let i=r(n),o={cards:t.cards,condition:{mode:t.condition.mode,count:iM(iB(1)(i))(i)(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:iB(1)(i),max:i};return tX(rN.eq)(e)(t.condition.cards)?tL(tB("Return",void 0),tE):tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("JustDraw"===t.condition.mode){let i={cards:t.cards,condition:{mode:t.condition.mode,count:iM(0)(r(n))(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:0,max:r(n)};return tX(rN.eq)(e)(t.condition.cards)?tL(tB("Return",void 0),tE):tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("Remains"===t.condition.mode){let i=r(n),o={cards:t.cards,condition:{mode:t.condition.mode,count:iM(iB(1)(i))(i)(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:iB(1)(i),max:i};return tX(rN.eq)(e)(t.condition.cards)?tL(tB("Return",void 0),tE):tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("JustRemains"===t.condition.mode){let i={cards:t.cards,condition:{mode:t.condition.mode,count:iM(0)(r(n))(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:0,max:r(n)};return tX(rN.eq)(e)(t.condition.cards)?tL(tB("Return",void 0),tE):tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("Choice"===t.condition.mode||"LeftOne"===t.condition.mode||"LeftAll"===t.condition.mode){let r=n.length,i={cards:t.cards,condition:{mode:t.condition.mode,count:iM(iB(1)(r))(r)(t.condition.count),cards:eo(rE.compare)(y(t=>t.id)(n))},min:iB(1)(r),max:r};return tX(rN.eq)(e)(t.condition.cards)?tL(tB("Return",void 0),tE):tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}m()},tS(tg,tg)))}if("UpdateConditionMode"===t.tag)return iq(t=>tL(iO._1,tN("CatCons",e=>{let n=e.condition.cards,r=ee(t=>e_(rN)(t.id)(n),e.cards),i=iL(t=>t.count);if("AtLeast"===t){let n=i(r),o={cards:e.cards,condition:{mode:t,count:iM(iB(1)(n))(n)(e.condition.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("JustDraw"===t){let n={cards:e.cards,condition:{mode:t,count:iM(0)(i(r))(e.condition.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:0,max:i(r)};return tL(tB("Bind",nB("State",t=>tl(void 0,n)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("Remains"===t){let n=i(r),o={cards:e.cards,condition:{mode:t,count:iM(iB(1)(n))(n)(e.condition.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("JustRemains"===t){let n={cards:e.cards,condition:{mode:t,count:iM(0)(i(r))(e.condition.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:0,max:i(r)};return tL(tB("Bind",nB("State",t=>tl(void 0,n)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("Choice"===t||"LeftOne"===t||"LeftAll"===t){let n=r.length,i={cards:e.cards,condition:{mode:t,count:iM(iB(1)(n))(n)(e.condition.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}m()},tS(tg,tg))))("AtLeast"===t._1?I("Just",i_):"JustDraw"===t._1?I("Just",ip):"Remains"===t._1?I("Just",ig):"JustRemains"===t._1?I("Just",iv):"Choice"===t._1?I("Just",im):"LeftOne"===t._1?I("Just",ih):"LeftAll"===t._1?I("Just",iC):T);if("UpdateCardCount"===t.tag)return iq(t=>tL(iO._1,tN("CatCons",e=>{let n=e.condition.cards,r=ee(t=>e_(rN)(t.id)(n),e.cards),i=iL(t=>t.count);if("AtLeast"===e.condition.mode){let n=i(r),o={cards:e.cards,condition:{mode:e.condition.mode,count:iM(iB(1)(n))(n)(t),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("JustDraw"===e.condition.mode){let n={cards:e.cards,condition:{mode:e.condition.mode,count:iM(0)(i(r))(t),cards:eo(rE.compare)(y(t=>t.id)(r))},min:0,max:i(r)};return tL(tB("Bind",nB("State",t=>tl(void 0,n)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("Remains"===e.condition.mode){let n=i(r),o={cards:e.cards,condition:{mode:e.condition.mode,count:iM(iB(1)(n))(n)(t),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("JustRemains"===e.condition.mode){let n={cards:e.cards,condition:{mode:e.condition.mode,count:iM(0)(i(r))(t),cards:eo(rE.compare)(y(t=>t.id)(r))},min:0,max:i(r)};return tL(tB("Bind",nB("State",t=>tl(void 0,n)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("Choice"===e.condition.mode||"LeftOne"===e.condition.mode||"LeftAll"===e.condition.mode){let n=r.length,i={cards:e.cards,condition:{mode:e.condition.mode,count:iM(iB(1)(n))(n)(t),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",iD,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}m()},tS(tg,tg))))(e0(t._1));if("Receive"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>tl(t.condition,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>{let n=t.cards,r=ee(t=>e_(rN)(t.id)(n),e),i=iL(t=>t.count);if("AtLeast"===t.mode){let n=i(r),o={cards:e,condition:{mode:t.mode,count:iM(iB(1)(n))(n)(t.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tE)}if("JustDraw"===t.mode){let n={cards:e,condition:{mode:t.mode,count:iM(0)(i(r))(t.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:0,max:i(r)};return tL(tB("Bind",nB("State",t=>tl(void 0,n)),t=>tL(tB("Return",t),tE)),tE)}if("Remains"===t.mode){let n=i(r),o={cards:e,condition:{mode:t.mode,count:iM(iB(1)(n))(n)(t.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,o)),t=>tL(tB("Return",t),tE)),tE)}if("JustRemains"===t.mode){let n={cards:e,condition:{mode:t.mode,count:iM(0)(i(r))(t.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:0,max:i(r)};return tL(tB("Bind",nB("State",t=>tl(void 0,n)),t=>tL(tB("Return",t),tE)),tE)}if("Choice"===t.mode||"LeftOne"===t.mode||"LeftAll"===t.mode){let n=r.length,i={cards:e,condition:{mode:t.mode,count:iM(iB(1)(n))(n)(t.count),cards:eo(rE.compare)(y(t=>t.id)(r))},min:iB(1)(n),max:n};return tL(tB("Bind",nB("State",t=>tl(void 0,i)),t=>tL(tB("Return",t),tE)),tE)}m()},tS(tg,tg)))}if("SelectOnFocus"===t.tag)return iP((()=>{let e=eK(t._1.target,T,M),n="Just"===e.tag?r9(T,M,"HTMLInputElement",e._1):"Nothing"===e.tag?T:void m();return"Nothing"===n.tag?()=>{}:"Just"===n.tag?it(n._1):void m()})());m()},handleQuery:t=>{if("GetCondition"===t.tag){let e=ik(t=>t.condition);return tL(e._1,"CatNil"===e._2.tag?tN("CatCons",e=>tL(tB("Return","Just"===e.tag?I("Just",t._1(e._1)):T),tE),tS(tg,tg)):"CatCons"===e._2.tag?tN("CatCons",e._2._1,tS(e._2._2._1,tp("Cons",tN("CatCons",e=>tL(tB("Return","Just"===e.tag?I("Just",t._1(e._1)):T),tE),tS(tg,tg)),e._2._2._2))):void m())}if("UpdateState"===t.tag){let e=t._2,n=t._1,r=t._1.mode,i=t._1.cards;return tL(tB("Bind",nB("State",t=>tl(t.cards,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>{let o=ee(t=>e_(rN)(t.id)(i),t),a=iL(t=>t.count);if("AtLeast"===r){let r=a(o);return tL(tB("Bind",nB("State",e=>tl(void 0,{cards:t,condition:n,min:iB(1)(r),max:r})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let n=iT(C)()(rp(y(t=>({key:t.id,value:t.name,selected:iI(t)(o)}))(t)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)))}if("JustDraw"===r)return tL(tB("Bind",nB("State",e=>tl(void 0,{cards:t,condition:n,min:0,max:a(o)})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let n=iT(C)()(rp(y(t=>({key:t.id,value:t.name,selected:iI(t)(o)}))(t)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)));if("Remains"===r){let r=a(o);return tL(tB("Bind",nB("State",e=>tl(void 0,{cards:t,condition:n,min:iB(1)(r),max:r})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let n=iT(C)()(rp(y(t=>({key:t.id,value:t.name,selected:iI(t)(o)}))(t)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)))}if("JustRemains"===r)return tL(tB("Bind",nB("State",e=>tl(void 0,{cards:t,condition:n,min:0,max:a(o)})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let n=iT(C)()(rp(y(t=>({key:t.id,value:t.name,selected:iI(t)(o)}))(t)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)));if("Choice"===r||"LeftOne"===r||"LeftAll"===r){let r=o.length;return tL(tB("Bind",nB("State",e=>tl(void 0,{cards:t,condition:n,min:iB(1)(r),max:r})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let n=iT(C)()(rp(y(t=>({key:t.id,value:t.name,selected:iI(t)(o)}))(t)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)))}return tL(tB("Bind",nB("State",t=>{m()}),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let n=iT(C)()(rp(y(t=>({key:t.id,value:t.name,selected:iI(t)(o)}))(t)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)))},tS(tg,tp("Cons",tN("CatCons",t=>tL(tB("Return",I("Just",t)),tE),tS(tg,tg)),tg))))}m()},receive:t=>I("Just",iS("Receive",t)),initialize:I("Just",iz)})},iW=((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of f(e))p.call(t,n)||void 0===n||s(t,n,{get:()=>e[n],enumerable:!(r=c(e,n))||r.enumerable});return t})(s(null!=(r=g())?d(_(r)):{},"default",{value:r,enumerable:!0}),r);function iZ(t){return(0,iW.default)(t)}function iK(t){return t.toJSNumber()}function i$(t){return function(e){return t.add(e)}}var iV=function(t){return t.toString(10)},iY={add:i$,zero:iZ(0),mul:function(t){return function(e){return t.multiply(e)}},one:iZ(1)},iX=(function(t){return function(e){return function(n){try{var r=(0,iW.default)(n,e);return M(r)}catch(e){return t}}}})(T)(10);function i1(t){return function(){t.terminate()}}var i0=t=>e=>(function(e){return function(){return new Worker(t,e)}})({name:e.name,credentials:"Omit"===e.credentials?"omit":"SameOrigin"===e.credentials?"same-origin":"Include"===e.credentials?"include":void m(),type:"Classic"===e.type?"classic":"Module"===e.type?"module":void m()}),i2={name:"",credentials:"Omit",type:"Classic"},i3=t=>rP(e=>{let n=i0("bundle/worker.js")({...i2,type:"Module"});return()=>{var r,i;let o=n();(r=t=>e((()=>{let e=rx("BigInt.fromString"),n=iX(t.data);return"Nothing"===n.tag?F("Left",e):"Just"===n.tag?F("Right",n._1):void m()})()),function(t){return function(){t.onmessage=function(t){r(t)()}}})(o)(),(i=t=>{let n=i1(o);return()=>(n(),e(F("Left",rx((()=>{let e=r9(T,M,"ErrorEvent",t);return"Nothing"===e.tag?"Unknown worker error":"Just"===e.tag?e._1.message:void m()})())))())},function(t){return function(){t.onerror=function(t){i(t)()}}})(o)(),(function(e){return function(n){return function(){n.postMessage(t,e.length>0?e:void 0)}}})([])(o)();let a=rq(i1(o));return t=>a}});function i5(t){return function(e){return function(n){return t.apply(n,[e])}}}var i4=i5(Number.prototype.toPrecision),i6=i5(Number.prototype.toFixed),i7=i5(Number.prototype.toExponential),i8=(t,e)=>({tag:t,_1:e}),i9=t=>e=>n=>{let r=t6.compare(t)(n),i="LT"===r?n:"EQ"===r||"GT"===r?t:void m(),o=t6.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void m()},ot=t=>"Precision"===t.tag?i4(t._1):"Fixed"===t.tag?i6(t._1):"Exponential"===t.tag?i7(t._1):void m(),oe=function(t){var e=null;return function(){return void 0===t||(e=t(),t=void 0),e}},on=function(t){return t()},or=t=>{let e=t.Apply0(),n=e.Functor0(),r=(()=>{let t={map:t=>{let e=n.map(t);return t=>n=>e(t(n))}};return{apply:t=>n=>r=>e.apply(t(r))(n(r)),Functor0:()=>t}})();return{bind:e=>n=>r=>t.bind(e(r))(t=>n(t)(r)),Apply0:()=>r}},oi=t=>{let e=t.Applicative0(),n=e.Apply0(),r=(()=>{let t=n.Functor0(),r={map:e=>{let n=t.map(e);return t=>e=>n(t(e))}},i={apply:t=>e=>r=>n.apply(t(r))(e(r)),Functor0:()=>r};return{pure:t=>{let n=e.pure(t);return t=>n},Apply0:()=>i}})(),i=or(t.Bind1());return{Applicative0:()=>r,Bind1:()=>i}};String.fromCharCode(65535);var oo=(t,e,n)=>({tag:t,_1:e,_2:n}),oa=oo("Nil"),ou={map:t=>e=>oe(n=>{let r=on(e);return"Nil"===r.tag?oa:"Cons"===r.tag?oo("Cons",t(r._1),ou.map(t)(r._2)):void m()})},ol=t=>e=>{let n=v(()=>oe(r=>on((()=>{let r=ou.map(t)(n());return oe(t=>oo("Cons",e,r))})())));return n()},od=t=>{let e;return e=on(t),t=>{let n=e,r=t,i=!0,o;for(;i;){let t=n,e=r;if("Nil"===t.tag){i=!1,o=T;continue}if("Cons"===t.tag){if(0===e){i=!1,o=I("Just",t._1);continue}n=on(t._2),r=e-1|0;continue}m()}return o}},os=t=>e=>n=>()=>{let r=tH(M,T,t,n),i=tH(M,T,e,n);"Just"===r.tag&&"Just"===i.tag&&(tW(t,i._1,n),tW(e,r._1,n))},oc=t=>e=>n=>{let r=[...n];return os(t)(e)(r)(),r},of=t=>e=>n=>{if(t===e)return n;let r=[...n],i=tZ(t)(1)([])(r)();return tZ(e)(0)(i)(r)(),r},o_=(()=>{let t=ol(t=>er(i$,[iY.one,...t],t[0].isOdd()?[...t,t[t.length-1|0]]:t))([iZ(2)]);return e=>n=>{let r=e,i=n,o=!0,a;for(;o;){let e=r,n=i;if(e<0||e<n){o=!1,a=iY.zero;continue}if((e-n|0)<n){r=e,i=e-n|0;continue}if(0===n){o=!1,a=iY.one;continue}if(1===n){o=!1,a=iZ(e);continue}let u=od(t)(e-2|0),l=n-1|0;if("Just"===u.tag){if(l>=0&&l<u._1.length){o=!1,a=u._1[l];continue}o=!1,a=iY.zero;continue}if("Nothing"===u.tag){o=!1,a=iY.zero;continue}m()}return a}})(),op=(t=>{let e={append:e=>n=>t.add(e)(n)};return ta.foldMap({mempty:t.zero,Semigroup0:()=>e})})({add:function(t){return function(e){return t+e|0}},zero:0,mul:function(t){return function(e){return t*e|0}},one:1}),og=t=>e=>{let n=ed(rE.compare)(N(N(e)(il))(t=>t.cards));return{cards:eo(t=>e=>t4.compare(t.id)(e.id))(ee(t=>e_(rN)(t.id)(n),t.cards)),others:t.others+op(t=>t.count)(ee(t=>ef(rN)(t.id)(n),t.cards))|0,hand:t.hand}},ov=t=>o_(op(t=>t.count)(t.cards)+t.others|0)(t.hand),om=(t,e,n)=>({tag:"Calculate",_1:t,_2:e,_3:n}),oh=tU(tI),oC=tG(nP),oy=oC.state(t=>tl(t,t)),ob=(()=>{let t=tj(tI),e=t.Plus1().empty;return n=>n?t.Applicative0().pure():e})(),oR=(t=>{let e=nF(t.MonadEffect0());return{liftAff:e=>tL(tB("Bind",nB("Lift",t.liftAff(e)),t=>tL(tB("Return",t),tE)),tE),MonadEffect0:()=>e}})({liftAff:t=>t,MonadEffect0:()=>rY}).liftAff,oS=(i=r0,{throwError:t=>tL(tB("Bind",nB("Lift",i.throwError(t)),t=>tL(tB("Return",t),tE)),tE),Monad0:()=>tI}).throwError,ow=(()=>{let t=tF(rC).mempty;return e=>n=>"Nothing"===n.tag?t:"Just"===n.tag?e(n._1):void m()})(),oN=tz(tI).pure,oE=t=>e=>n=>om(t,e,n),ox={initialState:t=>({deck:{cards:[],others:0,hand:0},condition:[],combination:iY.zero,total:iY.zero,calculation:T}),render:t=>{var e;return ny("Elem",T,"div",[ra("flex min-w-60 items-center")],[ny("Elem",T,"div",[ra("mx-1 flex w-36 items-center justify-end gap-1")],"Just"===t.calculation.tag?[ny("Elem",T,"div",[ra("text-2xl")],[ny("Text","Calculating")]),ny("Elem",T,"i",[ra("fa-solid fa-spinner fa-pulse")],[])]:[ny("Elem",T,"div",[ra("text-2xl")],[ny("Text",(e=t.total,function(t){return e.equals(t)})(iY.zero)?"N/A":ot(i8("Fixed",i9(0)(20)(4)))(100*(iK(t.combination)/iK(t.total)))+"%")])]),ny("Elem",T,"div",[ra("mx-1 flex min-w-20 justify-end")],[ny("Elem",T,"div",[ra("flex flex-col divide-y divide-gray-400")],[ny("Elem",T,"div",[ra("px-1 text-right")],[ny("Text",iV(t.combination))]),ny("Elem",T,"div",[ra("px-1 text-right")],[ny("Text",iV(t.total))])])])])},eval:n4({...n6,handleQuery:t=>{let e=t._3,n=t._2,r=og(t._1)(n);return oh.bind(oy)(t=>oh.bind(ob(!(tX(t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name)(r.cards)(t.deck.cards)&&r.hand===t.deck.hand&&r.others===t.deck.others)||!tX(tX((()=>{let t=tX(rN.eq);return e=>n=>t(e.cards)(n.cards)&&e.count===n.count&&("AtLeast"===e.mode?"AtLeast"===n.mode:"JustDraw"===e.mode?"JustDraw"===n.mode:"Remains"===e.mode?"Remains"===n.mode:"JustRemains"===e.mode?"JustRemains"===n.mode:"Choice"===e.mode?"Choice"===n.mode:"LeftOne"===e.mode?"LeftOne"===n.mode:"LeftAll"===e.mode&&"LeftAll"===n.mode)})()))(n)(t.condition)))(()=>oh.bind(oC.state(t=>tl(void 0,{...t,deck:r,condition:n})))(()=>oh.bind((()=>{let t=oR(r2(i3({deck:r,condition:n})));return tL(tB("Bind",nB("Fork",(()=>{let e=t=>{if("Left"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,combination:iY.zero,total:iY.zero,calculation:T})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>oS(e),tS(tg,tg)))}if("Right"===t.tag){let e=t._1,n=ov(r);return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,combination:e,total:n,calculation:T})),t=>tL(tB("Return",t),tE)),tE)}m()};return tL(t._1,"CatNil"===t._2.tag?tN("CatCons",e,tS(tg,tg)):"CatCons"===t._2.tag?tN("CatCons",t._2._1,tS(t._2._2._1,tp("Cons",tN("CatCons",e,tS(tg,tg)),t._2._2._2))):void m())})(),nk),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>tL(tB("Return",I("Just",t)),tE),tS(tg,tg)))})())(t=>oh.bind(oC.state(t=>tl(t.calculation,t)))(n=>oh.bind(oC.state(e=>tl(void 0,{...e,calculation:I("Just",t)})))(()=>oh.bind((()=>{let t=ow(nU)(n);return tL(t._1,"CatNil"===t._2.tag?tN("CatCons",t=>tL(tB("Return",I("Just",t)),tE),tS(tg,tg)):"CatCons"===t._2.tag?tN("CatCons",t._2._1,tS(t._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Return",I("Just",t)),tE),tS(tg,tg)),t._2._2._2))):void m())})())(()=>oN(e))))))))}})},oJ=(t,e)=>({tag:t,_1:e}),oA=(t,e,n,r)=>({tag:t,_1:e,_2:n,_3:r}),oL={reflectSymbol:()=>"line"},oB=r7()(oL)(rE),ok={reflectSymbol:()=>"result"},oI=r6()(ok)(t5),oT=tR.traverse(P),oM=t=>e=>{let n=e,r=!0,i;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,i=T;continue}if("Node"===e.tag){let o=t4.compare(t)(e._3);if("LT"===o){n=e._5;continue}if("GT"===o){n=e._6;continue}if("EQ"===o){r=!1,i=I("Just",e._4);continue}}m()}return i},oO=tL(tB("Bind",nB("State",t=>tl(t,t)),t=>tL(tB("Return",t),tE)),tE),oq=ia()(oL)(rE),oP=ti(tq)(ta),oF=io()(oL)(rE),oU=io()(ok)(t5),oD=tU(tI).bind,oz=(()=>{let t=tG(nP);return e=>t.state(t=>tl(void 0,e(t)))})(),oG=tz(tI).pure,oQ=nF(rY).liftEffect(rw),oj=t=>oA("GetState",t),oH=t=>e=>n=>oA("UpdateState",t,e,n),oW=t=>oA("ToggleDisabled",t),oZ="Updated",oK=oJ("Initialize"),o$=oJ("AddCondition"),oV=oJ("ReceiveConditionUpdated"),oY={initialState:t=>({conditions:[],deck:t,disabled:!1}),render:t=>ny("Elem",T,"div",[ro(["grow rounded border-2 border-violet-300 p-1",t.disabled?"bg-slate-100 text-gray-400":"bg-white text-gray-700"])],[ny("Elem",T,"div",[ra("flex items-center justify-end gap-1")],[ny("Elem",T,"div",[ra(t.disabled?"mr-auto w-0 py-1 pl-3 text-xl":"hidden")],[ny("Text","Disabled")]),ny("Elem",T,"div",[ra(t.disabled?"text-gray-400":"text-black")],[oI(C)()(ox)()])]),ny("Elem",T,"ul",[ra("my-1")],y((()=>{let e=t.deck.cards;return t=>ny("Elem",T,"li",[ro(["flex gap-1 rounded px-1",t.disabled?"bg-slate-100 text-gray-400 line-through":"bg-transparent"])],[ny("Elem",T,"div",[ra("mx-1 flex")],[rl(ny("Elem",T,"i",[ra("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(oJ("RemoveCondition",t.id)),rl(ny("Elem",T,"i",[ra("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(oJ("ToggleItemDisabled",t.id))]),ny("Elem",T,"div",[ra("min-w-0 grow")],[oB(C)(t.id)(iH)(e)(t=>oV)])])})())(t.conditions)),ny("Elem",T,"div",[ra("px-1")],[rl(ny("Elem",T,"i",[ra("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(o$)])]),eval:n4({...n6,handleAction:t=>{if("Initialize"===t.tag)return tL(oQ._1,"CatNil"===oQ._2.tag?tN("CatCons",t=>tL(tB("Bind",nB("State",e=>tl(void 0,{...e,conditions:[{id:t,disabled:!1}]})),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)):"CatCons"===oQ._2.tag?tN("CatCons",oQ._2._1,tS(oQ._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Bind",nB("State",e=>tl(void 0,{...e,conditions:[{id:t,disabled:!1}]})),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)),oQ._2._2._2))):void m());if("AddCondition"===t.tag)return tL(tB("Bind",nB("State",t=>tl(t.conditions,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>{let e=e=>tL(tB("Bind",nB("State",n=>tl(void 0,{...n,conditions:eu(t)({id:e,disabled:!1})})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",oZ,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)));return tL(oQ._1,"CatNil"===oQ._2.tag?tN("CatCons",e,tS(tg,tg)):"CatCons"===oQ._2.tag?tN("CatCons",oQ._2._1,tS(oQ._2._2._1,tp("Cons",tN("CatCons",e,tS(tg,tg)),oQ._2._2._2))):void m())},tS(tg,tg)));if("RemoveCondition"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>{let n={...t,conditions:ee(t=>t.id!==e,t.conditions)};return tl(n,n)}),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>tL(tB("Bind",nB("Raise",0===t.conditions.length?"AllConditionDeleted":oZ,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("ToggleItemDisabled"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>tl(void 0,(()=>{let n=t8(M,T,t=>t.id===e,t.conditions);if("Just"===n.tag){let e=el(n._1)(t=>({...t,disabled:!t.disabled}))(t.conditions);if("Just"===e.tag)return{...t,conditions:e._1};if("Nothing"===e.tag)return t;m()}if("Nothing"===n.tag)return t;m()})())),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>tL(tB("Bind",nB("Raise",oZ,void 0),t=>tL(tB("Return",t),tE)),tE),tS(tg,tg)))}if("Receive"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,deck:e})),t=>tL(tB("Return",t),tE)),tE)}if("ReceiveConditionUpdated"===t.tag)return tL(tB("Bind",nB("Raise",oZ,void 0),t=>tL(tB("Return",t),tE)),tE);m()},handleQuery:t=>{if("GetState"===t.tag)return tO.apply(tL(oO._1,tN("CatCons",e=>tL(tB("Return",(()=>{let n=e.conditions,r=e.disabled;return e=>{let i=n.length>0?oT(t=>{let n=oM(t.id)(e);return"Just"===n.tag?I("Just",{id:t.id,condition:n._1,disabled:t.disabled}):T})(n):T;return"Just"===i.tag?I("Just",t._1({conditions:i._1,disabled:r})):T}})()),tE),tS(tg,tg))))(oq(C)(iF));if("UpdateState"===t.tag){let e=t._3,n=t._1,r=t._2;return tL(tB("Bind",nB("State",t=>{let e={...t,conditions:y(t=>({id:t.id,disabled:t.disabled}))(n),disabled:r};return tl(e,e)}),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>{let r=t.deck,i=oP(n)(t=>oF(C)(t.id)(iU(t.condition))),o=()=>{let t=oU(C)()(oE(r)(t7(to.foldr,ib(n))));return tL(t._1,"CatNil"===t._2.tag?tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)):"CatCons"===t._2.tag?tN("CatCons",t._2._1,tS(t._2._2._1,tp("Cons",tN("CatCons",()=>tL(tB("Return",e),tE),tS(tg,tg)),t._2._2._2))):void m())};return tL(i._1,"CatNil"===i._2.tag?tN("CatCons",o,tS(tg,tg)):"CatCons"===i._2.tag?tN("CatCons",i._2._1,tS(i._2._2._1,tp("Cons",tN("CatCons",o,tS(tg,tg)),i._2._2._2))):void m())},tS(tg,tp("Cons",tN("CatCons",t=>tL(tB("Return",I("Just",t)),tE),tS(tg,tg)),tg))))}if("ToggleDisabled"===t.tag){let e=t._1;return oD(oz(t=>({...t,disabled:!t.disabled})))(()=>oG(e))}m()},receive:t=>I("Just",oJ("Receive",t)),initialize:I("Just",oK)})};function oX(t){return t.dataTransfer}var o1=(t,e,n)=>({tag:t,_1:e,_2:n}),o0=(t,e)=>({tag:"SetDeck",_1:t,_2:e}),o2=(()=>{let t=ng("type");return e=>t(eW(e))})(),o3=ng("value"),o5=tU(tI).bind,o4=(()=>{let t=tG(nP);return e=>t.state(t=>tl(void 0,e))})(),o6=tz(tI).pure,o7=nF(rY),o8=o7.liftEffect(rw),o9=tL(tB("Bind",nB("State",t=>tl(t,t)),t=>tL(tB("Return",t),tE)),tE),at=tF(rC),ae=t=>e=>n=>{let r=t6.compare(t)(n),i="LT"===r?n:"EQ"===r||"GT"===r?t:void m(),o=t6.compare(e)(i);return"LT"===o||"EQ"===o?e:"GT"===o?i:void m()},an=t=>e=>{let n=t6.compare(t)(e);return"LT"===n||"EQ"===n?t:"GT"===n?e:void m()},ar=tX(tY),ai=t=>e=>o0(t,e),ao=o1("AddCard"),aa=t=>o1("UpdateTotal",t),au=t=>o1("UpdateHand",t),al=t=>o1("UpdateOthers",t),ad=t=>e=>o1("StartReorder",t,e),as=t=>e=>o1("ExecuteReorder",t,e),ac=(()=>{let t=ej(" ")(["appearance-none rounded-none border-b border-transparent bg-white p-1 text-gray-700","transition-colors duration-75 hover:border-gray-500 focus:border-slate-800 focus:outline-none"]),e=ej(" ")(["w-16 text-right",t]),n=(t,n,r,i,o)=>ny("Elem",T,"div",[ra("mx-1 flex flex-wrap justify-end border-b border-gray-500")],[ny("Elem",T,"div",[ra("m-1")],[ny("Text",t)]),ny("Elem",T,"input",[ra(e),o2(eH),o3(A(n)),n9(rm("Step",1)),re(e1(r)),rn(e1(i)),np("Handler","focus",t=>I("Just",eZ("Action",o1("SelectOnFocus",t)))),ir("change")("value")(e7(H))(t=>o((()=>{let e=e0(t);return"Nothing"===e.tag?0:"Just"===e.tag?e._1:void m()})()))],[])]),r={append:t=>e=>t+e|0},i=ta.foldMap({mempty:0,Semigroup0:()=>r})(t=>t.count),o=t=>{var e,n;if("AddCard"===t.tag)return tL(o8._1,"CatNil"===o8._2.tag?tN("CatCons",t=>tL(tB("Bind",nB("State",e=>{let n={...e,cards:eu(e.cards)({id:t,name:"",count:0})};return tl(n,n)}),t=>tL(tB("Return",t),tE)),tN("CatCons",nM,tS(tg,tg))),tS(tg,tg)):"CatCons"===o8._2.tag?tN("CatCons",o8._2._1,tS(o8._2._2._1,tp("Cons",tN("CatCons",t=>tL(tB("Bind",nB("State",e=>{let n={...e,cards:eu(e.cards)({id:t,name:"",count:0})};return tl(n,n)}),t=>tL(tB("Return",t),tE)),tN("CatCons",nM,tS(tg,tg))),tS(tg,tg)),o8._2._2._2))):void m());if("RemoveCard"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>{let n={...t,cards:ep(t=>e=>t.id===e.id)(e)(t.cards),others:t.others+e.count|0};return tl(n,n)}),t=>tL(tB("Return",t),tE)),tN("CatCons",nM,tS(tg,tg)))}if("UpdateCard"===t.tag){let e=t._1;return tL(o9._1,tN("CatCons",t=>{let n=t8(M,T,t=>t.id===e.id,t.cards);if("Just"===n.tag){if(n._1>=0&&n._1<t.cards.length){let r=t.cards[n._1],i={...e,count:""===e.name?0:ae(0)(r.count+t.others|0)(e.count)},o=et(M,T,n._1,i,t.cards);if("Just"===o.tag){let e=o._1;return tL(tB("Bind",nB("State",n=>{let o={...n,cards:e,others:t.others-(i.count-r.count|0)|0};return tl(o,o)}),t=>tL(tB("Return",t),tE)),tN("CatCons",nM,tS(tg,tg)))}if("Nothing"===o.tag)return at.mempty;m()}return at.mempty}if("Nothing"===n.tag)return at.mempty;m()},tS(tg,tg)))}if("UpdateTotal"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>tl(t.cards,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>o(o1("UpdateOthers",e-i(t)|0)),tS(tg,tg)))}if("UpdateHand"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>{let n={...t,hand:ae(1)(i(t.cards)+t.others|0)(e)};return tl(n,n)}),t=>tL(tB("Return",t),tE)),tN("CatCons",nM,tS(tg,tg)))}if("UpdateOthers"===t.tag){let e=t._1;return tL(tB("Bind",nB("State",t=>{let n=i(t.cards),r=ae(n)(255)(n+e|0),o={...t,others:r-n|0,hand:an(t.hand)(r)};return tl(o,o)}),t=>tL(tB("Return",t),tE)),tN("CatCons",nM,tS(tg,tg)))}if("SelectOnFocus"===t.tag)return o7.liftEffect((()=>{let e=eK(t._1.target,T,M),n="Just"===e.tag?r9(T,M,"HTMLInputElement",e._1):"Nothing"===e.tag?T:void m();return"Nothing"===n.tag?()=>{}:"Just"===n.tag?it(n._1):void m()})());if("StartReorder"===t.tag){let n=t._1,r=oX(t._2),i=o7.liftEffect((e="tcg-calculator/card",function(t){return function(n){return function(){return n.setData(e,t)}}})(n)(r)),o=()=>tL(tB("Bind",nB("GetRef",n,nk),t=>tL(tB("Return",t),tE)),tN("CatCons",t=>o7.liftEffect((()=>{if("Nothing"===t.tag)return()=>{};if("Just"===t.tag)return(function(t){return function(e){return function(n){return function(){return r.setDragImage(t,e,n)}}}})(t._1)(5)(15);m()})()),tS(tg,tg)));return tL(i._1,"CatNil"===i._2.tag?tN("CatCons",o,tS(tg,tg)):"CatCons"===i._2.tag?tN("CatCons",i._2._1,tS(i._2._2._1,tp("Cons",tN("CatCons",o,tS(tg,tg)),i._2._2._2))):void m())}if("HandleDragBehavior"===t.tag){let e=o7.liftEffect(r8(t._1));return ar(oX(t._1).types)(["tcg-calculator/card"])?e:tL(tB("Return",void 0),tE)}if("ExecuteReorder"===t.tag){let e=t._1,r=t._2,i=o7.liftEffect((n="tcg-calculator/card",function(t){return function(){return t.getData(n)}})(oX(r))),o=t=>{let n=""===t,i=o7.liftEffect(r8(r)),o=()=>tL(tB("Bind",nB("State",t=>tl(t.cards,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",n=>{if("string"==typeof t&&ry.test(t)&&t!==e){let r=t8(M,T,e=>e.id===t,n);if("Just"===r.tag){let t=t8(M,T,t=>t.id===e,n);if("Just"===t.tag){let e=of(r._1)(t._1)(n);return tL(tB("Bind",nB("State",t=>{let n={...t,cards:e};return tl(n,n)}),t=>tL(tB("Return",t),tE)),tN("CatCons",nM,tS(tg,tg)))}if("Nothing"===t.tag)return at.mempty;m()}if("Nothing"===r.tag)return at.mempty;m()}return at.mempty},tS(tg,tg))),a=tL(i._1,"CatNil"===i._2.tag?tN("CatCons",o,tS(tg,tg)):"CatCons"===i._2.tag?tN("CatCons",i._2._1,tS(i._2._2._1,tp("Cons",tN("CatCons",o,tS(tg,tg)),i._2._2._2))):void m());return n?n?tL(tB("Return",void 0),tE):void m():a};return tL(i._1,"CatNil"===i._2.tag?tN("CatCons",o,tS(tg,tg)):"CatCons"===i._2.tag?tN("CatCons",i._2._1,tS(i._2._2._1,tp("Cons",tN("CatCons",o,tS(tg,tg)),i._2._2._2))):void m())}m()};return{initialState:t=>({cards:[],others:40,hand:5}),render:r=>{let o=r.others,a=i(r.cards);return ny("Elem",T,"div",[ra("rounded border-2 border-amber-500 p-1")],[(()=>{let t=a+o|0;return ny("Elem",T,"div",[ra("flex gap-1")],[ny("Elem",T,"div",[ra("mx-1 flex grow flex-wrap text-sky-900")],[ru("fa-layer-group")(["m-1 text-2xl"]),ny("Elem",T,"div",[ra("m-1")],[ny("Text","デッキ情報")])]),n("手札枚数:",r.hand,1,t,au),n("デッキ枚数:",t,a,255,aa)])})(),ny("Keyed",T,"ul",[ra("m-1"),np("Handler","dragenter",t=>I("Just",eZ("Action",o1("HandleDragBehavior",t)))),np("Handler","dragover",t=>I("Just",eZ("Action",o1("HandleDragBehavior",t))))],y(n=>{let r=n.id;return tl(r,ny("Elem",T,"li",[ra("flex"),np("Ref",t=>I("Just",eZ("RefUpdate",r,"Created"===t.tag?I("Just",t._1):"Removed"===t.tag?T:void m()))),(()=>{let t=as(n.id);return np("Handler","drop",e=>I("Just",eZ("Action",t(e))))})()],[ny("Elem",T,"div",[ra("mx-1 flex items-center")],[ny("Elem",T,"div",[ra("hidden cursor-grab px-1 text-gray-500 active:cursor-grabbing md:block"),ri(!0),(()=>{let t=ad(n.id);return np("Handler","dragstart",e=>I("Just",eZ("Action",t(e))))})()],[ny("Elem",T,"i",[ra("fa-solid fa-grip-vertical")],[])]),rl(ny("Elem",T,"i",[ra("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(o1("RemoveCard",n))]),ny("Elem",T,"div",[ra("flex grow border-b border-gray-500")],[ny("Elem",T,"input",[ro(["grow",t]),o2("InputText"),o3(n.name),ir("change")("value")(e7(H))(t=>o1("UpdateCard",{...n,name:t}))],[]),ny("Elem",T,"input",[ra(e),o2(eH),n9(rm("Step",1)),o3(A(n.count)),re(0),rn(""===n.name?0:e1(n.count+o|0)),np("Handler","focus",t=>I("Just",eZ("Action",o1("SelectOnFocus",t)))),ir("change")("value")(e7(H))(t=>o1("UpdateCard",(()=>{let e=e0(t);return{...n,count:"Nothing"===e.tag?0:"Just"===e.tag?e._1:void m()}})()))],[])])]))})(r.cards)),ny("Elem",T,"div",[ra("flex gap-1")],[ny("Elem",T,"div",[ra("mx-1 grow")],[rl(ny("Elem",T,"i",[ra("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(ao)]),n("その他のカード:",o,0,255-a|0,al)])])},eval:n4({...n6,handleAction:o,handleQuery:t=>{let e=t._2;return o5(o4(t._1))(()=>o6(e))}})}})(),af=Object.prototype.toString,a_=Object.prototype.hasOwnProperty,ap=(t,e,n)=>{try{return e(JSON.parse(n))}catch(e){return t(e.message)}},ag=(t,e)=>isNaN(e)||!isFinite(e)?t:e,av=(t,e,n,r,i,o,a)=>{if(null==a)return t(null);let u=typeof a;return"boolean"===u?e(a):"number"===u?n(a):"string"===u?r(a):"[object Array]"===af.call(a)?i(a):o(a)},am=t=>t,ah=t=>t,aC=(t,e,n)=>{let r={};for(var i=0;i<n.length;i++)r[t(n[i])]=e(n[i]);return r},ay=(t,e,n,r)=>a_.call(r,n)?e(r[n]):t,ab=t=>t,aR=t=>JSON.stringify(t),aS=t=>T,aw=(t,e,n)=>({tag:t,_1:e,_2:n}),aN=aw("Tip"),aE=t=>e=>aw("AtKey",t,e),ax=t=>e=>aw("AtIndex",t,e),aJ={eq:t=>e=>"Tip"===t.tag?"Tip"===e.tag:"AtKey"===t.tag?"AtKey"===e.tag&&t._1===e._1&&aJ.eq(t._2)(e._2):"AtIndex"===t.tag&&"AtIndex"===e.tag&&t._1===e._1&&aJ.eq(t._2)(e._2)},aA=t=>e=>{let n=t,r=e,i=!0,o;for(;i;){let t=n,e=r;if("AtKey"===e.tag){if("AtKey"===t.tag){if(t._1===e._1){n=t._2,r=e._2;continue}i=!1,o=T;continue}if("Tip"===t.tag){i=!1,o=I("Just",e);continue}i=!1,o=T;continue}if("AtIndex"===e.tag&&"AtIndex"===t.tag){if(t._1===e._1){n=t._2,r=e._2;continue}i=!1,o=T;continue}if("Tip"===t.tag){i=!1,o=I("Just",e);continue}i=!1,o=T}return o},aL=t=>{let e=t=>"Tip"===t.tag?"":"AtKey"===t.tag?"."+t._1+e(t._2):"AtIndex"===t.tag?"["+A(t._1)+"]"+e(t._2):void m();return"$"+e(t)},aB=t=>e=>({...e,path:t(e.path),causes:y(aB(t))(e.causes)}),ak=t=>{let e=y(e=>{var n;return(n=1===t.causes.length?"\n  ":"\n    ",function(t){return t.replace(RegExp("\n".replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)})(ak(aB(e=>{let n=aA(t.path)(e);return"Nothing"===n.tag?e:"Just"===n.tag?n._1:void m()})(e)))})(t.causes),n=t.causes.length;return(aJ.eq(t.path)(aN)?""+t.message:aL(t.path)+": "+t.message)+(0===n?"":1===n?":\n  "+ej("\n  ")(e):":\n  - "+ej("\n  - ")(e))};function aI(t){return function(e){return t===e}}var aT=tr($)(ta),aM=t=>t,aO=()=>{let t=[];return{emitter:e=>()=>(t=[...t,e],()=>{let n=t;t=ep(aI)(e)(n)}),listener:e=>{let n=aT(t=>t(e));return()=>n(t)()}}};"undefined"!=typeof Symbol&&null!=Symbol&&void 0!==Symbol.iterator&&String.prototype[Symbol.iterator],String.prototype.fromCodePoint,String.prototype.codePointAt;var aq=function(t){return function(e){return function(){return e[t]}}};aq("URL"),aq("documentURI"),aq("origin"),aq("compatMode"),aq("characterSet"),aq("contentType"),aq("documentElement");var aP=function(t){return function(e){return function(){return e[t]}}};aP("baseURI"),aP("ownerDocument");var aF=aP("parentNode");aP("parentElement"),aP("childNodes"),aP("firstChild"),aP("lastChild"),aP("previousSibling");var aU=aP("nextSibling");function aD(t){return function(e){return function(){e.appendChild(t)}}}aP("nodeValue"),aP("textContent");var az=function(){return window};function aG(t){return function(e){return function(n){return function(r){return function(){return r.pushState(t,e,n)}}}}}function aQ(t){return function(e){return function(n){return function(r){return function(){return r.replaceState(t,e,n)}}}}}function aj(t){return function(){return t.document}}function aH(t){return function(){return t.history}}var aW=tr($),aZ=aW({foldr:t=>e=>n=>"Left"===n.tag?e:"Right"===n.tag?t(n._1)(e):void m(),foldl:t=>e=>n=>"Left"===n.tag?e:"Right"===n.tag?t(e)(n._1):void m(),foldMap:t=>{let e=t.mempty;return t=>n=>"Left"===n.tag?e:"Right"===n.tag?t(n._1):void m()}}),aK=aW(eL),a$=t=>()=>{var e;let n=aj(az())(),r=F("Right",0),i=(function(t){return function(){return t.createTextNode("")}})(n)(),o=(e=e=>e=>()=>{let e=r;return r="Left"===e.tag?F("Right",1+e._1|0):"Right"===e.tag?F("Right",e._1):void m(),t()},function(){return new MutationObserver(function(t,n){return e(t)(n)()})})();(function(t){return function(e){return function(){return e.observe(i,t)}}})({characterData:!0})(o)();let a=aZ(t=>{let e=F("Left",t+1|0);return()=>{var n;return r=e,(n=A(t),function(t){return function(){t.nodeValue=n}})(i)()}});return()=>a(r)()},aV=()=>{let t=0,e=eb,n=t=>{let n=aK(e=>e(t));return()=>n(e)()},r=()=>{var t,e;let n=(t=az(),function(){return t.location})(),r=(e=aH(az())(),function(){return e.state})(),i=function(){return n.pathname}(),o=function(){return n.search}(),a=function(){return n.hash}();return{state:r,pathname:i,search:o,hash:a,path:i+o+a}},i=a$(()=>n(r())())(),o=t=>e=>n=>{let r=t(e)("")(n);return()=>(r(aH(az())())(),i())},a=nc(t=>()=>n(r())())(),u=az();return nf("popstate")(a)(!1)(u)(),{pushState:o(aG),replaceState:o(aQ),locationState:r,listen:n=>()=>{let r=t;t=r+1|0;let i=e;e=eJ(t6)(r)(n)(i);let o=eT(t6)(r);return()=>{e=o(e)}}}},aY=(t,e)=>({tag:"Codec",_1:t,_2:e}),aX=eY(H),a1=e$(H),a0=iu.traverseWithIndex(aX),a2=aY((()=>{let t=aX.pure({});return e=>t})(),(t=>{let e=t_(t.Semigroup0());return{pure:td(t.mempty),Apply0:()=>e}})({mempty:tg,Semigroup0:()=>th}).pure),a3=aY(t=>{let e=av(aS,aS,aS,M,aS,aS,t);return"Just"===e.tag?F("Right",e._1):"Nothing"===e.tag?F("Left",{path:aN,message:"Expected value of type String",causes:[]}):void m()},t=>tl(ab(t),t)),a5=aY(t=>{let e=av(aS,aS,aS,aS,aS,M,t);return"Just"===e.tag?F("Right",e._1):"Nothing"===e.tag?F("Left",{path:aN,message:"Expected value of type Object",causes:[]}):void m()},t=>tl(ab(t),t)),a4=aY(t=>{let e=av(aS,aS,aS,aS,M,aS,t);return"Just"===e.tag?F("Right",e._1):"Nothing"===e.tag?F("Left",{path:aN,message:"Expected value of type Array",causes:[]}):void m()},t=>tl(ab(t),t)),a6=aY(t=>{let e=av(aS,aS,M,aS,aS,aS,t),n="Just"===e.tag?e2(e._1):"Nothing"===e.tag?T:void m();return"Just"===n.tag?F("Right",n._1):"Nothing"===n.tag?F("Left",{path:aN,message:"Expected value of type Int",causes:[]}):void m()},t=>tl(ag(0,e1(t)),t)),a7=t=>aY(e=>a1.bind(a5._1(e))(t._1),e=>tl(a5._2(aC(tf,ts,t7(tm.foldr,t._2(e)._1)))._1,e)),a8=t=>()=>e=>n=>{let r=t.reflectSymbol(C);return aY(t=>a1.bind(n._1(t))(n=>a1.bind((()=>{let n=ay(T,M,r,t);if("Just"===n.tag){let t=e._1(n._1);return"Left"===t.tag?F("Left",aB(aE(r))(t._1)):t}if("Nothing"===n.tag)return F("Left",{path:aw("AtKey",r,aN),message:"No value found",causes:[]});m()})())(t=>aX.pure(J(r)(t)(n)))),t=>tl(tp("Cons",tl(r,e._2(x(r)(t))._1),n._2(t)._1),t))},a9=aY(t=>{let e=av(aS,M,aS,aS,aS,aS,t);return"Just"===e.tag?F("Right",e._1):"Nothing"===e.tag?F("Left",{path:aN,message:"Expected value of type Boolean",causes:[]}):void m()},t=>tl(ab(t),t)),ut=t=>aY(e=>a1.bind(a4._1(e))(e=>a0(e=>n=>{let r=t._1(n);return"Left"===r.tag?F("Left",aB(ax(e))(r._1)):r})(am(e))),e=>tl(ab(ah(y(e=>t._2(e)._1)(e))),e)),ue={rowListCodec:t=>a2},un=t=>()=>()=>e=>({rowListCodec:n=>a8(e)()(x(e.reflectSymbol(C))(n))(t.rowListCodec(n))}),ur={reflectSymbol:()=>"disabled"},ui={reflectSymbol:()=>"count"},uo={reflectSymbol:()=>"cards"},ua=tR.traverse(P),uu=e$(W),ul=or(uu).bind,ud=eY(W).pure,us=(t=>{let e=t.Monad0(),n={Applicative0:()=>eY(e),Bind1:()=>e$(e)};return{liftEffect:n=>e.Bind1().bind(t.liftEffect(n))(t=>e.Applicative0().pure(F("Right",t))),Monad0:()=>n}})({liftEffect:t=>t,Monad0:()=>W}),uc=(t=>{let e=oi(t.Monad0());return{liftEffect:e=>{let n=t.liftEffect(e);return t=>n},Monad0:()=>e}})(us).liftEffect(rw),uf=eY(W),u_=(()=>{let t=uf.Apply0(),e=t.Functor0(),n={map:t=>{let n=e.map(t);return t=>e=>n(t(e))}},r={apply:e=>n=>r=>t.apply(e(r))(n(r)),Functor0:()=>n};return{pure:t=>{let e=uf.pure(t);return t=>e},Apply0:()=>r}})(),up=(()=>{let t=eV(W);return e=>n=>r=>t.apply(e(r))(n(r))})(),ug=us.liftEffect(rw),uv=tR.traverse(uf),um=(o=iy.show,t=>aY(e=>{let n=a3._1(e);return(()=>{if("Left"===n.tag){let t=n._1;return e=>F("Left",t)}if("Right"===n.tag){let t=n._1;return e=>e(t)}m()})()(e=>{let n=t(e);return"Nothing"===n.tag?F("Left",{path:aN,message:"Unexpected value '"+e+"' found",causes:[]}):"Just"===n.tag?F("Right",n._1):void m()})},t=>tl(a3._2(o(t))._1,t)))(t=>"AtLeast"===t?I("Just",i_):"JustDraw"===t?I("Just",ip):"Remains"===t?I("Just",ig):"JustRemains"===t?I("Just",iv):"Choice"===t?I("Just",im):"LeftOne"===t?I("Just",ih):"LeftAll"===t?I("Just",iC):T),uh=(t=>{let e=ut(t);return aY(t=>{let n=e._1(t);return"Left"===n.tag?F("Left",{path:n._1.path,message:"Could not decode NonEmptyArray",causes:[n._1]}):"Right"===n.tag?n._1.length>0?F("Right",n._1):F("Left",{path:aN,message:"Could not decode NonEmptyArray, unexpected value found",causes:[]}):void m()},t=>tl(e._2(t)._1,t))})(a7(un(un(un(un(ue)()()({reflectSymbol:()=>"mode"}))()()(ur))()()(ui))()()(uo).rowListCodec({mode:um,count:a6,cards:ut(a6),disabled:a9}))),uC=ut(a7(un(un(ue)()()(ur))()()({reflectSymbol:()=>"conditions"}).rowListCodec({conditions:uh,disabled:a9}))),uy=a7(un(un(ue)()()({reflectSymbol:()=>"name"}))()()(ui).rowListCodec({name:a3,count:a6})),ub=a7(un(un(un(ue)()()({reflectSymbol:()=>"others"}))()()({reflectSymbol:()=>"hand"}))()()(uo).rowListCodec({cards:ut(uy),others:a6,hand:a6})),uR=a7(un(un(ue)()()({reflectSymbol:()=>"deck"}))()()({reflectSymbol:()=>"condition"}).rowListCodec({deck:ub,condition:uC})),uS=(()=>{let t=tR.traverse(E)(t=>e=>({mode:t.condition.mode,count:t.condition.count,cards:(()=>{let n=ua(t=>t8(M,T,e=>e===t,e))(t.condition.cards);return eo(t6.compare)("Nothing"===n.tag?[]:"Just"===n.tag?n._1:void m())})(),disabled:t.disabled})),e=tR.traverse(E)(e=>{let n=e.disabled,r=t(e.conditions);return t=>({conditions:r(t),disabled:n})}),n=tR.traverse(u_)(t=>{let e=t.cards,n=t.count,r=t.disabled,i=t.mode;return ul(ud)(t=>ul(uc)(o=>ul((()=>{let n=ua(e=>e>=0&&e<t.length?I("Just",t[e]):T)(e),r="Nothing"===n.tag?F("Left",{path:aN,message:"Could not decode conditions",causes:[]}):"Just"===n.tag?F("Right",n._1):void m();return t=>()=>r})())(t=>u_.pure({id:o,condition:{mode:i,count:n,cards:t},disabled:r}))))}),r=tR.traverse(u_)(t=>{let e=t.disabled;return up(t=>{let n=uc(t);return()=>{let t=n();return"Left"===t.tag?F("Left",t._1):"Right"===t.tag?F("Right",(()=>{let n=t._1;return t=>({id:n,conditions:t,disabled:e})})()):void m()}})(n(t.conditions))});return aY(t=>{let e=t.deck.hand,n=t.deck.others,i=t.condition;return uu.bind(uv(t=>{let e=t.count,n=t.name;return()=>{let t=ug();return"Left"===t.tag?F("Left",t._1):"Right"===t.tag?F("Right",{id:t._1,name:n,count:e}):void m()}})(t.deck.cards))(t=>uu.bind(r(i)(y(t=>t.id)(t)))(r=>uf.pure({deck:{cards:t,hand:e,others:n},condition:r})))},t=>tl({deck:{cards:y(t=>({name:t.name,count:t.count}))(t.deck.cards),hand:t.deck.hand,others:t.deck.others},condition:e(t.condition)(y(t=>t.id)(t.deck.cards))},t))})(),uw=aY(t=>uu.bind((()=>{let e=uR._1(t);return()=>e})())(uS._1),t=>{let e=uS._2(t);return tl(uR._2(e._1)._1,e._2)}),uN=(t,e,n)=>({tag:t,_1:e,_2:n}),uE={reflectSymbol:()=>"result"},ux={reflectSymbol:()=>"deck"},uJ={reflectSymbol:()=>"condition"},uA=r7()(uJ)(rE),uL=t=>()=>{},uB=nF(rY),uk=uB.liftEffect(rw),uI=io()(uJ)(rE),uT=(()=>{let t=tF(rC).mempty;return e=>n=>"Nothing"===n.tag?t:"Just"===n.tag?e(n._1):void m()})(),uM=tL(tB("Bind",nB("State",t=>tl(t,t)),t=>tL(tB("Return",t),tE)),tE),uO=io()(ux)(t5),uq=ti(tq)(ta),uP=io()(uE)(t5),uF=ia()(uJ)(rE),uU=tR.traverse(P),uD=t=>e=>{let n=e,r=!0,i;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,i=T;continue}if("Node"===e.tag){let o=t4.compare(t)(e._3);if("LT"===o){n=e._5;continue}if("GT"===o){n=e._6;continue}if("EQ"===o){r=!1,i=I("Just",e._4);continue}}m()}return i},uz=uN("Initialize"),uG=uN("PrepareDefaultState"),uQ=t=>uN("UpdateDeck",t),uj=uN("AddCondition"),uH=t=>e=>uN("ReceiveConditionUpdated",t,e),uW=uN("SaveState"),uZ=(()=>{let t=v(()=>{let e=e$(W);return n=>{if("Initialize"===n.tag){let e=uB.liftEffect(aO),n=e=>{let n=e.emitter;return tL(tB("Bind",nB("Subscribe",t=>n,nk),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let n=uB.liftEffect(aV),r=n=>tL(tB("Bind",nB("State",t=>tl(void 0,{...t,pushState:t=>n.pushState(t)("#"+aR(uw._2(t)._1)),replaceState:t=>n.replaceState(t)("#"+aR(uw._2(t)._1))})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>{let r=uB.liftEffect(n.listen(t=>e.listener(null!==t.state?uN("ApplyState",t.state):""!==t.hash?uN("RestoreState",t.hash):uG))),i=()=>{let e=e=>t()(null!==e.state?uN("ApplyState",e.state):""!==e.hash?uN("RestoreState",e.hash):uG),r=uB.liftEffect(n.locationState);return tL(r._1,"CatNil"===r._2.tag?tN("CatCons",e,tS(tg,tg)):"CatCons"===r._2.tag?tN("CatCons",r._2._1,tS(r._2._2._1,tp("Cons",tN("CatCons",e,tS(tg,tg)),r._2._2._2))):void m())};return tL(r._1,"CatNil"===r._2.tag?tN("CatCons",i,tS(tg,tg)):"CatCons"===r._2.tag?tN("CatCons",r._2._1,tS(r._2._2._1,tp("Cons",tN("CatCons",i,tS(tg,tg)),r._2._2._2))):void m())},tS(tg,tg)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",r,tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",r,tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)))};return tL(e._1,"CatNil"===e._2.tag?tN("CatCons",n,tS(tg,tg)):"CatCons"===e._2.tag?tN("CatCons",e._2._1,tS(e._2._2._1,tp("Cons",tN("CatCons",n,tS(tg,tg)),e._2._2._2))):void m())}if("PrepareDefaultState"===n.tag)return tL(uk._1,"CatNil"===uk._2.tag?tN("CatCons",t=>{let e=e=>{let n=n=>tL(tB("Bind",nB("State",t=>tl(t.replaceState,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",r=>uB.liftEffect(r({deck:{cards:[{id:t,name:"Card1",count:3}],others:37,hand:5},condition:[{id:n,conditions:[{id:e,condition:{mode:i_,count:1,cards:[t]},disabled:!1}],disabled:!1}]})),tS(tg,tg)));return tL(uk._1,"CatNil"===uk._2.tag?tN("CatCons",n,tS(tg,tg)):"CatCons"===uk._2.tag?tN("CatCons",uk._2._1,tS(uk._2._2._1,tp("Cons",tN("CatCons",n,tS(tg,tg)),uk._2._2._2))):void m())};return tL(uk._1,"CatNil"===uk._2.tag?tN("CatCons",e,tS(tg,tg)):"CatCons"===uk._2.tag?tN("CatCons",uk._2._1,tS(uk._2._2._1,tp("Cons",tN("CatCons",e,tS(tg,tg)),uk._2._2._2))):void m())},tS(tg,tg)):"CatCons"===uk._2.tag?tN("CatCons",uk._2._1,tS(uk._2._2._1,tp("Cons",tN("CatCons",t=>{let e=e=>{let n=n=>tL(tB("Bind",nB("State",t=>tl(t.replaceState,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",r=>uB.liftEffect(r({deck:{cards:[{id:t,name:"Card1",count:3}],others:37,hand:5},condition:[{id:n,conditions:[{id:e,condition:{mode:i_,count:1,cards:[t]},disabled:!1}],disabled:!1}]})),tS(tg,tg)));return tL(uk._1,"CatNil"===uk._2.tag?tN("CatCons",n,tS(tg,tg)):"CatCons"===uk._2.tag?tN("CatCons",uk._2._1,tS(uk._2._2._1,tp("Cons",tN("CatCons",n,tS(tg,tg)),uk._2._2._2))):void m())};return tL(uk._1,"CatNil"===uk._2.tag?tN("CatCons",e,tS(tg,tg)):"CatCons"===uk._2.tag?tN("CatCons",uk._2._1,tS(uk._2._2._1,tp("Cons",tN("CatCons",e,tS(tg,tg)),uk._2._2._2))):void m())},tS(tg,tg)),uk._2._2._2))):void m());if("UpdateDeck"===n.tag){let e=n._1;return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,deck:e})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>t()(uW),tS(tg,tg)))}if("AddCondition"===n.tag){let e=e=>tL(tB("Bind",nB("State",t=>tl(void 0,{...t,conditions:eu(t.conditions)(e)})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>t()(uW),tS(tg,tg)));return tL(uk._1,"CatNil"===uk._2.tag?tN("CatCons",e,tS(tg,tg)):"CatCons"===uk._2.tag?tN("CatCons",uk._2._1,tS(uk._2._2._1,tp("Cons",tN("CatCons",e,tS(tg,tg)),uk._2._2._2))):void m())}if("RemoveCondition"===n.tag){let e=n._1;return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,conditions:ep(rN.eq)(e)(t.conditions)})),t=>tL(tB("Return",t),tE)),tN("CatCons",()=>t()(uW),tS(tg,tg)))}if("ToggleDisabled"===n.tag){let e=uI(C)(n._1)(oW);return tL(e._1,"CatNil"===e._2.tag?tN("CatCons",()=>t()(uW),tS(tg,tg)):"CatCons"===e._2.tag?tN("CatCons",e._2._1,tS(e._2._2._1,tp("Cons",tN("CatCons",()=>t()(uW),tS(tg,tg)),e._2._2._2))):void m())}if("SwapPrev"===n.tag){let t=n._1;return tL(tB("Bind",nB("State",t=>tl(t.conditions,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",e=>uT(t=>{let e=t-1|0,n=oc(e)(e+1|0);return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,conditions:n(t.conditions)})),t=>tL(tB("Return",t),tE)),tE)})(t8(M,T,e=>e===t,e)),tS(tg,tg)))}if("SwapNext"===n.tag){let t=n._1;return tL(tB("Bind",nB("State",t=>tl(t.conditions,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",e=>uT(t=>{let e=oc(t)(t+1|0);return tL(tB("Bind",nB("State",t=>tl(void 0,{...t,conditions:e(t.conditions)})),t=>tL(tB("Return",t),tE)),tE)})(t8(M,T,e=>e===t,e)),tS(tg,tg)))}if("ReceiveConditionUpdated"===n.tag){if("Updated"===n._2)return t()(uW);if("AllConditionDeleted"===n._2)return t()(uN("RemoveCondition",n._1));m()}if("RestoreState"===n.tag){let r=e3("#")(n._1),i=uB.liftEffect((()=>{let t=(()=>{if("Just"===r.tag){var t=r._1;try{return M(decodeURIComponent(t))}catch(e){let t;return T}}if("Nothing"===r.tag)return T;m()})();return e.bind((()=>{let e=ap(U,D,"Nothing"===t.tag?"":"Just"===t.tag?t._1:void m()),n="Left"===e.tag?F("Left",{path:aN,message:e._1,causes:[]}):"Right"===e.tag?F("Right",e._1):void m();return()=>n})())(uw._1)})()),o=e=>{if("Left"===e.tag){var n;let r=uB.liftEffect((n="Failed to decode JSON: "+ak(e._1),function(){console.error(n)}));return tL(r._1,"CatNil"===r._2.tag?tN("CatCons",()=>t()(uG),tS(tg,tg)):"CatCons"===r._2.tag?tN("CatCons",r._2._1,tS(r._2._2._1,tp("Cons",tN("CatCons",()=>t()(uG),tS(tg,tg)),r._2._2._2))):void m())}if("Right"===e.tag){let t=e._1;return tL(tB("Bind",nB("State",t=>tl(t.replaceState,t)),t=>tL(tB("Return",t),tE)),tN("CatCons",e=>uB.liftEffect(e(t)),tS(tg,tg)))}m()};return tL(i._1,"CatNil"===i._2.tag?tN("CatCons",o,tS(tg,tg)):"CatCons"===i._2.tag?tN("CatCons",i._2._1,tS(i._2._2._1,tp("Cons",tN("CatCons",o,tS(tg,tg)),i._2._2._2))):void m())}if("ApplyState"===n.tag){let t=n._1.deck,e=n._1.condition,r=y(t=>t.id)(e);return tL(uM._1,tN("CatCons",n=>{let i=tB("Bind",nB("State",e=>tl(void 0,{...e,deck:t,conditions:r})),t=>tL(tB("Return",t),tE));return tX(t=>e=>t.count===e.count&&t.id===e.id&&t.name===e.name)(t.cards)(n.deck.cards)&&t.hand===n.deck.hand&&t.others===n.deck.others&&tX(rN.eq)(r)(n.conditions)?tL(tB("Return",void 0),tN("CatCons",()=>{let n=uq(e)(t=>uI(C)(t.id)(oH(t.conditions)(t.disabled)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>uP(C)()(oE(t)(iR(e))),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>uP(C)()(oE(t)(iR(e))),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg))):tL(i,tN("CatCons",()=>uO(C)()(ai(t)),tS(tg,tp("Cons",tN("CatCons",()=>{let n=uq(e)(t=>uI(C)(t.id)(oH(t.conditions)(t.disabled)));return tL(n._1,"CatNil"===n._2.tag?tN("CatCons",()=>uP(C)()(oE(t)(iR(e))),tS(tg,tg)):"CatCons"===n._2.tag?tN("CatCons",n._2._1,tS(n._2._2._1,tp("Cons",tN("CatCons",()=>uP(C)()(oE(t)(iR(e))),tS(tg,tg)),n._2._2._2))):void m())},tS(tg,tg)),tg))))},tS(tg,tg)))}if("SaveState"===n.tag)return tL(uM._1,tN("CatCons",t=>{let e=t.deck,n=t.conditions,r=uF(C)(oj),i=r=>uB.liftEffect(t.pushState({deck:e,condition:(()=>{let t=uU(t=>{let e=uD(t)(r);return"Just"===e.tag?I("Just",{...e._1,id:t}):T})(n);return"Nothing"===t.tag?[]:"Just"===t.tag?t._1:void m()})()}));return tL(r._1,"CatNil"===r._2.tag?tN("CatCons",i,tS(tg,tg)):"CatCons"===r._2.tag?tN("CatCons",r._2._1,tS(r._2._2._1,tp("Cons",tN("CatCons",i,tS(tg,tg)),r._2._2._2))):void m())},tS(tg,tg)));m()}}),e=t();return{initialState:t=>({deck:{cards:[],others:0,hand:0},conditions:[],pushState:uL,replaceState:uL}),render:t=>ny("Elem",T,"div",[ra("relative overflow-x-clip")],[ny("Elem",T,"header",[ra("flex items-baseline px-2")],[ny("Elem",T,"h1",[ra("p-1 text-lg")],[ny("Elem",T,"a",[rr("#")],[ny("Text","Draw Calculator")])]),ny("Text","-"),ny("Elem",T,"h2",[ra("p-1")],[ny("Text","TCG 用ドロー確率計算機")])]),ny("Elem",T,"main",[ra("relative mb-[80vh] flex max-w-4xl flex-col gap-3 p-1")],[ny("Elem",T,"div",[ra("flex flex-wrap gap-1")],[ny("Elem",T,"div",[ra("grow")],[r7()(ux)(t5)(C)()(ac)()(uQ)]),ny("Elem",T,"div",[ra("flex grow basis-0 items-center justify-end rounded border-2 border-cyan-400 p-1")],[r6()(uE)(t5)(C)()(ox)()])]),ny("Elem",T,"ul",[ra("flex flex-col gap-1")],y((()=>{let e={...t.deck,cards:ee(t=>""!==t.name,t.deck.cards)};return t=>ny("Elem",T,"li",[ra("flex items-start gap-1")],[ny("Elem",T,"div",[ra("flex flex-col")],[rl(ny("Elem",T,"i",[ra("fa-solid fa-angle-up")],[]))("text-gray-500 hover:bg-gray-200")(uN("SwapPrev",t)),rl(ny("Elem",T,"i",[ra("fa-solid fa-xmark")],[]))("text-gray-500 hover:bg-gray-200")(uN("RemoveCondition",t)),rl(ny("Elem",T,"i",[ra("fa-solid fa-arrows-rotate")],[]))("text-gray-500 hover:bg-gray-200")(uN("ToggleDisabled",t)),rl(ny("Elem",T,"i",[ra("fa-solid fa-angle-down")],[]))("text-gray-500 hover:bg-gray-200")(uN("SwapNext",t))]),uA(C)(t)(oY)(e)(uH(t))])})())(t.conditions)),ny("Elem",T,"div",[],[rl(ny("Elem",T,"i",[ra("fa-solid fa-plus")],[]))("border border-sky-500 text-sky-700 hover:bg-sky-200")(uj)])]),ny("Elem",T,"footer",[ra("flex items-baseline px-2")],[ny("Elem",T,"a",[ra("m-1 rounded border border-sky-500 px-2 py-1 text-sm"),rr("https://github.com/acple/tcg-calculator"),rt("_blank"),n8("noopener noreferrer")],[ny("Text","→ 使い方とかソース")])])]),eval:n4({...n6,handleAction:e,initialize:I("Just",uz)})}})(),uK=function(t){return function(e){return function(){return e[t]}}};uK("children"),uK("firstElementChild"),uK("lastElementChild"),uK("childElementCount");var u$=t=>{let e=function(e){return function(){return e.querySelector(t)}};return t=>{let n=e(t);return()=>eK(n(),T,M)}},uV="Loading",uY=t=>()=>{let e=t.readyState;return"loading"===e?uV:"interactive"===e?"Interactive":"complete"===e?"Complete":uV},uX=t=>rO(rq((()=>{let e=u$(t);return()=>e(aj(az())())()})()))(t=>rI((()=>{if("Just"===t.tag){var e,n;return e=t._1,0===(n=Object.prototype.toString.call(e)).indexOf("[object HTML")&&n.indexOf("Element]")===n.length-8?M(e):T}if("Nothing"===t.tag)return T;m()})())),u1=r5(t=>"Left"===t.tag?rJ(t._1):"Right"===t.tag?()=>{}:void m()),u0=rO(rP(t=>()=>{if("Loading"===uY(aj(az())())()){var e;let n=az(),r=nc(e=>t(F("Right",void 0)))();nf("DOMContentLoaded")(r)(!1)(n)();let i=rq((e="DOMContentLoaded",function(t){return function(n){return function(r){return function(){return r.removeEventListener(e,t,n)}}}})(r)(!1)(n));return t=>i}return t(F("Right",void 0))(),r4}))(()=>rO(uX("body"))(t=>{let e=rT(rx("Could not find body"));return"Nothing"===t.tag?e:"Just"===t.tag?rI(t._1):void m()})),u2=(t,e)=>({tag:"CoyonedaF",_1:t,_2:e}),u3=(t,e,n)=>({tag:t,_1:e,_2:n}),u5=tr($)(to),u4=t=>e=>{let n=e,r=!0,i;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,i=T;continue}if("Node"===e.tag){let o=t6.compare(t)(e._3);if("LT"===o){n=e._5;continue}if("GT"===o){n=e._6;continue}if("EQ"===o){r=!1,i=I("Just",e._4);continue}}m()}return i},u6=tr(rZ),u7=u6(tm),u8=rL(r$)(rV)(tm)(rA),u9=u6(to),lt=t=>e=>{let n=e,r=!0,i;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,i=T;continue}if("Node"===e.tag){let o=t6.compare(t)(e._3);if("LT"===o){n=e._5;continue}if("GT"===o){n=e._6;continue}if("EQ"===o){r=!1,i=I("Just",e._4);continue}}m()}return i},le=t=>e=>{let n=e,r=!0,i;for(;r;){let e=n;if("Leaf"===e.tag){r=!1,i=T;continue}if("Node"===e.tag){let o=t4.compare(t)(e._3);if("LT"===o){n=e._5;continue}if("GT"===o){n=e._6;continue}if("EQ"===o){r=!1,i=I("Just",e._4);continue}}m()}return i},ln=(t=>{let e=t.Monad0(),n=e.Bind1().Apply0().Functor0();return r=>t.tailRecM(t=>{let i=tk(t);return"Return"===i.tag?n.map(X)(e.Applicative0().pure(i._1)):"Bind"===i.tag?n.map(t=>Y("Loop",i._2(t)))(r(i._1)):void m()})})({tailRecM:t=>{let e=n=>rO(t(n))(t=>"Done"===t.tag?rI(t._1):"Loop"===t.tag?e(t._1):void m());return e},Monad0:()=>rj}),lr=(t=>{let e=t.compare;return t=>n=>r=>{let i=ew(e,n,r),o=t(i._1);return"Nothing"===o.tag?eE(i._2,i._3):"Just"===o.tag?eS(n,o._1,i._2,i._3):void m()}})(t4),li=t=>e=>()=>{let n=e.value.subscriptions.value;return u5(aM)((()=>{let e=u4(t);return"Just"===n.tag?e(n._1):"Nothing"===n.tag?T:void m()})())()},lo=t=>e=>rO(rq(()=>t.value))(n=>"Nothing"===n.tag?e:"Just"===n.tag?rq(()=>t.value=I("Just",tp("Cons",e,n._1))):void m()),la=t=>e=>rO(rq(()=>t.value={initializers:tg,finalizers:tg}))(()=>rO(rq(e))(e=>rO(rq(()=>t.value))(t=>{let n=t.initializers;return rO(u7(rz)(t.finalizers))(()=>rO(u8(n))(()=>rI(e)))}))),lu=r5(t=>"Left"===t.tag?rJ(t._1):"Right"===t.tag?()=>{}:void m()),ll=t=>e=>rO(rq(()=>e.value))(e=>{var n;return rq((n=e=>({state:e+1|0,value:t(e)}),function(t){return function(){var e=n(t.value);return t.value=e.state,e.value}})(e.fresh))}),ld=t=>e=>n=>rO(rq(()=>e.value))(r=>ls(t)(e)(r.component.eval(u3("Query",u2(t=>I("Just",t),n),t=>T)))),ls=t=>e=>n=>ln(n=>{if("State"===n.tag)return rO(rq(()=>e.value))(r=>{let i=n._1(r.state);if(aI(r.state)(i._2))return rI(i._1);let o=i._1;return rO(rq((()=>{let t={...r,state:i._2};return()=>e.value=t})()))(()=>rO(la(r.lifecycleHandlers)(t(r.lifecycleHandlers)(e)))(()=>rI(o)))});if("Subscribe"===n.tag)return rO(ll(nI)(e))(r=>rO(rq(n._1(r)(n=>{let r=lu(lc(t)(e)(eZ("Action",n)));return()=>{r()}})))(t=>rO(rq(()=>e.value))(e=>rO(rq((()=>{let n=eJ(t6)(r)(t),i=e.subscriptions;return()=>{let t=i.value;i.value="Just"===t.tag?I("Just",n(t._1)):T}})()))(()=>rI(n._2(r))))));if("Unsubscribe"===n.tag){let t=n._2;return rO(rq(li(n._1)(e)))(()=>rI(t))}if("Lift"===n.tag)return n._1;if("ChildQuery"===n.tag){let r=n._1;return rO(rq(()=>e.value))(e=>{let n=r._2;return rM(r._3)(rF(r._1(rV)(e=>rO(rq(()=>e.value))(e=>ld(t)(e.selfRef)(n)))(e.children)))})}if("Raise"===n.tag){let t=n._2,r=n._1;return rO(rq(()=>e.value))(e=>{let n=e.handlerRef,i=e.pendingOuts;return rO(rq(()=>n.value))(e=>rO(lo(i)(e(r)))(()=>rI(t)))})}if("Par"===n.tag)return rF(nx(rV)(nS)((()=>{let r=ls(t)(e);return nx(nA)(t=>nR("Lift",r(t)))(n._1)})()));if("Fork"===n.tag){let r=n._1;return rO(ll(nT)(e))(i=>rO(rq(()=>e.value))(o=>{let a=o.forks;return rO(rq(()=>({value:!1})))(o=>rO(rz(rK(rq((()=>{let t=eT(t6)(i);return()=>{let e=a.value;return a.value=t(e),o.value=!0}})()))(ls(t)(e)(r))))(t=>rO(rq((()=>{let e=eJ(t6)(i)(t);return()=>{let t=o.value;if(!t){let t=a.value;a.value=e(t);return}t||m()}})()))(()=>rI(n._2(i)))))}))}if("Join"===n.tag){let t=n._2,r=n._1;return rO(rq(()=>e.value))(e=>{let n=e.forks;return rO(rq(()=>n.value))(e=>rO(u9(rX)(lt(r)(e)))(()=>rI(t)))})}if("Kill"===n.tag){let t=n._2,r=n._1;return rO(rq(()=>e.value))(e=>{let n=e.forks;return rO(rq(()=>n.value))(e=>rO(u9(r1(rx("Cancelled")))(lt(r)(e)))(()=>rI(t)))})}if("GetRef"===n.tag){let t=n._1;return rO(rq(()=>e.value))(e=>rI(n._2(le(t)(e.refs))))}m()})(n),lc=t=>e=>n=>{if("RefUpdate"===n.tag){let t=n._2,r=n._1;return rq(()=>{let n=e.value;e.value={...n,refs:lr(e=>t)(r)(n.refs)}})}if("Action"===n.tag){let r=n._1;return rO(rq(()=>e.value))(n=>ls(t)(e)(n.component.eval(u3("Action",r,void 0))))}m()},lf=ti($)(to),l_=tr(rZ)(tm),lp=tr($),lg=lp(to),lv=lp(eL),lm=rL(r$)(rV)(tm)(rA),lh=(t=>{let e=tr(t)(eL);return t=>n=>e(t=>n(t))(t)})($),lC=(()=>{let t=tr($)(to);return e=>n=>t(e)(n.rendering)})(),ly=()=>({value:{initializers:tg,finalizers:tg}}),lb=t=>()=>{let e=t.value;return t.value=T,lf(e)((()=>{let t=l_(rz);return e=>lu(t((t=>{let e=tg,n=t,r=!0,i;for(;r;){let t=e,o=n;if("Nil"===o.tag){r=!1,i=t;continue}if("Cons"===o.tag){e=tp("Cons",o._1,t),n=o._2;continue}m()}return i})(e)))})())()},lR=t=>{let e=lg(lv(aM)),n=t.subscriptions;return()=>{e(n.value)(),t.subscriptions.value=T;let r=t.forks.value;return lv((()=>{let t=r1(rx("finalized"));return e=>lu(t(e))})())(r)(),t.forks.value=eb}},lS=t=>e=>n=>{let r=t=>e=>n=>{let r=ls(a)(n.selfRef)(n.component.eval(u3("Initialize",void 0)));return()=>{let i=t.value;t.value={initializers:tp("Cons",rO(lm((t=>{let e=tg,n=t,r=!0,i;for(;r;){let t=e,o=n;if("Nil"===o.tag){r=!1,i=t;continue}if("Cons"===o.tag){e=tp("Cons",o._1,t),n=o._2;continue}m()}return i})(i.initializers)))(()=>rO(r)(()=>rq((()=>{let t=lb(n.pendingQueries);return()=>(t(),lb(n.pendingOuts)())})()))),e),finalizers:i.finalizers}}},i=t=>e=>n=>i=>()=>{let o=ly(),u={value:{}},l={value:I("Just",tg)},d={value:I("Just",tg)},s={value:I("Just",eb)};u.value={component:i,state:i.initialState(n),refs:eb,children:eb,childrenIn:{value:eb},childrenOut:{value:eb},selfRef:u,handlerRef:{value:e},pendingQueries:l,pendingOuts:d,pendingHandlers:{value:T},rendering:T,fresh:{value:1},subscriptions:s,forks:{value:eb},lifecycleHandlers:o};let c=t.value;t.value={initializers:tg,finalizers:c.finalizers};let f=u.value;a(t)(f.selfRef)();let _=u.value;return r(t)(c.initializers)(_)(),u},o=e=>n=>r=>o=>u=>()=>{let l=r.value,d=u.pop(l),s=(()=>{if("Just"===d.tag){r.value=d._1._2;let t=d._1._1.value,e=rI();return t.handlerRef.value=t=>{let r=u.output(t);return"Nothing"===r.tag?e:"Just"===r.tag?n(r._1):void m()},lu(ls(a)(t.selfRef)(t.component.eval(u3("Receive",u.input,void 0))))(),d._1._1}if("Nothing"===d.tag)return i(e)((()=>{let t=rI();return e=>{let r=u.output(e);return"Nothing"===r.tag?t:"Just"===r.tag?n(r._1):void m()}})())(u.input)(u.component)();m()})(),c=o.value;(()=>{let t=u.get(c);return"Nothing"!==t.tag&&("Just"===t.tag||void m())})()&&console.warn("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur");let f=o.value;o.value=u.set(s)(f);let _=s.value;return"Nothing"===_.rendering.tag?rJ(rx("Halogen internal error: child was not initialized in renderChild"))():"Just"===_.rendering.tag?t.renderChild(_.rendering._1):void m()},a=e=>n=>()=>{let r=n.value,i=r.pendingHandlers.value,l="Nothing"===i.tag||"Just"!==i.tag&&void m();l&&(r.pendingHandlers.value=I("Just",tg)),r.childrenOut.value=eb,r.childrenIn.value=r.children;let d=r.pendingHandlers,s=t.render((()=>{let t=rM(t=>{});return e=>lu(lo(d)(t(lc(a)(r.selfRef)(e))))})())(o(e)((()=>{let t=rM(t=>{});return e=>lo(r.pendingQueries)(lo(d)(t(lc(a)(r.selfRef)(eZ("Action",e)))))})())(r.childrenIn)(r.childrenOut))(r.component.render(r.state))(r.rendering)(),c=r.childrenOut.value;lh(r.childrenIn.value)(n=>()=>{let r=n.value;return lC(t.removeChild)(r)(),u(e)(r)()})();let f=r.selfRef.value;r.selfRef.value={...f,rendering:I("Just",s),children:c};let _=tt(t=>()=>{let t=d.value;d.value=I("Just",tg),lg((()=>{let t=l_(rz);return e=>lu(t((t=>{let e=tg,n=t,r=!0,i;for(;r;){let t=e,o=n;if("Nil"===o.tag){r=!1,i=t;continue}if("Cons"===o.tag){e=tp("Cons",o._1,t),n=o._2;continue}m()}return i})(e)))})())(t)();let e=d.value;return"Nothing"!==e.tag&&("Just"===e.tag?"Nil"===e._1.tag:void m())?(d.value=T,Y("Done",void 0)):Y("Loop",void 0)})();if(l)return _()},u=t=>e=>{let n=lR(e);return()=>{n();let r=t.value;return t.value={initializers:r.initializers,finalizers:tp("Cons",ls(a)(e.selfRef)(e.component.eval(u3("Finalize",void 0))),r.finalizers)},lh(e.children)(e=>()=>{let n=e.value;return u(t)(n)()})()}};return rO(rq(ly))(r=>rO(rq(()=>({value:!1})))(o=>la(r)(()=>{let l=aO(),d=i(r)(t=>rq(l.listener(t)))(n)(e)().value;return{query:(()=>{let t=d.selfRef;return e=>rO(rq(()=>o.value))(n=>n?rI(T):ld(a)(t)(e))})(),messages:l.emitter,dispose:la(r)(()=>{if(!o.value)return o.value=!0,u(r)(d)(),lf(d.selfRef.value.rendering)(t.dispose)()})}})))},lw=tr($)(to),lN=t=>t,lE=t=>e=>n=>{if("Just"===n.tag){if("Just"===e.tag){let r=(function(e){return function(n){return function(){n.insertBefore(t,e)}}})(e._1)(n._1);return()=>{r()}}if("Nothing"===e.tag){let e=aD(t)(n._1);return()=>{e()}}}return()=>{}},lx=t=>{let e=t.node,n=aF(e);return()=>{let t=n();return lw(t=>(function(t){return function(){t.removeChild(e)}})(t))(eK(t,T,M))()}},lJ=t=>e=>n=>({buildWidget:t=>{let n=n2(tC)(t),r=t=>e9((0,e.value)(t)().node,T,o,t=>{if("Just"===t.tag)return ne(t._1)}),i=t=>{if("ComponentSlot"===t.tag)return r(t._1);if("ThunkSlot"===t.tag){let e=n(t._1);return e9(e._1,I("Just",e),o,t=>{if("Just"===t.tag)return ne(t._1)})}m()},o=(t,e)=>{if("Just"===t.tag){if("ComponentSlot"===e.tag){let n=e._1;return ne(t._1),r(n)}if("ThunkSlot"===e.tag){let n=e._1,r=nt(t._1,n);return e9(r._1,I("Just",r),o,t=>{if("Just"===t.tag)return ne(t._1)})}m()}return i(e)};return i},buildAttributes:nh(t),document:n}),lA=t=>e=>({render:n=>r=>i=>o=>{if("Nothing"===o.tag)return()=>{let o={value:r},a=n1(lJ(n)(o)(t))(i);return aD(a._1)(e)(),{machine:a,node:a._1,renderChildRef:o}};if("Just"===o.tag){let t=o._1.machine,e=o._1.node,n=o._1.renderChildRef;return()=>{n.value=r;let o=aF(e)(),a=aU(e)(),u=nt(t,i),l=lE(u._1)(eK(a,T,M))(eK(o,T,M));return aI(e)(u._1)||l(),{machine:u,node:u._1,renderChildRef:n}}}m()},renderChild:lN,removeChild:lx,dispose:lx}),lL=t=>e=>n=>rO(rq(()=>aj(az())()))(r=>lS(lA(r)(n))(t)(e));u1(rO(u0)(t=>lL(uZ)()(t)))()})();
//# sourceMappingURL=tcg-calculator.3608b4e0.js.map
